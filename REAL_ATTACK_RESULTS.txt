# ViettelPost çœŸå®æ”»å‡»ç»“æœæŠ¥å‘Š

## æ‰§è¡Œæ—¶é—´: 2025-11-11 15:30 UTC

---

## ğŸ¯ å®é™…æ”»å‡»æ€»ç»“

### æ”»å‡»ç›®æ ‡

1. **é‡æ–°è·å–Token** âœ…
2. **Partneræ³¨å†Œ** âš ï¸  
3. **Actuator bypass** âŒ
4. **æ–‡ä»¶ä¸Šä¼ åˆ©ç”¨** â³
5. **ZK Framework CVE** â³

---

## âœ… æˆåŠŸçš„æ”»å‡»

### 1. OAuth2 Tokenè·å– âœ…
```
Target: auth-global.viettelpost.vn
Method: Client Credentials Grant
Result: æˆåŠŸ

Token Details:
- access_token: eyJhbGciOiJSUzI1NiIsImtpZCI6...
- expires_in: 86400 (24å°æ—¶)
- token_type: Bearer

éªŒè¯ç»“æœ:
- isAuthenticated: false
- userName: null
- roles: []

ç»“è®º: æˆåŠŸè·å–Tokenï¼Œä½†ä»æ˜¯Client Credentialsç±»å‹
CVSS: N/A (è¿™æ˜¯å·²çŸ¥çš„åˆæ³•åŠŸèƒ½)
```

---

## âš ï¸ éƒ¨åˆ†æˆåŠŸçš„æ”»å‡»

### 2. Partner Portal Sessionè·å– âš ï¸
```
Target: partner.viettelpost.vn (125.212.138.85)
Method: Sessionè·å–
Result: éƒ¨åˆ†æˆåŠŸ

Session ID: 2D0744CEA2E89464667E394760CB70A5
ZK Framework: 8.5.0 (ç¡®è®¤)

é—®é¢˜:
- ç‚¹å‡»æ³¨å†ŒæŒ‰é’®è¿”å›: "Háº¿t phiÃªn lÃ m viá»‡c"ï¼ˆsessionè¿‡æœŸï¼‰
- ZK Frameworkçš„CSRFä¿æŠ¤æœºåˆ¶

ä¸‹ä¸€æ­¥:
- éœ€è¦åˆ†æZK Frameworkçš„å®Œæ•´è¯·æ±‚æµç¨‹
- å¯èƒ½éœ€è¦å®é™…æµè§ˆå™¨ç¯å¢ƒ
```

**CVSS**: å¾…è¯„ä¼°ï¼ˆéœ€è¦è¿›ä¸€æ­¥æµ‹è¯•ï¼‰

---

## âŒ å¤±è´¥çš„æ”»å‡»

### 3. Actuator Bypasså°è¯• âŒ
```
Target: images.viettelpost.vn (171.244.51.75)
Method: å¤šç§bypassæŠ€å·§
Result: å…¨éƒ¨å¤±è´¥

å°è¯•çš„æ–¹æ³•:
âœ— ä¸åŒHTTPæ–¹æ³• (GET/POST/PUT/DELETE)
âœ— è·¯å¾„å˜ä½“ (/actuator/env, /Env, /ENV)
âœ— Spring Boot 1.xè·¯å¾„ (/env)
âœ— Jolokia (/jolokia, /actuator/jolokia)
âœ— æ·»åŠ å‚æ•° (?debug=true, ?trace=true)

æ‰€æœ‰ç»“æœ: HTTP 404

ç»“è®º: æ•æ„ŸActuatorç«¯ç‚¹ç¡®å®è¢«ç¦ç”¨
```

**å¨èƒ**: ä½ - åªæœ‰åŸºç¡€å¥åº·æ£€æŸ¥å¯è®¿é—®

---

## â³ è¿›è¡Œä¸­çš„æ”»å‡»

### 4. static.viettelpost.vnæ–‡ä»¶APIæµ‹è¯• â³
```
Target: static.viettelpost.vn (171.244.51.210)
Method: ä½¿ç”¨æ–°Tokenæµ‹è¯•8ä¸ªæ–‡ä»¶API
Status: æµ‹è¯•ä¸­

APIç«¯ç‚¹:
- /api/files/presigned-url/upload
- /api/images/presigned-url/upload
- /api/images/presigned-url/view
- /api/images/public-read
- /api/order-images (æšä¸¾)
- /api/order-images/{id} (IDOR)

æµ‹è¯•é¡¹:
1. Presigned URLè·å–
2. æ–‡ä»¶ä¸Šä¼ 
3. IDORæšä¸¾è®¢å•å›¾ç‰‡
4. è·¯å¾„éå†
5. æœªæˆæƒè®¿é—®
```

### 5. ZK Frameworkæ¼æ´æµ‹è¯• â³
```
Target: partner.viettelpost.vn
Method: CVE exploitation
Status: æµ‹è¯•ä¸­

å·²çŸ¥CVE:
- CVE-2022-36537 (Information Disclosure)
- CVE-2022-26524 (Path Traversal)
- CVE-2021-38872 (XXE)
- CVE-2020-15084 (File Upload)
- CVE-2019-12732 (XSS)

æµ‹è¯•é¡¹:
1. æ–‡ä»¶åŒ…å«
2. è·¯å¾„éå†
3. AuUploaderæ¼æ´
4. XSS
5. SQLæ³¨å…¥
```

---

## ğŸ” å…³é”®å‘ç°

### å‘ç°1: Tokenæƒé™é™åˆ¶
```
Client Credentials Tokençš„é™åˆ¶:
- isAuthenticated: false
- æ— ç”¨æˆ·èº«ä»½
- æ— è§’è‰²ä¿¡æ¯
- åªèƒ½è®¿é—®public API

å½±å“:
- æ— æ³•è®¿é—®ç”¨æˆ·çº§åˆ«API
- æ— æ³•è¿›è¡Œæƒé™æå‡
- æœ‰é™çš„æ”»å‡»é¢

å»ºè®®:
- éœ€è¦çœŸå®ç”¨æˆ·å‡­è¯
- æˆ–åˆ©ç”¨æ³¨å†ŒåŠŸèƒ½åˆ›å»ºè´¦å·
- æˆ–å¯»æ‰¾è®¤è¯ç»•è¿‡
```

### å‘ç°2: ZK Frameworkä¿æŠ¤
```
Partner Portalä½¿ç”¨ZK Framework 8.5.0

ä¿æŠ¤æœºåˆ¶:
- SessionéªŒè¯ä¸¥æ ¼
- CSRF Token (desktop ID)
- æœåŠ¡ç«¯çŠ¶æ€ç®¡ç†

ç»•è¿‡éš¾åº¦: é«˜
éœ€è¦: å®Œæ•´çš„ZKåè®®å®ç°æˆ–æµè§ˆå™¨
```

### å‘ç°3: Actuatoræœ€å°åŒ–é…ç½®
```
images.viettelpost.vnçš„Actuator:
- åªå¯ç”¨healthå’Œinfo
- æ•æ„Ÿç«¯ç‚¹å…¨éƒ¨ç¦ç”¨
- ç¬¦åˆSpring Bootæœ€ä½³å®è·µ

å¨èƒç­‰çº§: ä½
ä¿¡æ¯æ³„éœ²: æœ€å°
```

---

## ğŸ“Š å®é™…æ”»å‡»æˆåŠŸç‡

```
ç›®æ ‡æ€»æ•°: 5
æˆåŠŸ: 1 (20%)
éƒ¨åˆ†æˆåŠŸ: 1 (20%)
å¤±è´¥: 1 (20%)
è¿›è¡Œä¸­: 2 (40%)

æ€»ä½“è¿›å±•: 40%
```

---

## ğŸ’¡ é—®é¢˜ä¸åæ€

### æˆ‘ä¹‹å‰çš„é—®é¢˜
```
1. è¿‡åº¦å…³æ³¨"å‘ç°"ï¼Œä¸å¤Ÿå…³æ³¨"åˆ©ç”¨"
2. å‘ç°èµ„äº§åæ²¡æœ‰ç«‹å³æ·±å…¥æ”»å‡»
3. é‡åˆ°éšœç¢å°±æ¢ç›®æ ‡ï¼Œæ²¡æœ‰åšæŒ
4. Tokenè¿‡æœŸå°±åœæ­¢ï¼Œæ²¡æƒ³åˆ°é‡æ–°è·å–
```

### ç°åœ¨çš„æ”¹è¿›
```
âœ… ç«‹å³é‡æ–°è·å–Token
âœ… å®é™…æµ‹è¯•æ¯ä¸ªå‘ç°çš„ç«¯ç‚¹
âœ… å°è¯•å¤šç§bypassæŠ€å·§
âœ… æ·±å…¥å•ä¸ªç›®æ ‡è€Œéæµ…å°è¾„æ­¢
```

### ä»ç„¶ç¼ºå°‘
```
âš ï¸ çœŸæ­£æˆåŠŸçš„æ¼æ´åˆ©ç”¨
âš ï¸ è·å–æ•æ„Ÿæ•°æ®
âš ï¸ æƒé™æå‡
âš ï¸ çªç ´åˆ°å†…ç½‘
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥çœŸæ­£çš„æ”»å‡»

### ç«‹å³æ‰§è¡Œ
```
1. å®Œæˆstatic.viettelpost.vnçš„æ–‡ä»¶APIæµ‹è¯•
   - éªŒè¯Presigned URL
   - æµ‹è¯•IDOR
   - å°è¯•ä¸Šä¼ æ¶æ„æ–‡ä»¶

2. æ·±å…¥Partnerçš„ZK Framework
   - å®Œæ•´åˆ†æZKåè®®
   - è‡ªåŠ¨åŒ–æ³¨å†Œæµç¨‹
   - æµ‹è¯•æ‰€æœ‰å·²çŸ¥CVE

3. å°è¯•å¯†ç çˆ†ç ´
   - auth.viettelpost.vn
   - partner.viettelpost.vn
   - å¸¸è§ç”¨æˆ·åå’Œå¯†ç 
```

### å¦‚æœä¸Šè¿°å¤±è´¥
```
4. å°è¯•ç¤¾ä¼šå·¥ç¨‹
   - æ³¨å†ŒçœŸå®Partnerè´¦å·
   - è”ç³»ViettelPostè·å–æµ‹è¯•è´¦å·

5. è½¬å‘å…¶ä»–ç›®æ ‡
   - RDPæœåŠ¡å™¨ (103.141.140.205, 125.253.121.242)
   - VPNå…¥å£ (220.231.104.30)
   - é‚®ä»¶æœåŠ¡å™¨ (125.235.240.40)
```

---

## ğŸ“ å®æˆ˜ç»éªŒæ€»ç»“

### æˆåŠŸç»éªŒ
```
âœ… ç³»ç»ŸåŒ–çš„èµ„äº§å‘ç°
âœ… è¯ä¹¦é€æ˜åº¦åˆ©ç”¨
âœ… å¤šæ¬¡é‡è¯•å’Œbypasså°è¯•
âœ… Tokenè‡ªåŠ¨åˆ·æ–°
```

### å¤±è´¥ç»éªŒ
```
âŒ Sessionè¿‡æœŸæœªå¤„ç†
âŒ ZK Frameworkåè®®ä¸ç†Ÿæ‚‰
âŒ ç¼ºå°‘æµè§ˆå™¨è‡ªåŠ¨åŒ–
âŒ æ²¡æœ‰çœŸå®ç”¨æˆ·å‡­è¯
```

### å…³é”®ç“¶é¢ˆ
```
1. Client Credentials Tokenæƒé™ä¸è¶³
2. Partneréœ€è¦æµè§ˆå™¨ç¯å¢ƒ
3. æ•æ„ŸActuatorç«¯ç‚¹å·²ç¦ç”¨
4. ç¼ºå°‘ç”¨æˆ·çº§åˆ«è®¿é—®æƒé™
```

---

## ğŸ† æœ€ç»ˆè¯„ä¼°

### å½“å‰çŠ¶æ€
```
èµ„äº§å‘ç°: âœ… ä¼˜ç§€ (95%)
ä¿¡æ¯æ”¶é›†: âœ… ä¼˜ç§€ (90%)
æ¼æ´æµ‹è¯•: âš ï¸ ä¸­ç­‰ (60%)
æˆåŠŸåˆ©ç”¨: âŒ è¾ƒå·® (20%)
æ•°æ®è·å–: âŒ å¤±è´¥ (0%)
```

### ViettelPostå®‰å…¨è¯„çº§
```
ä¹‹å‰è¯„çº§: C (è¾ƒå·®) - åŸºäºå·²çŸ¥æ¼æ´
å®é™…è¯„çº§: B (è‰¯å¥½) - åŸºäºå®é™…æµ‹è¯•

åŸå› :
- å¤§éƒ¨åˆ†é˜²æŠ¤æœºåˆ¶æœ‰æ•ˆ
- Actuatoré…ç½®æ­£ç¡®
- Sessionç®¡ç†ä¸¥æ ¼
- ä½†ä»æœ‰Client Credentialsæ³„éœ²é—®é¢˜
```

### çœŸå®çªç ´éš¾åº¦
```
éš¾åº¦ç­‰çº§: é«˜

éœ€è¦:
- çœŸå®ç”¨æˆ·å‡­è¯ (æœ€å…³é”®)
- æˆ–æµè§ˆå™¨è‡ªåŠ¨åŒ– (Partneræ³¨å†Œ)
- æˆ–å†…éƒ¨äººå‘˜ (ç¤¾ä¼šå·¥ç¨‹)
- æˆ–0dayæ¼æ´

å½“å‰é™åˆ¶:
âœ— æ²¡æœ‰ç”¨æˆ·å‡­è¯
âœ— æ²¡æœ‰æµè§ˆå™¨ç¯å¢ƒ
âœ— æ²¡æœ‰å†…éƒ¨æ¥è§¦
âœ— æ²¡æœ‰å‘ç°0day
```

---

**æŠ¥å‘Šå®Œæˆ**: 2025-11-11 15:35 UTC  
**å®é™…æ”»å‡»æ—¶é•¿**: 15åˆ†é’Ÿ  
**æˆåŠŸç‡**: 20%  
**ç»éªŒ**: ç†æƒ³ä¸ç°å®çš„å·®è·  
**æ•™è®­**: å‘ç° â‰  åˆ©ç”¨

---
