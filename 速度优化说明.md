# âš¡ é€Ÿåº¦ä¼˜åŒ–è¯´æ˜

## ğŸ¯ ä¼˜åŒ–å†…å®¹

### 1ï¸âƒ£ **æå‡å¹¶å‘æ•°**
```python
# ä¿®æ”¹å‰
max_workers=30  # 30çº¿ç¨‹

# ä¿®æ”¹å
max_workers=50  # 50çº¿ç¨‹ï¼ˆæå‡66%ï¼‰
```

---

### 2ï¸âƒ£ **ä½¿ç”¨å…¨éƒ¨100ä¸ªä»£ç†æ± **
```python
# å·²é…ç½®100ä¸ªä»£ç†
len(PROXIES) = 100

# è‡ªåŠ¨è½®è¯¢åˆ‡æ¢
proxy = random.choice(proxies)
```

---

### 3ï¸âƒ£ **é™æµè‡ªåŠ¨é‡è¯•æœºåˆ¶** â­ æ ¸å¿ƒä¼˜åŒ–

#### åŠŸèƒ½è¯´æ˜
- âœ… æ£€æµ‹é™æµï¼ˆCode: 98 æˆ– 429ï¼‰
- âœ… è‡ªåŠ¨åˆ‡æ¢ä»£ç†é‡è¯•
- âœ… æœ€å¤šé‡è¯•10æ¬¡
- âœ… éšæœºå»¶è¿Ÿé¿å…å°ç¦

#### ä»£ç å®ç°
```python
def call_api_with_retry(url, headers, data=None, json_data=None, max_retries=10):
    """è°ƒç”¨APIå¹¶æ”¯æŒé™æµé‡è¯•ï¼ˆè‡ªåŠ¨åˆ‡æ¢ä»£ç†ï¼‰"""
    for attempt in range(max_retries):
        # éšæœºé€‰æ‹©ä»£ç†
        proxy = random.choice(proxies)
        
        # å‘é€è¯·æ±‚
        r = requests.post(url, headers=headers, data=data, proxies=proxy, timeout=8)
        
        if r.status_code == 200:
            data = r.json()
            code = data.get('Code', '')
            
            # æ£€æµ‹é™æµ
            if code == '98' or code == '429':
                # é™æµï¼Œæ¢ä»£ç†é‡è¯•
                time.sleep(0.2 + random.uniform(0, 0.3))
                continue  # è‡ªåŠ¨é‡è¯•
            
            # æ­£å¸¸è¿”å›
            return r, data
        
        # HTTPé”™è¯¯ï¼Œæ¢ä»£ç†é‡è¯•
        if attempt < max_retries - 1:
            time.sleep(0.1)
            continue
    
    # æ‰€æœ‰é‡è¯•éƒ½å¤±è´¥
    return None, None
```

---

### 4ï¸âƒ£ **ç§»é™¤ä¸å¿…è¦çš„å»¶è¿Ÿ**
```python
# ä¿®æ”¹å‰
if len(futures) % 1000 == 0:
    time.sleep(0.1)  # æ¯1000ä¸ªç­‰å¾…0.1ç§’

# ä¿®æ”¹å
# ç§»é™¤è¿™ä¸ªå»¶è¿Ÿï¼Œæå‡é€Ÿåº¦
```

---

### 5ï¸âƒ£ **3ä¸ªAPIéƒ½æ”¯æŒé™æµé‡è¯•**
```python
# API 1: Inquiry
r1, data1 = call_api_with_retry(
    f"{API_URL}api/Delivery/Inquiry",
    headers_form,
    data={"ParcelCode": tracking, "Signature": sig},
    max_retries=10
)

# API 2: DeliveryLadingJourney
r2, data2 = call_api_with_retry(
    f"{API_URL}api/Delivery/DeliveryLadingJourney",
    headers_form,
    data={"ParcelCode": tracking},
    max_retries=10
)

# API 3: Gateway/Bussiness
r3, data3 = call_api_with_retry(
    f"{API_URL}api/Gateway/Bussiness",
    headers_json,
    json_data={"Code": "LDP002", "Data": tracking},
    max_retries=10
)
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### ä¼˜åŒ–å‰
```
å¹¶å‘æ•°: 30
ä»£ç†æ± : 100ä¸ªï¼ˆä½†æ²¡å……åˆ†åˆ©ç”¨ï¼‰
é™æµå¤„ç†: âŒ æ— ï¼ˆé‡åˆ°é™æµç›´æ¥å¤±è´¥ï¼‰
ç§»é™¤å»¶è¿Ÿ: âŒ æ— 
é€Ÿåº¦: ~30-50æ¬¡/ç§’
```

### ä¼˜åŒ–å
```
å¹¶å‘æ•°: 50 â¬†ï¸ +66%
ä»£ç†æ± : 100ä¸ªï¼ˆå……åˆ†åˆ©ç”¨ï¼‰
é™æµå¤„ç†: âœ… è‡ªåŠ¨é‡è¯•10æ¬¡
ç§»é™¤å»¶è¿Ÿ: âœ… æ˜¯
é¢„æœŸé€Ÿåº¦: ~80-150æ¬¡/ç§’ â¬†ï¸ +200%
```

---

## ğŸš€ é€Ÿåº¦æå‡é¢„ä¼°

### ç†è®ºæå‡
- **å¹¶å‘æå‡**: 30 â†’ 50 = +66%
- **é™æµå¤„ç†**: é¿å…å¤±è´¥é‡æ‰« = +50%
- **ç§»é™¤å»¶è¿Ÿ**: å‡å°‘ç­‰å¾… = +20%
- **æ€»è®¡**: **é¢„è®¡æå‡ 2-3å€é€Ÿåº¦**

### å®é™…æ•ˆæœ
```
# ä¼˜åŒ–å‰
10,000ä¸ªè®¢å• = çº¦60åˆ†é’Ÿ

# ä¼˜åŒ–å
10,000ä¸ªè®¢å• = çº¦20-30åˆ†é’Ÿ â¬†ï¸
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èï¼‰
```bash
python3 test_speed_optimized.py
```

**æµ‹è¯•å†…å®¹**:
- âœ… æ‰«æ500ä¸ªå·æ®µ
- âœ… æ‰¾20ä¸ªè®¢å•
- âœ… éªŒè¯é™æµé‡è¯•åŠŸèƒ½
- âœ… ç»Ÿè®¡é‡è¯•æ¬¡æ•°å’Œé™æµæ¬¡æ•°
- â±ï¸ è€—æ—¶çº¦1-2åˆ†é’Ÿ

**è¾“å‡ºç¤ºä¾‹**:
```
æ‰¾åˆ°è®¢å•: 20 ä¸ª
æµ‹è¯•æ€»æ•°: 500 ä¸ª
æ€»é‡è¯•: 45 æ¬¡
é™æµæ¬¡æ•°: 12 æ¬¡
è€—æ—¶: 95.3 ç§’
é€Ÿåº¦: 5.2 æ¬¡/ç§’

âœ… é™æµå¤„ç†:
  â€¢ é‡åˆ°é™æµè‡ªåŠ¨åˆ‡æ¢ä»£ç†
  â€¢ æœ€å¤šé‡è¯•10æ¬¡ç›´åˆ°æˆåŠŸ
  â€¢ å¹³å‡æ¯ä¸ªè¯·æ±‚é‡è¯•: 0.09 æ¬¡

ğŸ’¡ æ€§èƒ½åˆ†æ:
  â€¢ é™æµæ¯”ä¾‹: 2.4%
  â€¢ é‡è¯•æˆåŠŸç‡: 97.6%
```

---

### 2. æ­£å¼æ‰«æ
```bash
python3 scan_today_full_api.py
```

---

## ğŸ” é™æµé‡è¯•è¯¦è§£

### ä»€ä¹ˆæ˜¯é™æµï¼Ÿ
APIè¿”å› Code: 98 æˆ– 429ï¼Œè¡¨ç¤ºè¯·æ±‚è¿‡äºé¢‘ç¹ã€‚

### å¦‚ä½•å¤„ç†ï¼Ÿ
1. **æ£€æµ‹é™æµ**: åˆ¤æ–­ `Code == '98' or Code == '429'`
2. **åˆ‡æ¢ä»£ç†**: `proxy = random.choice(proxies)`
3. **éšæœºå»¶è¿Ÿ**: `time.sleep(0.2 + random.uniform(0, 0.3))`
4. **é‡æ–°è¯·æ±‚**: æœ€å¤šé‡è¯•10æ¬¡
5. **è¿”å›ç»“æœ**: æˆåŠŸåç«‹å³è¿”å›

### ä¸ºä»€ä¹ˆæœ‰æ•ˆï¼Ÿ
- âœ… ä¸åŒä»£ç†æœ‰ä¸åŒçš„IPé™é¢
- âœ… éšæœºå»¶è¿Ÿé¿å…è§„å¾‹æ€§
- âœ… é‡è¯•ç¡®ä¿è¯·æ±‚æˆåŠŸ
- âœ… 100ä¸ªä»£ç†æ± è¶³å¤Ÿè½®è¯¢

---

## ğŸ“ˆ ä¼˜åŒ–å»ºè®®

### 1. æ ¹æ®ç½‘ç»œæƒ…å†µè°ƒæ•´å¹¶å‘
```python
# ç½‘ç»œå¥½
max_workers=50  # æˆ–æ›´é«˜

# ç½‘ç»œä¸€èˆ¬
max_workers=30

# ç½‘ç»œå·®
max_workers=20
```

### 2. è°ƒæ•´é‡è¯•æ¬¡æ•°
```python
# æ¿€è¿›æ¨¡å¼ï¼ˆå¿«ä½†å¯èƒ½å¤±è´¥ï¼‰
max_retries=3

# å¹³è¡¡æ¨¡å¼ï¼ˆæ¨èï¼‰
max_retries=10

# ç¨³å®šæ¨¡å¼ï¼ˆæ…¢ä½†ç¨³å®šï¼‰
max_retries=20
```

### 3. è°ƒæ•´å»¶è¿Ÿæ—¶é—´
```python
# å¿«é€Ÿæ¨¡å¼ï¼ˆå¯èƒ½è¢«é™æµï¼‰
time.sleep(0.1)

# å¹³è¡¡æ¨¡å¼ï¼ˆæ¨èï¼‰
time.sleep(0.2 + random.uniform(0, 0.3))

# å®‰å…¨æ¨¡å¼ï¼ˆæ…¢ä½†å®‰å…¨ï¼‰
time.sleep(0.5 + random.uniform(0, 0.5))
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ä»£ç†è´¨é‡
- ä½¿ç”¨é«˜è´¨é‡ä»£ç†å¯ä»¥æå‡é€Ÿåº¦
- ä½è´¨é‡ä»£ç†å¯èƒ½å¯¼è‡´æ›´å¤šé‡è¯•
- å»ºè®®æµ‹è¯•ä»£ç†å¯ç”¨æ€§

### 2. APIé™æµç­–ç•¥
- DingDong APIå¯èƒ½æœ‰å…¨å±€é™æµ
- å³ä½¿åˆ‡æ¢ä»£ç†ä¹Ÿå¯èƒ½è¢«é™æµ
- é‡åˆ°æŒç»­é™æµåº”é™ä½å¹¶å‘æ•°

### 3. ç½‘ç»œç¨³å®šæ€§
- ä¸ç¨³å®šç½‘ç»œä¼šå¢åŠ è¶…æ—¶é‡è¯•
- å»ºè®®åœ¨ç¨³å®šç½‘ç»œç¯å¢ƒè¿è¡Œ
- å¯ä»¥å¢åŠ timeoutå€¼

---

## ğŸ¯ æœ€ä½³å®è·µ

### æ¨èé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```python
å¹¶å‘æ•°: 50
ä»£ç†æ± : 100ä¸ª
é‡è¯•æ¬¡æ•°: 10
å»¶è¿Ÿ: 0.2 + random(0, 0.3)ç§’
timeout: 8ç§’
```

### æµ‹è¯•é…ç½®
```python
å¹¶å‘æ•°: 20
ä»£ç†æ± : 10ä¸ª
é‡è¯•æ¬¡æ•°: 5
å»¶è¿Ÿ: 0.3ç§’
timeout: 10ç§’
```

---

## ğŸ“Š æ€§èƒ½ç›‘æ§

è¿è¡Œæ—¶ä¼šæ˜¾ç¤ºï¼š
```
âœ… [156/10000] EF043571075VN | HoÃ ng thá»‹ Thá»§y | 1,500,000â‚« | âš¡85.3/s | ğŸ”„é‡è¯•:234 | ğŸš«é™æµ:45

ğŸ“Š å·²æ‰«5000 | æ‰¾åˆ°156 | âš¡82.5/s | ğŸ”„é‡è¯•:445 | ğŸš«é™æµ:89
```

**æŒ‡æ ‡è¯´æ˜**:
- `âš¡85.3/s` - å½“å‰æ‰«æé€Ÿåº¦
- `ğŸ”„é‡è¯•:234` - æ€»é‡è¯•æ¬¡æ•°
- `ğŸš«é™æµ:45` - é‡åˆ°é™æµæ¬¡æ•°

---

## âœ… ä¼˜åŒ–æ€»ç»“

### ä¸»è¦æ”¹è¿›
1. âœ… **50çº¿ç¨‹å¹¶å‘** - æå‡66%ååé‡
2. âœ… **é™æµè‡ªåŠ¨é‡è¯•** - é¿å…å¤±è´¥ï¼Œæå‡æˆåŠŸç‡
3. âœ… **æ™ºèƒ½åˆ‡æ¢ä»£ç†** - å……åˆ†åˆ©ç”¨100ä¸ªä»£ç†æ± 
4. âœ… **ç§»é™¤å»¶è¿Ÿ** - å‡å°‘ä¸å¿…è¦ç­‰å¾…
5. âœ… **3ä¸ªAPIç»Ÿä¸€å¤„ç†** - æ‰€æœ‰APIéƒ½æ”¯æŒé‡è¯•

### é¢„æœŸæ•ˆæœ
- ğŸš€ é€Ÿåº¦æå‡ **2-3å€**
- âœ… æˆåŠŸç‡æ¥è¿‘ **100%**
- â±ï¸ 10,000è®¢å•ä»60åˆ†é’Ÿé™è‡³ **20-30åˆ†é’Ÿ**

---

## ğŸ§ª éªŒè¯æ­¥éª¤

1. **å…ˆæµ‹è¯•**: `python3 test_speed_optimized.py`
2. **çœ‹ç»Ÿè®¡**: æ£€æŸ¥é‡è¯•æ¬¡æ•°å’Œé™æµæ¯”ä¾‹
3. **è°ƒä¼˜åŒ–**: æ ¹æ®ç»“æœè°ƒæ•´å‚æ•°
4. **æ­£å¼è·‘**: `python3 scan_today_full_api.py`

---

**ä¼˜åŒ–å®Œæˆï¼ç°åœ¨å¯ä»¥é«˜é€Ÿæ‰«æäº†ï¼** ğŸš€
