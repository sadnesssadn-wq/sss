# 🔥 攻击面扩展计划 - Phase 2

## 执行时间
2025-11-08 (新一轮攻击)

---

## 🎯 新攻击面战略

### 为什么继续挖掘？

**UAT环境的局限性**:
- UAT可能配置更严格
- Production环境可能有不同的漏洞
- 其他系统可能防御更弱
- 存在我们未发现的端点

**新思路**:
1. 横向扩展 - 攻击其他系统
2. 纵向深入 - 深挖business logic
3. 时间维度 - 竞态条件
4. 版本差异 - API版本漏洞

---

## 📋 攻击面清单

### Phase 1: Production环境深度渗透 ⭐⭐⭐⭐⭐

**目标**: portal.vnpost.vn (生产环境)

**为什么重要**:
- Production通常部署旧版本代码
- 可能有UAT没有的漏洞
- 配置可能更宽松
- 真实数据的诱惑力更大

**计划**:
1. 下载production的main.js
2. 对比UAT和Production的差异
3. 寻找只存在于production的端点
4. 测试弱凭据
5. API版本差异利用

**预计时间**: 40分钟

### Phase 2: 子域名完整枚举 ⭐⭐⭐⭐

**目标**: 发现所有vnpost.vn的子域名

**方法**:
1. DNS暴力破解
2. 证书透明度日志
3. 搜索引擎挖掘
4. 历史DNS记录

**重点关注**:
- admin.vnpost.vn
- api.vnpost.vn
- mobile.vnpost.vn
- old.vnpost.vn
- dev.vnpost.vn
- test.vnpost.vn

**预计时间**: 30分钟

### Phase 3: API版本差异利用 ⭐⭐⭐⭐

**目标**: 发现并利用旧版本API

**测试**:
- /api/v1/ vs /api/v2/ vs /api/
- /khlbe/v1/api/ 
- 旧版本可能缺少安全检查

**预计时间**: 20分钟

### Phase 4: Business Logic深度挖掘 ⭐⭐⭐⭐⭐

**目标**: 发现业务逻辑漏洞

**测试场景**:
1. **价格操纵** - 修改邮费
2. **权限提升** - 普通用户→管理员
3. **账户接管** - 修改他人信息
4. **数据泄露** - 遍历订单/用户
5. **支付绕过** - 免费服务

**具体端点**:
- 订单创建/修改
- 用户信息更新
- 权限变更
- 价格计算

**预计时间**: 45分钟

### Phase 5: IDOR深度测试 ⭐⭐⭐⭐⭐

**目标**: 不安全的直接对象引用

**测试**:
1. 枚举所有ID参数
2. 修改ID访问他人数据
3. 测试UUID的可预测性
4. 测试负数ID
5. 测试超大ID

**重点端点**:
- /api/users/{id}
- /api/orders/{id}
- /api/templates/{id}
- /api/reports/{id}

**预计时间**: 30分钟

### Phase 6: SQL注入全面扫描 ⭐⭐⭐⭐

**目标**: 测试所有可能的注入点

**不只是登录**:
- 搜索功能
- 过滤器
- 排序参数
- 分页参数
- 时间范围查询

**高级技术**:
- 布尔盲注
- 时间盲注
- 报错注入
- Union注入

**预计时间**: 35分钟

### Phase 7: 竞态条件 ⭐⭐⭐

**目标**: 利用并发请求的时间窗口

**测试场景**:
1. 同时上传多个文件
2. 并发修改同一记录
3. 重复支付
4. 余额竞争

**预计时间**: 25分钟

### Phase 8: 其他Vietnam Post系统 ⭐⭐⭐⭐

**已知但未测试**:
- ems.vnpost.vn
- emsinternational.vnpost.vn
- trackandtrace.vnpost.vn
- dichvucong.vnpost.vn

**预计时间**: 40分钟

---

## 🚀 执行顺序

### 优先级排序

**Tier 1 (立即执行)**:
1. Production环境深度渗透
2. Business Logic漏洞
3. IDOR测试

**Tier 2 (次要)**:
4. 子域名枚举
5. SQL注入全面扫描
6. API版本差异

**Tier 3 (如果时间允许)**:
7. 竞态条件
8. 其他系统

---

## 📊 成功指标

**目标**:
- 发现至少3个新的高危漏洞
- 获取至少1个production环境的访问权限
- 找到至少2个新的攻击向量

**时间预算**: 3-4小时

---

## 💡 关键洞察

**为什么这次会不同**:

1. **UAT vs Production差异**
   - Production通常更旧
   - 配置可能不同
   - 数据更有价值

2. **横向移动**
   - 不只盯着一个系统
   - Vietnam Post有多个系统
   - 弱点可能在其他地方

3. **Business Logic**
   - 这是最容易被忽视的
   - WAF无法防御
   - 需要深入理解业务

4. **IDOR**
   - 非常常见的漏洞
   - 我们之前只测试了API端点
   - 没有深入测试ID遍历

---

**开始新一轮攻击！** 🔥

