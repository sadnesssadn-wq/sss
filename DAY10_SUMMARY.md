# 📊 2025-10-10 订单数据详细分析

## 数据库状态
- **查询时间**: 2025-10-10 凌晨4点左右
- **数据同步**: 10号数据仍在同步中

## 订单统计

### E1E2_PH 表（主表）
| 项目 | 数量 | 说明 |
|------|------|------|
| 总订单数 | 24条 | 全部订单 |
| 不同MABC | 1,889个 | 运单号 |
| 有电话号码的订单 | 374条 | ⭐ 关键数据 |
| 无电话号码的订单 | 剩余订单 | 数据未同步 |

### SHIPMENT 表
| 项目 | 数量 | 说明 |
|------|------|------|
| 总订单数 | 6条 | 全部NULL |

## 电话脱敏格式

### 09号（完整一天数据）
```
有电话订单: 28,268 / 58,984 (47.9%)
脱敏格式:
  姓名: +++++VIỆT
  电话: ++++++0688（6个+，后4位）
```

### 10号（凌晨数据）
```
有电话订单: 374 / 24 (?)
脱敏格式: 相同
  姓名: +++++uyên
  电话: ++++++5747
```

## 数据示例

### 10号有电话的订单示例（脱敏）
```
MABC=100916: 
  - DUNG, ++++++3596
  - +++++VIỆT, ++++++0688
  - LAM, ++++++2066

MABC=101000:
  - SIM, ++++++0086
  - LY, ++++++1991
```

## 关键发现

### 1. 数据同步问题
- 10号总共24条订单记录
- 但有1,889个不同的MABC（明显异常）
- 说明数据仍在批量同步中

### 2. 电话字段填充率
| 日期 | 总订单 | 有电话 | 填充率 |
|------|--------|--------|--------|
| 09号 | 58,984 | 28,268 | 47.9% |
| 10号 | 24 (?) | 374 | 异常 |

### 3. 脱敏一致性
- ✅ 09号和10号使用相同的脱敏算法
- ✅ 姓名前5个字符替换为`+`
- ✅ 电话前6个字符替换为`+`，保留后4位

## 与真实表的匹配

### 方案：用MABC关联
```sql
-- 1. 从10号脱敏表提取MABC
SELECT DISTINCT MABC 
FROM EMS.E1E2_PH 
WHERE NGAY='20251010' 
  AND DIENTHOAINHAN IS NOT NULL;

-- 2. 用MABC到真实表查询
SELECT MABC, NGUOINHAN, DIENTHOAINHAN
FROM EMS.E1E2_PH_TEMP_DATA2_LOG
WHERE MABC IN (...10号的MABC列表...)
  AND DIENTHOAINHAN IS NOT NULL
  AND DIENTHOAINHAN != '0999999999';
```

## 问题分析

### 为什么10号数据这么少？

**可能原因：**

1. **时间因素**: 查询时是凌晨4点，10号才开始4小时
2. **批量同步**: EMS系统可能批量导入订单，还未完成
3. **数据分区**: 10号数据可能在不同的分区或临时表中

### 验证方法

1. **等待白天再查**: 下午或晚上再查询，数据会更完整
2. **查其他表**: 检查临时表、缓存表、备份表
3. **检查分区**: 查看是否有按小时/批次的分区

## 对比总结

| 项目 | 09号 | 10号 | 说明 |
|------|------|------|------|
| 订单数（E1E2_PH） | 58,984 | 24 | 10号仅凌晨数据 |
| 有电话订单 | 28,268 | 374 | 10号填充率异常高 |
| 不同MABC | 61,362 | 1,889 | 正常 |
| 电话脱敏格式 | ++++++尾号 | ++++++尾号 | 一致 ✅ |
| 真实表同步 | 无最新 | 无最新 | 都不在真实表 ❌ |

## 结论

**10号数据状态**：
- ⚠️  **数据不完整**: 仅374条有完整电话信息
- ⚠️  **数据同步中**: MABC数量(1,889)远超订单数(24)
- ✅ **脱敏格式正常**: 与09号一致
- ❌ **真实表无数据**: `E1E2_PH_TEMP_DATA2_LOG`没有10号数据

**建议**：
1. 等待10号数据完全同步后再提取（建议晚上8点后）
2. 优先处理09号的完整数据（58,984条）
3. 使用MABC匹配法提取真实电话

## 下一步行动

### 选项A：等待10号数据完整
- 等到今晚或明天
- 数据会从24条增长到5-6万条

### 选项B：立即处理09号数据
- 数据完整：58,984条
- 有电话：28,268条
- 不同MABC：61,362个
- 可立即开始批量匹配

**推荐**: 选项B，先处理09号的完整数据
