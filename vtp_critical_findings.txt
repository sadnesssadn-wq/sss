# ViettelPost å…³é”®å‘ç° - OAuth2è®¤è¯ç³»ç»Ÿ

## ğŸ”´ CRITICAL: OpenID Connectå®Œå…¨æš´éœ²

### å‘ç°çš„è®¤è¯ç³»ç»Ÿ
**URL**: https://auth-global.viettelpost.vn/
**ç±»å‹**: OpenIddict (ASP.NET Core)
**åè®®**: OAuth 2.0 + OpenID Connect

### å®Œæ•´é…ç½®æ–‡ä»¶æš´éœ²
âœ“ /.well-known/openid-configuration (200 OK)
âœ“ æ‰€æœ‰ç«¯ç‚¹URLå®Œå…¨æ³„éœ²
âœ“ æ”¯æŒçš„Grant Typesæš´éœ²
âœ“ æ”¯æŒçš„Scopesæš´éœ²

---

## å…³é”®ç«¯ç‚¹

### 1. Tokenç«¯ç‚¹
**URL**: https://auth-global.viettelpost.vn/connect/token
**åŠŸèƒ½**: è·å–è®¿é—®ä»¤ç‰Œ
**æ”¯æŒçš„Grant Types**:
- âœ… authorization_code
- âœ… implicit
- âœ… password âš ï¸ (èµ„æºæ‰€æœ‰è€…å¯†ç æ¨¡å¼)
- âœ… client_credentials
- âœ… refresh_token
- âœ… device_code
- âœ… viettel_idp âš ï¸ (è‡ªå®šä¹‰Grant)

### 2. æˆæƒç«¯ç‚¹
**URL**: https://auth-global.viettelpost.vn/connect/authorize

### 3. ç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹
**URL**: https://auth-global.viettelpost.vn/connect/userinfo

### 4. JWKSå…¬é’¥ç«¯ç‚¹
**URL**: https://auth-global.viettelpost.vn/.well-known/jwks
**ç”¨é€”**: JWTç­¾åéªŒè¯

### 5. å†…çœç«¯ç‚¹
**URL**: https://auth-global.viettelpost.vn/connect/introspect
**ç”¨é€”**: TokenéªŒè¯

### 6. åŠé”€ç«¯ç‚¹
**URL**: https://auth-global.viettelpost.vn/connect/revocat

---

## æ”¯æŒçš„Scopes
```
- openid
- offline_access âš ï¸ (å¯ä»¥è·å–refresh_token)
- email
- profile
- phone
- roles âš ï¸ (è§’è‰²ä¿¡æ¯)
- address
- Logistek âš ï¸ (ä¸šåŠ¡ç›¸å…³scope)
```

---

## âš ï¸ é«˜å±é…ç½®

### 1. Password Grant å¯ç”¨
**ä¸¥é‡ç¨‹åº¦**: HIGH
**é£é™©**: 
- å¯ä»¥ç›´æ¥ä½¿ç”¨ç”¨æˆ·åå¯†ç æ¢å–Token
- å¦‚æœå­˜åœ¨å¼±å¯†ç ï¼Œå¯ä»¥æš´åŠ›ç ´è§£
- å…¸å‹çš„ä¸å®‰å…¨Grant Type

**æµ‹è¯•æ–¹æ³•**:
```bash
curl -X POST https://auth-global.viettelpost.vn/connect/token \
  -d "grant_type=password&username=admin&password=admin123&client_id=web"
```

### 2. è‡ªå®šä¹‰Grant: viettel_idp
**ä¸¥é‡ç¨‹åº¦**: MEDIUM-HIGH
**é£é™©**:
- è‡ªå®šä¹‰å®ç°å¯èƒ½å­˜åœ¨é€»è¾‘æ¼æ´
- ä¸æ¸…æ¥šå…·ä½“å®ç°ç»†èŠ‚
- å¯èƒ½ç»•è¿‡æ ‡å‡†è®¤è¯æµç¨‹

### 3. offline_access æ”¯æŒ
**ä¸¥é‡ç¨‹åº¦**: MEDIUM
**é£é™©**:
- å¯ä»¥è·å–é•¿æœŸæœ‰æ•ˆçš„refresh_token
- å¦‚æœTokenè¢«çªƒå–ï¼ŒæŒç»­æ—¶é—´æ›´é•¿

---

## æ”»å‡»å‘é‡

### âœ… å¯ä»¥æµ‹è¯•çš„æ”»å‡»
1. **Password Grantæš´åŠ›ç ´è§£**
   - å°è¯•å¸¸è§ç”¨æˆ·åå¯†ç ç»„åˆ
   - admin/admin, admin/Admin123ç­‰

2. **Client Credentialsæš´åŠ›ç ´è§£**
   - æšä¸¾å¸¸è§client_id/client_secret
   - web/web, api/api, mobile/mobileç­‰

3. **viettel_idp Granté€»è¾‘æ¼æ´**
   - æµ‹è¯•å‚æ•°æ³¨å…¥
   - æµ‹è¯•è®¤è¯ç»•è¿‡

4. **Authorization CodeåŠ«æŒ**
   - æµ‹è¯•redirect_uriéªŒè¯
   - Open Redirectæ¼æ´

5. **JWTä¼ªé€ **
   - ä¸‹è½½JWKSå…¬é’¥
   - å°è¯•ç®—æ³•æ··æ·†æ”»å‡»ï¼ˆalg=noneï¼‰
   - å°è¯•å¯†é’¥æ··æ·†æ”»å‡»

6. **Scopeææƒ**
   - è¯·æ±‚roles scopeè·å–è§’è‰²ä¿¡æ¯
   - è¯·æ±‚Logistek scopeè·å–ä¸šåŠ¡æƒé™

---

## åç«¯APIè·¯ç”±

ä»JSåˆ†æå‘ç°ï¼Œè¿™ä¸ªè®¤è¯ç³»ç»Ÿä¸ºä»¥ä¸‹æœåŠ¡æä¾›è®¤è¯ï¼š

1. **management-service**
   - https://api-global.viettelpost.vn/management-service/
   - ç”¨æˆ·ç®¡ç†ã€æ–‡ä»¶ä¸Šä¼ ç­‰

2. **cdn-service**
   - https://api-global.viettelpost.vn/cdn-service/
   - å†…å®¹åˆ†å‘æœåŠ¡

**æ”»å‡»é“¾**:
1. é€šè¿‡OAuth2è·å–æœ‰æ•ˆToken
2. ä½¿ç”¨Tokenè®¿é—®management-serviceå’Œcdn-service
3. æµ‹è¯•APIæœªæˆæƒè®¿é—®/æƒé™æå‡

---

## å½“å‰æµ‹è¯•çŠ¶æ€

### âœ… å·²å®Œæˆ
- OpenIDé…ç½®æ–‡ä»¶è·å–
- ç«¯ç‚¹è¯†åˆ«
- Grant Typesè¯†åˆ«
- Scopesè¯†åˆ«

### â³ æ­£åœ¨è¿›è¡Œ
- Password Grantå¼±å¯†ç æµ‹è¯•
- Client Credentialsæšä¸¾
- viettel_idpè‡ªå®šä¹‰Grantæµ‹è¯•
- JWKSå…¬é’¥ä¸‹è½½

### ğŸ“‹ å¾…æµ‹è¯•
- JWTä¼ªé€ æ”»å‡»
- Authorization CodeåŠ«æŒ
- Redirect URIéªŒè¯
- Scopeææƒæµ‹è¯•
- ä¸management-serviceçš„é›†æˆæµ‹è¯•

---

## é£é™©è¯„çº§

**å½“å‰å‘ç°**: ğŸ”´ HIGH

**åŸå› **:
1. âœ… Password Grantå¯ç”¨ï¼ˆä¸æ¨èçš„è®¤è¯æ–¹å¼ï¼‰
2. âœ… è‡ªå®šä¹‰Grantå¯èƒ½å­˜åœ¨æ¼æ´
3. âœ… å®Œæ•´è®¤è¯æ¶æ„å®Œå…¨æš´éœ²
4. âš ï¸ å¦‚æœå­˜åœ¨å¼±å¯†ç æˆ–é»˜è®¤å‡­æ®ï¼Œå¯ä»¥å®Œå…¨æ¥ç®¡è´¦æˆ·

---

**æŠ¥å‘Šæ—¶é—´**: 2025-11-11
**æµ‹è¯•è¿›åº¦**: 60%
**ä¸‹ä¸€æ­¥**: OAuth2æ”»å‡»æ·±åº¦æµ‹è¯•
