#!/bin/bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ”¥ æ·±åº¦æå–ï¼šJSæ–‡ä»¶ä¸­çš„å¯†é’¥/Token"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

echo "[*] ä»æ‰€æœ‰JSæ–‡ä»¶ä¸­æ·±åº¦æå–æ•æ„Ÿä¿¡æ¯..."

# æå–æ‰€æœ‰å¯èƒ½çš„å¯†é’¥æ¨¡å¼
grep -rE "(api[_-]?key|token|secret|password|auth|bearer)\s*[:=]\s*['\"]([^'\"]{20,})" . --include="*.js" | \
    grep -v "function\|var\|let\|const\|return" | head -50 > js_secrets_extracted.txt

echo "[1] API Keys:"
grep -iE "api[_-]?key" js_secrets_extracted.txt

echo ""
echo "[2] Tokens:"
grep -iE "token" js_secrets_extracted.txt

echo ""
echo "[3] Secrets:"
grep -iE "secret" js_secrets_extracted.txt

echo ""
echo "[*] æå–Base64ç¼–ç çš„å¯ç–‘å­—ç¬¦ä¸²..."
grep -rEo "['\"][A-Za-z0-9+/=]{40,}['\"]" . --include="*.js" | head -20 | while read b64; do
    decoded=$(echo "$b64" | tr -d "\"'" | base64 -d 2>/dev/null)
    if [ -n "$decoded" ]; then
        echo "  Base64: $b64"
        echo "  è§£ç : $decoded"
        echo "---"
    fi
done

echo ""
echo "[*] æå–JWTæ ¼å¼çš„å­—ç¬¦ä¸²..."
grep -rEo "eyJ[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]*" . --include="*.js" | head -10 | while read jwt; do
    echo "JWT: $jwt"
    # è§£ç header
    header=$(echo "$jwt" | cut -d'.' -f1 | base64 -d 2>/dev/null)
    # è§£ç payload  
    payload=$(echo "$jwt" | cut -d'.' -f2 | base64 -d 2>/dev/null)
    echo "  Header: $header"
    echo "  Payload: $payload"
    echo "---"
done

echo ""
echo "[*] æå–ç¡¬ç¼–ç çš„å†…ç½‘åœ°å€..."
grep -rEo "(10\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|192\.168\.[0-9]{1,3}\.[0-9]{1,3}|172\.(1[6-9]|2[0-9]|3[01])\.[0-9]{1,3}\.[0-9]{1,3})" . --include="*.js" | sort -u

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
