#!/bin/bash
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "步骤7：完整端口扫描"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"

# 主要IP
IPS=(
    "103.188.250.130"
    "103.188.251.130"
    "103.188.250.129"
    "103.188.251.129"
)

# 常见端口
PORTS=(21 22 23 25 53 80 110 143 443 445 3306 3389 5432 6379 8080 8443 9090 27017)

echo "[*] 扫描常见服务端口..."

for ip in "${IPS[@]}"; do
    echo ""
    echo "━━━ $ip ━━━"
    for port in "${PORTS[@]}"; do
        timeout 2 bash -c "echo > /dev/tcp/$ip/$port" 2>/dev/null && echo "  ✅ $port OPEN" &
    done
    wait
done

echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "✅ 端口扫描完成"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
