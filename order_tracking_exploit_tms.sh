#!/bin/bash
# é’ˆå¯¹tms-*çš„401ç«¯ç‚¹è¿›è¡Œç»•è¿‡æµ‹è¯•

BASE="https://gw.vtpglobal.com.vn"

echo "[ðŸ’¥] TMSæœåŠ¡401ç»•è¿‡æµ‹è¯•ï¼ˆç«¯ç‚¹ç¡®è®¤å­˜åœ¨ï¼ï¼‰"
echo ""

# æµ‹è¯•ä¸åŒHTTPæ–¹æ³•
for service in tms-receiving tms-dest tms-sorting tms-handover tms-pricing; do
  echo "[+] æµ‹è¯• $service"
  
  # OPTIONSè¯·æ±‚ï¼ˆå¯èƒ½æ³„æ¼ä¿¡æ¯ï¼‰
  echo "  [*] OPTIONS /$service/api/v1/order"
  curl -sk "$BASE/$service/api/v1/order" -X OPTIONS -v 2>&1 | grep -E "Allow:|Access-Control|HTTP/" | head -10
  
  # HEADè¯·æ±‚
  echo "  [*] HEAD /$service/api/v1/order"
  curl -sk "$BASE/$service/api/v1/order" -X HEAD -I | grep -E "HTTP/|Allow:|WWW-Authenticate" | head -5
  
  # POST with empty body
  echo "  [*] POST /$service/api/v1/order (ç©ºbody)"
  curl -sk "$BASE/$service/api/v1/order" -X POST \
    -H "Content-Type: application/json" \
    -d '{}' -w "\nHTTP: %{http_code}\n" | head -10
  
  echo ""
done

# æµ‹è¯•RESTfulè·¯å¾„
echo "[+] æµ‹è¯•RESTfulé£Žæ ¼è·¯å¾„"
curl -sk "$BASE/tms-receiving/api/v1/order/1" -w "\nHTTP: %{http_code}\n" | head -10
curl -sk "$BASE/tms-receiving/api/v1/orders" -w "\nHTTP: %{http_code}\n" | head -10
