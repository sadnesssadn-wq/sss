(r=>{var c=(()=>{var t=!0,e=r('<canvas width="0" height="0" style="display: none;"></canvas>').appendTo(r("body"));try{e[0].getContext("2d"),t=!0}catch(e){t=!1}return e.remove(),t})(),u="Microsoft Internet Explorer"===navigator.appName&&"MSIE8.0"===navigator.appVersion.split(";")[1].replace(/[ ]/g,""),e=r.su.Widget.register("speedTestGauge",{extend:"echart",settings:{type:{attribute:"type",defaultValue:"gauge"},color:{attribute:"color",defaultValue:r.getUIColor("--s-color-theme-status-success")},min:{attribute:"min",defaultValue:0},max:{attribute:"max",defaultValue:240}},listeners:[],init:function(){var e=this.settings.color;this.axisTickBackground=u||!c?"transparent":{image:this.getBackgroundFromCanvas({from:6===(e=(e=(e=e)[0]==="#"?e.slice(1):e).length===3?e.repeat(2):e).length&&/^[0-9a-fA-F]{3,6}$/i.test(e)?[parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16),0]:[0,0,0],to:[229,229,229,.3],outerRadius:100}),repeat:"no-repeat"}},getBackgroundFromCanvas:function(e){for(var t,a,i=e.from,s=e.to,e=e.outerRadius,n=[[.5*Math.PI,.75*Math.PI],[.75*Math.PI,2.25*Math.PI],[.25*Math.PI,.5*Math.PI]],l=document.createElement("canvas"),o=(l.width=l.height=2*e,l.getContext("2d")),d=l.width/2,r=l.height/2,c=e,u=[],h=(o.beginPath(),o.moveTo(d,r),t=n[0][0],a=n[0][1],o.arc(d,r,c,t,a),o.fillStyle=v(i),o.fill(),o.closePath(),s.length),p=(n[1][1]-n[1][0])/Math.PI*180,g=0;g<p-1;g++){for(var m=0;m<h;m++)u[m]=3===m?Math.round(100*(s[m]-i[m])/p*g+100*i[m])/100:Math.round((s[m]-i[m])/p*g+i[m]);o.beginPath(),o.moveTo(d,r),a=(t=n[1][0]+(n[1][1]-n[1][0])/p*g)+(n[1][1]-n[1][0])/p*2,o.fillStyle=v(u),o.arc(d,r,c,t,a),o.fill(),o.closePath()}function v(e){return"rgba("+e.join()+")"}return o.beginPath(),o.moveTo(d,r),t=n[2][0],a=n[2][1],o.arc(d,r,c,t,a),o.fillStyle=v(s),o.fill(),o.closePath(),l},render:function(){var a=this.dom();return e.superclass.render.call(this,function(){a.addClass("speedTestGauge-container");var e=a.find(".chart-canvas"),t="";t=(t=(t=(t+='<div class="chart-info">')+'<div class="chart-detail"><span class="chart-title"></span>')+'<span class="chart-unit">'+r.su.CHAR.INTERNET.MBPS+"</span>")+"</div></div>",e.find(".chart-info").detach().end().append(t)})},setOption:function(e){var t=this.dom(),a=this.settings,i=(e=r.extend(a.options||{},e)).name,s=e.value,t=(t.find(".chart-title").text(i),this.calculateOption({value:s,name:i,convert:e.convert||a.convert}));t[0].detail.show=!0,this.setGaugeOption({series:t}),a.options=e},calculateOption:function(e){var t=this.settings,a=t.color,i=[],s=(Math.min(this.settings.width,this.settings.height)-10)/2,t=(e=r.extend({min:t.min,max:t.max,value:0,splitNumber:8,type:"gauge",data:[{value:0,name:""}]},e),function(e){return e});if("array"===r.type(e.convert)){for(var n=e.convert,l=[],o=(e.max-e.min)/e.splitNumber,d=0;d<=e.splitNumber;d++)l.push(o*d+e.min);h(l,n),t=h(n,l),e.formatValue=t(e.value)}return i.push({radius:s-10,min:e.min,max:e.max,name:e.name,type:e.type,startAngle:225,endAngle:-45,animation:!1,splitNumber:e.splitNumber,axisLine:{lineStyle:{width:6,color:[[1,"#F2F3F5"]]}},splitLine:{show:!1,length:8},axisTick:{show:!1},axisLabel:{backgroundColor:"",borderRadius:2,color:r.getUIColor("--s-color-chart-axis-label"),padding:0},pointer:{width:4,length:"80%"},itemStyle:{normal:{color:a}},detail:{color:a,rich:{},offsetCenter:[0,"60%"],fontSize:"29"},data:[{value:e.formatValue,name:""}]}),!u&&c&&(n=-270/(e.max-e.min)*e.formatValue,this.generateLayer({name:"colorArc",outerRadius:115,innerRadius:86,padding:20,opacity:.6,angleDiff:Math.abs(n/180*Math.PI),background:this.axisTickBackground.image}),this.generateArc({name:"outerLine",outerRadius:115,innerRadius:98,padding:1,opacity:1,angleDiff:Math.abs(n/180*Math.PI)})),i},generateArc:function(e){var t=this.settings.color,a=this.dom().find(".chart-canvas"),i=e.name,s=a.find(".chart-layer-"+i),i=(s.length||(s=r('<div class="chart-layer chart-layer-'+i+'"></div>').appendTo(a)),e.angleDiff),a=e.padding||0,n=e.outerRadius-a,l=e.innerRadius-a,o=document.createElement("canvas"),n=(o.width=o.height=2*n,o.style.width=o.style.height=2*e.outerRadius+"px",o.style.padding=a+"px",o.getContext("2d")),e=o.width/2,a=o.height/2,d=.75*Math.PI,i=.75*Math.PI+i;n.lineWidth=5,n.strokeStyle=t,n.arc(e,a,l,d,i),n.stroke(),s.html(o)},generateLayer:function(e){var t,a,i,s,n,l=this.dom().find(".chart-canvas"),o=e.name,d=l.find(".chart-layer-"+o);(d=d.length?d:r('<div class="chart-layer chart-layer-'+o+'"></div>').appendTo(l)).html((l=(o=e).angleDiff,d=o.opacity,e=o.background,i=o.outerRadius-(a=o.padding||0),s=o.innerRadius-a,(n=document.createElement("canvas")).width=n.height=2*i,n.style.width=n.style.height=2*o.outerRadius+"px",n.style.padding=a+"px",i=n.getContext("2d"),o=n.width/2,a=n.height/2,i.drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),i.globalCompositeOperation="destination-out",i.beginPath(),i.moveTo(o,a),e=.25*Math.PI,t=.75*Math.PI,i.arc(o,a,Math.max(n.width,n.height),e,t),i.fillStyle="white",i.fill(),i.closePath(),i.globalCompositeOperation="destination-out",i.beginPath(),i.moveTo(o,a),e=.75*Math.PI+l,t=2.25*Math.PI,i.arc(o,a,Math.max(n.width,n.height),e,t),i.fillStyle="white",i.fill(),i.closePath(),i.globalCompositeOperation="destination-out",i.beginPath(),i.moveTo(o,a),i.arc(o,a,s,0,2*Math.PI),i.fillStyle="white",i.fill(),i.closePath(),n.style.opacity=d,n))},loading:function(e){var t=this,a=(e=e||5e3,this.settings),i=(this.loadingInterval&&clearInterval(this.loadingInterval),0),e=e/(a.max-a.min);this.loadingInterval=setInterval(function(){i<a.max?t.setOption({value:++i}):(i=0,t.setOption({value:i}))},e)},cancelLoading:function(){this.loadingInterval&&(clearInterval(this.loadingInterval),this.setOption({value:0}))}});function h(d,r){return function(e){for(var t,a,i,s,n=e,l=n,o=0;o<d.length-1;o++)if(d[o]<=n&&n<=d[o+1]){t=d[o],a=r[o],i=d[o+1],l=(s=((s=r[o+1])-a)/(i-t))*n+(a-s*t);break}return 10*(l=l>r[r.length-1]?r[r.length-1]:l).toFixed(1)/10}}})(jQuery),$.su.Widget.register("calendar",{settings:{todayMark:{attribute:"today-mark",defaultValue:!0},timeZone:{attribute:"time-zone",defaultValue:!1}},listeners:[{selector:".ym-container .month-container",event:"click",callback:function(e,t){t.settings.calendarStack.push("month"),t.showCalendar()}},{selector:".ym-container .year-container",event:"click",callback:function(e,t){t.settings.calendarStack.push("year"),t.showCalendar()}},{selector:".ym-container .first-btn",event:"click",callback:function(e,t){var a=t.dom().find(".ym-container"),i=t.dateInfo.date;a.hasClass("tool-year-slot")?i.year(i.year()-10):(i.year(i.year()-1),a.hasClass("tool-month")&&(t.dateInfo.fixedDate=moment(t.dateInfo.date))),t.showCalendar()}},{selector:".ym-container .prev-btn",event:"click",callback:function(e,t){var a=t.getDateObj(t.dateInfo.date);0<a.month?a.month=a.month-1:(a.year--,a.month=11),a.date=15,t.dateInfo.date=moment(a),t.dateInfo.fixedDate=moment(t.dateInfo.date),t.showCalendar()}},{selector:".ym-container .next-btn",event:"click",callback:function(e,t){var a=t.getDateObj(t.dateInfo.date);a.month<11?a.month=a.month+1:(a.year++,a.month=0),a.date=15,t.dateInfo.date=moment(a),t.dateInfo.fixedDate=moment(t.dateInfo.date),t.showCalendar()}},{selector:".ym-container .last-btn",event:"click",callback:function(e,t){var a=t.dom().find(".ym-container"),i=t.dateInfo.date;a.hasClass("tool-year-slot")?i.year(i.year()+10):(i.year(i.year()+1),a.hasClass("tool-month")&&(t.dateInfo.fixedDate=moment(t.dateInfo.date))),t.showCalendar()}},{selector:".month-calendar .calendar-cell a",event:"click",callback:function(e,t){var a,i=$(this).closest(".calendar-cell");i.hasClass("disabled")||(a=t.dateInfo.date.month(),a=t.getDisplayText(t.dateInfo.date,"MM")-1-a,t.dateInfo.date.month(i.attr("data-value")-a),t.dateInfo.fixedDate=moment(t.dateInfo.date),t.settings.calendarStack.pop(),t.showCalendar())}},{selector:".year-calendar .calendar-cell a",event:"click",callback:function(e,t){var a,i=$(this).closest(".calendar-cell");i.hasClass("disabled")||(a=t.dateInfo.date.year(),a=t.getDisplayText(t.dateInfo.date,"yyyy")-a,t.dateInfo.date.year(i.attr("data-value")-a),(i=t.settings.calendarStack).pop(),"date"===i[i.length-1]&&(t.dateInfo.fixedDate=moment(t.dateInfo.date)),t.showCalendar())}}],init:function(e){this.settings.calendarStack=[]},render:function(){for(var e=this.dom(),t=this.settings,a=$.su.CHAR.DATEPICKER,i=[a.SUNDAY_ABBR,a.MONDAY_ABBR,a.TUESDAY_ABBR,a.WEDNESDAY_ABBR,a.THURSDAY_ABBR,a.FRIDAY_ABBR,a.SATURDAY_ABBR],s=[a.JAN,a.FEB,a.MAR,a.APR,a.MAY,a.JUN,a.JUL,a.AUG,a.SEP,a.OCT,a.NOV,a.DEC],n=(e.addClass(t.cls+"calendar-container"),""),n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n+='<div class="widget-wrap-outer calendar-wrap-outer">')+'<div class="calendar-wrap">'+'<div class="ym-container">')+'<div class="prev-btns-container paging-btns-container">'+'<a class="prev-btns first-btn"></a>')+'<a class="prev-btns prev-btn"></a>'+"</div>")+'<div class="month-container tool-item">'+'<a class="text" data-value="">')+"</a>"+"</div>")+'<div class="year-container tool-item">'+'<a class="text" data-value="">')+"</a>"+"</div>")+'<div class="year-slot-container tool-item hidden">'+'<span class="text" data-value="">')+"</span>"+"</div>")+'<div class="next-btns-container paging-btns-container">'+'<a class="next-btns next-btn"></a>')+'<a class="next-btns last-btn"></a>'+"</div>")+"</div>"+'<div class="calendar-area">')+'<div class="date-calendar-container">'+'<table class="date-calendar">')+'<thead class="week-info-container">'+"<tr>",l=0,o=i.length;l<o;l++)n+='<th class="week-day">'+i[l]+"</th>";n+='</tr></thead><tbody class="calendar-body"></tbody></table></div><div class="month-calendar-container hidden"><table class="month-calendar"><tbody class="calendar-body">';for(var d=0;d<4;d++){n+='<tr class="calendar-row">';for(var r=0;r<3;r++)n=n+'<td class="calendar-cell" data-value="'+(3*d+r)+'"><a>'+s[3*d+r]+"</a></td></td>";n+="</tr>"}e.append(n=(n=(n=(n=(n=(n=n+"</tbody>"+"</table>")+"</div>"+'<div class="year-calendar-container hidden">')+'<table class="year-calendar">'+'<tbody class="calendar-body">')+"</tbody>"+"</table>")+"</div>"+"</div>")+"</div>"+"</div>"),this.settings.calendarStack.push("date"),this.initCalendar()},initCalendar:function(){var e=$.su.serviceManager.get("time").getNowTimeStamp();this.dateInfo={},this.dateInfo.today=moment(e),this.dateInfo.timeZone=0,this.updateDateInfo(),this.dateInfo.fixedDate=null,this.dateInfo.selected=null,this.updateToolBar(),this.showCalendar()},updateDateInfo:function(e){e=e||this.dateInfo.today,this.dateInfo.date=moment(e)},updateToolBar:function(){var e=this.dom(),t=this.getDateObj(this.dateInfo.date),a=$.su.CHAR.DATEPICKER,a=[a.JAN,a.FEB,a.MAR,a.APR,a.MAY,a.JUN,a.JUL,a.AUG,a.SEP,a.OCT,a.NOV,a.DEC],i=t.month,t=t.year,s=t-+(t+"").split("").splice(3,1).join();e.find(".month-container .text").attr("data-value",i).text(a[i]),e.find(".year-container .text").attr("data-value",t).text(t),e.find(".year-slot-container .text").attr("data-value",t).text(s+"-"+(9+s)),this.updateToolBtns()},getDateObj:function(e){return e instanceof moment&&(e=e.valueOf()),"date"===$.type(e)?null:(e=this.getDisplayText(e,"yyyy-MM-dd",!1).split("-"),{year:parseInt(e[0]),month:parseInt(e[1])-1,date:parseInt(e[2])})},getDisplayText:function(e,t,a){return $.su.serviceManager.get("time").getTextFromUTC(e,this.settings.timeZoneType,{pattern:t||"MM dd, yyyy",transferMonth:a||!1})},updateDateCalendar:function(e){for(var t,a=this.dom().find(".date-calendar .calendar-body"),i=this.dateInfo.date,s=this.getDateObj(i),n=s.month,l=s.year,s=this.getDateObj(this.dateInfo.today),o=s.month,d=s.year,r=s.date,s=moment(i),c=(s.month(s.month()-1),(s=this.getDateObj(s)).month),u=s.year,s=moment(i),h=(s.month(s.month()+1),(s=this.getDateObj(s)).month),p=s.year,g=moment([l,n]).day()%7,m=this.getDates(l,n-1),v=this.getDates(l,n),b="",f="",x=0;x<6;x++){f+='<tr class="calendar-row">';for(var w=0;w<7;w++){var y,C,_,k=7*x+w,b=k<g?(t=m+w-g+1,C=u,y=c,_=!0,"prev-month-date other-month-date"+((_=this.minDate&&this.minDate.year&&(this.minDate.month||0===this.minDate.month)&&this.minDate.day?this.compareDate({year:C,month:y,day:t},this.minDate):_)?"":" disabled")):v+g<=k?(t=k-g-v+1,C=p,y=h,_=!0,"next-month-date other-month-date"+((_=this.minDate&&this.minDate.year&&(this.minDate.month||0===this.minDate.month)&&this.minDate.day?this.compareDate({year:C,month:y,day:t},this.minDate):_)?"":" disabled")):(t=k-g+1,C=l,y=n,_=!0,"current-month-date"+((_=this.minDate&&this.minDate.year&&(this.minDate.month||0===this.minDate.month)&&this.minDate.day?this.compareDate({year:C,month:y,day:t},this.minDate):_)?"":" disabled"));this.settings.todayMark&&t===r&&y===o&&C===d&&(b+=" today"),f+='<td class="calendar-cell '+b+'" data-date="'+C+"-"+y+"-"+t+'" data-index="'+t+'"><a>'+t+"</a></td>"}f+="</tr>"}a.empty().append(f)},getDates:function(e,t){var a=0,e=((t+=1)<0&&(a=t,t=0),11<t&&(a=t-11,t=11),moment([e,t,1]));return e.month(e.month()+a),e.date(e.date()-1),e.date()},updateYearCalendar:function(){var e=this.dom().find(".year-calendar .calendar-body"),t="",a=this.getDateObj(this.dateInfo.date).year,i=e.find(".current-slot-year");if(!(0<e.children().length&&a>=+i.eq(0).attr("data-value")&&a<=+i.eq(9).attr("data-value"))){for(var s=a-+(a+"").split("").splice(3,1).join()-1,n=0;n<4;n++){t+='<tr class="calendar-row">';for(var l=0;l<3;l++)t+='<td class="calendar-cell '+(0===n&&0===l?"prev-slot-year":3===n&&2===l?"next-slot-year":"current-slot-year")+'" data-value="'+s+'"><a>'+s+++"</a></td>";t+="</tr>"}e.empty().append(t)}},showCalendar:function(e){var t=this.settings.calendarStack,t=t[t.length-1],a=this.dom().find(".ym-container");switch(a.removeClass("tool-month tool-year tool-year-slot"),a.children(".tool-item").addClass("hidden"),t){case"date":this.updateDateCalendar(),a.children(".month-container").removeClass("hidden"),a.children(".year-container").removeClass("hidden"),a.addClass("tool-month");break;case"month":a.children(".year-container").removeClass("hidden"),a.addClass("tool-year");break;case"year":this.updateYearCalendar(),a.children(".year-slot-container").removeClass("hidden"),a.addClass("tool-year-slot")}this.updateToolBar();var i=this.dom().find(".calendar-area");i.children().addClass("hidden"),i.children("."+t+"-calendar-container").removeClass("hidden"),this.dom().triggerHandler("ev_calendar_view_update")},updateToolBtns:function(){var e=this.dom().find(".ym-container");e.hasClass("tool-month")?(e.find(".prev-btn").removeClass("hidden"),e.find(".next-btn").removeClass("hidden")):(e.find(".prev-btn").addClass("hidden"),e.find(".next-btn").addClass("hidden"))},resetStack:function(e,t,a){this.settings.calendarStack=[this.settings.calendarStack[0]]},setMinDate:function(e){this.minDate=e,this.updateDateCalendar(!0)},compareDate:function(e,t){e=moment([e.year,e.month,e.day]),t=moment([t.year,t.month,t.day]);return e.valueOf()>=t.valueOf()},setTimezoneType:function(e){this.settings.timeZoneType=e}}),$.su.Widget.register("rangepicker",{settings:{format:{attribute:"format",defaultValue:"yyyy-mm-dd"},labelField:{attribute:"label-field",defaultValue:""},timeZone:{attribute:"time-zone",defaultValue:!1},inputBox:{attribute:"input-box",defaultValue:!1},timeZoneType:{attribute:"time-zone-type",defaultValue:"site"},displayLeft:{attribute:"display-left",defaultValue:!1},limitDay:{attribute:"limit-day",defaultValue:!1},enableTime:{attribute:"enable-Time",defaultValue:!1}},listeners:[{selector:".datepicker-display-container",event:"click",callback:function(e,t){e.stopPropagation(),t.settings.shownStatus?t.hideDatepicker():t.dom().hasClass("disabled")||(t.startCalendar.resetStack(),t.endCalendar.resetStack(),t.setSelected(t.dateInfo.selected),t.showDatepicker())}},{selector:".datepicker-date-select .date-item",event:"click",callback:function(e,t){var a=+$(this).attr("data-offset"),i=+$(this).attr("data-type"),s=$.su.serviceManager.get("time").getNowTimeStamp(),n=t.getDisplayText(s,"yyyy-MM-dd",!1);switch(i){case 1:o=t.getStartTime(n);break;case 2:var l=moment(n).date(moment(n).date()-1).format("YYYY-MM-DD"),s=t.getEndTime(l),o=t.getStartTime(l)}i||(o=moment(s.valueOf()-a));i=t.transferEnableDate({start:moment(o),end:moment(s)});t.dom().triggerHandler("ev_view_change",[{"type":"value","value":{start:i.start.valueOf(),end:i.end.valueOf()}}]),t.hideDatepicker()}},{selector:".date-calendar-container .calendar-cell a",event:"click",callback:function(e,t){e.stopPropagation();var a,i,s,n,e=t.dateInfo,l=$(this).closest(".calendar-cell");l.hasClass("disabled")||(a={},null!==e.selected&&null===e.selected.end?(e=$.su.serviceManager.get("time").getTextFromUTC(e.selected.start,t.settings.timeZoneType,{pattern:"yyyy-MM-dd",transferMonth:!1}),i=t.getDateText(l.attr("data-date")),s=moment(e).valueOf(),n=moment(i).valueOf(),a.start=s<n?e:i,a.end=s<n?i:e,t.hideDatepicker()):(a.start=t.getDateText(l.attr("data-date")),a.end=null),a.start=t.getStartTime(a.start),a.end&&(a.end=t.getEndTime(a.end)),t.dom().triggerHandler("ev_calendar_change",[a]),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}]))}},{selector:".date-calendar-container .calendar-cell",event:"mouseenter",callback:function(e,t){$(".date-calendar-container .hover").removeClass("hover");var a,i,s=t.dateInfo.selected,n=$(this).closest(".calendar-cell");null!==s&&null===s.end&&(a=n.closest(".date-calendar"),n.hasClass("prev-month-date")?(i=a.find(".current-month-date").eq(0).attr("data-date").split("-"))[2]=i[2]-1:n.hasClass("next-month-date")?(i=a.find(".current-month-date").last().attr("data-date").split("-"))[2]=+i[2]+1:(n.addClass("hover"),i=n.attr("data-date").split("-")),n=(a=moment(t.getStartTime(t.getDateText(i.join("-"))))).valueOf()>s.start.valueOf()?s.start:a,i=a.valueOf()<s.start.valueOf()?s.start:a,t.updateCoverRangeStatus(n,i))}},{selector:".datepicker-display-container .date",event:"mouseenter",callback:function(e,t){t.dom().hasClass("disabled")||null!==t.dateInfo.selected&&$(this).addClass("clear")}},{selector:".datepicker-display-container .clear",event:"mouseleave",callback:function(e,t){$(this).removeClass("clear")}},{selector:".datepicker-display-container .clear",event:"click",callback:function(e,t){e.stopPropagation(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":null}])}},{selector:".datepicker-input.start-date",event:"keyup",callback:function(e,t){var a,i,s,n;13===e.keyCode&&(e=$(this).val(),n=+$(this).attr("maxlength"),a=t.checkFormatValidate(e),i=t.dateInfo,s={start:null,end:null},e.length==n&&a?(e=$(this).closest(".datepicker-input-inner").find(".end-date").val(),n=t.checkFormatValidate(e),s.start=moment([a.year,a.month,a.date]).valueOf(),null!==i.selected&&null!==i.selected.end&&t.checkDateRange(a,n)&&(s.end=moment(i.selected.end).valueOf(),t.hideDatepicker()),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":s}])):null!==i.selected&&null!==i.selected.end&&(s.start=moment(i.selected.start).valueOf(),s.end=moment(i.selected.end).valueOf(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":s}]),t.hideDatepicker()))}},{selector:".datepicker-input.end-date",event:"keyup",callback:function(e,t){var a,i,s,n,l=$(this).closest(".datepicker-input-inner").find(".start-date").val(),l=t.checkFormatValidate(l);13===e.keyCode&&l&&(e=$(this).val(),a=+$(this).attr("maxlength"),i=t.checkFormatValidate(e),s=t.dateInfo,n={start:moment(s.selected.start).valueOf(),end:null},e.length<a||!i||!t.checkDateRange(l,i)?n.end=null===s.selected.end?t.getNextMonthDate(s.selected.start):moment(s.selected.end):n.end=moment([i.year,i.month,i.date]),n.end=n.end.valueOf(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":n}]),t.hideDatepicker())}},{selector:".datepicker-input.start-date",event:"blur",callback:function(e,t){t.updateText()}},{selector:".datepicker-input.end-date",event:"blur",callback:function(e,t){t.updateText()}},{selector:function(){return{parent:"body",target:""}},event:"click",callback:function(e,t){e.stopPropagation();var a=t.settings,e=e.target||e.srcElement,e=$(e).closest(".datepicker-wrap-outer");a.shownStatus&&0===e.length&&t.hideDatepicker()}}],init:function(e){this.settings.shownStatus=!1,$.su.serviceManager.get("time").setDefaultTimezone(this.settings.timeZoneType)},render:function(){var e=this.dom(),t=this.settings,a=(e.addClass(t.cls+" rangepicker-container datepicker-container"+(t.inputBox?" input-enable":"")),""),i=(null!==t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<div class="widget-fieldlabel-inner"><label class="widget-fieldlabel datepicker-fieldlabel">'+("false"===t.labelField?"":t.labelField)+"</label>",t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div></div>"),a=(a=(a=(a=(a+='<div class="widget-wrap-outer datepicker-wrap-outer">')+('<div id="'+this.domId+'_picker" class="datepicker">')+'<div class="datepicker-display-container">')+('<input type="text" class="datepicker-display start-date" readonly placeholder="'+$.su.CHAR.DATEPICKER.START_DATE+'" maxlength="10">')+'<span class="separator">â€“</span>')+('<input type="text" class="datepicker-display end-date" readonly placeholder="'+$.su.CHAR.DATEPICKER.END_DATE+'" maxlength="10">'))+'<span class="icon date"></span>'+"</div>",t.displayLeft?a+='<div class="datepicker-calendar-container left hidden">':a+='<div class="datepicker-calendar-container hidden">',a+='<div class="datepicker-calendar-inner u-d-inline-block">',t.inputBox&&(a=(a=(a+='<div class="datepicker-input-container"><div class="datepicker-input-inner u-d-table">')+'<input type="text" class="datepicker-input start-date u-d-table-cell" placeholder="'+$.su.CHAR.DATEPICKER.START_DATE+'" maxlength="10"><span class="separator u-d-table-cell">-</span>')+'<input type="text" class="datepicker-input end-date u-d-table-cell" placeholder="'+$.su.CHAR.DATEPICKER.END_DATE+'" maxlength="10"></div></div>'),a=(a=(a+='<div widget="calendar" today-mark="{false}" time-zone="{true}" id="'+this.domId+'_start_calendar" class="start-calendar u-d-inline-block">')+"</div>"+('<div widget="calendar" today-mark="{false}" time-zone="{true}" id="'+this.domId+'_end_calendar" class="end-calendar u-d-inline-block">'))+"</div>"+"</div>",t.configs&&t.configs.timeslot);if(i){a+='<ul class="datepicker-date-select u-d-inline-block">';for(var s=0,n=i.length;s<n;s++)a+='<li class="date-item" data-offset="'+i[s].offset+'" data-type="'+i[s].type+'"><span>'+i[s].text+"</span></li>";a+="</ul>"}a=(a=(a+='<div class="datepicker-button-container hidden">')+'<div widget="button" text="'+$.su.CHAR.OPERATION.OK+'" id="'+this.domId+'_ok_button" class="ok-button u-d-inline-block">')+'</div><div widget="button" text="'+$.su.CHAR.OPERATION.CANCEL+'" id="'+this.domId+'_cancel_button" class="cancel-button secondary-button u-d-inline-block">',e.append(a=(a=(a+="</div>")+"</div>"+"</div>")+"</div>"+"</div>"),this.startCalendar=new $.su.widgets.calendar({id:this.domId+"_start_calendar"}),this.startCalendar.setTimezoneType(this.settings.timeZoneType),this.startCalendar.render();var l=this;this.startCalendar.dom().on("ev_calendar_view_update",function(e){l.setSelectedStatus(),l.updateCalendarStatus($(this))}),this.endCalendar=new $.su.widgets.calendar({id:this.domId+"_end_calendar"}),this.endCalendar.setTimezoneType(this.settings.timeZoneType),this.endCalendar.render(),this.endCalendar.dom().on("ev_calendar_view_update",function(e){l.setSelectedStatus(),l.updateCalendarStatus($(this))}),this.okBtn=new $.su.widgets.button({id:this.domId+"_ok_button"}),this.okBtn.render(),this.okBtn.dom().on("ev_button_click",function(e){}),this.cancelBtn=new $.su.widgets.button({id:this.domId+"_cancel_button"}),this.cancelBtn.render(),this.cancelBtn.dom().on("ev_button_click",function(e){}),this.dateInfo={startInfo:this.startCalendar.dateInfo,endInfo:this.endCalendar.dateInfo,selected:null},this.dateInfo.startInfo.fixedDate=moment(this.dateInfo.startInfo.date),this.dateInfo.endInfo.fixedDate=moment(this.dateInfo.endInfo.date)},setSelected:function(e){e=this.transferEnableDate(e),this.updateDateInfo(e),this.updateSelectedInfo(e),this.startCalendar.showCalendar(),this.endCalendar.showCalendar(),this.setSelectedStatus(),this.updateText()},transferEnableDate:function(e){var t;return e&&e.start&&e.end&&this.settings.enableInterval&&(t=e.end.valueOf()-this.settings.enableInterval,e.start.valueOf()<t)&&(e.start=moment(t)),e},updateSelectedInfo:function(e){this.dateInfo.selected=null===e?null:null===e.end?{start:moment(e.start),end:null}:{start:moment(e.start),end:moment(e.end)}},updateDateInfo:function(e){var t=this.dateInfo,a=t.startInfo,t=t.endInfo,i=e&&e.start?e.start:a.today,i=(this.setFirstDayOfMonth(a,i),e&&e.end?e.end:a.date),e=(this.setFirstDayOfMonth(t,i),this.getDateObj(a.date)),i=this.getDateObj(t.date);e.year===i.year&&e.month===i.month&&(t.date=moment(this.getNextMonthTime(a.date)))},setFirstDayOfMonth:function(e,t){e.date=moment(t);t=this.getDateOffset(e.date);e.date.date(1-t)},getDateOffset:function(e){return this.getDisplayText(e,"dd",!1)-e.date()},getNextMonthTime:function(e){var e=this.getDisplayText(e,"yyyy-MM-dd",!1).split("-"),t=+e[1]+1;return e[0]=+e[0]+Math.floor(t/13),e[1]=("0"+(t<13?t:1)).slice(-2),e[2]="01",this.getStartTime(e.join("-"))},setSelectedStatus:function(){var e=this.dom(),t=this.dateInfo,a=this.getDateObj(t.startInfo.date),i=this.getDateObj(t.endInfo.date),s=e.find(".calendar-container"),s=(s.find(".selected").removeClass("selected"),s.find(".disabled").removeClass("disabled"),s.find(".hover").removeClass("hover"),e.find(".start-calendar")),n=e.find(".end-calendar"),s=(s.find('.year-calendar-container .current-slot-year[data-value="'+a.year+'"]').addClass("selected"),s.find('.month-calendar-container .calendar-cell[data-value="'+a.month+'"]').addClass("selected"),n.find('.year-calendar-container .current-slot-year[data-value="'+i.year+'"]').addClass("selected"),n.find('.month-calendar-container .calendar-cell[data-value="'+i.month+'"]').addClass("selected"),t.selected);this.setFixedDisableRange(),null===s?this.updateCoverRangeStatus(null):(a=(n=this.getDateObj(s.start)).year+"-"+n.month+"-"+n.date,e.find(`.current-month-date[data-date="${a}"]`).addClass("selected"),null===s.end?(this.setDisableStatus(),this.updateCoverRangeStatus(null)):(i=(t=this.getDateObj(s.end)).year+"-"+t.month+"-"+t.date,e.find(`.current-month-date[data-date="${i}"]`).addClass("selected"),n=moment(this.getStartTime(this.getDateText(a))),s=moment(this.getStartTime(this.getDateText(i))),this.updateCoverRangeStatus(n,s),this.setDisableStatus()))},setDisableStatus:function(){var e,t,a=this.dateInfo.selected,i=this.settings;!i.enableInterval&&a&&a.start&&null===a.end&&!i.limitDay||(e=-1/0,t=1/0,i.enableInterval&&a&&a.start&&null===a.end&&(a=a.start.valueOf(),e=Math.max(a-i.enableInterval,e),t=Math.min(a+i.enableInterval,t)),i.limitDay&&(a=$.su.serviceManager.get("time").getCurrentDayStart(),e=Math.max(a-60*i.limitDay*60*24*1e3,e)),this.setDisableCalendarCell(e,t))},setFixedDisableRange:function(){var e=this.settings.enableTime;e&&this.setDisableCalendarCell(e.start,e.end)},setDisableCalendarCell:function(t,a){this.dom().find(".date-calendar-container .calendar-cell").each(function(){var e=$(this).attr("data-date").split("-"),e=moment([e[0],e[1],e[2]]).valueOf();(e<t||a<e)&&$(this).addClass("disabled")})},updateCoverRangeStatus:function(o,d){if(this.dom().find(".calendar-container .calendar-cell").removeClass("covered coveredStart coveredEnd"),null!==o){let e=o.valueOf(),t=d.valueOf(),a,i,s=this.dom().find(".current-month-date"),n=0,l=s.length-1;for(;n<s.length;){var r=s[n];if(e<=this.getStartTime(this.getDateText($(r).attr("data-date")))){a=r;break}n++}for(;0<=l;){var c=s[l];if(this.getStartTime(this.getDateText($(c).attr("data-date")))<=t){i=c;break}l--}for(let e=n;e<=l;e++)$(s[e]).addClass("covered");$(a).hasClass("disabled")||$(a).addClass("coveredStart"),$(i).hasClass("disabled")||$(i).addClass("coveredEnd")}},updateText:function(){var e=null===this.dateInfo.selected?"":this.getDisplayText(this.dateInfo.selected.start),t=null===this.dateInfo.selected||null===this.dateInfo.selected.end?"":this.getDisplayText(this.dateInfo.selected.end);this.dom().find(".start-date").val(e),this.dom().find(".end-date").val(t)},getDisplayText:function(e,t,a){return $.su.serviceManager.get("time").getTextFromUTC(e,this.settings.timeZoneType,{pattern:t||"MM dd, yyyy",transferMonth:a})},getStartTime:function(e){return $.su.serviceManager.get("time").getStartUTCTimeInDay(e,this.settings.timeZoneType)},getEndTime:function(e){return $.su.serviceManager.get("time").getEndUTCTimeInDay(e,this.settings.timeZoneType)},getDateText:function(e){return(e=e.split("-"))[1]=this.padStart(+e[1]+1),e[2]=this.padStart(e[2]),e.join("-")},padStart:function(e){return("0"+e).slice(-2)},getDateFromFormat:function(e){var t;return"string"===$.type(e)?(t=this.checkFormatValidate(e))?moment([t.year,t.month,t.date]):null:"number"===$.type(e)?moment(e):void 0},getDateObj:function(e){return e instanceof moment&&(e=e.valueOf()),"date"===$.type(e)?null:(e=this.getDisplayText(e,"yyyy-MM-dd",!1).split("-"),{year:parseInt(e[0]),month:parseInt(e[1])-1,date:parseInt(e[2])})},showDatepicker:function(){var e=this.dom();this.dateInfo;this.settings.shownStatus=!this.settings.shownStatus,e.find(".datepicker-display-container").addClass("active"),e.find(".datepicker-calendar-container").removeClass("hidden"),e.find(".datepicker-input").eq(0).focus()},hideDatepicker:function(){var e=this.dom();this.settings.shownStatus=!this.settings.shownStatus,e.find(".datepicker-display-container").removeClass("active"),e.find(".datepicker-calendar-container").addClass("hidden"),e.triggerHandler("ev_view_close")},updateCalendarStatus:function(e){e.find(".ym-container");this.dom().find(".adjacent").removeClass("adjacent"),this.dom().find(".disabled").removeClass("disabled"),0<this.dom().find(".calendar-container").not(e).length&&(this.updatePagingBtns(),this.updateMonthCellStatus(),this.updateYearCellStatus(),this.setFixedDisableRange(),this.setDisableStatus())},updatePagingBtns:function(){var e=this.dom(),t=(e.find(".adjacent").removeClass("adjacent"),this.getDateObj(this.startCalendar.dateInfo.date)),a=this.getDateObj(this.endCalendar.dateInfo.date);t.year===a.year&&t.month+1===a.month&&e.find(".ym-container").addClass("adjacent")},updateMonthCellStatus:function(){this.dom().find(".month-calendar-container .disabled").removeClass("disabled");var e=this.startCalendar,t=this.endCalendar,a=this.getDateObj(e.dateInfo.date),i=this.getDateObj(t.dateInfo.date),s=this.getDateObj(e.dateInfo.fixedDate),n=this.getDateObj(t.dateInfo.fixedDate);a.year>=n.year&&(a=a.year>n.year?0:n.month+1,e.dom().find(".month-calendar-container .calendar-cell").slice(a).addClass("disabled")),i.year<=s.year&&(n=i.year<s.year?12:s.month+1,t.dom().find(".month-calendar-container .calendar-cell").slice(0,n).addClass("disabled"))},updateYearCellStatus:function(){this.dom().find(".year-calendar-container .disabled").removeClass("disabled");var e=this.startCalendar,t=this.endCalendar,a=this.getDateObj(e.dateInfo.date),i=this.getDateObj(t.dateInfo.date),s=this.getDateObj(e.dateInfo.fixedDate),n=this.getDateObj(t.dateInfo.fixedDate),a=a.year-(a.year+"").slice(-1)-1,i=i.year-(i.year+"").slice(-1)-1,l=s.year-(s.year+"").slice(-1)-1,o=n.year-(n.year+"").slice(-1)-1;o<=a&&(a=o<a?0:0===n.month?n.year-o:n.year-o+1,e.dom().find(".year-calendar-container .calendar-cell").slice(a).addClass("disabled")),i<=l&&(n=i<l?12:11===s.month?s.year-l+1:s.year-l,t.dom().find(".year-calendar-container .calendar-cell").slice(0,n).addClass("disabled"))},checkFormatValidate:function(e){var t,a,i,s,n,l,o,d,r=this.settings.format;return!(e.length<r.length||(l=r.indexOf("y"),o=r.lastIndexOf("y")+1,d=r.indexOf("m"),t=r.lastIndexOf("m")+1,a=r.indexOf("d"),r=r.lastIndexOf("d")+1,i=+e.slice(l,o),s=e.slice(d,t)-1,e=+e.slice(a,r),isNaN(i))||isNaN(s)||isNaN(e)||(l=+((n=moment([i,s,e])).year()+"").slice(l-o),o=+("0"+n.month()).slice(d-t),d=+("0"+n.date()).slice(a-r),i!=l)||s!=o||e!=d)&&{year:i,month:s,date:e}},checkDateRange:function(e,t){e=moment([e.year,e.month,e.date]),t=moment([t.year,t.month,t.date]);return e.valueOf()<=t.valueOf()},getNextMonthDate:function(e){var e=this.getDateObj(e),t=moment([e.year,e.month+2,0]);return e.date<t.date()&&t.date(e.date),t},getValue:function(){return this.dateInfo.selected},setValue:function(e){var t;void 0!==e&&(null!==(t=null===e?null:{start:null,end:null})&&("object"===$.type(e)?(e.start&&(t.start=this.getDateFromFormat(e.start)),e.end&&(t.end=this.getDateFromFormat(e.end))):t.start=this.getDateFromFormat(e)),this.setSelected(t))},setEnableInterval:function(e){this.settings.enableInterval=e,this.dateInfo.selected&&(e=this.transferEnableDate(this.dateInfo.selected),this.dom().triggerHandler("ev_view_change",[{"type":"value","value":{start:e.start&&e.start.valueOf(),end:e.end&&e.end.valueOf()}}]))},initShownStatus:function(){this.settings.shownStatus=!1},getLimitDay:function(){return this.settings.limitDay},setLimitDay:function(e){this.settings.limitDay=e},setEnableTime:function(e){this.settings.enableTime=e},getTimeRangeStr:function(){return this.dom().find(".start-date")[0].value+" - "+this.dom().find(".end-date")[0].value},updateTimeZoneType:function(e){this.settings.timeZoneType=e||"site"}}),$.su.Widget.register("transfer",{settings:{leftTitle:{attribute:"left-title",defaultValue:""},rightTitle:{attribute:"right-title",defaultValue:""},enableSearch:{attribute:"enable-search",defaultValue:!1},caseSensitive:{attribute:"case-sensitive",defaultValue:!1},simple:{attribute:"simple",defaultValue:!1}},listeners:[{selector:".transfer-button",event:"click",callback:function(e,t){if(!t.dom().hasClass("disabled")){var a,i,s=[];if(!$(e.currentTarget).hasClass("disabled"))if($(e.currentTarget).hasClass("right")){for(i in a=t._leftCheckboxGroup.getValue())a.hasOwnProperty(i)&&a[i]&&s.push(i);t.setValue(t._value.concat(s))}else{for(i in a=t._rightCheckboxGroup.getValue())a.hasOwnProperty(i)&&a[i]&&s.push(i);for(var n=t._value.length-1;0<=n;n--)-1!==s.indexOf(t._value[n])&&t._value.splice(n,1);t.setValue(t._value)}}}},{selector:".all-checkbox-left .checkbox-label",event:"click",callback:function(e,t){t.dom().hasClass("disabled")||($(this).find("input[type=checkbox]").prop("checked")?t.unselectAll("left"):t.selectAll("left"))}},{selector:".all-checkbox-right .checkbox-label",event:"click",callback:function(e,t){t.dom().hasClass("disabled")||($(this).find("input[type=checkbox]").prop("checked")?t.unselectAll("right"):t.selectAll("right"))}},{selector:".transfer-search-text-left input[type=text]",event:"keyup",callback:$.su.debounce(function(e,t){var a=$(this).closest("[widget=textbox]").data("viewObj").getValue();t.dom().find(".search-icon-left")[a?"addClass":"removeClass"]("clear"),t.filterItems(a,"left")},500)},{selector:".transfer-search-text-right input[type=text]",event:"keyup",callback:$.su.debounce(function(e,t){var a=$(this).closest("[widget=textbox]").data("viewObj").getValue();t.dom().find(".search-icon-right")[a?"addClass":"removeClass"]("clear"),t.filterItems(a,"right")},500)},{selector:".search-icon-left.clear",event:"click",callback:function(e,t){$(this).closest(".transfer-search-container").find("[widget=textbox].transfer-search-text-left").data("viewObj").setValue(null),t.dom().find(".search-icon-left").removeClass("clear"),t.filterItems("","left")}},{selector:".search-icon-right.clear",event:"click",callback:function(e,t){$(this).closest(".transfer-search-container").find("[widget=textbox].transfer-search-text-right").data("viewObj").setValue(null),t.dom().find(".search-icon-right").removeClass("clear"),t.filterItems("","right")}},{selector:".simple-bottom-text",event:"click",callback:function(e,t){if(!t.dom().hasClass("disabled"))if($(this).hasClass("left")){var a,i=[];for(a in t._option)t._option.hasOwnProperty(a)&&i.push(t._option[a].value);t.setValue(i)}else t.setValue([])}}],init:function(){this._defaultValue=null,this._option=[],this._value=[],this._total=0,this._leftCheckboxGroup=void 0,this._rightCheckboxGroup=void 0,this._leftCheckAll=void 0,this._rightCheckAll=void 0,this._searchLeft=void 0,this._searchRight=void 0},render:function(){for(var e=this.dom(),t=this.settings,a=(e.addClass(t.cls+"transfer-container "),""),i=(null!==t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel combobox-fieldlabel">'+("false"===t.labelField?"":t.labelField)+"</label>",t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>"),a=(a=(a+='<div class="widget-wrap-outer transfer-wrap-outer">')+'<div class="widget-wrap transfer-wrap">'+('<div class="transfer-container-left u-d-inline-block'+(t.enableSearch?" with-search-bar":"")+'">'))+('<div class="transfer-title">'+t.leftTitle+"</div>"),a=(a=t.enableSearch?(a+='<div class="transfer-search-container">')+'<div widget="textbox" id="'+this.domId+'-search-input-left" hint="'+$.su.CHAR.COMMON.SEARCH+'" class="transfer-search-text-left"></div><div class="search-icon-left"></div></div>':a)+'<div class="transfer-content"></div>'+'<div class="transfer-bottom">',t.simple?a+='<span class="simple-bottom-text left">'+$.su.CHAR.COMMON.MOVE_ALL+"</span>":a+='<div widget="checkbox" id="'+this.domId+'_all_checkbox_left" class="u-label-none all-checkbox-left"></div>',a=(a+="</div>")+"</div>"+'<div class="transfer-button-container u-d-inline-block">',t.simple?a+='<div class="transfer-button simple"><span class="icon-simple"></span></div>':a+='<div class="transfer-button right"><span class="icon-right"></span></div><div class="transfer-button left"><span class="icon-left"></span></div>',a=(a=a+"</div>"+('<div class="transfer-container-right u-d-inline-block'+(t.enableSearch?" with-search-bar":"")+'">'))+('<div class="transfer-title">'+t.rightTitle+"</div>"),a=(a=t.enableSearch?(a+='<div class="transfer-search-container">')+'<div widget="textbox" id="'+this.domId+'-search-input-right" hint="'+$.su.CHAR.COMMON.SEARCH+'" class="transfer-search-text-right"></div><div class="search-icon-right"></div></div>':a)+'<div class="transfer-content"></div>'+'<div class="transfer-bottom">',t.simple?a+='<span class="simple-bottom-text right">'+$.su.CHAR.COMMON.MOVE_ALL+"</span>":a+='<div widget="checkbox" id="'+this.domId+'_all_checkbox_right" class="u-label-none all-checkbox-right"></div>',a=(a=a+"</div>"+"</div>")+"</div>"+"</div>",e.append($(a)),t.enableSearch&&(this._searchLeft=new $.su.widgets.textbox({id:this.domId+"-search-input-left"}),this._searchRight=new $.su.widgets.textbox({id:this.domId+"-search-input-right"}),this._searchLeft.render(),this._searchRight.render()),this._leftCheckAll=new $.su.widgets.checkbox({id:this.domId+"_all_checkbox_left"}),this._rightCheckAll=new $.su.widgets.checkbox({id:this.domId+"_all_checkbox_right"}),this._leftCheckAll.render(),this._rightCheckAll.render(),e.find(".transfer-content")),s=0;s<i.length;s++)0===$(i[s]).find(".ps__rail-y").length&&$.su.scrollbar({ele:i[s]})},loadItems:function(e){this.settings.items=e,this._option=e,this._total=e.length,this.transferTo(e,"left")},setValue:function(e){if(e){this._value=e;for(var t=[],a=[],i=0;i<this._option.length;i++)(-1!==e.indexOf(this._option[i].value)?t:a).push(this._option[i]);this.transferTo(t,"right"),this.transferTo(a,"left"),this._leftCheckAll.dom().find(".checkbox-label").removeClass("imperfect"),this._rightCheckAll.dom().find(".checkbox-label").removeClass("imperfect"),this._leftCheckAll.setValue(!1),this._rightCheckAll.setValue(!1)}},transferTo:function(o,d){var r=this,c=this.settings,u=this.dom(),e="",h="left"===d?"right":"left";u.find(".transfer-button."+h).removeClass("disabled active").addClass("disabled"),(o=$.isArray(o)?o:[]).length&&(e+='<div widget="checkboxGroup" id="'+this.domId+"_"+d+'_option" columns="{1}" class="u-label-none"></div>'),u.find(".transfer-container-"+d+" .transfer-content").empty().append(e),o.length?(u.find(".transfer-container-"+d+" .transfer-content").removeClass("no-data"),this["_"+d+"CheckboxGroup"]=new $.su.widgets.checkboxGroup({id:this.domId+"_"+d+"_option"}),this["_"+d+"CheckboxGroup"].render(),this["_"+d+"CheckboxGroup"].loadItems(o),this["_"+d+"CheckAll"].setBoxLabel($.su.CHAR.COMMON.ITEMS.replace("%num",o.length||0)),c.simple&&r["_"+d+"CheckboxGroup"].dom().find(".checkbox-icon").remove(),this["_"+d+"CheckboxGroup"].dom().off("ev_view_change").on("ev_view_change",function(e,t){if(c.simple){var a;for(s in t.value)t.value.hasOwnProperty(s)&&!0===t.value[s]&&(a=s);if("left"===d)r._value.push(a);else for(var i=r._value.length-1;0<=i;i--)r._value[i]===a&&r._value.splice(i,1);r.setValue(r._value)}else{r["_"+d+"CheckboxGroup"].setValue(t.value);var s,n=0,l=0;for(s in t.value)t.value.hasOwnProperty(s)&&(!0===t.value[s]&&l++,n++);0===l?(r["_"+d+"CheckAll"].dom().find(".checkbox-label").removeClass("imperfect"),r["_"+d+"CheckAll"].setValue(!1)):l===o.length?(r["_"+d+"CheckAll"].dom().find(".checkbox-label").removeClass("imperfect"),r["_"+d+"CheckAll"].setValue(!0)):r["_"+d+"CheckAll"].dom().find(".checkbox-label").addClass("imperfect"),u.find(".transfer-button."+h).removeClass("disabled active").addClass(0===l?"disabled":"active"),r["_"+d+"CheckAll"].setBoxLabel(0===l?$.su.CHAR.COMMON.ITEMS.replace("%num",o.length||0):$.su.CHAR.COMMON.ITEMS_OF.replace("%num1",l).replace("%num2",n))}})):(u.find(".transfer-container-"+d+" .transfer-content").addClass("no-data"),u.find(".transfer-container-"+d+" .transfer-content").append('<div class="no-data-tip">'+$.su.CHAR.COMMON.NO_DATA+"</div>"),r["_"+d+"CheckAll"].setBoxLabel($.su.CHAR.COMMON.ITEMS.replace("%num",0)))},selectAll:function(e){var t,a=this["_"+e+"CheckboxGroup"].getValue();for(t in a)a.hasOwnProperty(t)&&(a[t]=!0);this["_"+e+"CheckboxGroup"].dom().triggerHandler("ev_view_change",[{"type":"value","value":a}]),this.settings.simple||(this["_"+e+"CheckAll"].dom().find(".checkbox-label").removeClass("imperfect"),this["_"+e+"CheckAll"].setValue(!0))},unselectAll:function(e){var t,a=this["_"+e+"CheckboxGroup"].getValue();for(t in a)a.hasOwnProperty(t)&&(a[t]=!1);this["_"+e+"CheckboxGroup"].dom().triggerHandler("ev_view_change",[{"type":"value","value":a}]),this["_"+e+"CheckAll"].dom().find(".checkbox-label").removeClass("imperfect"),this["_"+e+"CheckAll"].setValue(!1)},filterItems:function(e,t){var a,t=this["_"+t+"CheckboxGroup"].dom().find("span.text"),i=this;e?(e=(e=(e=e).replace(/[\*\.\?\+\$\^\[\]\(\)\{\}\|\\\/]/g,function(e){return"\\"+e})).replace(/\s/g,function(e){return"\\s"}),a=new RegExp(e,i.settings.caseSensitive?"g":"gi"),t.each(function(){var e=$(this).text(),t=!0;e.replace(a,function(e){t=!1}),t?$(this.closest("li.checkbox-list")).hide():$(this.closest("li.checkbox-list")).show()})):t.each(function(){$(this.closest("li.checkbox-list")).show()})},disable:function(){this.dom().addClass("disabled"),this.settings.simple||(this._leftCheckAll.disable(),this._rightCheckAll.disable()),this._searchLeft.disable(),this._searchRight.disable(),this._leftCheckboxGroup.disable(),this._rightCheckboxGroup.disable()}}),$.su.Widget.register("textbox",{settings:{readOnly:{attribute:"read-only",defaultValue:!1},readOnly:{attribute:"read-only",defaultValue:!1},prefix:{attribute:"prefix",defaultValue:""},suffix:{attribute:"suffix",defaultValue:""},tipText:{attribute:"tip-text",defaultValue:""},unit:{attribute:"unit",defaultValue:""},addon:{attribute:"add-on",defaultValue:""},hint:{attribute:"hint",defaultValue:null},prefixText:{attribute:"prefix-text",defaultValue:""},upperCase:{attribute:"upper-case",defaultValue:!1},placeholder:{attribute:"placeholder",defaultValue:""},instantSearch:{attribute:"instant-search",defaultValue:!1},autocomplete:{attribute:"autocomplete",defaultValue:""}},listeners:[{selector:".text-wrap-inner input.text",event:"keyup",callback:function(e,t){t.settings.upperCase&&t.setValue(t.dom().find(".text-wrap-inner input").val().toUpperCase());var a=t.getValue();t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}]),t.dom().hasClass("search-box")&&(t.settings.instantSearch?t.dom().trigger("ev_textbox_search",[a]):108!==e.keyCode&&13!==e.keyCode||t.dom().triggerHandler("ev_textbox_search"))}},{selector:".text-wrap-inner input",event:"click",callback:function(e,t){var a=t.getValue();t.dom().addClass("focus"),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}])}},{selector:"div.text-wrap",event:"mouseenter",callback:function(e,t){t.dom().addClass("hover")}},{selector:"div.text-wrap",event:"mouseleave",callback:function(e,t){t.dom().removeClass("hover")}},{selector:".text-wrap-inner input.text",event:"blur",callback:function(e,t){var a=t.getValue();t.dom().find("div.widget-addon").hide(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}]),t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":a}]),(a=t.settings.parentWidget)&&a.dom().triggerHandler("ev_item_text_blur",[a,t]),t.dom().triggerHandler("ev_textbox_blur"),t.dom().removeClass("focus"),(repeat=t.settings.repeatWidget)&&repeat.dom().triggerHandler("ev_repeat_text_blur",[t])}},{selector:".text-wrap-inner input",event:"focus",callback:function(e,t){var a;(a=t.settings.parentWidget)&&a.dom().triggerHandler("ev_item_text_focus",[a,t]),t.setAddon(),t.dom().addClass("focus"),t.dom().triggerHandler("ev_textbox_focus"),(repeat=t.settings.repeatWidget)&&repeat.dom().triggerHandler("ev_repeat_text_focus",[t.domId])}},{selector:".text-wrap-after",event:"click",callback:function(e,t){t.dom().hasClass("search-box")&&t.dom().triggerHandler("ev_textbox_search")}}],init:function(){},render:function(){var e=this.dom(),t=this.settings,a=t.readOnly?'readonly="readonly"':"",i=t.placeholder||t.hint,s=t.autocomplete,n=(e.addClass(t.cls+"text-container "+(!1===t.labelField?"label-empty":"")+(""===t.addon?"":" addon")+(""===t.unit?"":" unit")+(""===t.tips?"":" tips")+(t.prefix?" has-prefix":"")+(t.suffix?" has-suffix":"")),"");t.labelField&&(n=(n+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel text-fieldlabel">'+$.su.escapeHtml(t.labelField)+"</label>",t.labelField&&(n+='<span class="widget-separator">'+t.separator+"</span>"),n+="</div>"),t.prefixText&&(n+='<span class="textbox-prefix-text">'+t.prefixText+"</span>"),n=(n=(n+='<div class="widget-wrap-outer text-wrap-outer">')+'<div class="widget-wrap text-wrap hover-errortip"><span class="text-wrap-before">'+t.prefix+"</span>")+'<span class="text-wrap-inner"><input class="text" type="text" '+(i?'placeholder="'+i+'" ':"")+(s?'autocomplete="'+s+'" ':"")+a+'/></span><span class="text-wrap-after">'+t.suffix+"</span>",t.unit&&(n+='<span class="text-wrap-unit">'+t.unit+"</span>"),n+="</div>",n=(n=null!=t.tips&&null!=t.tips?(n+='<div class="widget-tips textbox-tips '+t.tipsCls+'">')+'<div class="content tips-content">'+t.tips+"</div></div>":n)+('<div widget="errortip" error-cls="'+t.errorTipsCls)+'"></div>',t.addon&&(n=(n+='<div class="widget-addon">')+'<span class="addon-content">'+t.addon+"</span></div>"),n+="</div>",t.tipText&&(n+='<div widget="toolTip"></div>',e.addClass("has-tool-tip")),e.empty().append(n)},setMaxLength:function(e){var t=this.dom();e=parseInt(e),"number"===$.type(e)&&t.find(".text-wrap-inner input").attr("maxlength",e)},focus:function(){this.dom().find(".text-wrap-inner input").focus()},disable:function(){var e=this.dom();e.addClass("disabled"),e.find(".text-wrap-inner input").prop("disabled",!0),e.triggerHandler("ev_view_disable")},disableDom:function(){var e=this.dom();e.addClass("disabled"),e.find(".text-wrap-inner input").prop("disabled",!0),this.setNormal()},enable:function(){var e=this.dom();this.getContainer().removeClass("disabled"),e.find(".text-wrap-inner input").prop("disabled",!1),e.triggerHandler("ev_view_enable")},enableDom:function(){var e=this.dom();this.getContainer().removeClass("disabled"),e.find(".text-wrap-inner input").prop("disabled",!1),this.setNormal()},setValue:function(e){this.getValue()!==e&&this.dom().find(".text-wrap-inner input").val(e)},getValue:function(){var a,e=this.dom().find(".text-wrap-inner input");return 1<e.length?(a=[],e.each(function(){var e=$(this),t=e.val()&&parseInt(e.val(),10);$.isNumeric(t)||(t=""),e.val(t),a.push(t)}),a):e.val()},setAddon:function(e){e=e||this.settings.addon,e=this.dom().find("div.widget-addon");this.setNormal(),e.show()},setHint:function(e){this.dom().find(".text-wrap-inner .text").attr("placeholder",e)},setUnit:function(e){this.dom().find("span.text-wrap-unit").text(e||"")},setPrefixText:function(e){this.dom().find("span.text-wrap-before").text(e||"")},setReadOnly:function(a){this.settings.readOnly=a;var e=this.getContainer(),e=(a?e.removeClass("readonly").addClass("readonly"):e.removeClass("readonly"),this.dom().find(".text-wrap-inner input"));e&&$.each(e,function(e,t){a?$(t).attr("readonly","readonly"):$(t).removeAttr("readonly")})}}),(o=>{var i=o.su.Widget.register("ip",{extend:"textbox",settings:{maskEnable:{attribute:"mask-enable",defaultValue:!1},allowZeroMask:{attribute:"allow-zero-mask",defaultValue:!1},portEnable:{attribute:"port-enable",defaultValue:!1},placeholder:{attribute:"placeholder",defaultValue:""}},listeners:[{selector:"span.ip-input input",event:"keyup",callback:function(e,t){t.dom().triggerHandler("ev_view_change",[{"type":"value","value":t.getValue()}]);var a=o(this),i=parseInt(a.attr("data-index"),10),s=a.get(0).selectionStart,n=a.get(0).selectionEnd,l=e.key||(96<=(l=e.which||e.keyCode)&&l<=105?l-96:String.fromCharCode(l)),s=parseInt(a.val().slice(0,s)+l+a.val().slice(n),10);37!==e.keyCode&&39!==e.keyCode&&8!==e.keyCode&&(s<0||255<s)&&i<3&&(l=t.dom().find("span.ip-input input[data-index="+(i+1)+"]"),a.blur(),l.focus())}},{selector:"span.ip-input input",event:"keydown",callback:function(e,t){var a=o(this),i=parseInt(a.attr("data-index"),10);if((!e.ctrlKey||86!==e.keyCode)&&(9!==e.keyCode&&17!==e.keyCode&&(!0!==e.ctrlKey||65!==e.keyCode)))if(48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105||8==e.keyCode||190==e.keyCode||110==e.keyCode||e.ctrlKey||e.metaKey||39===e.keyCode||37===e.keyCode||32===e.keyCode)if(!0!==e.shiftKey||48<=e.keyCode&&e.keyCode<=57)if(110===e.keyCode||190===e.keyCode||39===e.keyCode||32===e.keyCode)i<3&&(a.val()||0===a.val())&&t.dom().find("span.ip-input input[data-index="+(i+1)+"]").focus().select(),e.preventDefault();else if(37===e.keyCode)0<i&&((n=t.dom().find("span.ip-input input[data-index="+(i-1)+"]")).focus(),e.preventDefault());else{if(8===e.keyCode)return""===a.val()&&0<i?((n=t.dom().find("span.ip-input input[data-index="+(i-1)+"]")).val(n.val().slice(0,-1)),n.focus(),void e.preventDefault()):void 0;var t=a.get(0).selectionStart,i=a.get(0).selectionEnd,s=e.key||(96<=(s=e.which||e.keyCode)&&s<=105?s-96:String.fromCharCode(s)),n=parseInt(a.val().slice(0,t)+s+a.val().slice(i),10);(n<0||255<n)&&e.preventDefault()}else e.preventDefault();else e.preventDefault()}},{selector:"span.ip-input input",event:"paste",callback:function(e,t){e.preventDefault();e=(e.originalEvent.clipboardData||window.clipboardData).getData("text");o.su.Vtype.types.ip.regex.test(e)?t.dom().triggerHandler("ev_view_change",[{"type":"value","value":e}]):t.setError(o.su.CHAR.VTYPETEXT.IP_PASTE_ERR)}},{selector:"span.ip-input.last input",event:"blur",callback:function(e,t){255<+o(this).val()&&o(this).val(255)}},{selector:"input.mask-input",event:"keydown",callback:function(e,t){var a,i,s,n=e.which||e.keyCode;8!==n&&(!(48<=n&&n<=57||96<=n&&n<=105||8===n)||(a=this.selectionStart,i=this.selectionEnd,s=o(this).val(),n=96<=n&&n<=105?n-96:String.fromCharCode(n),(s=parseInt(s.slice(0,a)+n+s.slice(i),10))<0)||!t.settings.allowZeroMask&&0===s||32<s||0==n&&!t.settings.allowZeroMask&&s<10)&&e.preventDefault()}},{selector:"input.port-input",event:"keydown",callback:function(e,t){var a;(!(48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105||8===e.keyCode)||65535<(a=+o(this).val()+e.key)||0==a)&&e.preventDefault()}},{selector:"input.mask-input",event:"keyup",callback:function(e,t){var a=t.getValue();t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}])}},{selector:"input.port-input",event:"keyup",callback:function(e,t){var a=t.getValue();t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}])}},{selector:"input.mask-input",event:"focus",callback:function(e,t){t.showTip("mask")}},{selector:"input.port-input",event:"focus",callback:function(e,t){t.showTip("port")}},{selector:"input.mask-input",event:"blur",callback:function(e,t){t.hideTip("mask")}},{selector:"input.port-input",event:"blur",callback:function(e,t){t.hideTip("port")}},{selector:"div.widget-wrap-outer .widget-wrap",event:"blur",callback:function(e,t){var a;t.dom().triggerHandler("ev_view_change",[{"type":"value","value":t.getValue()}]),t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":t.getValue()}]),(a=t.settings.parentWidget)&&a.dom().triggerHandler("ev_item_ip_blur",[a,t]),t.dom().triggerHandler("ev_textbox_blur"),t.dom().removeClass("focus")}}],init:function(){},render:function(){var e=this.settings,t=(i.superclass.render.call(this),this.dom()),a=e.maskEnable?" ip-mask":e.portEnable?" ip-port":"",a=(t.addClass("ip-container"+a),"");a+='<span class="ip-input first"><input type="text" maxlength="3" data-index="0" /></span>',e.maskEnable?(a="",a=(a=(a+='<div class="mask-wrap u-d-inline-block"><span class="separator mask-separator u-d-inline-block">/</span><div class="mask-wrap-inner u-d-inline-block">')+'<input class="mask-input" type="text" maxlength="2" placeholder="'+e.placeholder+'" /></div><div class="mask-tip-wrap tip-wrap u-d-none"><span class="tip">')+(e.allowZeroMask?"(0-32)":"(1-32)")+"</span></div></div>",t.find(".text-wrap").after(a)):e.portEnable&&(a="",a=(a+='<div class="port-wrap u-d-inline-block"><span class="separator port-separator u-d-inline-block">:</span><div class="port-wrap-inner u-d-inline-block">')+'<input class="port-input" type="text" maxlength="5" placeholder="'+e.placeholder+'" /></div><div class="port-tip-wrap tip-wrap u-d-none"><span class="tip">(1-65535)</span></div></div>',t.find(".text-wrap").after(a)),t.find(".text-wrap-inner").attr("dir","ltr"),t.find(".text-wrap-inner").html('<span class="ip-input first"><input type="text" maxlength="3" data-index="0" /></span><span class="ip-dot">.</span><span class="ip-input"><input type="text" maxlength="3" data-index="1" tabindex="-1"/></span><span class="ip-dot">.</span><span class="ip-input"><input type="text" maxlength="3" data-index="2" tabindex="-1"/></span><span class="ip-dot">.</span><span class="ip-input last"><input type="text" maxlength="3" data-index="3" tabindex="-1"/></span>')},disable:function(){var e=this.dom();e.addClass("disabled"),e.find(".text-wrap-outer input").prop("disabled",!0),e.triggerHandler("ev_view_disable")},enable:function(){var e=this.dom();this.getContainer().removeClass("disabled"),e.find(".text-wrap-outer input").prop("disabled",!1),e.triggerHandler("ev_view_enable")},showTip:function(e){this.dom().find("."+e+"-wrap .tip-wrap").removeClass("u-d-none")},hideTip:function(e){this.dom().find("."+e+"-wrap .tip-wrap").addClass("u-d-none")},getValue:function(){var e=i.superclass.getValue.call(this);return""===e.join("")?"":(e=e.join("."),this.settings.maskEnable?e+="/"+this.dom().find("input.mask-input").val():this.settings.portEnable&&(e+=":"+this.dom().find("input.port-input").val()),e)},setValue:function(e){if(null==e)e="";else if("string"!==o.type(e))return;var t,a=this.settings,a=(a.maskEnable?(e=(t=e.split("/"))[0],this.dom().find("input.mask-input").val(t[1])):a.portEnable&&(e=(t=e.split(":"))[0],this.dom().find("input.port-input").val(t[1])),this.dom().find("span.ip-input input")),i=e.split(".");a.each(function(e,t){o(t).val(i[e])})},setMaxLength:function(){return!1}})})(jQuery),(n=>{var a=n.su.Widget.register("authCode",{extend:"textbox",listeners:[{selector:"span.code-input input",event:"keyup",callback:function(e,t){t.dom().triggerHandler("ev_view_change",[{type:"value",value:t.getValue()}]);var a=n(this);t.toNext(e,a)}},{selector:"span.code-input input",event:"keydown",callback:function(e,t){var a,i=n(this),s=parseInt(i.attr("data-index"),10);if(48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105||8==e.keyCode||39===e.keyCode||37===e.keyCode||e.ctrlKey&&86===e.keyCode)if(!0!==e.shiftKey||48<=e.keyCode&&e.keyCode<=57)if(39===e.keyCode)s<5&&(i.val()||0===i.val())&&t.dom().find("span.code-input input[data-index="+(s+1)+"]").focus().select(),e.preventDefault();else{if(37!==e.keyCode)return 8===e.keyCode?""===i.val()&&0<s?((a=t.dom().find("span.code-input input[data-index="+(s-1)+"]")).val(a.val().slice(0,-1)),a.focus(),void e.preventDefault()):void 0:void t.toNext(e,i);0<s&&((a=t.dom().find("span.code-input input[data-index="+(s-1)+"]")).focus(),e.preventDefault())}else e.preventDefault();else e.preventDefault()}},{selector:"span.code-input input",event:"paste",callback:function(e,t){e.preventDefault();var a=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData("Text"),i=parseInt(e.currentTarget.getAttribute("data-index"),10);if(/^[0-9]+$/.test(a)){for(let e=0;e<Math.min(6-i,a.length);e++)t.dom().find("span.code-input input[data-index="+(i+e)+"]").val(a[e]);t.dom().triggerHandler("ev_view_change",[{type:"value",value:t.getValue()}])}}}],render:function(){var e=this.dom(),t=(a.superclass.render.call(this),e.addClass("auth-container"),"");t+='<span class="code-input first"><input type="text" maxlength="1" data-index="0" /></span>',e.find(".text-wrap-inner").html('<span class="code-input first"><input type="text" maxlength="1" data-index="0" /></span><span class="code-separator"></span><span class="code-input"><input type="text" maxlength="1" data-index="1" tabindex="-1"/></span><span class="code-separator"></span><span class="code-input"><input type="text" maxlength="1" data-index="2" tabindex="-1"/></span><span class="code-separator"></span><span class="code-input"><input type="text" maxlength="1" data-index="3" tabindex="-1"/></span><span class="code-separator"></span><span class="code-input"><input type="text" maxlength="1" data-index="4" tabindex="-1"/></span><span class="code-separator"></span><span class="code-input last"><input type="text" maxlength="1" data-index="5" tabindex="-1"/></span>')},getValue:function(){var e=a.superclass.getValue.call(this);return""===e.join("")?"":e.join("")},setValue:function(e){if(null==e)e="";else if("string"!==n.type(e))return;var t=this.dom().find("span.code-input input"),a=e.split("");t.each(function(e,t){n(t).val(a[e])})},toNext:function(e,t){var a=parseInt(t.attr("data-index"),10);37===e.keyCode||39===e.keyCode||8===e.keyCode||e.ctrlKey||17===e.keyCode||a<5&&(48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105)&&this.dom().find("span.code-input input[data-index="+a+"]").val()&&(e=this.dom().find("span.code-input input[data-index="+(a+1)+"]"),t.blur(),e.focus())}})})(jQuery),$.su.Widget.register("keywords",{settings:{max:{attribute:"data-max",defaultValue:5},itemSep:{attribute:"item-sep",defaultValue:""},placeholder:{attribute:"placeholder"},addText:{attribute:"add-text",defaultValue:$.su.CHAR.OPERATION.ADD_NEW},type:{attribute:"type",defaultValue:"textbox"},textTips:{attribute:"text-tips",defaultValue:""}},listeners:[{selector:"div.keywords-add",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.addKeyword()}},{selector:"div.keywords-delete",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();e=$(this).attr("data-id");t.deleteKeyword(e)}},{selector:"div[widget=textbox] div.text-wrap input",event:"keyup",callback:function(e,t){t.valueChange()}},{selector:"div[widget=combination]",event:"keyup",callback:function(e,t){t.valueChange()}},{selector:"div[widget=ip]",event:"keyup",callback:function(e,t){t.valueChange()}},{selector:"span.ip-input input",event:"paste",callback:function(e,t){e.preventDefault();var e=(e.originalEvent.clipboardData||window.clipboardData).getData("text"),a=$.su.Vtype.types.ip.regex,i=t.getValue(),s=Object.keys(t.textboxs).indexOf(t.id);i.splice(s,1,e),a.test(e)&&t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}])}},{event:"ev_item_ip_blur ev_item_text_blur",callback:function(e,t,a){a=a.dom().parents(".textboxs-wrap").attr("data-id");t.validateId=a,t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":t.getValue()}])}},{event:"ev_item_text_focus",callback:function(e,t,a){a=a.dom().parents(".textboxs-wrap").attr("data-id");t.id=a,t.setNormal(a)}}],init:function(){var e=this.settings.itemSep.match(/\[([\S]+?)\]/g);if(this.items=[],e)for(var t=0,a=e.length;t<a;t++)this.items[t]=e[t].slice(1,-1);this.currentNum=1,this.textboxs={}},render:function(){var e,t,a=this.dom(),i=this.settings,s=(i.readOnly,a.addClass(i.cls+"keywords-container "+(!1===i.labelField?"label-empty":"")+" "+(i.readOnly?"readOnly":"")),"");if(null!==i.labelField&&(s=(s+='<div class="widget-fieldlabel-wrap '+i.labelCls+'">')+'<label class="widget-fieldlabel keywords-fieldlabel">'+i.labelField+"</label>",i.labelField&&(s+='<span class="widget-separator">'+i.separator+"</span>"),s+="</div>"),s=(s=(s=s+'<div class="widget-wrap-outer keywords-wrap-outer">'+'<div class="widget-wrap keywords-wrap hover-errortip">')+this.getItem(this.domId+"_textbox_default",!0))+"</div>"+('<div class="keywords-add"><span>'+i.addText+"</span></div>"),null!=i.tips&&null!=i.tips&&(s=(s+='<div class="widget-tips keywords-tips '+i.tipsCls+'">')+'<div class="content tips-content">'+i.tips+"</div></div>"),s+="</div>",i.tipText&&(s+='<div widget="toolTip"></div>'),a.empty().append(s),this.items&&0!==this.items.length){this.defaultTextbox=[];for(var n=0,l=this.items.length;n<=l;n++){var o=new $.su.widgets[i.type]({id:a.find("div[widget=textbox"+i.type+"]").eq(n),settings:{tips:i.textTips}});"combination"===i.type&&((e=new $.su.widgets.ip({id:a.find("div[widget=ip]")})).render(),(t=new $.su.widgets.textbox({id:a.find("div[widget=textbox]")})).render()),"ip"===i.type&&(e=new $.su.widgets.ip({id:a.find("div[widget=ip]")})).render(),o.render(),this.defaultTextbox.push(o)}}else this.defaultTextbox=new $.su.widgets[i.type]({id:a.find("div[widget="+i.type+"]"),settings:{tips:i.textTips}}),"combination"===i.type&&((e=new $.su.widgets.ip({id:a.find("div[widget=ip]"),settings:{parentWidget:this}})).render(),(t=new $.su.widgets.textbox({id:a.find("div[widget=textbox]"),settings:{parentWidget:this}})).render()),"ip"===i.type&&(e=new $.su.widgets.ip({id:a.find("div[widget=ip]"),settings:{parentWidget:this}})).render(),this.defaultTextbox.render();this.textboxs[this.domId+"_textbox_default"]={parentWidget:this.defaultTextbox,ipWidget:e,textboxWidget:t},i.placeholder&&a.find("input").attr("placeholder",i.placeholder)},getItem:function(e,t){var a=this.settings,i="";if(i+='<div class="textboxs-wrap" data-id="'+e+'">',this.items&&0!==this.items.length)for(var s=0,n=this.items.length;s<=n;s++)i+='<div widget="'+a.type+'" id="'+e+"_"+s+'" class="keyword-part-'+s+'" label-field="{false}" hint="'+(a.hint||"")+'" tips="'+a.textTips+'"></div>',s<n&&(i+=' <span class="separator">'+this.items[s]+"</span> ");else"combination"===a.type?i=i+'<div widget="combination" id="'+e+'" label-field="{false}" widget-separator="/" class="u-d-inline-block container widget-container combination-container total-2"><div widget="ip" name="" class="u-d-inline-block"></div><div widget="textbox" name="" class="u-d-inline-block text_s"></div></div>':"ip"===a.type?i+='<div widget="ip" label-field="{false}" id="'+e+'"></div>':i+='<div widget="textbox" id="'+e+'" label-field="{false}" hint="'+(a.hint||"")+'" tips="'+a.textTips+'" class="u-d-inline-block"></div>';return t||(i+='<div data-id="'+e+'" class="keywords-delete"><span>Delete</span></div>'),i+="</div>"},addKeyword:function(){var e,t,a,i=this.dom(),s=this.settings,n=i.find("div.keywords-wrap");if(!(this.currentNum>=s.max||this.isDisabled())){this.currentNum+=1;var l=$.su.randomId(this.domId+"_textbox"),o=this.getItem(l);if(n.append(o),this.items&&0!==this.items.length)for(var d=[],r=0,c=this.items.length;r<=c;r++)e=new $.su.widgets[s.type]({id:$("#"+l+"_"+r)}),"combination"===s.type&&((t=new $.su.widgets.ip({id:i.find("div[widget=ip]")})).render(),(a=new $.su.widgets.textbox({id:i.find("div[widget=textbox]")})).render()),"ip"===s.type&&(t=new $.su.widgets.ip({id:i.find("div[widget=ip]")})).render(),e.render(),d.push({parentWidget:e,ipWidget:t,textboxWidget:a});else e=new $.su.widgets[s.type]({id:$("#"+l),settings:{tips:s.textTips}}),"combination"===s.type&&((t=new $.su.widgets.ip({id:$("#"+l).find("div[widget=ip]"),settings:{parentWidget:this}})).render(),(a=new $.su.widgets.textbox({id:$("#"+l).find("div[widget=textbox]"),settings:{parentWidget:this}})).render()),"ip"===s.type&&(t=new $.su.widgets.ip({id:$("#"+l).find("div[widget=ip]"),settings:{parentWidget:this}})).render(),e.render(),d={parentWidget:e,ipWidget:t,textboxWidget:a};return this.textboxs[l]=d,s.placeholder&&i.find("input").attr("placeholder",s.placeholder),this.currentNum>=s.max?this.disableAddBtn():this.enableAddBtn(),d}},deleteKeyword:function(e){var t=this.dom().find("div.keywords-wrap div.textboxs-wrap[data-id="+e+"]"),a=this.settings;if(e!==this.domId+"_textbox_default"&&0<this.currentNum){if(0===this.items.length)""!==("ip"!==a.type&&this.textboxs[e].ipWidget||this.textboxs[e].parentWidget).getValue()&&0;else for(var i=0,s=this.textboxs[e].length;i<s;i++)""!==this.textboxs[e][i].getValue()&&0;--this.currentNum,t.remove(),delete this.textboxs[e],this.currentNum<this.settings.max?this.enableAddBtn():this.disableAddBtn(),this.valueChange()}},setValue:function(e){var t=this,a=this.dom(),i=this.settings;if(0===(e=$.isArray(e)?e:[e]).length)if(0===this.items.length)t.defaultTextbox.setValue("");else for(var s=0,n=t.defaultTextbox.length;s<n;s++)t.defaultTextbox[s].setValue("");for(var l,o=0,n=(e=e.length>this.settings.max?e.splice(0,this.settings.max):e).length,d=a.find("div.keywords-wrap div.textboxs-wrap"),r=d.length;o<n;o++)if(l=r<o+1?this.addKeyword():(p=$(d.get(o)).attr("data-id"),t.textboxs[p]),0===this.items.length)"combination"===i.type?(l.ipWidget.setValue(e[o]&&e[o].split("/")[0]),l.textboxWidget.setValue(e[o]&&e[o].split("/")[1])):l.parentWidget.setValue(e[o]);else for(var c=this.getVals(e[o]),u=0,h=l.length;u<h;u++)l[u].setValue(c[u]);for(var p,g=d.length-1;0<=g;g--)o<g+1&&(p=$(d[g]).attr("data-id"),t.deleteKeyword(p))},getValue:function(){var e,a=this,t=this.dom().find("div.keywords-wrap div.textboxs-wrap"),i=[],s="";return t.each(function(){var t="";a.items&&0!==a.items.length?(s=a.items.join(""),$(this).find("div[widget=textbox]").each(function(e){t+=$(this).data("viewObj").getValue(),a.items[e]&&(t+=a.items[e])})):(e=$(this).find("div[widget=ip]"),textWidget=$(this).find("div[widget=textbox]"),t=0<e.length&&0<textWidget.length?e.data("viewObj").getValue()+"/"+$(this).find("div[widget=textbox]").data("viewObj").getValue():(0<e.length?e:$(this).find("div[widget=textbox]")).data("viewObj").getValue()),(0===a.items.length&&""!==t||0!==a.items.length&&t!==s)&&i.push(t)}),i},getVals:function(e){if(0===this.items.length)return e;if(null===e)return[];for(var t=[],a=0,i=this.items.length;a<i;a++){var s=e.split(this.items[a]);t[a]=s[0],t[a+1]=s[1]}return t},setError:function(e){for(var t,a=this.dom(),i=this,s=a.find("div.textboxs-wrap"),n=(e="string"===$.type(e)?[e]:e).length,l=0;l<n;l++)if(t=$(s.get(l)).attr("data-id"),this.validateId){if(this.validateId===t)return o(e[l],t),void(this.validateId=null)}else o(e[l],t);function o(e,t){!0===e?i.textboxs[t].parentWidget.setNormal():i.textboxs[t].parentWidget.setError(e)}},setNormal:function(e){if(void 0===e)for(var t in this.textboxs)this.textboxs[t].parentWidget.setNormal();else this.textboxs[e].parentWidget.setNormal()},valueChange:function(){var e=this.getValue();this.dom().triggerHandler("ev_view_change",[{"type":"value","value":e}])},disable:function(e){var t=this.dom().find("div.keywords-wrap"),a=this.dom(),i=t.find("div.textboxs-wrap");if("string"!==$.type(e)){if("number"===$.type(e))e=[e];else if(void 0===e||!1===e){for(var s in this.dom().addClass("disabled"),this.textboxs)this.textboxs.hasOwnProperty(s)&&t.find("div.textboxs-wrap[data-id="+s+"]").addClass("disabled");return void a.triggerHandler("ev_view_disable")}for(var n=0,l=e.length;n<l;n++){var o=e[n];$(i.get(o)).addClass("disabled")}}},enable:function(e){var t=this.dom().find("div.keywords-wrap"),a=this.dom();if("string"!==$.type(e)){if("number"===$.type(e))e=[e];else if(void 0===e||!1===e){for(var i in this.dom().removeClass("disabled"),this.textboxs)this.textboxs.hasOwnProperty(i)&&t.find("div.textboxs-wrap[data-id="+i+"]").removeClass("disabled");return void a.triggerHandler("ev_view_enable")}for(var a=this.dom(),s=t.find("div.textboxs-wrap"),n=0,l=e.length;n<l;n++){var o=e[n];$(s.get(o)).removeClass("disabled")}}},refresh:function(){var e=this.getValue();this.setValue(e)},refreshBox:function(e){this.setValue(e)},enableAddBtn:function(){this.dom().find(".keywords-add").removeClass("disabled")},disableAddBtn:function(){this.dom().find(".keywords-add").addClass("disabled")}}),(o=>{var s=o.su.Widget.register("mac",{extend:"textbox",settings:{connector:{attribute:"connector",defaultValue:"-"},deviceKey:{attribute:"device-key",defaultValue:!1}},listeners:[{selector:"span.mac-input input",event:"keypress",callback:function(e,t){switch(e.charCode){case 64:case 33:case 35:case 36:case 37:case 94:case 38:case 42:case 40:case 41:e.preventDefault()}}},{selector:"span.mac-input input",event:"keyup",callback:function(e,t){var a=t.settings,i=(this.value=this.value.toUpperCase(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":t.getValue()}]),o(this)),s=parseInt(i.attr("data-index"),10);37===e.keyCode||39===e.keyCode||8===e.keyCode||86===e.keyCode||e.ctrlKey||17===e.keyCode||(a.deviceKey?/^[a-zA-Z0-9]{4}$/i.test(i.val())&&s<4&&t.dom().find("span.mac-input input[data-index="+(s+1)+"]").focus():/^[a-f0-9]{2}$/i.test(i.val())&&s<5&&t.dom().find("span.mac-input input[data-index="+(s+1)+"]").focus())}},{selector:"span.mac-input input",event:"keydown",callback:function(e,t){var a,i=o(this),s=t.settings,n=parseInt(i.attr("data-index"),10),l="-"===s.connector?189:186;if((!e.ctrlKey||86!==e.keyCode)&&9!==e.keyCode&&17!==e.keyCode){if(s.deviceKey){if(!(48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=122||65<=e.keyCode&&e.keyCode<=90||8==e.keyCode||e.keyCode===l||39===e.keyCode||37===e.keyCode))return void e.preventDefault()}else if(!(48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105||65<=e.keyCode&&e.keyCode<=70||8==e.keyCode||e.keyCode===l||39===e.keyCode||37===e.keyCode))return void e.preventDefault();e.keyCode===l||39===e.keyCode?(n<5&&t.dom().find("span.mac-input input[data-index="+(n+1)+"]").focus().select(),e.preventDefault()):37===e.keyCode?0<n&&((a=t.dom().find("span.mac-input input[data-index="+(n-1)+"]")).focus(),e.preventDefault()):8===e.keyCode&&""===i.val()&&0<n&&((a=t.dom().find("span.mac-input input[data-index="+(n-1)+"]")).val(a.val().slice(0,-1)),a.focus(),e.preventDefault())}}},{selector:"span.mac-input input",event:"paste",callback:function(e,t){e.preventDefault();var a=t.settings,e=(e.originalEvent.clipboardData||window.clipboardData).getData("text");(a.deviceKey?o.su.Vtype.types.deviceKey:o.su.Vtype.types.mac).regex.test(e)?(e=e.replace(/\-|\:/g,t.settings.connector),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":e.toUpperCase()}])):t.setError(a.deviceKey?o.su.CHAR.VTYPETEXT.DEVICE_KEY_PASTE_ERR:o.su.CHAR.VTYPETEXT.MAC_PASTE_ERR)}},{selector:"span.mac-input input",event:"blur",callback:function(e,t){this.value=this.value.toUpperCase()}},{selector:"div.widget-wrap-outer .widget-wrap",event:"blur",callback:function(e,t){t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":t.getValue()}]),t.dom().triggerHandler("ev_textbox_blur"),t.dom().removeClass("focus")}}],init:function(){},render:function(){var e="",t=this.dom(),a=this.settings.connector,i=this.settings.deviceKey;s.superclass.render.call(this),t.addClass("mac-container"),e=i?(e=(e=(e=(e+='<span class="mac-input device-key first"><input type="text" maxlength="4" data-index="0" /></span>')+'<span class="mac-dot">'+a+'</span><span class="mac-input device-key"><input type="text" maxlength="4" data-index="1" /></span>')+'<span class="mac-dot">'+a+'</span><span class="mac-input device-key"><input type="text" maxlength="4" data-index="2" /></span>')+'<span class="mac-dot">'+a+'</span><span class="mac-input device-key"><input type="text" maxlength="4" data-index="3" /></span>')+'<span class="mac-dot">'+a+'</span><span class="mac-input device-key last"><input type="text" maxlength="4" data-index="4" /></span>':(e=(e=(e=(e=(e+='<span class="mac-input first"><input type="text" maxlength="2" data-index="0" /></span>')+'<span class="mac-dot">'+a+'</span><span class="mac-input"><input type="text" maxlength="2" data-index="1" /></span>')+'<span class="mac-dot">'+a+'</span><span class="mac-input"><input type="text" maxlength="2" data-index="2" /></span>')+'<span class="mac-dot">'+a+'</span><span class="mac-input last"><input type="text" maxlength="2" data-index="3" /></span>')+'<span class="mac-dot">'+a+'</span><span class="mac-input last"><input type="text" maxlength="2" data-index="4" /></span>')+'<span class="mac-dot">'+a+'</span><span class="mac-input last"><input type="text" maxlength="2" data-index="5" /></span>',t.find(".text-wrap-inner").attr("dir","ltr"),t.find(".text-wrap-inner").html(e)},getValue:function(){var a,e=this.dom().find(".text-wrap-inner input");return 1<e.length&&(a=[],e.each(function(){var e=o(this),t=e.val();e.val(t),a.push(t)})),""===a.join("")?"":a.join(this.settings.connector)},setValue:function(e){if(null==e)e="";else if("string"!==o.type(e))return;var t=this.dom().find("span.mac-input input"),a=e.split(this.settings.connector);t.each(function(e,t){o(t).val(a[e])})},setMaxLength:function(){return!1}})})(jQuery),$.su.Widget.register("textarea",{settings:{readOnly:{attribute:"read-only",defaultValue:!1},datePicker:{attribute:"date-picker",defaultValue:""},tipText:{attribute:"tip-text",defaultValue:""},textareaCls:{attribute:"textarea-cls",defaultValue:""},placeholder:{attribute:"placeholder",defaultValue:""},editable:{attribute:"editable",defaultValue:!1}},listeners:[{selector:".text-wrap textarea",event:"keyup",callback:function(e,t){var a=$(this).val();t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}])}},{selector:".text-wrap textarea",event:"blur",callback:function(e,t){var a=$(this).val();t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":a}]),t.dom().triggerHandler("ev_textbox_blur"),t.dom().removeClass("focus")}},{selector:".contenteditable",event:"input",callback:function(e,t){t.dom().triggerHandler("ev_view_change",[{"type":"value","value":t.getValue()}])}},{selector:".contenteditable",event:"blur",callback:function(e,t){t.saveSelections()}},{selector:".contenteditable",event:"click",callback:function(e,t){e.stopPropagation(),t.isLinkSelected()&&(e=$(t.lastSelectAnchorNode),t.dom().triggerHandler("ev_textarea_link_click",[e]))}},{selector:".contenteditable",event:"paste",callback:function(e,t){e.preventDefault();e=e.originalEvent.clipboardData.getData("text/plain");document.execCommand("insertText",!1,e)}},{selector:"span.text-wrap",event:"mouseenter",callback:function(e,t){t.dom().addClass("hover")}},{selector:"span.text-wrap",event:"mouseleave",callback:function(e,t){t.dom().removeClass("hover")}},{selector:"span.text-wrap textarea",event:"click",callback:function(e,t){t.dom().addClass("focus")}}],init:function(){var a=this;this.settings.editable&&(this.MutationsObserver=new MutationObserver(function(e,t){a.dom().triggerHandler("ev_view_change",[{"type":"value","value":a.getValue()}])}))},render:function(){var e,t=this.dom(),a=this.settings,i=a.readOnly?'readonly="readonly"':"",s=a.cls+"text-container textarea-container "+(!1===a.labelField?"label-empty":"")+" "+(a.readOnly?"readOnly":""),i=(a.editable?(e='<div class="contenteditable '+a.textareaCls+'" contenteditable="true"></div>',s+=" editable"):e='<textarea type="text" class="'+a.textareaCls+'" '+(a.placeholder?'placeholder="'+a.placeholder+'" ':"")+i+"></textarea>",t.addClass(s),"");null!==a.labelField&&(i=(i+='<div class="widget-fieldlabel-wrap '+a.labelCls+'">')+'<label class="widget-fieldlabel text-fieldlabel">'+a.labelField+"</label>",a.labelField&&(i+='<span class="widget-separator">'+a.separator+"</span>"),i+="</div>"),i=(i+='<div class="widget-wrap-outer text-wrap-outer"><div class="widget-wrap hover-errortip"><span class="text-wrap-before"></span>')+'<span class="text-wrap">'+e+'</span><span class="text-wrap-after"></span>',a.hint&&(i=(i+='<span class="hint text-hint">')+'<input class="text-hint" value="'+a.hint+'" tabindex="-1" contenteditable="false" readonly="readonly"/></span>'),""!=a.datePicker&&(i+='<div widget="datepicker" id="'+this.domId+'_date_picker" class="datepicker-widget"></div>'),a.tips&&(i=(i+='<div class="widget-tips textbox-tips '+a.tipsCls+'">')+'<div class="content tips-content">'+a.tips+"</div></div>"),i=(i+="</div>")+'<div widget="errortip" error-cls="'+a.errorTipsCls+'"></div></div>',a.tipText&&(i+='<div widget="toolTip"></div>'),i+="</div>",t.empty().append(i),""!=a.datePicker&&(t.addClass("textbox-datepicker"),t.find("div[widget=datepicker]").datepicker({textbox:this})[0].render()),this.settings.editable&&(this.$contenteditable=this.dom().find(".contenteditable"),this.MutationsObserver.observe(this.$contenteditable[0],{childList:!0}))},setMaxLength:function(e){var t=this.dom();e=parseInt(e),"number"===$.type(e)&&t.find("textarea").attr("maxlength",e)},setReadonly:function(e){var t=this.dom(),a=t.find(".text-wrap-inner textarea");e?(a.prop("readonly",!0),t.addClass("readonly")):(a.prop("readonly",!1),t.removeClass("readonly"))},focus:function(){this.dom().find("textarea").focus()},disabled:function(){var e=this.dom();e.addClass("disabled"),e.find(".text-wrap-outer textarea").prop("disabled",!0)},setValue:function(e){var t;this.getValue()!==e&&(t=this.dom(),this.settings.editable?(this.$contenteditable.html(e),this.clearSelections()):t.find("textarea").val(e))},getValue:function(){var e=this.dom(),e=this.settings.editable?this.$contenteditable[0].innerText:e.find("textarea").val();return e},getHtml:function(){var e=this.$contenteditable[0].innerHTML,t="textarea-editable-temp",a=document.querySelector(t)||document.createElement("div");return a.id=t,a.className="u-d-none",a.innerHTML=e,document.body.appendChild(a),Array.prototype.forEach.call(a.querySelectorAll("a"),function(e){e.removeAttribute("href")}),a.innerHTML},scrollTextArea:function(){var e=this.dom().find("textarea"),t=e[0].scrollHeight;e.scrollTop(t)},saveSelections:function(){this.savedSel=window.getSelection(),this.savedRange=this.savedSel.getRangeAt(0)},clearSelections:function(){this.savedSel=null,this.savedRange=null},restoreSelection:function(){var e,t,a=window.getSelection();this.savedRange&&11!==this.savedRange.commonAncestorContainer.nodeType?e=this.savedRange:(e=document.createRange(),t=this.$contenteditable[0],e.selectNodeContents(t),e.collapse(!1),this.lastSelectAnchorNode=null),a.removeAllRanges(),a.addRange(e),this.saveSelections()},collapseSelection:function(){var e=this.savedSel||window.getSelection(),t=this.savedRange||window.getSelection().getRangeAt(0);(t=t.cloneRange()).collapse(!1),e.removeAllRanges(),e.addRange(t)},isLinkSelected:function(){var e;return(e=this.isSelectionContain()?$(this.lastSelectAnchorNode):e)&&e.is("a")},isSelectionContain:function(){var e=this._getSelectionStartNode(),t=this.$contenteditable[0];return isContain=!1,e&&t.contains(e)&&(e===t?this._textSelected&&(this.lastSelectAnchorNode=null):this.lastSelectAnchorNode=e,isContain=!0),isContain},selectNode:function(){this.savedRange.selectNode(this.lastSelectAnchorNode)},getLinkInfo:function(){var e=$(this.lastSelectAnchorNode);return e&&{text:e.text(),href:e.data("content")}},getLinkInfoCollection:function(){return this.$contenteditable.find("a").map(function(e,t){return{text:this.innerText,content:this.dataset.content}}).get()},createLink:function(e,t){this.restoreSelection(),e=this.newAnchorEle(e,t),this.savedRange.collapsed||this.savedRange.deleteContents(),this.savedRange.insertNode(e),this.collapseSelection()},newAnchorEle:function(e,t){e=document.createTextNode(e);return(link=document.createElement("a")).dataset.content=t,link.href="#",link.appendChild(e),link},unlink:function(){var e;this.selectNode(),e=document.createTextNode(this.savedRange.extractContents().textContent),this.savedRange.deleteContents(),this.savedRange.insertNode(e),this.lastSelectAnchorNode=null,this.collapseSelection()},_getSelectionStartNode:function(){var e,t,a=window.getSelection(),i=a.anchorNode;if(this._textSelected=!1,i)return t=a.getRangeAt(0),3===i.nodeType?(e=a.isCollapsed&&i.parentNode.textContent.length===a.focusOffset?(t.selectNode(i.parentNode),t.collapse(),this.$contenteditable[0]):i.parentNode,this._textSelected=!0):e=i,e}}),$.su.Widget.register("displaylabel",{settings:{readOnly:{attribute:"read-only",defaultValue:!1},tipText:{attribute:"tip-text",defaultValue:""},labelTipText:{attribute:"label-tip-text",defaultValue:""},titleAttr:{attribute:"title-attr",defaultValue:!1},escapeText:{attribute:"escape-text",defaultValue:!0},statusIcon:{attribute:"status-icon",defaultValue:!1},hideEmpty:{attribute:"hide-empty",defaultValue:!1},valueUnit:{attribute:"value-unit",defaultValue:!1},renderer:{attribute:"renderer",defaultValue:function(e){return null==e?"":e}},ellipsisLength:{attribute:"ellipsis-length",defaultValue:void 0}},listeners:[{selector:".text-wrap-display",event:"click",callback:function(e,t){t.dom().triggerHandler("ev_displaylabel_click")}}],init:function(){var e=this.settings;this.renderer=(e.configs||e).renderer},render:function(){var e=this.dom(),t=this.settings,a=!1===t.labelField?"label-empty":"",a=(e.addClass(t.cls+"displaylabel-container "+a),t.hideEmpty&&e.hide(),"");t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel text-fieldlabel">'+$.su.escapeHtml(t.labelField)+"</label>",t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),t.labelTipText&&(a+='<div widget="toolTip" class="label-tip"></div>'),a+="</div>"),a=(a=(a+='<div class="widget-wrap-outer text-wrap-outer"><div class="widget-wrap text-wrap"><span class="text-wrap-before"></span><span class="text-wrap-display"></span>')+'<span class="text-wrap-after"> '+(t.valueUnit||"")+"</span></div>")+'<div widget="errortip" error-cls="'+t.errorTipsCls+'"></div>',null!=t.tips&&null!=t.tips&&(a=(a+='<div class="widget-tips textbox-tips '+t.tipsCls+'">')+'<div class="content tips-content">'+t.tips+"</div></div>"),a+="</div>",t.tipText&&(a+='<div widget="toolTip"></div>'),e.append(a)},setValue:function(e){var t=this.dom(),a=this.settings;if(e=this.renderer(e),e=a.escapeText?$.su.escapeHtml(e):e,e=void 0!==a.ellipsisLength?$.su.ellipsisGridStr(e,a.ellipsisLength):e,a.hideEmpty){if(!e)return t.hide(),void t.find("span.text-wrap-display").html(e);t.show()}if(a.statusIcon&&null!=e)switch(t.addClass("icon"),e){case"OK":t.removeClass("error loading empty").addClass("correct");break;case"LOADING":t.removeClass("error correct empty").addClass("loading");break;case null:case void 0:case"":case"EMPTY":t.removeClass("error correct loading").addClass("empty");break;default:t.removeClass("correct loading empty").addClass("error")}t.find("span.text-wrap-display").html(e),a.titleAttr&&t.find("span.text-wrap-display").attr("title",e)},getValue:function(){return this.dom().find("span.text-wrap-display").text()}}),$.su.Widget.register("search",{settings:{labelField:{attribute:"label-field",defaultValue:""},tipText:{attribute:"tip-text",defaultValue:""},displayField:{attribute:"display-field",defaultValue:"name"},valueField:{attribute:"value-field",defaultValue:"value"},itemWidth:{attribute:"item-width",defaultValue:240},noneSelectedRemind:{attribute:"none-selected-remind",defaultValue:!1},noneSelectedText:{attribute:"none-selected-text",defaultValue:$.su.CHAR.COMMON.PLEASE_SELECT},searchList:{attribute:"search-list",defaultValue:!0},clear:{attribute:"clear",defaultValue:!1},maxLength:{attribute:"max-length",defaultValue:128},sortByName:{attribute:"sort-by-name",defaultValue:!1},showEditBtn:{attribute:"show-edit-btn",defaultValue:!1},showDeleteBtn:{attribute:"show-delete-btn",defaultValue:!1},useFrontSearch:{attribute:"use-front-search",defaultValue:!1},abbreviateLength:{attribute:"abbreviate-length",defaultValue:!1},toggleSearchReadonly:{attribute:"toggle-search-readonly",defaultValue:!0}},listeners:[{selector:"div.search-wrap",event:"click",callback:function(e,t){e.stopPropagation(),t.settings.searchList&&(t._handleToggle(),t.dom().triggerHandler("ev_search_wrap_click"))}},{selector:"div.search-wrap",event:"mouseenter",callback:function(e,t){t.dom().addClass("hover")}},{selector:"div.search-wrap",event:"mouseleave",callback:function(e,t){t.dom().removeClass("hover")}},{selector:".search-wrap-inner input",event:"click",callback:function(e){e.preventDefault()}},{selector:".search-wrap-inner input",event:"focus",callback:function(e,t){var a=t.dom();a.hasClass("disabled")||a.hasClass("none-items")||(t.setFocus(),a.addClass("focus"))}},{selector:".search-wrap-inner input",event:"blur",callback:function(e,t){t.dom().triggerHandler("ev_search_blur"),t.dom().removeClass("focus")}},{selector:".search-wrap-inner input",event:"keyup",callback:function(e,t){var a=t.getText();t.settings.useFrontSearch?t.filterOptions(a):$(this).attr("readonly")||13!==e.keyCode||(t.setClear(),t.dom().triggerHandler("ev_search_click",[a]),t.settings.searchList&&t.hideOptions())}},{selector:".search-switch",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.settings.useFrontSearch||$(this).hasClass("opt")||$(this).hasClass("clear")||(e=t.getText(),t.setClear(),t.dom().triggerHandler("ev_search_click",[e]),t.settings.searchList&&t.hideOptions())}},{selector:".search-switch.opt",event:"mouseenter",callback:function(e,t){$(this).addClass("clear")}},{selector:".search-switch.opt",event:"mouseleave",callback:function(e,t){$(this).removeClass("clear")}},{selector:".search-switch.clear",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.clearValue(),$(this).removeClass("clear opt"),t.dom().find(".search-text").removeAttr("readonly"),t.dom().triggerHandler("ev_search_clear")}},{selector:"label.search-label",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var a,e=$(this);e.closest("li.search-list").hasClass("disabled")||(a=t.dom(),e=e.find("input.search-checkbox"),e=t._dataMap[e.attr("data-index")],t.hideOptions(),a.addClass("selected"),a.removeClass("focus"),t.settings.useFrontSearch?t.dom().triggerHandler("ev_search_select",[e]):(t.dom().triggerHandler("ev_view_change",[{"type":"value","value":e},t.getValue(),t]),a.find(".search-switch").addClass("opt"),a.find(".search-text").attr("readonly",!0)))}},{selector:".supplement-btn",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();var e=$(this),a=e.closest("li.search-list").find(".search-label").find("input.search-checkbox"),a=t._dataMap[a.attr("data-index")],i=t._displayMap[a],e=e.attr("action-type");t.hideOptions(),t.dom().triggerHandler("ev_action_"+e,[{"value":a,"name":i}])}}],init:function(){this._dataMap={},this._displayMap={},this.toggleFlag=!1,this._value=""},render:function(){var e=this.dom(),t=this.settings,a=t.configs&&t.configs.noneSelectedText||t.noneSelectedText,i=t.showDeleteBtn||t.showEditBtn?"show-supplement-btn":"",i=(e.addClass(t.cls+"search-container "+(!1===t.labelField?" label-empty":"")+(t.tips?" tips":"")+i),"");e.empty(),null!==t.labelField&&(i=(i+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel combobox-fieldlabel">'+("false"===t.labelField?"":t.labelField)+"</label>",t.labelField&&(i+='<span class="widget-separator">'+t.separator+"</span>"),i+="</div>"),i=(i=(i+='<div class="widget-wrap-outer search-wrap-outer"><div class="widget-wrap search-wrap"><span class="text-wrap-before"></span>')+'<span class="search-wrap-inner"><input class="search-text '+t.inputCls+'" placeholder="'+(t.noneSelectedRemind?a:"")+'"></span>')+'</span><a class="search-switch" href="javascript:void(0);" tabindex="'+t.tabindex+'"><span class="icon"></span></a><span class="text-wrap-after"></span></div>',t.searchList&&(i+='<div class="hidden search-lists"><div class="search-list-wrap"><div class="search-list-content-wrap su-scroll">',t.useFrontSearch&&(i+='<div class="combobox-no-search-result-tip">'+$.su.CHAR.COMMON.NO_SEARCH_RESULT_FOUND+"</div>"),i+='<ul class="search-list"></ul></div></div></div>'),i=i+('<div widget="errortip" error-cls="'+t.errorTipsCls)+'"></div>',null!=t.tips&&null!=t.tips&&(i=(i+='<div class="widget-tips search-tips '+t.tipsCls+'">')+'<div class="content tips-content">'+t.tips+"</div></div>"),i+="</div>",t.tipText&&(i+='<div widget="toolTip"></div>'),e.append(i),e.find(".search-wrap-inner input").attr("maxlength",t.maxLength),t.items&&0<t.items.length&&this.loadItems(t.items)},loadItems:function(e){var t,a=this.dom(),i=this.settings,s=i.displayField,n=(this.hideOptions(),$.isArray(e)||(e=[]),i.items=e,this._displayMap={},this._dataMap={},"");i.sortByName&&e.sort(function(e,t){return e[s]<t[s]?-1:e[s]>t[s]?1:0});for(var l=0,o=e.length;l<o;l++)e[l]&&e[l].name&&(n+=this.initItemHtml(l,e[l]),e[l].selected)&&(t=e[l][i.valueField],this._defaultValue=t);a.find("div.search-lists .search-list").eq(0).html(n),this.setValue(t),0==e.length?a.addClass("none-items"):a.removeClass("none-items"),a.triggerHandler("ev_view_update")},initItemHtml:function(e,t){var a=this.settings,i=this.dom()[0].id+"-"+$.su.randomId("option"),s=t[a.displayField],n=t[a.valueField],l=!!t["disabled"],o=!!t.selected,t=t.cls||"";this._dataMap[e]=n,this._displayMap[n]=s,a.itemWidth&&(s=$.su.abbreviateStr(s,a.itemWidth-80,40).text);var d=(d=(d=(d="")+'<li class="search-list '+t+" "+(l?"disabled":"")+" "+(o?"selected":"")+'"><label for="'+i+'" class="search-label">')+'<input id="'+i+'" name="'+a.name+'" display="'+$.su.escapeHtml(s)+'" class="search-checkbox" type="checkbox" data-index="'+e+'" '+(o?' checked="checked"':"")+" "+(l?'disabled="disabled"':"")+' /><span class="icon"></span>')+'<span class="text" data-tip="'+(this._displayMap[n]!==s?$.su.escapeHtml(this._displayMap[n]):"")+'">'+$.su.escapeHtml(s)+"</span></label>";return a.showEditBtn&&(d+='<span class="edit supplement-btn" action-type="edit"></span>'),a.showDeleteBtn&&(d+='<span class="delete supplement-btn" action-type="delete"></span>'),d+="</li>"},setValue:function(e){if(null===e){if(null!=this._defaultValue)return void this.dom().triggerHandler("ev_view_change",[{"type":"record","value":this._defaultValue},"set-value"]);e=this._defaultValue}this._displayMap[e]&&(this._value=e,e=this._displayMap[e]||this.settings.noneSelectedText,this.setText(e),this.toggleFlag)&&this.setOptionsSelected()},getValue:function(){return this._value},clearValue:function(e){this._value="",this.dom().triggerHandler("ev_view_change",[{"type":"record","value":null},"set-value"]),this.setText(e),this.toggleFlag&&this.setOptionsSelected()},setClear:function(){var e=this,t=e.getText();e.settings.clear&&t&&(e.dom().find(".search-switch").addClass("clear"),e.settings.toggleSearchReadonly)&&e.dom().find(".search-text").attr("readonly",!0)},setText:function(e){this.dom().find("input.search-text").val(e)},getText:function(){return this.dom().find("input.search-text").val()},setOptionsSelected:function(){var e=this.dom(),i=this;e.find(".search-lists").find("input.search-checkbox").each(function(e,t){var a=$(t);i._dataMap[a.attr("data-index")]===i._value?(a.closest("li.search-list").addClass("selected"),t.checked=!0):(a.closest("li.search-list").removeClass("selected"),t.checked=!1)})},_handleToggle:function(){var e=this.dom();e.find(".search-lists");if(e.hasClass("disabled")||e.hasClass("none-items")||e.hasClass("readonly"))return!1;this.setFocus(),e.addClass("focus"),e.removeClass("error"),this.toggleFlag||this.showOptions()},showOptions:function(){var t=this,e=t.dom(),a=e.find(".widget-wrap.search-wrap"),i=e.find("div.search-lists"),s=parseInt(e.attr("option-offset"),10)||0,n=e.find(".search-wrap-outer"),e=(i.width(a.outerWidth()+"px"),i.removeClass("hidden"),i.css({"position":"absolute","left":s+"px","top":2+a.height()+"px","z-index":1e3}),t.toggleFlag=!0,t.setOptionsSelected(),i.find("li.selected")),s=$(i.find("li").get(0));0<e.length?(a=e.offset().top-s.offset().top,i.find("div.search-list-content-wrap").scrollTop(a)):i.find("div.search-list-content-wrap").scrollTop(0),$("html").on("mousedown.search",function(e){$(e.target||e.srcElement).closest(".search-wrap-outer").get(0)!==n.get(0)&&(t.hideOptions(),$("html").off("mousedown.search"))}),$("div.ps--active-y").off("scroll.search").on("scroll.search",function(e){$(e.target||e.srcElement).closest(".search-wrap-outer").get(0)!==n.get(0)&&(t.hideOptions(),$("div.ps--active-y").off("scroll.search"))})},hideOptions:function(){var e=this.dom(),t=e.find("div.search-lists");e.removeClass("focus"),this.toggleFlag&&(t.addClass("hidden"),t.off("click","label.combobox-label")),this.toggleFlag=!1,this.settings.useFrontSearch&&(this.setText(""),this.filterOptions(""))},filterOptions:$.su.debounce(function(e){this.settings;var i=this,t=this.dom(),s=(e=>(e=(e=e.replace(/[\*\.\?\+\$\^\[\]\(\)\{\}\|\\\/]/g,function(e){return"\\"+e})).replace(/\s/g,function(e){return"\\s"}),e=new RegExp(e,"gi")))(e),e=t.find(".search-lists").find("input.search-checkbox"),n=0;e.each(function(e,t){s.lastIndex=0;var t=$(t),a=i._dataMap[t.attr("data-index")],a=i._displayMap[a];s.test(a)?t.closest("li.search-list").removeClass("u-d-none"):(t.closest("li.search-list").removeClass("u-d-none").addClass("u-d-none"),n++)}),n===e.length?t.addClass("none-items"):t.removeClass("none-items")},200),toggleSearchPlaceHolder:function(e){var t=this;t.settings.noneSelectedRemind&&(e?t.dom().find(".search-text").attr("placeholder",t._displayMap[e]):t.dom().find(".search-text").attr("placeholder",t.settings.noneSelectedText))},startSearch:function(){this.dom().find(".search-wrap-inner input").click(),this.dom().find(".search-wrap-inner input").focus()}}),$.su.Widget.register("combobox",{settings:{name:{attribute:"name",defaultValue:""},labelField:{attribute:"label-field",defaultValue:""},preText:{attribute:"pre-text",defaultValue:""},multiSelect:{attribute:"multi-select",defaultValue:"single"},allowSelectAll:{attribute:"allow-select-all",defaultValue:!1},displayField:{attribute:"display-field",defaultValue:"name"},supplementField:{attribute:"supplement-field",defaultValue:"supplement"},autoWidth:{attribute:"auto-width",defaultValue:!0},valueField:{attribute:"value-field",defaultValue:"value"},openOnHover:{attribute:"open-on-hover",defaultValue:!1},openOnFocus:{attribute:"open-on-focus",defaultValue:!1},openAfterReload:{attribute:"open-after-reload",defaultValue:!1},addonPosition:{attribute:"addon-position",defaultValue:"last"},tipText:{attribute:"tip-text",defaultValue:""},editable:{attribute:"editable",defaultValue:!1},readOnly:{attribute:"read-only",defaultValue:!1},noneSelectedRemind:{attribute:"none-selected-remind",defaultValue:!1},noneSelectedText:{attribute:"none-selected-text",defaultValue:$.su.CHAR.COMMON.PLEASE_SELECT},noneItemTipText:{attribute:"none-item-tip-text",defaultValue:$.su.CHAR.COMMON.NO_ITEMS},adaptiveWidth:{attribute:"adaptive-width",defaultValue:!1},itemWidth:{attribute:"item-width",defaultValue:350},supplementWidth:{attribute:"supplement-width",defaultValue:100},iconWidth:{attribute:"icon-width",defaultValue:0},cascader:{attribute:"cascader",defaultValue:!1},cascaderConnector:{attribute:"cascader-connector",defaultValue:"/"},searchBox:{attribute:"search-box",defaultValue:!1},virtualLazyLoad:{attribute:"virtual-lazy-load",defaultValue:!1},searchBoxHint:{attribute:"search-box-hint",defaultValue:""},searchBoxCaseSensitive:{attribute:"search-box-case-sensitive",defaultValue:!1},searchBoxMaxLength:{attribute:"max-length",defaultValue:128},closerOptions:{attribute:"closer-options",defaultValue:!1},dimensions:{attribute:"dimensions",defaultValue:""},dimensionText:{attribute:"dimension-text",defaultValue:""},sortByName:{attribute:"sort-by-name",defaultValue:!1},showEditBtn:{attribute:"show-edit-btn",defaultValue:!1},showDeleteBtn:{attribute:"show-delete-btn",defaultValue:!1},showBottom:{attribute:"show-bottom",defaultValue:!1},labelFieldEscape:{attribute:"label-field-escape",defaultValue:!0},preventExpand:{attribute:"prevent-expand",defaultValue:!1},initLoadData:{attribute:"init-load-data",defaultValue:!1},listMaxHeight:{attribute:"list-max-height",defaultValue:288},ellipsisSubtractLength:{attribute:"ellipsis-subtract-length",defaultValue:10},optionZIndex:{attribute:"option-z-index",defaultValue:1e3},comboboxTextWidthFixed:{attribute:"combobox-text-width-fixed",defaultValue:!0},searchBoxInsideDropdown:{attribute:"search-box-inside-dropdown",defaultValue:!1},comboboxWrapMaxWidth:{attribute:"combobox-wrap-max-width",defaultValue:350},bottomSlotHideOnClick:{attribute:"bottom-slot-hide-on-click",defaultValue:!0},allowShowAllText:{attribute:"allow-show-all-text",defaultValue:!1},maxTagCount:{attribute:"max-tag-count",defaultValue:20},beforeLoadingExpand:{attribute:"before-loading-expand",defaultValue:!1},variableHeight:{attribute:"variable-height",defaultValue:!1},selfDefineRightColumn:{attribute:"self-define-right-column",defaultValue:!1},hijackOptionClickClass:{attribute:"hijack-option-click-class",defaultValue:""},useDimensionsKeys:{attribute:"use-dimensions-keys",defaultValue:!1},optionDisplayField:{attribute:"option-display-field",defaultValue:"name"},dropDownVisibleWhenReadOnly:{attribute:"drop-down-visible-when-read-only",defaultValue:!1},searchKeys:{attribute:"search-keys",defaultValue:""},dimensionColumnWidth:{attribute:"dimension-column-width",defaultValue:""},optionEllipsisGap:{attribute:"option-ellipsis-gap",defaultValue:0}},listeners:[{selector:".combobox-switch .icon",event:"click",callback:function(e,t){"single"===t.settings.multiSelect&&t.settings.editable&&(e.stopPropagation(),t.dom().triggerHandler("ev_combobox_icon_click"))}},{selector:".combobox-switch .icon.clear",event:"click",callback:function(e,t){e.stopPropagation(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":[]}]),$(this).removeClass("clear")}},{selector:".combobox-switch.arrow-up .icon",event:"click",callback:function(e,t){e.stopPropagation(),t.hideGlobalOptions()}},{selector:"div.combobox-wrap",event:"click",callback:function(e,t){e.stopPropagation();var e=t.getContainer(),a=t.settings.searchBox&&!t.isSearchBoxInsideDropdown()&&t.getSingleComboboxSearchText();t.settings.openAfterReload||e.hasClass("disabled")||e.hasClass("readonly")&&!t.settings.dropDownVisibleWhenReadOnly||a||(t.triggerToggle(),t.dom().find(".single-combobox-search-box").focus()),t.dom().triggerHandler("ev_combobox_wrap_click",[e.hasClass("disabled")])}},{selector:"div.combobox-wrap",event:"mouseenter",callback:function(e,t){var a=t.getContainer();t.dom().addClass("hover"),t.settings.openOnHover&&"shown"!==t.toggleFlag&&!a.hasClass("disabled")&&t.triggerToggle(),t.toggleClear(!0)}},{selector:"div.combobox-wrap",event:"mouseleave",callback:function(e,t){t.dom().removeClass("hover"),t.toggleClear()}},{selector:".single-combobox-search-box",event:"focus",callback:function(e,t){t.dom().find(".combobox-text").removeClass("single-search-focus").addClass("single-search-focus"),$("#global-tip").hide()}},{selector:".single-combobox-search-box",event:"blur",callback:function(e,t){t.dom().find(".combobox-text").removeClass("single-search-focus"),t.dom().find(".combobox-text").css("visibility","visible"),t.setSingleComboboxSearchText(null),t.filterOptions(null),t.searchKey=null}},{selector:".single-combobox-search-box",event:"input",callback:function(e,t){var a;t.toggleComboboxText(),"hidden"===t.toggleFlag?t.debounceTriggerToggle():t.isVirtualLazyLoad()?t.debounceLoadFirstPageData():(a=t.getSingleComboboxSearchText(),t.filterOptions(a)),t.dom().triggerHandler("ev_combobox_search_input")}},{selector:".combobox-text",event:"click",callback:function(e){e.preventDefault()}},{selector:".combobox-text",event:"focus",callback:function(e,t){var a=t.getContainer();a.hasClass("disabled")||a.hasClass("none-items")||(t.setFocus(),a.addClass("focus"))}},{selector:".combobox-text",event:"keyup",callback:function(e,t){var a,i=$("#global-combobox-options");i.attr("data-shown")===t.domId&&(a=i.find(".combobox-text").val(),t=i.find("input.combobox-checkbox"),i.find("li").removeClass("selected"),t.prop("checked",!1),t.each(function(e,t){if($(t).val()==a)return $(t).prop("checked",!0),$(t).closest("li.combobox-list").addClass("selected"),!1}))}},{selector:".combobox-text",event:"keyup",callback:function(e,t){t.settings.editable&&t.dom().find(".combobox-text").val()}},{selector:".combobox-text",event:"blur",callback:function(e,t){t.settings.editable&&0===t.dom().find(".combobox-text").val().length&&t.clearValue("")}},{selector:"span.multiple-item .close",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();e=t.getContainer();if(!e.hasClass("disabled")&&!e.hasClass("readonly")){for(var a=$(this).prev().attr("data-val"),e=t.getValue(),i=$.su.clone(e),s=0,n=i.length;s<n;s++)if(i[s]==a&&!t._isItemDisabled(a)){i.splice(s,1);break}t.setValue(i),t.calculatePosition(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i},e])}}}],init:function(){this._defaultValue=null,this._dataMap={},this._displayMap={},this._supplementMap={},this._value=[],this._addonEnable=!0,this._addonTopEnable=!0,this._addonBottomEnable=!0,this._cascaderMap=[],this._cascaderValue=[],this._selectAll=!1,this._disabledData=[],this._defaultPagingData={currentPage:1,currentPageSize:100},this.totalRows=0,this.searchKey=null,this.OPTION_NUM_IN_ONE_VIEW=8,this.optionHeight=36,this.dynamicOffset=0,this.dynamicHeight=0,this.isIntegrated=window.top!==window,this.EXCLUDE_COMBOBOX_LIST_HEIGHT=this.isIntegrated?364:420,this.MIN_OPTION_NUM=4,this.COMBOBOX_CONTAINER_PADDING=16,this.COMBOBOX_DISTANCE_BOTTOM=24,this.COMBOX_LIST_CONTENT_WRAP_MIN_HEIGHT=434},render:function(){for(var e=this.dom(),t=this.settings,a=!0===t.editable&&"single"===t.multiSelect?"":'readonly="true"',i=!1===t.labelField?" label-empty":"",s=t.readOnly?" readonly":"",n=t.tips?" tips":"",l=t.cascader?" cascader":"",i=(e.addClass(t.cls).addClass("widget-container").addClass("combobox-container "+t.multiSelect+i+s+n+l),""),o=(this.addonTop=$.su.transferedStr(e.find("[slot=top]").html()||""),this.addonBottom=$.su.transferedStr(e.find("[slot=bottom]").html()||""),this.selfDefineRightColumnSlot=$.su.transferedStr(e.find("[slot=column-right]").html()||""),this.selfDefineRightColumnTextSlot=$.su.transferedStr(e.find("[slot=column-right-label]").html()||""),this.addonTop||this.addonBottom||this.selfDefineRightColumnSlot||this.selfDefineRightColumnTextSlot||(this.addonBottom=$.su.transferedStr(e.html())),e.empty(),null!==t.labelField&&(i=(i+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel combobox-fieldlabel">'+("false"===t.labelField?"":t.labelFieldEscape?$.su.escapeHtml(t.labelField):t.labelField)+"</label>",t.labelField&&(i+='<span class="widget-separator">'+t.separator+"</span>"),i+="</div>"),i=(i=i+'<div class="widget-wrap-outer combobox-wrap-outer">'+'<div class="widget-wrap combobox-wrap">')+'<span class="text-wrap-before"></span>'+'<span class="combobox-wrap-inner">',t.searchBox&&!this.isSearchBoxInsideDropdown()?i=(i+='<input class="single-combobox-search-box '+t.inputCls+'" type="text" tabindex="-1" />')+'<span class="combobox-text '+t.inputCls+'">'+(t.noneSelectedRemind?t.noneSelectedText:"")+"</span>":i+=0===a.length?'<input class="combobox-text '+t.inputCls+'" type="text" tabindex="-1" '+a+' placeholder="'+(t.noneSelectedRemind?t.noneSelectedText:"")+'" />':'<span class="combobox-text '+t.inputCls+'"'+a+">"+(t.noneSelectedRemind?t.noneSelectedText:"")+"</span>",i=(i=i+"</span>"+('<a class="combobox-switch" tabindex="'+t.tabindex+'">'))+'<span class="icon"></span>'+"</a>",0===$("#global-combobox-options").children().length&&(s='<div class="combobox-list-wrap">',s=(s+='<div class="position-top-left"></div><div class="position-top-center"></div><div class="position-center-left"><div class="position-center-right"><div class="combobox-list-content-wrap-outer"><div class="combobox-list-content-wrap"><div class="combobox-empty-tip"></div>')+'<div class="combobox-no-search-result-tip">'+$.su.CHAR.COMMON.NO_SEARCH_RESULT_FOUND+'</div><div class="combobox-list-wrapper"><ul class="combobox-list">',this.isVirtualLazyLoad()&&(s+='<div class="combobox-list-container"></div><div class="combobox-list-phantom"></div>'),s+='</ul></div><ul class="combobox-list-2 u-d-none"></ul><ul class="combobox-list-3 u-d-none"></ul></div></div></div></div><div class="position-bottom-left"></div><div class="position-bottom-center"></div></div>',$("#global-combobox-options").append(s)),i+='<div class="hidden combobox-lists">',this.isVirtualLazyLoad()&&(i+='<div class="combobox-list-container"></div><div class="combobox-list-phantom"></div>'),i=(i=(i=(i=(i+="</div>")+'<div class="hidden combobox-lists"></div>'+'<div class="hidden combobox-lists"></div>')+'<div class="hidden top-slots"></div>'+'<div class="hidden bottom-slots"></div>')+'<span class="text-wrap-after"></span>'+"</div>")+('<div widget="errortip" error-cls="'+t.errorTipsCls+'">')+"</div>",null!=t.tips&&null!=t.tips&&(i=(i+='<div class="widget-tips combobox-tips '+t.tipsCls+'">')+'<div class="content tips-content">'+t.tips+"</div></div>"),i+="</div>",t.tipText&&(i+='<div widget="toolTip"></div>'),e.append(i),t.items&&0<t.items.length&&this.loadItems(t.items),$("#global-combobox-options .combobox-list-content-wrap ul")),d=0;d<o.length;d++)0===$(o[d]).find(".ps__rail-y").length&&$.su.scrollbar({ele:o[d],opts:{minScrollbarLength:25}});n=this;n.isVirtualLazyLoad()&&t.initLoadData&&n.initComboboxData(),t.searchBox&&!this.isSearchBoxInsideDropdown()&&(n.debounceLoadFirstPageData=$.su.debounce(n.loadFirstPageData,200),n.debounceTriggerToggle=$.su.debounce(n.triggerToggle,200),e.find(".single-combobox-search-box").attr("maxlength",t.searchBoxMaxLength))},setDropdownTop:function(e){this.customTopContent=e},loadItems:function(e,t){var a,i=this.dom(),s=this.settings,n=this.getContainer(),l=(this.isVirtualLazyLoad()?i.find("div.combobox-lists .combobox-list-container"):i.find("div.combobox-lists")).eq(0),o=(this.hideGlobalOptions(),$.isArray(e)||(e=[]),s.items=e,t&&(this.totalRows=t),this.isVirtualLazyLoad()&&(this.dynamicOffset=0,this.updateDynamicOffset(i),this.updateDynamicHeight(i),e=this.getVirtualList()),this._displayMap=this.isVirtualLazyLoad()?this._displayMap:{},this._dataMap={},this._supplementMap={},s.cascader&&(this._cascaderMap=this.getLevelOrder(e)),"");s.sortByName&&e.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0});for(var d=0,r=e.length;d<r;d++)e[d]&&e[d].name&&(o+=this.initItemHtml(d,e[d]),e[d].selected)&&(a=e[d][s.valueField],a=this.convertValue(a),this._defaultValue=a);this._addonEnable&&(i.find("div.top-slots").html(this.addonTop),i.find("div.bottom-slots").html(this.addonBottom)),l.html(o),this.setValue(a),0==e.length?n.addClass("none-items"):n.removeClass("none-items"),this.resetPagingData(),i.triggerHandler("ev_view_update")},createSubItem:function(e,t){for(var a="",i=0,s=(e=$.isArray(e)?e:[]).length;i<s;i++)e[i]&&(a+=this.initItemHtml(i,e[i],t));return a},initComboboxListHeader:function(){var e,t="multiple"===this.settings.multiSelect&&!!this.settings.allowSelectAll,a=this.settings.dimensionText.split("|"),i=this.settings.dimensionColumnWidth.split("|");return t?(e='<div class="combobox-multiple-select-all combobox-list combobox-list-header">',e=(e+='<label type="multiple" class="combobox-label multiple all">')+'<input class="combobox-checkbox" name="all" display="'+$.su.CHAR.OPERATION.SELECT_ALL+(this._selectAll?' checked="checked"':"")+'"/><span class="icon"></span>'):(e='<div class="combobox-list combobox-list-header">',e+='<label class="combobox-label combobox-list-header-label"><span class="icon" />'),this.settings.dimensions&&this.settings.dimensionText?(e+=a.map(function(e,t){return'<span class="column text'+(i[t]?'" style="width:'+i[t]+"px":"")+'">'+$.su.getAttrObject($.su.CHAR,e)+"</span>"}).join(""),this.settings.selfDefineRightColumn&&this.selfDefineRightColumnTextSlot&&(e+=this.selfDefineRightColumnTextSlot)):t&&(e+='<span class="text">'+$.su.CHAR.OPERATION.SELECT_ALL+"</span>"),e+="</label></div>",this.settings.items.length&&(e+='<div class="combobox-list-header-divider"></div>'),e},initItemHtml:function(e,a,t){var i,s,n=this,l=this.settings,o=this.dom(),d=l.multiSelect,o=o[0].id+"-"+$.su.randomId("option"),r=a[l.displayField],c=a[l.optionDisplayField],u=a[l.supplementField],h=a[l.valueField],p=!!a["disabled"],g=!!a.selected,m=a.cls||"",v=!!l.cascader&&!!a.children,b=a.tip,f="",x=[],w=[],y=((l.showEditBtn||l.showDeleteBtn)&&(m+="show-supplement-btn"),r=$.isArray(r)?r.map(function(e){return null==e?e:e.toString()}):r.toString(),c=l.optionDisplayField===l.displayField?r:$.isArray(c)?c.map(function(e){return null==e?e:e.toString()}):c.toString(),this._dataMap[e]=h,this._displayMap[h]=r,this._supplementMap[h]=u,l.dimensions&&(x=l.dimensions.split("|")),l.dimensionColumnWidth&&(w=l.dimensionColumnWidth.split("|")),l.selfDefineRightColumn&&this.selfDefineRightColumnSlot?1:0),y=(l.itemWidth&&(i=l.dimensions?l.useDimensionsKeys?(s=l.itemWidth/(x.length+y),x.map(function(e,t){return C(a[e]||"--",w[t]||s)})):(s=l.itemWidth/(c.length+y),c.map(function(e,t){return C(e,w[t]||s)})):C(c,"single"===l.multiSelect?l.itemWidth:l.itemWidth-50)),u=u&&$.su.abbreviateStr(u,l.supplementWidth-12).text,b?f=b:l.dimensions?f=l.useDimensionsKeys?x.map(function(e,t){return a[e]===i[t]?"":$.su.escapeHtml(a[e])}):i.map(function(e,t){return n._displayMap[h][t]===e?"":$.su.escapeHtml(n._displayMap[h][t])}):this._displayMap[h]!==i&&(f=$.su.escapeHtml(this._displayMap[h])),"");function C(e,t){return $.su.abbreviateStr(e,t-((+l.optionEllipsisGap||62)+(u?+l.supplementWidth:0)+ +l.iconWidth),40).text}return y=(y=(y=(y+='<li class="combobox-list '+m+" "+(p?"disabled":"")+" "+(g?"selected":"")+'">')+('<label for="'+o+'" cascader-index="'+function(e,t,a){{if(a=a||0,l.cascader){for(var i=0;i<t.length;i++)if(t[i].value===e&&t[i].level===a)return i;return-1}return $.inArray(h,this._cascaderMap)}}(h,this._cascaderMap,t)+'" type="'+d+'" class="combobox-label '+d+(v?" has-sub":"")+(a.cls?" "+a.cls:"")+'">'))+('<input id="'+o+'" name="'+l.name+'" display="'+$.su.escapeHtml(r)+'" class="combobox-checkbox" type="checkbox" data-index="'+e+'" '+(g?' checked="checked"':"")+" "+(p?'disabled="disabled"':"")+" />"))+('<span class="icon"'+(a.tipText&&"single"===l.multiSelect?'data-tip="'+a.tipText+'"':"")+"></span>"),l.dimensions?(y+=i.map(function(e,t){return'<span class="text'+(w[t]?'" style="width:'+w[t]+"px":"")+'" data-tip="'+f[t]+'">'+$.su.escapeHtml(e)+"</span>"}).join(""),l.selfDefineRightColumn&&this.selfDefineRightColumnSlot&&(y+=this.selfDefineRightColumnSlot.replace("{value}",h))):y+='<span class="text" data-tip="'+f+'">'+$.su.escapeHtml(i)+"</span>",u&&(y+='<span class="supplement" data-tip="'+(this._supplementMap[h]!==u?$.su.escapeHtml(this._supplementMap[h]):"")+'">'+$.su.escapeHtml(u)+"</span>"),a.labelDom&&(y+=a.labelDom),v&&(y+='<span class="has-sub-icon"></span>'),y+="</label>",l.showEditBtn&&(y+='<span class="edit supplement-btn" action-type="edit"></span>'),l.showDeleteBtn&&(y+='<span class="delete supplement-btn" action-type="delete"></span>'),y+="</li>"},getLiIndex:function(e){for(var t in this._dataMap)if(this._dataMap.hasOwnProperty(t)&&e===this._dataMap[t])return t;return!1},clearValue:function(e){this._value=[],this.dom().triggerHandler("ev_view_change",[{"type":"record","value":null},"set-value"]);e=void 0===e?this.settings.noneSelectedText:e;this.setText(e),$("#global-combobox-options").attr("data-shown")===this.domId&&this.setOptionsSelected()},setValue:function(e){var t,a=$("#global-combobox-options"),i=this.dom(),s=this,n=this.settings;if(null==e||""===e||$.isArray(e)&&0===e.length){if(null!=this._defaultValue)return void this.dom().triggerHandler("ev_view_change",[{"type":"record","value":this._defaultValue},"set-value"]);e=this._defaultValue}if(e=this.convertValue(e),this._displayMap[e]||n.editable||"single"!==n.multiSelect||n.cascader||(e=this.convertValue(null)),this._value=$.su.clone(e),n.cascader){this._cascaderValue=$.su.clone(e)||[];var l,o,d=n.noneSelectedText;if(e&&e.length&&0!==e.length){for(var r=[],c=0;c<e.length;c++)this.getNode(e[c],c+1)&&r.push(this.getNode(e[c],c+1).name);d=r.join(" "+n.cascaderConnector+" "),i.find(".combobox-text").removeClass("no-selected")}else i.find(".combobox-text").removeClass("no-selected").addClass("no-selected"),a.find("ul.combobox-list-2").empty(),a.find("ul.combobox-list-3").empty();this.setText(d),e&&null!=e[1]&&(l=s.getChildren(e[0],1)||{},o=s.createSubItem(l.children,1),a.find("ul.combobox-list-2").html(o),s.dom().find("div.combobox-lists").eq(1).html(o)),e&&null!=e[2]&&(l=s.getChildren(e[1],2),o=s.createSubItem(l.children,2),a.find("ul.combobox-list-3").html(o),s.dom().find("div.combobox-lists").eq(2).html(o))}else if("multiple"===n.multiSelect){for(var u=[],h=[],p=0;p<e.length;p++)(t=this._displayMap[e[p]])&&(h.push({value:e[p],text:t}),u.push(t));this._selectAll=!!this.settings.items&&(this.isVirtualLazyLoad()?e.length>=this.settings.configs.allIds.length&&0!==e.length:this.settings.items.length===u.length)||1===e.length&&"ALL"===e[0],u=0<u.length?u.join(","):n.noneSelectedText,this.setText(u,h)}else"single"===n.multiSelect&&(this.isVirtualLazyLoad()&&!this._displayMap[e]&&s.settings.configs&&this.settings.configs.setCurrentText?this.settings.configs.setCurrentText():(i=n.editable?"":n.noneSelectedText,u=this._displayMap[e]||i,this.setText(u)));a.attr("data-shown")===this.domId&&this.setOptionsSelected(),this.adaptWidth()},setOptionsSelected:function(){this.dom();for(var s,n=this,e=this.settings,t=$("#global-combobox-options"),a=t.find("input.combobox-checkbox"),l=$.isArray(this._value)?$.su.clone(this._value):[this._value],i=l.length-1;0<=i;i--)void 0===n._displayMap[l[i]]&&l.splice(i,1);e.cascader?t.find("label.combobox-label").each(function(e,t){var t=$(t),a=!!n._cascaderMap[t.attr("cascader-index")]&&n._cascaderMap[t.attr("cascader-index")].value,i=!!n._cascaderMap[t.attr("cascader-index")]&&n._cascaderMap[t.attr("cascader-index")].level;l[i]===a?t.closest("li.combobox-list").removeClass("selected").addClass("selected"):t.closest("li.combobox-list").removeClass("selected")}):"multiple"===e.multiSelect?(s=(()=>{for(var e={},t=0;t<l.length;t++)e[l[t]]=!0;return e})(),a.each(function(e,t){var a,i=$(t);"all"===i.attr("name")?(t.checked=n._selectAll,n._selectAll?i.closest("div.combobox-list").removeClass("imperfect").addClass("selected"):0===l.length?i.closest("div.combobox-list").removeClass("selected").removeClass("imperfect"):i.closest("div.combobox-list").removeClass("selected").addClass("imperfect")):(a=i.attr("data-index"),n._dataMap[a]in s||n._selectAll?(i.closest("li.combobox-list").addClass("selected"),t.checked=!0):(i.closest("li.combobox-list").removeClass("selected"),t.checked=!1))})):"single"===e.multiSelect&&(l=l[0],a.each(function(e,t){var a=$(t),i=a.attr("data-index");n._dataMap[i]===l?(a.closest("li.combobox-list").addClass("selected"),t.checked=!0):(a.closest("li.combobox-list").removeClass("selected"),t.checked=!1)}))},convertValue:function(e){var t=this.settings;return e="array"===$.type(e)||"multiple"!==t.multiSelect&&!t.cascader?e:null==e?[]:[e]},isSearchBoxInsideDropdown:function(){var e=this.settings;return"multiple"===e.multiSelect||e.searchBoxInsideDropdown},setText:function(e,t){var a=this.settings,i=(a.sortByName&&t.sort(function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}),e===a.noneSelectedText?this.dom().removeClass("none-selected").addClass("none-selected"):this.dom().removeClass("none-selected"),a.preText&&(e=a.preText+e),t="multiple"===a.multiSelect?a.allowSelectAll&&this._selectAll&&a.allowShowAllText?$.su.CHAR.MAIN.ALL:0===t.length?e:this.convertText(t):$.su.escapeHtml(e),this.getContainer()),s=i.find(".combobox-text");this._text=e,s.is("input")?s.val(t):"single"===a.multiSelect?(e=a.comboboxTextWidthFixed?0<i.find(".combobox-text").width()?i.find(".combobox-text").width():a.itemWidth-48:a.comboboxWrapMaxWidth-48,i=$.su.ellipsisGridStr($.su.decodeHtml(t),e-a.ellipsisSubtractLength),s.html(i)):s.html(t)},refreshText:function(){this.setValue(this.getValue())},convertText:function(e){for(var t=this.getContainer().find(".combobox-text").width()?this.getContainer().find(".combobox-text").width()-44:256,a='<span class="multiple-items-container u-d-inline-block">',i=(e="array"===$.type(e)?e:[e],this.settings.maxTagCount),s=0,n=e.length>i?i:e.length;s<n;s++)var l=e[s].text,l=(a=(a+='<span class="multiple-item">')+('<span class="text" data-val="'+$.su.escapeHtml(e[s].value)+'">'),this.settings.dimensions&&(l=$.isArray(l)?l[0]:l),$.su.ellipsisGridStr(l,t-26)),a=(a=a+l+"</span>")+'<span class="close icon"></span>'+"</span>";return i<e.length&&(i="+ "+(e.length-i)+" ...",a=(a+='<span class="multiple-item over-item">')+$.su.ellipsisGridStr(i,t-26)+"</span>"),a+="</span>"},getText:function(){return this._text},updateText:function(){var e=this.getValue();if("multiple"===this.settings.multiSelect){result=[];for(var t=[],a=0;a<e.length;a++)(display=this._displayMap[e[a]])&&t.push({value:e[a],text:display}),display&&result.push(display);result=0<result.length?result.join(","):this.settings.noneSelectedText,this.setText(result,t)}else{var i=this._displayMap[e];this.setText(i)}},setReadOnly:function(e){this.settings.readOnly=e;var t=this.getContainer();e?t.addClass("readonly"):t.removeClass("readonly")},enable:function(){var e=this.getContainer();e.removeClass("disabled"),e.find(".combobox-text").removeClass("disabled"),e.find("input.combobox-checkbox").prop("disabled",!1),e.find("input.single-combobox-search-box").prop("disabled",!1),e.triggerHandler("ev_view_enable")},disable:function(){var e=this.getContainer();e.addClass("disabled"),e.find(".combobox-text").addClass("disabled"),e.find("input.combobox-checkbox").prop("disabled",!0),e.find("input.single-combobox-search-box").prop("disabled",!0),e.triggerHandler("ev_view_disable")},enableItems:function(e){this.toggleItems(e,!0)},disableItems:function(e){this.toggleItems(e,!1)},toggleAddon:function(e,t){t?"top"===t?this._addonTopEnable=e:"bottom"===t&&(this._addonBottomEnable=e):this._addonEnable=e,this.loadItems(this.settings.items)},getAddon:function(e){return"top"===e?this.addonTop:this.addonBottom},setAddon:function(e){this.addonBottom=e,this.toggleAddon(this._addonEnable)},setAddonTop:function(e){this.addonTop=e,this.toggleAddon(this._addonEnable)},toggleItems:function(e,t){if(void 0===e)return this.disable();for(var a,i,s,n=this.dom(),l=$("#global-combobox-options"),o=n.find("div.combobox-lists"),d=0,r=(e=$.isArray(e)?e:[e]).length;d<r;d++)i=this.getLiIndex(e[d]),s=this._disabledData.indexOf(e[d]),!1!==i&&(a=(i=o.find("input.combobox-checkbox[data-index="+i+"]")).closest("li"),t?(a.removeClass("disabled"),i.removeAttr("disabled"),0<=s&&this._disabledData.splice(s,1)):(a.addClass("disabled"),i.attr("disabled","disabled"),s<0&&this._disabledData.push(e[d])));l.attr("data-shown")===this.domId&&(n=o.eq(0).html(),l.find("ul.combobox-list").html(n),this._addonEnable&&(l.find("ul.top-slot").html(this.addonTop),l.find("ul.bottom-slot").html(this.addonBottom)),this.setOptionsSelected())},getValue:function(){var e=this.dom(),t=this.settings,e=(e.find("input.combobox-checkbox"),$.isArray(this._value)?$.su.clone(this._value):[this._value]);return e="single"!==t.multiSelect||t.cascader?e:0<e.length?e[0]:t.noneSelectedText},_handleToggle:function(){var s=this,e=s.dom(),t=e.find("a.combobox-switch"),t=(e.find(".widget-wrap.combobox-wrap"),t.next("div.combobox-list-wrap"),s.getContainer()),n=$("#global-combobox-options"),a=n.attr("data-shown")===s.domId?"shown":"hidden";if(t.hasClass("disabled")||t.hasClass("readonly")&&!s.settings.dropDownVisibleWhenReadOnly)return!1;t.hasClass("none-items")?n.removeClass("none-items").addClass("none-items"):n.removeClass("none-items"),s.setFocus(),t.addClass("focus"),t.removeClass("error"),"hidden"!=a||s.settings.preventExpand?s.hideGlobalOptions():(n.css({width:""}),"single"==s.settings.multiSelect?n.addClass("single").removeClass("multiple"):n.removeClass("single").addClass("multiple"),s.settings.dimensions?n.addClass("dimension"):n.removeClass("dimension"),s.settings.cascader?n.removeClass("cascader").addClass("cascader"):n.addClass("cascader").removeClass("cascader"),s.isVariableHeight()||n.find(".combobox-list-content-wrap ul").css("max-height",s.settings.listMaxHeight+"px"),"single"===s.settings.multiSelect?e.off("focusout","div.combobox-wrap-outer").on("focusout","div.combobox-wrap-outer",function(e){var t=n.offset(),a=n.find(".combobox-list-wrap").width(),i=n.find(".combobox-list-wrap").height();(s._xx<t.left||s._xx>t.left+a||s._yy<t.top||s._yy>t.top+i)&&s.hideGlobalOptions()}):$("html").on("click","div:not(.combobox-list-wrap)",function(e){var t=n.find(".combobox-search-box")[0];t&&!$.contains(t,e.target)&&s.hideGlobalOptions()}),s._bindGlobalEvent(),s.showGlobalOptions())},_bindGlobalEvent:function(){var g=this,m=$("#global-combobox-options");m.off("click","label.combobox-label").on("click","label.combobox-label",function(e){e.stopPropagation(),e.preventDefault();var t=$(this);if(!g.settings.dimensionText||g.settings.allowSelectAll||"multiple"===g.settings.multiSelect||!t.hasClass("combobox-list-header-label")){var a=t.closest("li.combobox-list"),i=g.getContainer(),s=t.find("input.combobox-checkbox"),n=g._dataMap[s.attr("data-index")];if(g.settings.hijackOptionClickClass&&$(e.target).hasClass(g.settings.hijackOptionClickClass))g.dom().triggerHandler("ev_option_click",[n,$(e.target)]);else{var l,o=g.getValue(),d=[];if(!a.hasClass("disabled")&&!i.hasClass("readonly")){if(g.settings.cascader){var e=$(this).closest("ul").hasClass("combobox-list")?0:$(this).closest("ul").hasClass("combobox-list-2")?1:2,r=!!g._cascaderMap[$(this).attr("cascader-index")]&&g._cascaderMap[$(this).attr("cascader-index")].value,c=g.getChildren(r,++e),e=g.createSubItem(c.children,e);for(g._cascaderValue[c.depth-1]=r;g._cascaderValue.length>c.depth;)g._cascaderValue.pop();$(this).closest("ul").find("li.combobox-list").removeClass("selected"),a.addClass("selected"),$(this).hasClass("has-sub")?1===c.depth?(m.find("ul.combobox-list-2").empty().html(e),g.dom().find("div.combobox-lists").eq(1).html(e),m.find("ul.combobox-list-3").empty()):(m.find("ul.combobox-list-3").empty().html(e),g.dom().find("div.combobox-lists").eq(2).html(e)):(1===c.depth?(m.find("ul.combobox-list-2").empty(),m.find("ul.combobox-list-3").empty()):2===c.depth&&m.find("ul.combobox-list-3").empty(),g.dom().triggerHandler("ev_view_change",[{"type":"value","value":g._cascaderValue}]),g.hideGlobalOptions()),g.adaptWidth(),g.calculatePosition()}else{switch(g.settings.multiSelect){case"multiple":var u=s.prop("checked");if(t.hasClass("all"))if(u)for(var h=0;h<g.settings.items.length;h++)l=g.settings.items[h].value,g._isItemDisabled(l)&&0<=o.indexOf(l)&&d.push(l);else{if(g.isVirtualLazyLoad())d=g.settings.configs.allIds;else for(h=0;h<g.settings.items.length;h++)l=g.settings.items[h].value,g._isItemDisabled(l)&&o.indexOf(l)<0||d.push(l);setTimeout(function(){s.prop("checked",!0)},0)}else{if(u){if(0<o.length)for(var p=o.length-1;0<=p;p--)if(o[p]==n){o.splice(p,1);break}}else o.push(n);d=o}break;case"single":d=n,g.hideGlobalOptions(),i.addClass("selected"),i.removeClass("focus")}g.dom().triggerHandler("ev_view_change",[{"type":"value","value":d},g.getValue(),g]),g.calculatePosition(),g.adaptWidth()}g.toggleClear(!0)}}}}),m.off("click",".supplement-btn").on("click",".supplement-btn",function(e){e.stopPropagation(),e.preventDefault();var e=$(this),t=e.closest("li.combobox-list").find(".combobox-label").find("input.combobox-checkbox"),t=g._dataMap[t.attr("data-index")],a=g._displayMap[t],e=e.attr("action-type");g.hideGlobalOptions(),g.dom().triggerHandler("ev_action_"+e,[{"value":t,"name":a}])}),m.off("mouseenter").on("mouseenter",()=>{g.toggleClear(!0)}),m.off("mouseleave").on("mouseleave",()=>{g.toggleClear()})},isSelectAll:function(){return this._selectAll},selectAll:function(){for(var e=this,t=[],a=0;a<e.settings.items.length;a++)t.push(e.settings.items[a].value);e.dom().triggerHandler("ev_view_change",[{"type":"value","value":t},e.getValue(),e])},showGlobalOptions:function(){var n=this,l=this.settings,e=n.dom(),t=e.find(".widget-wrap.combobox-wrap"),o=$("#global-combobox-options"),a=(t.offset(),$("body").offset(),e.find("div.combobox-lists").eq(0).html()),i=o.find("div.combobox-list-wrap"),s=o.find("div.combobox-list-content-wrap"),d=l.noneItemTipText,r=o.find("ul.combobox-list");(l.showEditBtn||l.showDeleteBtn)&&o.addClass("show-supplement-btn"),s.find(".combobox-empty-tip").html(d);e.find("a.combobox-switch").addClass("arrow-up"),r.html(a),l.dimensions&&(d=l.selfDefineRightColumn&&this.selfDefineRightColumnSlot?1:0,o.find(".combobox-list-content-wrap").removeClass("column-2").removeClass("column-3").removeClass("column-1"),r=l.dimensions.split("|").length+d,o.find(".combobox-list-content-wrap").addClass("column-"+r)),$(o).find("div.combobox-list-header").remove(),$(o).find(".combobox-list-header-divider").remove(),(this._addonEnable&&"multiple"===l.multiSelect&&l.allowSelectAll||l.dimensionText)&&(a=n.initComboboxListHeader())&&$(o).find("div.combobox-list-content-wrap ul.combobox-list").before(a),s.find("div.combobox-list-editor-wrap").remove(),s.find(".combobox-empty-tip").before('<div class="combobox-list-editor-wrap top u-d-none"><ul class="top-slot"></ul></div>'),s.append('<div class="combobox-list-editor-wrap bottom u-d-none"><ul class="bottom-slot"></ul></div>'),this._addonEnable&&(this.addonTop&&this._addonTopEnable&&o.find(".combobox-list-editor-wrap.top").removeClass("u-d-none"),this.addonBottom&&this._addonBottomEnable&&o.find(".combobox-list-editor-wrap.bottom").removeClass("u-d-none"),o.find("ul.top-slot").html(this.addonTop),o.find("ul.bottom-slot").html(this.addonBottom)),n.settings.cascader?(d=n.getValue(),o.find("ul.combobox-list-2").empty(),o.find("ul.combobox-list-3").empty(),d&&0!==d.length&&(null!=d[1]&&o.find("ul.combobox-list-2").html(e.find("div.combobox-lists").eq(1).html()),null!=d[2])&&o.find("ul.combobox-list-3").html(e.find("div.combobox-lists").eq(2).html())):i.width(n.settings.autoWidth?t.outerWidth()+"px":n.settings.itemWidth+"px"),i.removeClass().addClass("combobox-list-wrap "+this.settings.cls),l.searchBox&&n.isSearchBoxInsideDropdown()?($(o).find("div[widget=textbox].combobox-search-box").remove(),$(o).find("div.combobox-search-box-icon").remove(),$(o).find("div.combobox-search-container").remove(),r='<div class="combobox-search-container"><div widget="textbox" hint="'+l.searchBoxHint+'" class="combobox-search-box" ></div>',r+='<div class="combobox-search-box-icon"></div></div>',$(o).find("div.combobox-list-content-wrap").prepend(r),new $.su.widgets.textbox({id:$(o).find("div[widget=textbox].combobox-search-box")}).render(),$(o).find("div[widget=textbox].combobox-search-box").off("ev_view_change").on("ev_view_change",function(e,t){n.isVirtualLazyLoad()||n.filterOptions(t.value)}),n.isVirtualLazyLoad()&&$(o).find("div.combobox-search-box-icon").off("click").on("click",function(){n.loadFirstPageData()}),$(o).find("div[widget=textbox].combobox-search-box .widget-wrap-outer").off("keyup").on("keyup",function(e){108!==e.keyCode&&13!==e.keyCode||(e.stopPropagation(),n.isVirtualLazyLoad()&&n.loadFirstPageData())}),n.filterOptions(null),this.searchKey=null,$(o).find("div[widget=textbox].combobox-search-box").find(".text-wrap-inner input").attr("maxlength",l.searchBoxMaxLength)):($(o).find("div[widget=textbox].combobox-search-box").off("ev_view_change"),$(o).find("div[widget=textbox].combobox-search-box").remove(),$(o).find("div.combobox-search-box-icon").remove(),$(o).find("div.combobox-search-container").remove()),s.find("div.combobox-custom-top-wrap").remove(),n.customTopContent&&(a='<div class="combobox-custom-top-wrap">'+n.customTopContent+"</div>",$(o).find("div.combobox-list-content-wrap").prepend(a)),n.updateComboboxListVariableHeight(),this.adaptWidth(),i.show(),o.attr("data-shown",n.domId),e.triggerHandler("ev_combobox_show"),n.toggleFlag="shown",n.calculatePosition(),o.removeClass("none-search-result"),$(o).find("ul.combobox-list").off("scroll").on("scroll",function(e){var t,a,i,s;l.virtualLazyLoad&&l.configs&&l.configs.lazyLoadData&&($(o).find(".combobox-list-wrapper.init .loading-container").length||(e.stopPropagation(),e.preventDefault(),t=e.target,(a=$(t).data("ps")).update(),e=5*n.optionHeight,i=a.containerHeight,s=t.scrollTop,a.contentHeight<=i+s+e&&n.lazyLoadData(function(){n.updateDynamicHeight($(o)),n.loadVirtualList(),a.update(),s=t.scrollTop}),n.getItems().length>2*n.OPTION_NUM_IN_ONE_VIEW&&(n.dynamicOffset=s),n.updateDynamicOffset($(o)),n.updateDynamicHeight($(o)),n.loadVirtualList()))}),n.isVariableHeight()&&(n.updatePersistentHeight(),$(window).off("resize.combobox").on("resize.combobox",$.su.debounce(function(e){var t=n.getItems()||[];n.updateOptionNum(t),n.updateComboboxListVariableHeight(),n.updateDynamicOffset($(o)),n.updateDynamicHeight($(o)),n.loadVirtualList()},200))),n.setOptionsSelected();for(var c=o.find("div.combobox-list-content-wrap ul"),u=0;u<c.length;u++){var h=$(c[u]).find("li.selected"),p=$($(c[u]).find("li").get(0));0<h.length?(h=h.offset().top-p.offset().top,o.find("div.combobox-list-content-wrap ul").scrollTop(h)):o.find("div.combobox-list-content-wrap ul").scrollTop(0)}$(".combobox-text").off(".combobox").on("mousedown.combobox",function(e){if(0<$(e.target).closest(".multiple-item").length)return e.stopPropagation(),!1}),$("div.ps--active-y").not(function(){return $(o).find(this).length||$(o).is(this)||$(this).closest(".combobox-wrap-outer",e).length}).off(".combobox").one("scroll.combobox",function(e){0===$(e.target).closest(".combobox-container").length&&n.hideGlobalOptions()}),n._addonEnable&&n.addonBottom&&n._addonBottomEnable&&l.bottomSlotHideOnClick?$(o).find(".combobox-list-editor-wrap.bottom").off("click").on("click",function(e,t){n.hideGlobalOptions()}):$(o).find(".combobox-list-editor-wrap.bottom").off("click"),n._addonEnable&&n.addonBottom&&n._addonBottomEnable&&l.bottomSlotHideOnClick?$(o).find(".combobox-list-editor-wrap.bottom").off("click").on("click",function(e,t){n.hideGlobalOptions()}):$(o).find(".combobox-list-editor-wrap.bottom").off("click")},hideGlobalOptions:function(){var e=$("#global-combobox-options");this.dom().find("a.combobox-switch").removeClass("arrow-up"),e.find("div.combobox-list-wrap").removeClass().addClass("combobox-list-wrap"),this.toggleFlag="hidden",this.dom().removeClass("focus"),e.attr("data-shown")===this.domId&&(e.find("div.combobox-list-wrap").hide(),e.attr("data-shown","_hidden_"),e.off("click","label.combobox-label"),$("body").off("mousemove",this.getComboboxXy)),this.dom().triggerHandler("ev_combobox_hide")},adaptWidth:function(){var e,t,a=this,i=$("#global-combobox-options");a.settings.adaptiveWidth&&(e=a.dom().find(".combobox-text"),t=this.getText(),e=e.css("font-size")+" "+e.css("font-family"),e=(t=$.su.measureText(t,e))<150?t:150,a.dom().find(".combobox-wrap").css("width",e+42+"px")),a.settings.cascader&&((t=0)!==i.find("ul.combobox-list li").length&&t++,0!==i.find("ul.combobox-list-2 li").length?(i.find("ul.combobox-list-2").removeClass("u-d-none"),t++):i.find("ul.combobox-list-2").removeClass("u-d-none").addClass("u-d-none"),0!==i.find("ul.combobox-list-3 li").length?(t++,i.find("ul.combobox-list-3").removeClass("u-d-none")):i.find("ul.combobox-list-3").removeClass("u-d-none").addClass("u-d-none"),i.find(".combobox-list-wrap").css("width",(0===t?a.settings.itemWidth:178*t)+"px"))},adaptMouseLeaveArea:function(){var t=this,e=$("#global-combobox-options"),a=e.find("div.combobox-list-wrap"),e=(t._globalOffset=e.offset(),"mousedown");$("body").off(e).on(e,function(e){e.originalEvent&&e.originalEvent.isTrusted?t.dom().hasClass("hover")||"hidden"===t.toggleFlag||t.settings.openOnFocus&&t.dom().hasClass("focus")||(t.getComboboxXy(e),(t._xx<t._globalOffset.left-1||t._xx>t._globalOffset.left+a.width()+1||t._yy<t._globalOffset.top-1||t._yy>t._globalOffset.top+a.height()+1)&&t.hideGlobalOptions()):t.hideGlobalOptions()})},getComboboxXy:function(e){e=e||window.event;this._xx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this._yy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop},calculatePosition:function(){var e,t,a,i,s,n,l;"hidden"!==this.toggleFlag&&(t=(e=(n=this.dom()).find(".widget-wrap.combobox-wrap")).offset(),l=$("body").offset(),n.find("div.combobox-lists").eq(0).html(),i=(a=$("#global-combobox-options")).find("div.combobox-list-wrap"),s=parseInt(n.attr("option-offset"),10)||0,n=parseInt(n.attr("option-offset-y"),10)||0,l=$.su.language.isRtl()&&this.settings.cascader?t.left-l.left+s+e.outerWidth()-i.width():$.su.language.isRtl()?t.left-l.left+s-(i.width()-e.outerWidth()):t.left-l.left+s,t.top+e.outerHeight()+i.height()<=$(window).height()||t.top-i.height()<=0||this.settings.showBottom?a.css({"position":"absolute","left":l+"px","top":t.top+e.outerHeight()+4+n+"px","z-index":this.settings.optionZIndex}):a.css({"position":"absolute","left":l+"px","top":t.top-i.height()-4-n+"px","z-index":this.settings.optionZIndex}),this.adaptMouseLeaveArea())},getNode:function(i,s){var n,e=this.settings.items,l=[];try{for(var t=0;t<e.length;t++)!function e(t){if(l.push(t),(n=t).value===i&&(!s||l.length===s))throw"GOT IT!";if(t.children&&0<t.children.length)for(var a=0;a<t.children.length;a++)e(t.children[a]);l.pop()}(e[t])}catch(e){return n}},getChildren:function(i,s){var n,e=this.settings.items,l=[];try{for(var t=0;t<e.length;t++)!function e(t){if(l.push(t),n=t.children,t.value===i&&(!s||l.length===s))throw"GOT IT!";if(t.children&&0<t.children.length)for(var a=0;a<t.children.length;a++)e(t.children[a]);l.pop()}(e[t])}catch(e){return{children:n,depth:l.length}}},getLevelOrder:function(e){var t=[],a=[],i={children:e};i&&a.push(i);for(var s,n=i,l=-1;0!==a.length;){if(t.push({name:a[0].name,value:a[0].value,level:l}),(i=a.shift()).children&&0<i.children.length)for(var o=0;o<i.children.length;o++)a.push(i.children[o]),s=i.children[o];n===i&&(n=s,l++)}return t.shift(),t},filterOptions:$.su.debounce(function(e){var i,s,n,l,t=$("#global-combobox-options"),a=t.find("input.combobox-checkbox"),o=this;null==e||""===e?a.each(function(){$("#global-combobox-options").removeClass("none-search-result"),$(this).closest("li.combobox-list").removeClass("u-d-none")}):(t.find("ul.combobox-list")[0].scrollTop=0,t=(t=(t=e).replace(/[\*\.\?\+\$\^\[\]\(\)\{\}\|\\\/]/g,function(e){return"\\"+e})).replace(/\s/g,function(e){return"\\s"}),i=new RegExp(t,o.settings.searchBoxCaseSensitive?"g":"gi"),s=0,n=o.settings,l=n.searchKeys?n.searchKeys.split("|"):[],a.each(function(){if(l.length){var e=$(this).attr("data-index");if(!e)return;var t=n.items[e],e=l.map(function(e){return t[e]}).join(" ")}else e=$(this).attr("display");var a=!0;e.replace(i,function(e){a=!1}),a&&s++,a?$(this).closest("li.combobox-list").removeClass("u-d-none").addClass("u-d-none"):$(this).closest("li.combobox-list").removeClass("u-d-none")}),s===a.length?$("#global-combobox-options").removeClass("none-search-result").addClass("none-search-result"):$("#global-combobox-options").removeClass("none-search-result"),o.calculatePosition())},200),getDisplayMap:function(){return $.su.clone(this._displayMap)},getItems:function(){return $.su.clone(this.settings.items||[])},setItems:function(e){this.settings.items=e},_isItemDisabled:function(e){return-1!==this._disabledData.indexOf(e)},destroy:function(){var e=$("#global-combobox-options");e.find("div[widget=textbox].combobox-search-box").off("ev_view_change"),e.find("div[widget=textbox].combobox-search-box").remove(),e.find("div.combobox-search-box-icon").remove(),e.find("div.combobox-search-container").remove()},setLoadingDataStatus:function(e){var t=this.getContainer(),a=$("#global-combobox-options"),i=a.find(".combobox-list-wrapper");e?t.addClass("loading"):t.removeClass("loading"),e&&!i.find(".loading-container").length?(1===this.pagingData.currentPage&&0===this.getItems().length?i.addClass("init"):i.removeClass("init"),i.prepend('<div class="loading-container"><span class="icon loading-btn"></span></div>')):e||(i.find(".loading-container").remove(),i.removeClass("init")),this.updateDynamicHeight($(a))},getLoadingDataStatus:function(){return this.getContainer().hasClass("loading")},updateComboboxList:function(e){for(var t,a=this.dom(),i=this.settings,s=a.find("div.combobox-lists .combobox-list-container").eq(0),n=($.isArray(e)||(e=[]),i.cascader&&(this._cascaderMap=this.getLevelOrder(e)),""),l=0,o=e.length;l<o;l++)e[l]&&e[l].name&&(n+=this.initItemHtml(l,e[l]),e[l].selected)&&(t=e[l][i.valueField],t=this.convertValue(t),this._defaultValue=t);s.html(n),this.setValue(t);var d=$("#global-combobox-options");(s=d.find("ul.combobox-list .combobox-list-container")).html(n),0==e.length?d.removeClass("none-items").addClass("none-items"):d.removeClass("none-items"),a.triggerHandler("ev_view_update")},triggerToggle:function(){var e;"shown"!==this.toggleFlag&&this.isVirtualLazyLoad()?this.initComboboxData(!0):(this._handleToggle(),!this.settings.searchBox||this.isSearchBoxInsideDropdown()||this.isVirtualLazyLoad()||(e=this.getSingleComboboxSearchText(),this.filterOptions(e)))},initComboboxData:function(e){var t=this;t.resetPagingData(),this.isSearchBoxInsideDropdown()?t.searchKey=null:t.searchKey=this.getSingleComboboxSearchText(),t.lazyLoadFirstPageData(function(){e&&t._handleToggle()},!0)},lazyLoadFirstPageData:function(a,i){var s=this;s.settings.beforeLoadingExpand&&a&&a(),$("#global-combobox-options").removeClass("none-items"),this.setLoadingDataStatus(!0),$.when(this.settings.configs.lazyLoadData(this.pagingData,this.searchKey)).done(function(e){var t;$("#global-combobox-options").attr("data-shown")!=s.domId&&s.settings.beforeLoadingExpand||(t=e.result||[],s.totalRows=e.totalRows||0,s.setItems(t),s.updateOptionNum(t),s.updateComboboxListPosition(),i?s.loadItems(t):(s.updateDynamicHeight($("#global-combobox-options")),s.loadVirtualList()),s.setOptionsSelected(),a&&a(),s.updateOptionHeight(),s.updateComboboxListVariableHeight())}).fail(function(){}).always(function(){s.settings.configs&&s.settings.configs.updateCallback&&s.settings.configs.updateCallback(),s.setLoadingDataStatus(!1)})},updateComboboxListPosition:function(){this.dynamicOffset=0,$("#global-combobox-options").find("div.combobox-list-content-wrap ul.combobox-list").scrollTop(0)},loadFirstPageData:function(){this.settings;var e=null,e=this.isSearchBoxInsideDropdown()?$("#global-combobox-options").find("div[widget=textbox].combobox-search-box").data("viewObj").getValue():this.getSingleComboboxSearchText();this.searchKey=e,this.resetPagingData(),this.lazyLoadFirstPageData(null,!1)},resetPagingData:function(){this.settings.configs&&this.settings.configs.pagingData?this.pagingData=$.su.clone(this.settings.configs.pagingData):this.pagingData=$.su.clone(this._defaultPagingData)},isVirtualLazyLoad:function(){return this.settings.virtualLazyLoad},updateDisplayMap:function(e){$.extend(this._displayMap,e)},getSingleComboboxSearchText:function(){return this.dom().find("input.single-combobox-search-box").val()},setSingleComboboxSearchText:function(e){this.dom().find("input.single-combobox-search-box").val(e)},updateSearchKey:function(e){this.searchKey=e},toggleComboboxText:function(){this.getSingleComboboxSearchText()?this.dom().find(".combobox-text").css("visibility","hidden"):this.dom().find(".combobox-text").css("visibility","visible")},toggleClear:function(e){},lazyLoadData:function(a){var i;this.pagingData.currentPage*this.pagingData.currentPageSize>=this.totalRows||this.getLoadingDataStatus()||(this.pagingData.currentPage++,(i=this).setLoadingDataStatus(!0),$.when(this.settings.configs.lazyLoadData(this.pagingData,this.searchKey)).done(function(e){var t=(t=i.getItems()||[]).concat(e.result);i.updateOptionNum(t),i.totalRows=e.totalRows||0,i.setItems(t),i.setOptionsSelected(),a&&a()}).fail(function(){i.pagingData.currentPage--}).always(function(){i.settings.configs&&i.settings.configs.updateCallback&&i.settings.configs.updateCallback(),i.setLoadingDataStatus(!1)}))},getVirtualList:function(){var e,t,a=this.getItems()||[];return a.length>2*this.OPTION_NUM_IN_ONE_VIEW&&(e=Math.floor(Math.max(parseInt(this.dynamicOffset)+this.optionHeight/2,0)/this.optionHeight),a=(e=a.slice(e,e+this.OPTION_NUM_IN_ONE_VIEW-(this.isLoadingInView()?1:0))).length<this.OPTION_NUM_IN_ONE_VIEW-(this.isLoadingInView()?1:0)?(t=a.length,a.slice(t-this.OPTION_NUM_IN_ONE_VIEW,t)):e),a},loadVirtualList:function(){var e=$("#global-combobox-options ul.combobox-list"),e=(e[0]&&this.getItems().length>2*this.OPTION_NUM_IN_ONE_VIEW?this.dynamicOffset=e[0].scrollTop:this.dynamicOffset=0,this.updateDynamicOffset($("#global-combobox-options")),this.getVirtualList());this.updateComboboxList(e),this.getLoadingDataStatus()?this.setLoadingDataStatus(!0):this.setLoadingDataStatus(!1)},updateDynamicOffset:function(e){e.find(".combobox-list-container").css("top",this.dynamicOffset+"px")},updateDynamicHeight:function(e){this.dynamicHeight=(this.getItems()||[]).length*this.optionHeight,e.find(".combobox-list-phantom").css("height",this.dynamicHeight+"px")},updateOptionHeight:function(){var e=$("#global-combobox-options").find("li.combobox-list"),e=e.length&&e[0].getBoundingClientRect().height||this.optionHeight;this.optionHeight=e},updateComboboxListVariableHeight:function(){var e=$("#global-combobox-options"),t=e.find("ul.combobox-list"),e=e.find(".combobox-list-content-wrap");this.isVirtualLazyLoad()?(this.isVariableHeight()?(t.css("height",this.optionHeight*this.OPTION_NUM_IN_ONE_VIEW+"px"),e.css("min-height",this.COMBOX_LIST_CONTENT_WRAP_MIN_HEIGHT+"px")):(t.css("height",""),e.css("min-height","")),t.css("max-height",this.optionHeight*this.OPTION_NUM_IN_ONE_VIEW+"px")):(e.css("min-height",""),t.css("height",""),t.css("max-height",""))},isLoadingInView:function(){var e;return!!this.getLoadingDataStatus()&&(!(this.getItems().length>2*this.OPTION_NUM_IN_ONE_VIEW)||(e=$("#global-combobox-options"),e=$(e).find("ul.combobox-list").data("ps").containerHeight,parseInt(this.dynamicHeight)-parseInt(this.dynamicOffset)-e<=this.optionHeight/2))},isVariableHeight:function(){return this.isVirtualLazyLoad()&&this.settings.variableHeight},updateOptionNum:function(e){var t;this.isVariableHeight()?(e=(t=Math.floor((window.innerHeight-this.EXCLUDE_COMBOBOX_LIST_HEIGHT)/this.optionHeight))<=this.MIN_OPTION_NUM?this.MIN_OPTION_NUM:e.length<=t?e.length:t,this.OPTION_NUM_IN_ONE_VIEW=e):this.OPTION_NUM_IN_ONE_VIEW=8},updatePersistentHeight:function(){var e=this.isIntegrated?0:$(".header__central").height(),t=$("#global-combobox-options").find(".combobox-custom-top-wrap").height(),a=$("#global-combobox-options").find(".combobox-search-container").outerHeight(!0),i=$(".header__label").outerHeight(!0),s=$("#userSites").height();(this.isIntegrated||e)&&t&&a&&i&&s&&(this.EXCLUDE_COMBOBOX_LIST_HEIGHT=e+this.COMBOBOX_CONTAINER_PADDING+t+this.COMBOBOX_DISTANCE_BOTTOM+a+i+s,this.COMBOX_LIST_CONTENT_WRAP_MIN_HEIGHT=this.optionHeight*this.MIN_OPTION_NUM+a+t)}}),$.su.Widget.register("radio",{settings:{name:{attribute:"name",defaultValue:""},columns:{attribute:"columns",defaultValue:3},tipText:{attribute:"tip-text",defaultValue:""},toggleContent:{attribute:"toggle-content",defaultValue:!1},tipTextAfterLabel:{attribute:"tip-text-after-label",defaultValue:!1},readOnly:{attribute:"read-only",defaultValue:!1}},listeners:[{selector:".radio-label",event:"click",callback:function(e,t){var a,i;e.preventDefault(),e.stopPropagation(),$(this).hasClass("disabled")||$(this).closest(".radio-group-container").hasClass("readonly")||(a=t.getValue(),e=$(this).find("input").attr("data-index"),i=t.dataMap[e],e=$.su.getDefaultEvent(t,function(){t.dom().removeClass("error"),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i,"oldValue":a}]),t.setStatus("checked",!0)}),t.dom().triggerHandler("ev_view_before_change",[e.ev,i]),e.exe())}}],init:function(){this._defaultValue="",this.dataMap={},this._status.checked=!1},render:function(){var e=this.dom(),t=this.settings,a=!1===t.labelField?"label-empty":"",a=(e.addClass(t.cls+"radio-group-container "+a),"");null!==t.labelField&&"false"!==t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel radio-group-fieldlabel">'+$.su.escapeHtml(t.labelField)+"</label>",t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>"),t.tipText&&t.tipTextAfterLabel&&(a+='<div widget="toolTip" class="tip-after-label"></div>'),a=(a+='<div class="widget-wrap-outer radio-group-wrap-outer"><div class="radio-group-wrap"></div>')+'<div widget="errortip" error-cls="'+t.errorTipsCls+'"></div>',null!=t.tips&&null!=t.tips&&(a=(a+='<div class="widget-tips textbox-tips '+t.tipsCls+'">')+'<div class="widget-tips-wrap"><div class="content tips-content">'+t.tips+"</div></div></div>"),a+="</div>",t.tipText&&!t.tipTextAfterLabel&&(a+='<div widget="toolTip"></div>'),e.append(a),t.items&&0<t.items.length&&this.loadItems(t.items)},loadItems:function(e){var t=this.dom(),a=this.settings,i=a.configs&&a.configs.columns||a.columns,s=Math.ceil(e.length/i),n=0,l=!1;if($.isArray(e)&&!(e.length<=0)){a.items=e,a.name=e[0].name;for(var o='<ul class="radio-group-list-wrap">',d=function(e,t,a,i,s){o=(o=(o=(o=(o+='<li class="radio-list">')+'<div class="widget-wrap"><label class="radio-label '+s+" "+v+'" for="'+a+'">')+'<input class="radio-radio" type="radio" data-text="'+$.su.escapeHtml(i)+'" name="'+e+'" data-index="'+t+'" id="'+a+'" '+m+' /><span class="icon"><span class="icon-inner"></span></span>')+'<span class="text">'+$.su.escapeHtml(c.boxlabel)+"</span></label>")+(c.disableTipText?'<span class="disable-icon" data-tip="'+c.disableTipText+'"></span>':"")+'</div><div class="radio-content-wrap u-d-none"></div></li>'},r=0;r<e.length;r++){var c=e[r],u=c.name||"",h=null==c.value?"":c.value,p=c.id||$.su.randomId("radio"),g=c.itemCls||"",m="",v="";this.dataMap[r]=h,l=!!c.content||l,"checked"!==c.checked&&!0!==c.checked||(m='checked="checked"',v="checked",this._defaultValue=h),n<s?d(u,r,p,c.boxlabel,g):(o+='</ul><ul class="radio-group-list-wrap">',d(u,r,p,c.boxlabel,g),n=0),n++}o+="</ul>";var b,f=this.getContainer();if(f.find("div.radio-group-wrap").empty().append($(o)),l)for(r=0;r<e.length;r++)(c=e[r]).content?(b=$(c.content),f.find("li.radio-list").eq(r).find("div.radio-content-wrap").show().append(b)):f.find("li.radio-list").eq(r).find("div.radio-content-wrap").hide();t.triggerHandler("ev_view_update")}},getItems:function(){return $.su.clone(this.settings.items)},getSelectedText:function(){return this.dom().find("input.radio-radio[name="+this.getValue()+"]").attr("data-text")},getValue:function(){var e;return this.dom().find("input[type=radio]").each(function(){$(this).prop("checked")&&(e=$(this).attr("data-index"))}),void 0!==e?this.dataMap[e]:e},setStyle:function(e){var t,a,i=this.dom(),s=this.settings,n=i.find("input.radio-radio").removeAttr("checked");for(a in i.find("label.radio-label").removeClass("checked"),this.dataMap)this.dataMap.hasOwnProperty(a)&&this.dataMap[a]===e?((t=n.filter("[data-index="+a+"]")).prop("checked",!0),t.closest("label.radio-label").addClass("checked"),s.toggleContent&&t.closest("li.radio-list").find(".radio-content-wrap").show()):((t=n.filter("[data-index="+a+"]")).prop("checked",!1),s.toggleContent&&t.closest("li.radio-list").find(".radio-content-wrap").hide())},setValue:function(e){if(null===(e=void 0===e?"":e)){if(null!=this._defaultValue)return void this.dom().triggerHandler("ev_view_change",[{"type":"record","value":this._defaultValue}]);e=""}this.setStyle(e)},setRadioText:function(e){var t,a=this.dom().find(".text");for(t in e)$(a[t]).text(e[t])},disableItem:function(a){var e=this.dom(),i=this,e=e.find("input.radio-radio"),s=("string"!==$.type(a)&&"number"!==$.type(a)||(a=[a]),(()=>{for(var e={},t=0;t<a.length;t++)e[a[t]]=!0;return e})());e.each(function(e,t){var a=$(t).attr("data-index");i.dataMap[a]in s&&($(t).closest("li.radio-list").addClass("disabled"),$(t).closest("label.radio-label").addClass("disabled"),t.disabled=!0)})},enableItem:function(a){var e=this.dom(),i=this,e=e.find("input.radio-radio"),s=("string"!==$.type(a)&&"number"!==$.type(a)||(a=[a]),(()=>{for(var e={},t=0;t<a.length;t++)e[a[t]]=!0;return e})());e.each(function(e,t){var a=$(t).attr("data-index");i.dataMap[a]in s&&($(t).closest("li.radio-list").removeClass("disabled"),$(t).closest("label.radio-label").removeClass("disabled"),t.disabled=!1)})},disable:function(){var e=this.dom();this.disableDom(),e.triggerHandler("ev_view_disable"),this.setStatus("disabled",!0)},disableDom:function(){var e=this.dom(),t=this.getContainer(),e=e.find("input.radio-radio");t.addClass("disabled"),e.each(function(e,t){t=$(t);t.closest("li.radio-list").addClass("disabled"),t.closest("label.radio-label").addClass("disabled"),t.prop("disabled",!0)})},enable:function(){var e=this.dom();this.enableDom(),e.triggerHandler("ev_view_enable"),this.setStatus("disabled",!1)},enableDom:function(){var e=this.dom(),t=this.getContainer(),e=e.find("input.radio-radio");t.removeClass("disabled"),e.each(function(e,t){t=$(t);t.closest("li.radio-list").removeClass("disabled"),t.closest("label.radio-label").removeClass("disabled"),t.prop("disabled",!1)})},setReadOnly:function(e){this.settings.readOnly=e;var t=this.getContainer();e?t.addClass("readonly"):t.removeClass("readonly")}}),$.su.Widget.register("checkbox",{settings:{name:{attribute:"name",defaultValue:""},trueValue:{attribute:"true-value",defaultValue:!0},falseValue:{attribute:"false-value",defaultValue:!1},columns:{attribute:"columns",defaultValue:1},tipText:{attribute:"tip-text",defaultValue:""},boxLabel:{attribute:"box-label",defaultValue:""},readOnly:{attribute:"read-only",defaultValue:!1}},listeners:[{selector:".checkbox-label",event:"click",callback:function(e,t){e.preventDefault();var e=$(this),a=t.settings,i=(e.find("input[type=checkbox]").attr("name"),e.find("input[type=checkbox]").prop("checked"),t.getValue());e.hasClass("disabled")||e.closest(".checkbox-container").hasClass("readonly")||(i=i===a.trueValue?a.falseValue:a.trueValue,e=$.su.getDefaultEvent(t,function(){var e=$.su.getDefaultEvent(t,function(){t.setStatus("checked",i===a.trueValue)});t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}]),e.exe()}),t.dom().triggerHandler("ev_view_before_change",[e.ev,i]),e.exe(),t.dom().triggerHandler("ev_view_after_change"))}},{selector:".checkbox-label a",event:"click",callback:function(e){e.stopPropagation()}}],init:function(){this._status.disabled=!1,this._status.checked=!1},render:function(){var e=this.dom(),t=this.settings,a=!1===t.labelField?"label-empty":"",i=this.domId+"-checkbox-"+parseInt(1e3*Math.random()*1e3*1e3,10).toString(),a=(e.addClass(t.cls+"checkbox-container "+a),"");null!==t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel checkbox-group-label">'+t.labelField+"</label>",t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>"),a=(a=(a=(a+='<div class="widget-wrap-outer checkbox-group-wrap-outer"><div class="checkbox-group-wrap"><ul><li class="checkbox-list">')+'<div class="widget-wrap"><label class="checkbox-label " for="'+i+'">')+'<input class="checkbox-checkbox" type="checkbox" id="'+i+'" /><span class="checkbox-icon"><span class="checkbox-icon-inner"></span></span>')+'<span class="text">'+t.boxLabel+"</span></label></div></li></ul></div>",null!=t.tips&&null!=t.tips&&(a=(a+='<div class="widget-tips textbox-tips '+t.tipsCls+'">')+'<div class="widget-tips-wrap"><div class="content tips-content">'+t.tips+"</div></div></div>"),a=a+('<div widget="errortip" error-cls="'+t.errorTipsCls)+'"></div></div>',t.tipText&&(a+='<div widget="toolTip"></div>',e.addClass("has-tool-tip")),e.append(a)},setValue:function(e){var t=this.dom(),a=this,i=this.settings,t=t.find("input[type=checkbox]");t=t.eq(0),(e=e)===i.trueValue||!0===e||1===e?(t.closest("label.checkbox-label").addClass("checked"),t.prop("checked",!0),a.setStatus("checked",!0)):e!==i.falseValue&&!1!==e&&0!==e&&null!==e||(t.closest("label.checkbox-label").removeClass("checked"),t.prop("checked",!1),a.setStatus("checked",!1))},getValue:function(){var e=this.dom(),t=this.settings;return e.find("input[type=checkbox]").eq(0).prop("checked")?t.trueValue:t.falseValue},disable:function(){var e=this.dom(),t=e.find("input.checkbox-checkbox");this.getContainer().addClass("disabled"),t.each(function(e,t){t=$(t);t.closest("li.checkbox-list").addClass("disabled"),t.closest("label.checkbox-label").addClass("disabled"),t.prev("input[type=hidden]").prop("disabled",!0),t.prop("disabled",!0)}),e.triggerHandler("ev_view_disable"),this.setStatus("disabled",!0)},enable:function(){var e=this.dom(),t=e.find("input.checkbox-checkbox");this.getContainer().removeClass("disabled"),t.each(function(e,t){t=$(t);t.closest("li.checkbox-list").removeClass("disabled"),t.closest("label.checkbox-label").removeClass("disabled"),t.prev("input[type=hidden]").prop("disabled",!1),t.prop("disabled",!1)}),e.triggerHandler("ev_view_enable"),this.setStatus("disabled",!1)},setReadOnly:function(e){this.settings.readOnly=e;var t=this.getContainer();e?t.addClass("readonly"):t.removeClass("readonly")},setBoxLabel:function(e){var t=this.dom();this.settings;(this.getContainer()||t).find("span.text").html(e)}}),$.su.Widget.register("checkboxGroup",{settings:{trueValue:{attribute:"true-value",defaultValue:!0},falseValue:{attribute:"false-value",defaultValue:!1},columns:{attribute:"columns",defaultValue:1},tipText:{attribute:"tip-text",defaultValue:""},allowSelectAll:{attribute:"allow-select-all",defaultValue:!1},selectAllPos:{attribute:"select-all-position",defaultValue:"after"},maxLabelWidth:{attribute:"max-label-width",defaultValue:100},searchBox:{attribute:"search-box",defaultValue:!1},scroll:{attribute:"scroll",defaultValue:!1},exceptDisabledForSelectAll:{attribute:"except-disabled-for-select-all",defaultValue:!0}},listeners:[{selector:".checkbox-group-all .checkbox-label",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation();var a=t.dom().find(".checkbox-list"),i=t.selectAll.getValue(),s=t.settings;if(!t.dom().hasClass("disabled")){var n={},e=t.getValue();t.selectAll.setValue(!i);for(var l=0;l<s.items.length;l++){var o=s.items[l].name;n[o]=i?s.falseValue:s.trueValue,s.exceptDisabledForSelectAll&&$(a[l]).hasClass("disabled")&&(n[o]=t._items[o])}var d=$.su.getDefaultEvent(t,function(){t.dom().triggerHandler("ev_view_change",[{"type":"value","value":n}])});t.dom().triggerHandler("ev_view_before_change",[d.ev,n,e]),d.exe()}}},{selector:".checkbox-label.group",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation();var e=$(this),a=t.settings,i=e.find("input[type=checkbox]").attr("name"),s=(e.find("input[type=checkbox]").prop("checked"),t.getValue());e.hasClass("disabled")||("object"==$.type(s)&&void 0!==s[i]?s[i]=s[i]===a.trueValue?a.falseValue:a.trueValue:s=s===a.trueValue?a.falseValue:a.trueValue,e=$.su.getDefaultEvent(t,function(){t.dom().triggerHandler("ev_view_change",[{"type":"value","value":s}])}),a=t.getValue(),t.dom().triggerHandler("ev_view_before_change",[e.ev,s,a,i]),e.exe())}},{selector:".checkbox-group-search-box",event:"ev_textbox_search",callback:function(e,t,a){a._filterOptions(t)}}],init:function(){this._status.disabled=!1},render:function(){var e=this.dom(),t=this.settings,a=(e.addClass(t.cls+"checkbox-group-container"),"");null!==t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel checkbox-group-label">'+$.su.escapeHtml(t.labelField)+"</label>",""!==t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),t.tipText&&(a+='<div widget="toolTip"></div>'),a+="</div>"),a+='<div class="widget-wrap-outer checkbox-group-wrap-outer">',t.allowSelectAll&&"before"===t.selectAllPos&&(a+='<div widget="checkbox" id="'+this.domId+'_select_all" class="u-label-none checkbox-group-all"></div>'),t.searchBox&&(a+="<div widget='textbox' class='checkbox-group-search-box search-box' ></div>"),a+='<div class="checkbox-group-wrap"></div>',t.allowSelectAll&&"after"===t.selectAllPos&&(a+='<div widget="checkbox" id="'+this.domId+'_select_all" class="u-label-none checkbox-group-all"></div>'),null!=t.tips&&null!=t.tips&&(a=a+('<div class="widget-tips textbox-tips '+t.tipsCls)+'"><div class="widget-tips-wrap"><div class="content tips-content"></div></div></div>'),a+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">',e.append(a=a+"</div>"+"</div>"),t.searchBox&&(this._searchBox=new $.su.widgets.textbox({id:e.find(".checkbox-group-search-box"),customSettings:{instantSearch:!0}}),this._searchBox.render()),t.scroll&&$.su.scrollbar({ele:e.find(".checkbox-group-wrap")[0]}),t.items&&0<t.items.length&&this.loadItems(t.items),t.allowSelectAll&&(this.selectAll=new $.su.widgets.checkbox({id:this.domId+"_select_all"}),this.selectAll.render()),t.tipText&&new $.su.widgets.toolTip({id:e.find("[widget=toolTip]").not(".tooltip-container"),tipText:t.tipText}).render()},loadItems:function(e){var t=this.dom(),a=this.settings,i=Math.ceil(e.length/a.columns),s=0,l=a.maxLabelWidth;if($.isArray(e)||"object"!=typeof e||(e=[e]),$.isArray(e)&&!(e.length<0)){a.items=e;for(var o='<ul class="checkbox-group-list-wrap">',n=function(e){var t=e.boxName,a=e.boxValue,i=e.boxId,s=e.boxlabel,n=e.tip,e=(o=(o=(o=o+'<li class="checkbox-list">'+'<div class="widget-wrap">')+('<label class="checkbox-label group '+e.itemCls+" "+h+'" for="'+i+'">')+('<input class="hidden" type="hidden" name="'+t+'" data-checked="'+a+'" '+u+" />"))+('<input class="checkbox-checkbox" type="checkbox" name="'+t+'" value="'+a+'" data-checked="'+a+'" data-index="'+d+'" id="'+i+'" '+c+" />")+'<span class="checkbox-icon"><span class="checkbox-icon-inner"></span></span>',$.su.abbreviateStr(s,l)),n=n||(e.abbreviate?$.su.escapeHtml(s):"");o=o+('<span class="text" data-tip="'+n+'" tip-max-width="150px">'+$.su.escapeHtml(e.text))+"</span></label></div></li>"},d=0;d<e.length;d++){var r={boxName:e[d].name||"",boxValue:e[d].value||!1,itemCls:e[d].itemCls||"",boxId:e[d].id||"checkbox-"+parseInt(1e3*Math.random()*1e3*1e3,10).toString(),boxlabel:e[d].boxlabel||"",tip:e[d].tip},c="",u="",h="";"checked"!==e[d].checked&&!0!==e[d].checked||(c='checked="checked"',u='disabled="disabled"',h="checked"),s<i?n(r):(o+='</ul><ul class="checkbox-group-list-wrap">',n(r),s=0),s++}var o=(o=o+"</ul>"+'<div class="no-data-tip"></div>')+('<div class="search-empty-tip">'+$.su.CHAR.COMMON.NO_ITEMS+"</div>"),p=t.children(".checkbox-group-wrap-outer");p.children("div.checkbox-group-wrap").eq(0).empty().append($(o)),0===e.length?p.removeClass("empty").addClass("empty"):p.removeClass("empty"),this._searchBox&&this._searchBox.setValue(null),p.removeClass("empty-search"),a.allowSelectAll&&this.selectAll.setBoxLabel($.su.CHAR.COMMON.ITEMS_OF.replace("%num1",0).replace("%num2",!!a.items&&a.items.length||0)),t.triggerHandler("ev_view_update")}},getAllItems:function(){return this.settings.items},setValue:function(e){function a(e,t){t===n.trueValue?(e.closest("label.checkbox-label").addClass("checked"),e.prop("checked",!0),o++,s._items[e.prop["name"]]=!0):t===n.falseValue&&(e.closest("label.checkbox-label").removeClass("checked"),e.prop("checked",!1),s._items[e.prop["name"]]=!1)}var i,s=this,t=this.dom(),n=this.settings,l=t.find("input[type=checkbox]"),o=0,d=this;if(this._items={},null==e||""===e||!0===e)i=e?n.trueValue:n.falseValue,l.each(function(e,t){t=$(t);t.prop("disabled")||a(t,i)}),n.allowSelectAll&&(d.selectAll.dom().find("label.checkbox-label ").removeClass("imperfect"),d.selectAll.setBoxLabel($.su.CHAR.COMMON.ITEMS_OF.replace("%num1",o).replace("%num2",!!n.items&&n.items.length||0)));else{for(var r=0;n.items&&r<n.items.length;r++){var c,u=n.items[r].name;e.hasOwnProperty(u)?0!==(c=t.find('input[type=checkbox][name="'+u+'"]')).length&&a(c.eq(0),e[u]):0!==(c=t.find('input[type=checkbox][name="'+u+'"]')).length&&a(c.eq(0),n.falseValue)}n.allowSelectAll&&(d.selectAll.dom().find("label.checkbox-label ").removeClass("imperfect"),0===o?d.selectAll.setValue(!1):o===n.items.length?d.selectAll.setValue(!0):d.selectAll.dom().find("label.checkbox-label ").addClass("imperfect"),d.selectAll.setBoxLabel($.su.CHAR.COMMON.ITEMS_OF.replace("%num1",o).replace("%num2",!!n.items&&n.items.length||0)))}},getValue:function(){var e=this.dom(),i=this.settings,s={};return e.find("input[type=checkbox]").each(function(e,t){var a=$(t).attr("name");a&&(s[a]=$(t).prop("checked")?i.trueValue:i.falseValue)}),s||!1},disable:function(){var e=this.dom(),t=e.find("input.checkbox-checkbox");e.addClass("disabled"),t.each(function(e,t){t=$(t);t.closest("li.checkbox-list").addClass("disabled"),t.closest("label.checkbox-label.group").addClass("disabled"),t.prev("input[type=hidden]").prop("disabled",!0),t.prop("disabled",!0)}),e.triggerHandler("ev_view_disable"),this.setStatus("disabled",!0)},enable:function(){var e=this.dom(),t=e.find("input.checkbox-checkbox");e.removeClass("disabled"),t.each(function(e,t){t=$(t);t.closest("li.checkbox-list").removeClass("disabled"),t.closest("label.checkbox-label.group").removeClass("disabled"),t.prev("input[type=hidden]").prop("disabled",!1),t.prop("disabled",!1)}),e.triggerHandler("ev_view_enable"),this.setStatus("disabled",!1)},disableItem:function(s,n){var e=this.dom().find("input.checkbox-checkbox"),l=this;e.each(function(e,t){var a,i,t=$(t);e===s&&(null!=n&&((a=l.getValue())[t.attr("name")]=!1!==n,e=$.su.getDefaultEvent(l,function(){l.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}])}),i=l.getValue(),l.dom().triggerHandler("ev_view_before_change",[e.ev,a,i]),e.exe()),t.closest("li.checkbox-list").addClass("disabled"),t.closest("label.checkbox-label.group").addClass("disabled"),t.prev("input[type=hidden]").prop("disabled",!0),t.prop("disabled",!0))})},enableItem:function(a,i){var s=this.dom(),e=s.find("input.checkbox-checkbox"),n=this;e.each(function(e,t){t=$(t);e===a&&(e=n.getValue(),null!=i&&(e[t.attr("name")]=!1!==i,s.triggerHandler("ev_view_change",[{"type":"value","value":e}])),t.closest("li.checkbox-list").removeClass("disabled"),t.closest("label.checkbox-label.group").removeClass("disabled"),t.prev("input[type=hidden]").prop("disabled",!1),t.prop("disabled",!1))})},clearAllTip:function(){this.dom().find(".checkbox-label .text").removeAttr("data-tip")},toggleTipByName:function(e,t){e=this.dom().find("input.checkbox-checkbox").filter(`[name=${e}]`).siblings(".text");t?e.attr("data-tip",t):e.removeAttr("data-tip")},enableItemByName:function(e){var t;this.settings.items.length&&(e=$.isArray(e)?e:[e],t=this.dom(),e.forEach(function(e){e=t.find("input[name='"+e+"'].checkbox-checkbox");e.closest("li.checkbox-list").removeClass("disabled"),e.closest("label.checkbox-label.group").removeClass("disabled"),e.prev("input[type=hidden]").prop("disabled",!1),e.prop("disabled",!1)}))},disableItemByName:function(e,t){var a,i,s,n;this.settings.items.length&&(e=$.isArray(e)?e:[e],a=this.dom(),s=(i=this).getValue(),e.forEach(function(e){null!=t&&(s[e]=!1!==t);e=a.find("input[name='"+e+"'].checkbox-checkbox");e.closest("li.checkbox-list").addClass("disabled"),e.closest("label.checkbox-label.group").addClass("disabled"),e.prev("input[type=hidden]").prop("disabled",!0),e.prop("disabled",!0)}),null!=t)&&(e=$.su.getDefaultEvent(i,function(){i.dom().triggerHandler("ev_view_change",[{"type":"value","value":s}])}),n=i.getValue(),i.dom().triggerHandler("ev_view_before_change",[e.ev,s,n]),e.exe())},getDisableItems:function(e){var t=this.dom().find("input.checkbox-checkbox"),a=[];return t.each(function(e,t){t=$(t);t.closest("label.checkbox-label.group").hasClass("disabled")&&a.push(t.attr("name"))}),a},_filterOptions:$.su.debounce(function(e){var i,s=this.dom(),n=!1,l=!1;null==e||""===e?n=!0:i=$.su.createRegFromText(e,"i"),s.find(".checkbox-group-wrap")[0].scrollTop=0,this.settings.items.forEach(function(e){var t,a=s.find("input[name='"+e.name+"'].checkbox-checkbox");n||i&&i.test(e.boxlabel)?(t="show",l=!0):t="hide",a.closest("li.checkbox-list")[t]()}),this.dom().find(".checkbox-group-wrap-outer").eq(0)[l?"removeClass":"addClass"]("empty-search")},200),hideItem:function(t){var a=this.dom();this.settings.items.forEach(function(e){e.name===t&&a.find("input[name='"+e.name+"'].checkbox-checkbox").closest("li.checkbox-list").hide()})}}),(h=>{h.su.Widget.register("mediaList",{settings:{multiselect:{attribute:"multi-select",defaultValue:!1},maxLine:{attribute:"max-line",defaultValue:4},scroll:{attribute:"scroll",defaultValue:!1},numPerPage:{attribute:"num-per-page",defaultValue:8},addText:{attribute:"add-text",defaultValue:h.su.CHAR.PAYMENT_PROFILE.ADD_ACCOUNT}},listeners:[{selector:".devicesList-item-container",event:"click",callback:function(t,a){t.stopPropagation();var e=h(this).data("viewObj");if(e)if(e._status.disabled){let e=h(t.currentTarget).data("key");void 0!==e&&(e=e.toString()),void a.dom().triggerHandler("ev_item_disabled_click",e)}else{var i=e._relatedData;if(a.settings.multiselect){var e=h(this).find(".devicesList-item-checkbox[widget=checkbox]").data("viewObj"),t=t.target||t.srcElement,t=h(t).closest(".devicesList-item-checkbox[widget=checkbox]"),s=!e._status.checked,n=(0<t.size()&&(s=!s),a._selectedData);if(s)e.setValue(!0),n.push(i),h(this).addClass("item-selected");else{e.setValue(!1);for(var l=0,o=n.length;l<o;l++)if(i.key==n[l].key){n.splice(l,1);break}h(this).removeClass("item-selected")}a.dom().triggerHandler("ev_item_click",d)}else{a._selectedData[0]=i;var d=a.getSelected();a.dom().triggerHandler("ev_item_click",d),h(this).closest("[widget=mediaList]").find(".item-selected").removeClass("item-selected"),h(this).addClass("item-selected")}}}},{selector:".devicesList-paging-container .paging-btn",event:"click",callback:function(e,t){var a=t.dom().find(".devicesList-item-container"),i=parseInt(h(this).text()),s=t.settings.numPerPage,n=t.dom().find(".paging-btn-num");a.hide(),isNaN(i)&&(i=h(this).hasClass("pageing-btn-prev")?1:n.length),a.filter(function(e){return(i-1)*s<=e&&e<i*s}).show(),t.dom().find(".current").removeClass("current"),n.hide(),(i<=2?n.filter(function(e){return e<=4}):i>=n.length-1?n.filter(function(e){return e>=n.length-5}):n.filter(function(e){return i-3<=e&&e<=i+1})).show(),n.eq(i-1).addClass("current")}},{selector:".icon-action",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();let a=h(this).data("type"),i=h(this).closest(".devicesList-item-container"),s=i.data("key");void 0!==s&&(s=s.toString()),t.dom().triggerHandler("ev_billingList_action_click",[s,a,h(this)])}}],init:function(e){this._keys=[],this._renderedItems=[],this._selectedData=[];var t=this.settings.host;t&&t.setted&&(t.trueValue=void 0!==t.trueValue?t.trueValue:"HOST",t.name=void 0!==t.name?t.name:"host"),this._deviceList={COMPANY:"company",PERSONAL:"personal"}},render:function(){for(var e=this.settings,t=this.dom(),a=[],i=0;i<e.configs.length;i++)a.push(e.configs[i].type.toLowerCase());a.sort(),a.push("list"),a=a.join("-"),t.addClass("mediaList-container devicesList-container widget-container "+a);t.append('<ul class="devicesList-content-container"></ul>')},syncData:function(e,t){this.dom().find(".devicesList-content-container").empty(),this._keys=e,this._renderedItems=[],this._selectedData=[],this.dom().triggerHandler("ev_store_render_items",[e])},renderModels:function(e,t,a){for(var i,s=this.dom().find(".devicesList-content-container"),n=this.settings,l=n.configs[0],o=0;o<t.length;o++){var d=t[o].getData(),r=t[o][e].getValue(),c="classname"===l.type?l.value(d[l.dataIndex]):"",u=h('<li id="'+this.domId+"-item-"+o+'" class="devicesList-item-container '+c+'" data-key="'+r+'"></li>'),c=h(this.renderContent(d)),c=(u.append(c).appendTo(s),c=h(".devicesList-item-payment-method-infos"),h.each(c,function(e,t){h.su.scrollbar({ele:t})}),new h.su.widgets.form({id:u}));c.render(),c._relatedData={key:r,data:d},n.multiselect?(d=h('<div widget="checkbox" class="devicesList-item-checkbox" name="devicesList-item-checkbox"></div>').appendTo(u),new h.su.widgets.checkbox({id:d}).render(),u.addClass("multi-select")):u.addClass("single-select"),this._renderedItems.push({key:r,obj:c})}i=h('<div class="container"><span>'+n.addText+"</span></div>"),(u=h('<li class="devicesList-item-container icon-action" data-type="add"></li>')).append(i).appendTo(s),a&&a(this._renderedItems)},renderdevicesList:function(){var e=this.dom(),t=this.settings,a=t.maxLine,i=t.numPerPage,s=e.find(".devicesList-item-container"),a=s.eq(0).outerHeight(!0)*a;if(s.length>i&&!t.scroll){var n=Math.ceil(s.length/i),l=(s.filter(function(e){return i<=e}).hide(),'<div class="devicesList-paging-container paging-container disabled">');l+='<div class="paging-wrap"><div class="paging-btns inline-block">',5<n&&(l+='<a href="javascript:void(0);" class="paging-btn pageing-btn-prev" data-index="prev"><span class="icon"></span><span class="text"><</span></a>'),l+='<div class="num-buttons-container">';for(var o=0;o<n;o++)l=(l=l+'<a href="javascript:void(0);" class="paging-btn paging-btn-num pageing-btn-'+o+'"><span class="icon"></span>')+'<span class="text">'+(o+1)+"</span></a>";l+="</div>",5<n&&(l+='<a href="javascript:void(0);" class="paging-btn pageing-btn-next" data-index="next"><span class="icon"></span><span class="text">></span></a>'),l+="</div></div></div>",e.find(".devicesList-paging-container").remove(),h(l).appendTo(e);s=e.find(".paging-btn-num");s.eq(0).addClass("current"),5<n&&s.filter(function(e){return 5<=e}).hide()}else t.scroll&&(e.outerHeight(a),e.css({"overflow-y":"scroll"}))},renderContent:function(e){if(null!=e){for(var t=this.settings,a=t.configs,i=this._deviceList,t=t.host,s="",n=(t&&t.setted&&(s=t.trueValue===e[t.name]?" host":""),'<div class="devicesList-item-content">'),l=0,o=a.length;l<o;l++){var d,r=a[l].type;"classname"!==r&&(r=r.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}),d=a[l].dataIndex,"logo"==r?n+='<div class="logo-container"><span class="'+(s="icon icon-"+(e[d]?i[e[d]]:i["COMPANY"])+s)+'"></span></div>':(a[l].label&&a[l].label,n+='<div class="devicesList-item devicesList-item-'+r+'">',"string"===h.type(e[d])&&(e[d]=h.su.transSpecialChar(e[d])),a[l].renderer?n+='<span class="content">'+a[l].renderer.call(a[l],e[d],e)+"</span></div>":n+='<span class="content">'+e[d]+"</span></div>"))}return n=n+"</div>"+'<div class="operate-panel">',e.hideEdit||(n+='<span class="icon-edit icon-action" data-type="edit"></span>'),e.hideDelete||(n+='<span class="btn-delete icon-action" data-type="delete"><span class="icon"></span></span>'),n+="</div>"}},getSelected:function(){for(var e=this._selectedData,t=[],a=0,i=e.length;a<i;a++)t.push(e[a].data);return t},disable:function(e){null==e&&(e=this._keys);for(var t=0,a=(e=h.isArray(e)?e:[e]).length;t<a;t++){var i=h(".devicesList-item-container[data-key="+e[t]+"]");i.attr("disabled",!0).addClass("disabled"),i.data("viewObj")._status.disabled=!0}},enable:function(e){null==e&&(e=this._keys);for(var t=0,a=(e=h.isArray(e)?e:[e]).length;t<a;t++){var i=h(".devicesList-item-container[data-key="+e[t]+"]"),s=i.data("viewObj");s._status.disabled&&(i.removeAttr("disabled").removeClass("disabled"),s._status.disabled=!1)}},selectItems:function(e){null==e&&(e=this._keys);for(var t=0,a=(e=h.isArray(e)?e:[e]).length;t<a;t++){var i=h(".devicesList-item-container[data-key="+e[t]+"]");i.hasClass("item-selected")||i.trigger("click")}},unselectItems:function(e){null==e&&(e=this._keys);for(var t=0,a=(e=h.isArray(e)?e:[e]).length;t<a;t++){var i=h(".devicesList-item-container[data-key="+e[t]+"]");i.hasClass("item-selected")&&i.trigger("click")}}})})(jQuery),(m=>{m.su.Widget.register("devicesList",{settings:{multiselect:{attribute:"multiselect",defaultValue:!1},maxLine:{attribute:"max-line",defaultValue:4},noLogo:{attribute:"no-logo",defaultValue:!1},numPerPage:{attribute:"num-per-page",defaultValue:15},spliter:{attribute:"spliter-id",defaultValue:null},scroll:{attribute:"scroll",defaultValue:!0}},listeners:[{selector:".devicesList-item-container .devicesList-item-action a",event:"click",callback:function(e,t){var a;e.stopPropagation(),e.preventDefault(),m(this).hasClass("disabled")||(e=e.target||e.srcElement,e=m(e).closest(".devicesList-item-container").data("viewObj")._relatedData,a=m(this).data("type"),t.dom().triggerHandler("ev_list_action_click",[e,a,m(this)]),m(window).trigger("ev_remove_tip"))}},{selector:".devicesList-item-container",event:"click",callback:function(e,t){e.stopPropagation();var e=e.target||e.srcElement,a=m(e).closest(".devicesList-item-container");if(!a.hasClass("disabled")){var i=a.data("viewObj")._relatedData;if(t.settings.multiselect){var a=a.find("div[widget=checkbox]").data("viewObj"),s=!a._status.checked,n=(m(e).closest("div[widget=checkbox]")&&(s=!s),t._selectedData);if(s){a.setValue(!1);for(var l=0,o=n.length;l<o;l++)if(i.key==n[l].key){n.splice(l,1);break}m(this).removeClass("selected")}else a.setValue(!0),n.push(i),m(this).addClass("selected");t.dom().triggerHandler("ev_item_click")}else t.selectItem(i.key),t.dom().triggerHandler("ev_item_click",[i.data])}}},{selector:".devicesList-paging-container .paging-btn",event:"click",callback:function(e,t){var a=parseInt(m(this).text());t.dom().find(".paging-btn-num");isNaN(a)&&(a=m(this).hasClass("pageing-btn-prev")?1:t.settings.totalPage),t.settings.currentPage=a,t.syncData(t._keys,void 0,"pageChange")}}],init:function(e){var t,a=this.dom(),i=this.settings;this.settings.currentPage=1,this._keys=[],this._selectedData=[],this._disabledData=[],i.configs.initCallback&&(t="false"!==sessionStorage.getItem("list-status"),i.configs.initCallback(t,a.parent(),m("#"+i.spliter)),this.dom().triggerHandler("ev_list_memery",[t])),i.scroll&&0===a.find(".ps__rail-y").length&&m.su.scrollbar({ele:a[0]})},render:function(){for(var i=this,e=this.settings,t=this.dom(),a=[],s=0;s<e.configs.items.length;s++)a.push(e.configs.items[s].type.toLowerCase());a.sort(),a.push("list"),a=a.join("-"),t.addClass("devicesList-container widget-container "+a);var n='<ul class="devicesList-content-container"></ul>',n=(n=(n+='<div class="paging-go">')+'<div widget="textbox" label-field="{GRID.PAGE_TO}"></div>'+('<div widget="button" text="'+m.su.CHAR.COMMON.GO+'"></div>'),t.append(n+="</div>"),t.find('.paging-go div[widget="textbox"]')),t=t.find('.paging-go div[widget="button"]');this._pagingTextbox=new m.su.widgets.textbox({id:n}),this._pagingButton=new m.su.widgets.button({id:t}),this._pagingTextbox.render(),this._pagingButton.render(),this._pagingTextbox.dom().on("ev_view_change",function(){var e=i._pagingTextbox.getValue(),e=parseInt(e,10)-1;m.isNumeric(e)&&e%1==0&&0<=e?i._pagingButton.dom().removeClass("disabled"):i._pagingButton.dom().addClass("disabled")}),this._pagingButton.dom().addClass("disabled"),this._pagingTextbox.dom().on("keydown",function(e){var t,a;108!==e.keyCode&&13!==e.keyCode||(e=i._pagingTextbox.getValue(),e=parseInt(e,10),t=isNaN(e)?0:e,(a=i.settings.totalPage)<=e&&0<a?e=a:t<1&&(e=1),m.isNumeric(e)&&e!==i.settings.currentPage&&(i.settings.currentPage=e,i.syncData(i._keys,void 0,"pageChange"),i._pagingButton.dom().addClass("disabled")))}),this._pagingButton.dom().on("ev_button_click",function(){var e=i._pagingTextbox.getValue(),e=parseInt(e,10),t=isNaN(e)?0:e,a=i.settings.totalPage;a<=e&&0<a?e=a:t<1&&(e=1),"number"===m.type(e)&&e!==i.settings.currentPage&&(i.settings.currentPage=e,i.syncData(i._keys,void 0,"pageChange"))})},syncData:function(e,t,a){this.dom().find(".devicesList-content-container").empty(),this._keys=e,"pageChange"!==a&&(this._selectedData=[],this._disabledData=[]),this.dom().triggerHandler("ev_store_render_items",[e])},renderModels:function(e,t,a,i){var s=this.dom().find(".devicesList-content-container"),n=this.settings,l=n.configs.key||"id",o=(n.currentPage-1)*n.numPerPage,d=(d=o+n.numPerPage)>=t.length?t.length:d;m.isArray(t)&&0!==t.length?this.dom().removeClass("empty"):this.dom().removeClass("empty").addClass("empty");for(var r=t.length,c=o;c<d;c++){var u=t[c].getData(),h=t[c][e].getValue(),p=!!this._selectedData.find(function(e){return e.key===h}),g=-1!==this._disabledData.indexOf(h),p=m('<li id="'+this.domId+"-item-"+c+'" data-key="'+m.su.escapeHtml(u[l])+'" class="devicesList-item-container'+(p?" selected":"")+(g?" disabled":"")+'"></li>'),g=m(this.renderContent(u,i,r)),g=(p.append(g).appendTo(s),new m.su.widgets.form({id:p}));g.render(),g._relatedData={key:h,data:u},n.multiselect?(g=m('<div widget="checkbox" class="devicesList-item-checkbox" name="devicesList-item-checkbox"></div>').appendTo(p),new m.su.widgets.checkbox({id:g}).render(),p.addClass("multi-select")):p.addClass("single-select")}this.renderdevicesList(t.length)},renderdevicesList:function(e){var n=this.dom(),l=this.settings,t=l.maxLine,a=l.numPerPage,o=(n.find(".devicesList-item-container").eq(0).outerHeight(!0),Math.ceil(e/a));function i(){var e='<div class="devicesList-paging-container paging-container disabled">',t=(e=e+'<div class="paging-wrap">'+'<div class="paging-btns inline-block">',l.currentPage-3),a=l.currentPage+2<5?5:l.currentPage+2,i=o<a?o:a,a=t<0?0:i-5<=t?i-5:t;if(5<o&&(e+='<a href="javascript:void(0);" class="paging-btn pageing-btn-prev" data-index="prev"><span class="icon"></span><span class="text"></span></a>'),e+='<div class="num-buttons-container">',2<=i-(a=a<0?0:a))for(var s=a;s<i;s++)e=(e=e+'<a href="javascript:void(0);" class="paging-btn paging-btn-num pageing-btn-'+s+'"><span class="icon"></span>')+'<span class="text">'+(s+1)+"</span></a>";e+="</div>",5<o&&(e+='<a href="javascript:void(0);" class="paging-btn pageing-btn-next" data-index="next"><span class="icon"></span><span class="text"></span></a>'),e+="</div></div></div>",n.find(".devicesList-paging-container").remove(),n.find(".paging-go").before(m(e)),n.find(".pageing-btn-"+(l.currentPage-1)).addClass("current")}a<e?l.totalPage=o:e=1,i(),o<=5?n.find(".paging-go").hide():n.find(".paging-go").show()},renderContent:function(e,t,a){if(null!=e){var i=this.settings.configs.items,s=[];if(t=t&&!m.isArray(t)?[t]:t)for(var n=0;n<t.length;n++)s.push(e[t[n]]);for(var l='<div class="devicesList-item-content '+s.join(" ")+'">',o=0,d=i.length;o<d;o++){var r=i[o].type.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}),c=i[o].dataIndex;"logo"==r?this.settings.noLogo||(l+='<div class="logo-container"><span class="icon"></span></div>'):(l=l+('<div class="devicesList-item devicesList-item-'+r+(null==e[c]||""===e[c]?" empty":""))+'"><span class="content-label">'+(i[o].label?i[o].label+": ":"")+"</span>",i[o].renderer?l+='<span class="content">'+i[o].renderer.call(i[o],e[c],e,a)+"</span></div>":l+='<span class="content">'+m.su.escapeHtml(e[c])+"</span></div>")}return l+="</div>"}},getSelected:function(){for(var e=this._selectedData,t=[],a=0,i=e.length;a<i;a++)t.push(e[a].data);return t},selectItem:function(e){var t=this.dom(),a=t.find("li"),e=a.filter('[data-key="'+e+'"]');0!==e.length&&(a.removeClass("selected"),e.addClass("selected"),this.settings.multiSelect?-1===this._selectedData.indexOf(e.data("viewObj")._relatedData)&&this._selectedData.push(e.data("viewObj")._relatedData):this._selectedData=[e.data("viewObj")._relatedData],a=e.offset().top-t.offset().top,t.scrollTop(a))},unSelectAll:function(){this._selectedData=[],this.dom().find("li.selected").removeClass("selected")},disableItem:function(e){var a=this.dom().find("li");e=m.isArray(e)?e:[e],m.extend(this._disabledData,e),m.each(e,function(e,t){a.filter('[data-key="'+t+'"]').addClass("disabled")})},enableItem:function(e){var a=this.dom();e?(e=m.isArray(e)?e:[e],this._disabledData=m(this._disabledData).not(e).get(),m.each(e,function(e,t){a.find("li").filter('[data-key="'+t+'"]').removeClass("disabled")})):(this._disabledData=m(this._disabledData).not(e).get(),a.find("li.disabled").removeClass("disabled"))},goToPage:function(e){var t,a,i;e&&(t=isNaN(e)?0:e,(i=(a=this.settings).totalPage)<=e&&0<i?e=i:t<1&&(e=1),a.currentPage=e,this.syncData(this._keys,void 0,"pageChange"))},getPageByKey:function(e){for(var t=1,a=0;a<this._keys.length;a++)if(this._keys[a]===e){t=a+1;break}return Math.ceil(t/this.settings.numPerPage)},toggleMultiSelect:function(e){this.settings.multiselect=e}})})(jQuery),$.su.Widget.register("button",{settings:{text:{attribute:"text",defaultValue:""},iconCls:{attribute:"icon-cls",defaultValue:""},rightIconCls:{attribute:"right-icon-cls",defaultValue:""},enableToggle:{attribute:"enable-toggle",defaultValue:!1},toggleHander:{attribute:"toggle-hander",defaultValue:null},pressedCls:{attribute:"pressed-cls",defaultValue:"pressed"},pressed:{attribute:"pressed",defaultValue:!1},btnCls:{attribute:"btn-cls",defaultValue:"button-button"},handler:{attribute:"handler",defaultValue:null},tipText:{attribute:"tip-text",defaultValue:""},dataType:{attribute:"data-type",defaultValue:""}},listeners:[{selector:"",event:"click",condition:function(e){e=e.settings.enableToggle;return"true"===e||!0===e},callback:function(e,t){e.preventDefault();var e=$(this),t=t.settings,a="false"===(a=t.pressed).toString()?(e.addClass(t.pressedCls),!0):(e.removeClass(t.pressedCls),!1);e.attr("pressed",a),t.pressed=a,"function"===$.type(t.toggleHander)&&t.toggleHander.call(this,a)}},{selector:"a.button-button",event:"mousedown",callback:function(e,t){t.getContainer().hasClass("disabled")||t.getContainer().hasClass("clicked")||t.getContainer().addClass("clicked")}},{selector:"a.button-button",event:"mouseup mouseleave",callback:function(e,t){e.stopPropagation(),$("#global-tip").hide(),t.getContainer().hasClass("clicked")&&t.getContainer().removeClass("clicked")}},{selector:"a.button-button",event:"click",callback:function(e,t){e.preventDefault(),t.getContainer().hasClass("disabled")?e.stopPropagation():t.dom().triggerHandler("ev_button_click")}}],init:function(e){},render:function(){var e=this.dom(),t=this.settings,a=t.btnCls||"",i=t.text||"",s=(e.addClass(t.cls+"button-container "+(!1===t.labelField?"label-empty":"")+(""!==t.iconCls?" icon-button":"")),e.addClass(""!==t.rightIconCls?"right-icon-button":""),"");null!==t.labelField&&(s=(s+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel text-fieldlabel">'+t.labelField+"</label>",t.labelField&&(s+='<span class="widget-separator">'+t.separator+"</span>"),s+="</div>"),s=(s+='<div class="widget-wrap-outer button-wrap-outer"><div class="widget-wrap button-wrap">')+'<a href="javascript:void(0);" class="'+a+'" type="button" data-type="'+t.dataType+'" title="'+i+'"><span class="button-button-before"></span>',""!==t.iconCls&&(s+='<span class="button-icon '+t.iconCls+'"><span class="icon"></span></span>'),s+='<span class="text button-text">'+i+"</span>",""!==t.rightIconCls&&(s+='<span class="right-button-icon '+t.rightIconCls+'"><span class="icon"></span></span>'),s+='</a></div><span class="button-loading"></span>',null!=t.tips&&null!=t.tips&&(s=s+('<div class="widget-tips textbox-tips '+t.tipsCls)+'"><div class="content tips-content"></div></div>'),s=s+('<div widget="errortip" error-cls="'+t.errorTipsCls)+'"></div></div>',t.tipText&&(s+='<div widget="toolTip"></div>'),e.empty().append(s),!0===t.enableToggle&&(a=t.pressed,e.attr("pressed",a),"true"===a.toString())&&e.addClass(t.pressedCls),this.setTips(t.tips)},setText:function(e){var t=this.settings,a=this.getContainer(),i=a.find("a.button-button"),a=a.find("a.button-button span.button-text");e&&(t.text=e,a.html(e),i.attr("title",e))},getText:function(){return this.settings.text},setValue:function(e){},isLoading:function(){return this.dom().hasClass("loading")},loading:function(e){var t=this.dom();!1===e?(t.removeClass("loading"),this.enable()):(t.addClass("loading"),this.disable())},setIconCls:function(e){this.dom().find(".button-icon").removeClass().addClass("icon button-icon "+e)},status:function(e){return void 0!==e&&(this.dom().removeClass(this.dom().data("status")),this.dom().data("status",e),this.dom().addClass(e)),this.dom().data("status")},setLoadingStatus:function(e){this.dom().addClass("loading"),this.disable(),this.setTips(e)},cancelLoadingStatus:function(){this.dom().removeClass("loading"),this.enable(),this.setTips()}}),$.su.Widget.register("file",{settings:{accept:{attribute:"type-accept",defaultValue:""},inputCls:{attribute:"input-cls",defaultValue:"l"},buttonCls:{attribute:"button-cls",defaultValue:"inline-block"},buttonText:{attribute:"button-text",defaultValue:$.su.CHAR.OPERATION.FILEBUTTONTEXT},blankText:{attribute:"blank-text",defaultValue:$.su.CHAR.OPERATION.FILEBLANKTEXT},extension:{attribute:"extension",defaultValue:"txt, ai, docx"},extensionErrorText:{attribute:"extension-error-text",defaultValue:$.su.CHAR.ERROR["00000074"]},tipText:{attribute:"tip-text",defaultValue:""},paramName:{attribute:"param-name",defaultValue:"file"},note:{attribute:"note",defaultValue:""},multiple:{attribute:"multiple",defaultValue:!1},clearLast:{attribute:"clearLast",defaultValue:!1},showValue:{attribute:"show-value",defaultValue:!1},autoReset:{attribute:"auto-reset",defaultValue:!1}},listeners:[{selector:"div.file-text-wrap-after-icon",event:"click",callback:function(e,t){var a,i,s,n;t.getContainer().hasClass("disabled")||(a=t.fileName,i=$(this),s=t.dom(),n=i.closest("div.text-list-wrap").find("label").attr("data-file-id"),t=$.su.getDefaultEvent(t,function(){$("#global-tip").css("visibility","hidden"),i.closest("div.text-list-wrap").remove(),s.find("input.file-input").val(""),s.triggerHandler("ev_view_change",[{"type":"value","value":null}]),0===s.find(".text-list-wrap").length&&s.triggerHandler("ev_file_empty",[a])}),e.preventDefault(),e.stopPropagation(),s.triggerHandler("ev_file_delete",[a,n,t.ev]),t.exe())}},{selector:"div.file-button",event:"click",callback:function(e,t){t.getContainer().hasClass("disabled")||(e.preventDefault(),e.stopPropagation(),t.settings.autoReset&&t.resetFile(),e=$.su.getDefaultEvent(t,function(){t.showFileWindow()}),t.dom().triggerHandler("ev_file_click",[e.ev]),e.exe())}},{selector:"label.file-text",event:"click",callback:function(e,t){t=t.getContainer();t.hasClass("disabled")||(e.preventDefault(),e.stopPropagation(),t.find("div.file-button").click())}},{selector:function(){return{parent:this.dom().find("input.file-input")}},event:"change",callback:function(e,t){var a=t.getContainer();if(!a.hasClass("disabled")){var i=$(this).val();if(t.settings.multiple){var s=this.files;l=[];for(var n=0;n<s.length;n++)l.push(s[n].name);a.find("label.file-text").html(l.join(",")),a.find("label.file-text").attr("title",l.join(",")),l?t.dom().triggerHandler("ev_file_change",[l]):a.find("label.file-text").text(t.settings.blankText)}else{var l;l=(l=i.toString().match(/.+(?=\\)/g))&&l[0]&&l[0].length?i.substring(l[0].length+1):i,a.find("label.file-text").html(l),a.find("label.file-text").attr("title",l),l?(t.fileName=l,this.files?t.dom().triggerHandler("ev_file_change",[l,this.files]):t.dom().triggerHandler("ev_file_change",[l])):(a.find("label.file-text").text(t.settings.blankText),t.dom().triggerHandler("ev_file_change",[l]))}}}}],init:function(){this.settings.configs&&$.extend(this.settings,this.settings.configs)},render:function(){var e=this.dom(),t=this.settings,a=this,i=(e.addClass(t.cls+"text-container file-container"),""),s=t.accept?'accept="'+t.accept+'"':"",i=(null!==t.labelField&&(i=(i+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel text-fieldlabel">'+t.labelField+"</label>",""!==t.labelField&&(i+='<span class="widget-separator">'+t.separator+"</span>"),i+="</div>"),i=(i=(i=(i=(i+='<div class="file-wrap-outer widget-wrap-outer">')+'<div class="file-wrap widget-wrap">'+'<div class="widget-wrap text-wrap hover-errortip">')+'<span class="text-wrap-before"></span>'+'<span class="text-wrap-inner">')+('<label class="file-text text-text '+t.inputCls+'">'+t.blankText+"</label>")+"</span>")+'<span class="text-wrap-after"></span>'+"</div>",t.note&&(i+='<div class="note"><span>'+t.note+"</span></div>"),i=(i=(i=(i=(i=(i+='<div class="button-container file-button-container '+t.buttonCls+'">')+('<div widget="button" id="'+this.domId+'-btn" class="file-button outline-button" type="button" text="'+t.buttonText+'"></div>'))+"</div>"+('<div widget="errortip" error-cls="'+t.errorTipsCls+'"></div>'))+'<div class="text-list-wrap-out"></div>'+('<div widget="progressbar" id="'+this.domId+'-pgb" class="file-progress"></div>'))+"</div>"+('<div widget="errortip" error-cls="'+t.errorTipsCls+'">'))+"</div>"+"</div>",t.tips&&(i=(i+='<div class="widget-tips textbox-tips '+t.tipsCls+'">')+'<div class="content tips-content">'+t.tips+"</div></div>"),i+="</div>",t.tipText&&(i+='<div widget="toolTip"></div>'),e.append(i),this.getContainer()),n='<form method="post" style="display:none;" id="'+this.domId+'_form" name="form" enctype="multipart/form-data">';t.multiple?n+='<input type="file" name="'+t.paramName+'" multiple '+s+' class="file-input">':n+='<input type="file" name="'+t.paramName+'" class="file-input" '+s+">",n+="</form>",i.find("div.file-wrap").append($(n).prop("single",!0)),i.find("div.file-wrap").append('<div class="file-text-hover"></div>'),e.find("div[widget=button]").each(function(){var e=$(this);a.browseBtn=new $.su.widgets.button({id:e}),a.browseBtn.render()}),e.find("div[widget=progressbar]").each(function(){var e=$(this);a.progressbar=new $.su.widgets.progressbar({id:e}),a.progressbar.render()}),this.setTips(t.tips),a.progressbar.hide()},getFileName:function(){var e=this.dom().find("input.file-input");return void 0===e.val()?"":e.val()},getLoadFileName:function(){return this.fileName},resetFile:function(){var e=this.dom();e.find("input.file-input").val(""),e.find("label.file-text").text(this.settings.blankText).attr("title",this.settings.blankText),this.dom().triggerHandler("ev_file_reset")},hideBrowseBtn:function(e){this.browseBtn.hide(e)},showBrowseBtn:function(e){this.browseBtn.show(e)},appendFileText:function(e,t){var e=e||this.getLoadFileName(),a=$.su.measureText(e),a=a?Math.floor(330*$.su.len(e)/a):15,i=$.su.sub(e,a),s=this.getContainer().find("div.text-list-wrap-out"),n='<div class="text-list-wrap hover-errortip">',n=(n=(n+='<div class="file-text-wrap-container">')+'<div class="file-text-wrap-before-icon icon"></div>'+'<div class="text-list-wrap-inner">')+('<label class="file-list-text '+this.settings.inputCls+'"data-file-id="'+(t||"")+'" data-tip="'+(a>=$.su.len(e)?"":$.su.escapeHtml(e))+'">'+i+"</label>");s.append(n=(n=(n+="</div>")+'<div class="file-list-status"></div>'+"</div>")+'<div class="file-text-wrap-after-icon icon"></div>'+"</div>"),this.dom().find("[widget=errortip]").hide()},setStartLoadingStatus:function(e){this.appendFileText();var t=this.getContainer(),a=t.find("div.text-list-wrap"),i=a.length;t.addClass("disabled"),$(a[i-1]).addClass("loading"),$(a[i-1]).find(".file-list-status").addClass("loading-btn"),$(t).find(".button-button").addClass("loading"),this.progressbar.setValue(0,0),this.progressbar.show(),this.progressbar.update(95,e)},setEndLoadingStatus:function(i){var s=this;this.progressbar.update(100,1e3,function(){setTimeout(function(){s.progressbar.hide(),s.progressbar.setValue(0,0);var e=s.getContainer(),t=(e.removeClass("disabled"),e.find("div.text-list-wrap")),a=t.length;$(t[a-1]).removeClass("loading"),$(t[a-1]).find(".file-list-status").removeClass("loading-btn"),$(e).find(".button-button").removeClass("loading"),i&&i()},300)})},loadFileSuccess:function(a,i){var s=this;this.setEndLoadingStatus(function(){var e=s.getContainer().find("div.text-list-wrap"),t=e.length;$(e[t-1]).addClass("success"),i&&$(e[t-1]).find("label").attr("data-file-id",i),s.settings.clearLast&&2<=t&&e[0].remove(),a&&a()})},loadFileFailed:function(a){var i=this;this.setEndLoadingStatus(function(){var e=i.getContainer().find("div.text-list-wrap"),t=e.length;$(e[t-1]).addClass("failed"),$(e[t-1]).find(".file-list-status").append($.su.CHAR.OPERATION.FILEDATATIP),i.settings.clearLast&&2<=t&&e[0].remove(),a&&a()})},clearFiles:function(){this.dom().find(".text-list-wrap-out").empty(),this.resetFile()},setValue:function(e){this.settings.showValue&&(this.getContainer().find("div.text-list-wrap-out").empty(),null===e?this.dom().find("input.file-input").val(""):this.appendFileText(e))},getDataResult:function(){var e=this,t=this.getContainer().find(".file-input")[0].files[0],a=new FileReader;a.readAsDataURL(t),a.onload=function(){e.dom().triggerHandler("ev_data_reader",[a.result,t.type])}},getFiles:function(){return this.getContainer().find(".file-input")[0].files},disable:function(){this.getContainer().addClass("disabled")},enable:function(){this.getContainer().removeClass("disabled")},showFileWindow:function(){this.getContainer().find("input.file-input").click()}}),$.su.Widget.register("progressbar",{settings:{text:{attribute:"text",defaultValue:""},unit:{attribute:"unit",defaultValue:"%"},_timeout:{attribute:"timeout",defaultValue:"0"},duration:{attribute:"duration",defaultValue:1e3},value:{attribute:"value",defaultValue:0},url:{attribute:"url",defaultValue:null},animate:{attribute:"animate",defaultValue:!0},showPercentage:{attribute:"show-percentage",defaultValue:!0},fn:{attribute:"fn",defaultValue:null},ptype:{attribute:"ptype",defaultValue:"horizontal"},tipText:{attribute:"tip-text",defaultValue:""},step:{attribute:"step",defaultValue:!1},multiSection:{attribute:"multi-section",defaultValue:!1}},init:function(){var e=this.settings;!1!==e.step&&(e.step=parseInt(e.step,10))},render:function(){var e=this.dom(),t=this.settings,a=t.ptype,i=t.value,s=(e.addClass(t.cls+"progressbar-container progressbar-"+a+" "+(!1===t.labelField?"label-empty":"")+(t.multiSection?" multi-section":"")),"");if(null!==t.labelField&&(s=(s+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel processbar-fieldlabel">'+t.labelField+"</label>",t.labelField&&(s+='<span class="widget-separator">'+t.separator+"</span>"),s+="</div>"),s=(s=s+'<div class="widget-wrap-outer progressbar-wrap-outer">'+'<div class="widget-wrap progressbar-wrap">')+'<div class="widget-wrap progressbar-content">'+'<div class="progressbar-value">',t.multiSection){var n=t.configs.subsection;t.subsectionValue={};for(var l=0;l<n.length;l++)t.subsectionValue[n[l].name]=0,s+='<span class="sub-section sub-section-'+l+" "+n[l].name+'"></span>'}s+="</div></div>",""==t.text&&!t.showPercentage||(s+='<div class="progressbar-text">',t.showPercentage&&(s+='<span class="progressbar-percentage">'+i+t.unit+"</span>"),""!=t.text&&(s+='<span class="progressbar-text">'+t.text+"</span>"),s+="</div>"),s=s+'</div><div widget="errortip" error-cls="'+t.errorTipsCls+'"></div><span class="icon progressbar-loading"></span>',null!=t.tips&&null!=t.tips&&(s=(s+='<div class="widget-tips textbox-tips '+t.tipsCls+'">')+'<div class="content tips-content">'+t.tips+"</div></div>"),s+="</div>",t.tipText&&(s+='<div widget="toolTip"></div>'),e.append(s),this.setTips(t.tips),this.childrenDom={},this.childrenDom.container=this.getContainer(),this.childrenDom.progressbarBox=this.childrenDom.container.find("div.progressbar-content"),this.childrenDom.progressbarBar=this.childrenDom.progressbarBox.children("div.progressbar-value"),this.childrenDom.percentageBox=this.childrenDom.container.find("span.progressbar-percentage")},getValue:function(){return this.settings.value},setValue:function(e,t){if(null!=e){var a=this.settings,i=e;if(a.prevValue=a.value,a.multiSection&&"object"==typeof e){var s,n=this.getContainer(),l=parseFloat(a.value)?parseFloat(a.value):0;for(s in e){var o=a.subsectionValue[s];void 0!==o&&(o=parseFloat(e[s])-parseFloat(o),a.subsectionValue[s]=e[s],l+=o)}for(s in i=l+a.unit,a.subsectionValue){var d=n.find(".sub-section."+s),r=parseFloat(a.subsectionValue[s])/l*100+"%";d.css("width",r)}}a.value=i,a.animate?this.animate({percentageStart:a.prevValue,percentageEnd:i,duration:t||a.duration}):this.updateViewByPercentageVal(e)}},update:function(e,t,a){var i=this.settings,s=e;i.prevValue=i.value,i.value=s,this.animate({percentageStart:i.prevValue,percentageEnd:e,duration:t||i.duration,callback:!!a&&a})},animate:function(e){var a=this,i=this.settings,t=this.getContainer(),s=i.ptype,n=i.unit,l="horizontal"===s?"width":"height",s=null===e.percentageStart?0:e.percentageStart,s=parseInt(s,10),o=parseInt(e.percentageEnd,10),d="number"===$.type(parseInt(e.duration,10))?parseInt(e.duration,10):500,r=e.callback||null,c=s||0,e=t.find("div.progressbar-content"),u=e.children("div.progressbar-value"),h=t.find("span.progressbar-percentage"),p=(u.stop(!0,!0),e[l]()),g=(this.updateViewByPercentageVal(s),parseInt(d/Math.abs(o-s),10)),m=(new Date).getTime();clearInterval(i._timeout),i._timeout=setInterval(function(){var e=(new Date).getTime(),t=e-m,t=Math.round(t/g);m=e,$.isNumeric(t)&&c!=o?(c=o<c?(c-=t)<o?o:c:o<(c+=t)?o:c,i.percentageCurrent=c.toFixed(1)/100,!1!==i.step?a.updateViewByPercentageVal(c):(e="width"==l?{"width":parseInt(p*c/100,10)}:{"height":parseInt(p*c/100,10)},u.clearQueue().animate(e,g,function(){h.html(c+n)}))):(clearInterval(i._timeout),i._timeout=0,a.updateViewByPercentageVal(o),r&&r.call(this))},g)},reset:function(){var e=this.settings,t=this.getContainer(),a=e.unit,e="horizontal"===e.ptype?"width":"height";this.stop();var i=t.find("div.progressbar-content").children("div.progressbar-value"),t=t.find("span.progressbar-percentage");i.css("width"==e?{"width":0}:{"height":0}),t.html(0+a)},stop:function(){clearInterval(this.settings._timeout)},setText:function(e){this.getContainer().find("span.progressbar-text").text(e)},hide:function(){this.getContainer().css("display","none")},show:function(e){this.getContainer().fadeIn(void 0===e?150:e+1)},hideBar:function(){var e=this.dom();e.find("div.progressbar-content").hide(),e.addClass("hide-bar")},showBar:function(){var e=this.dom();e.find("div.progressbar-content").show(),e.removeClass("hide-bar")},updateViewByPercentageVal:function(e){var t,a,i,s,n,l=this.childrenDom,o=this.settings;null!==o&&(t=l.container,i=o.ptype,a=o.unit,i="horizontal"===i?"width":"height",s=l.progressbarBar,l=l.percentageBox,n=e+"%",!1!==o.step&&(n=(e*o.step/100).toFixed(0)/o.step+"%"),s.css(i,n),0<s.parents("#devices-drawer").length&&$("#"+t.attr("id")+" .progressbar-value").css(i,n),l.text(e+a))},setLoadingStatus:function(){this.dom().addClass("loading")},cancelLoadingStatus:function(){this.dom().removeClass("loading")}}),$.su.Widget.register("password",{settings:{hint:{attribute:"hint",defaultValue:null},validateIcon:{attribute:"validate-icon",defaultValue:!1},showLevel:{attribute:"show-level",defaultValue:!1},allowBlank:{attribute:"allow-blank",defaultValue:!0},encrypt:{attribute:"encrypt",defaultValue:$.su.encrypt},encryptParam:{attribute:"encrypt-param",defaultValue:["n","e"]},_minLength:{attribute:"min-length",defaultValue:2},_maxLength:{attribute:"max-length",defaultValue:16},vtype:{attribute:"vtype",defaultValue:"password"},invalidText:{attribute:"invalid-text",defaultValue:$.su.CHAR.VTYPETEXT.INVALIDTEXT},blankText:{attribute:"blank-text",defaultValue:$.su.CHAR.VTYPETEXT.BLANKTEXT},allowVisible:{attribute:"allow-visible",defaultValue:!0},tipText:{attribute:"tip-text",defaultValue:""},autoComplete:{attribute:"auto-complete",defaultValue:"current-password"},readOnly:{attribute:"readOnly",defaultValue:!1}},listeners:[{selector:"input.password-text",event:"click focus",callback:function(e,t){e.preventDefault(),t.setFocus()}},{selector:".text-wrap-inner",event:"mouseenter",callback:function(e,t){t.dom().addClass("hover")}},{selector:".text-wrap-inner",event:"mouseleave",callback:function(e,t){t.dom().removeClass("hover")}},{selector:"input.password-text",event:"blur",callback:function(e,t){var a=t.dom(),i=t.settings,s=a.find("input.password-visible"),a=a.find("input.password-hidden"),i=(i.passwordVisible?s:a).val();t.removeFocus(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}]),t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":i}]),t.dom().triggerHandler("ev_password_blur")}},{selector:"input.password-text",event:"keyup",callback:function(e,t){var a=$(this).val();t.levelCheck(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}])}},{selector:"span.allow-visible-btn",event:"click",callback:function(e,t){var a=t.dom(),i=t.settings,s=a.find("input.password-visible"),n=a.find("input.password-hidden"),a=a.hasClass("disabled"),l=$(this),o="";a||(i.passwordVisible?(o=s.val(),n.val(o),s.css("display","none"),n.css("display","block"),l.removeClass("visible"),i.passwordVisible=!1,t.dom().triggerHandler("ev_password_hide")):(o=n.val(),s.val(o),n.css("display","none"),s.css("display","block"),l.addClass("visible"),i.passwordVisible=!0,t.dom().triggerHandler("ev_password_show")))}}],init:function(){var e,t=this.settings;t.vtype&&(e=t.vtype,t.vtypeText&&(t.vtype.vtypeText=t.vtypeText),t.vtype=e)},render:function(){var e=this.dom(),t=this.settings,a=""===t.tips?"":" tips",i=t.hint,a=(e.addClass(t.cls+"text-container password-container "+(t.showLevel?"level":"")+a+(""===t.allowVisible?"":" visible")),""),i=(null!==t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel text-fieldlabel password-fieldlabel">'+t.labelField+"</label>",""!==t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>"),a=(a=(a+='<div class="widget-wrap-outer text-wrap-outer password-wrap-outer '+(t.allowVisible?"allow-visible":"")+'">')+'<div class="widget-wrap text-wrap password-wrap hover-errortip">'+'<span class="text-wrap-before"></span>')+'<span class="text-wrap-inner password-wrap ">'+('<input type="password" autocomplete="'+t.autoComplete+'"'+(t.readOnly?" readOnly":"")+(i?' placeholder="'+i+'" ':"")+' class="text-text password-text password-hidden '+t.inputCls+'"/>'),t.allowVisible&&(t.passwordVisible=!1,a+='<input type="text"'+(i?' placeholder="'+i+'" ':"")+(t.readOnly?" readOnly":"")+' class="text-text password-text password-visible '+t.inputCls+'"/>'),a+="</span>",t.showLevel&&(a=(a=(a=(a+='<div class="password-level hidden '+t.inputCls+'">')+'<span class="level low">'+$.su.CHAR.OPERATION.STRENGTH_LOW+"</span>")+'<span class="level middle">'+$.su.CHAR.OPERATION.STRENGTH_MIDDLE+"</span>")+'<span class="level high">'+$.su.CHAR.OPERATION.STRENGTH_HIGH+"</span></div>"),a+='<span class="text-wrap-after"></span>',t.allowVisible&&(a=(a+='<div class="allow-visible-wrapper"><span class="icon allow-visible-btn"></span>')+'<span class="text allow-visible-text">'+$.su.CHAR.OPERATION.SHOW+"</span></div>"),a+="</div>",t.validateIcon&&(a+='<span class="widget-validate-icon"></span>'),null!=t.tips&&null!=t.tips&&(a=(a+='<div class="widget-tips textbox-tips '+t.tipsCls+'">')+'<div class="content tips-content">'+t.tips+"</div></div>"),a=(a+='<div widget="errortip" error-cls="'+t.errorTipsCls+'">')+"</div>"+"</div>",t.tipText&&(a+='<div widget="toolTip"></div>'),e.append(a),e.find("div.progressbar-container").addClass("hidden"),this.getContainer()),a=i.find("input.password-hidden");i.find("input.password-visible").css("display","none"),a.css("display","block"),this.setTips(t.tips)},levelCheck:function(){var e,t,a,i,s,n=this.settings;n.showLevel&&(i=(e=this.getContainer()).find("input.password-visible"),s=e.find("input.password-hidden"),t="",a=0,n=(t=(n.passwordVisible?i:s).val()).length,a=(/[A-Z]/g.test(t)?1:0)+(/[a-z]/g.test(t)?1:0)+(/[0-9]/g.test(t)?1:0)+(10<=n?1:0)+(/[\`\~\!\@\#\$\%\^\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\\|\/\?\.\,\<\>\x20]/g.test(t)?1:0),i=0,n<=5?a<=2?i=1:3!=a&&4!=a||(i=2):a<=1?i=1:2==a||3==a?i=2:4<=a&&(i=3),(s=e.find("div.password-level")).removeClass("level-0 level-1 level-2 level-3"),""!==t?(s.fadeIn(100).addClass("level-"+i).removeClass("hidden"),e.addClass("level")):(s.hide().addClass("hidden"),e.removeClass("level")))},setValue:function(e){this.dom().find("span.password-wrap input").val(e),this.levelCheck()},getValue:function(){return this.dom().find("span.password-wrap input").val()},setMaxLength:function(e){var t=this.dom();e=parseInt(e),"number"===$.type(e)&&t.find("span.password-wrap input").attr("maxlength",e)},doEncrypt:function(){for(var e=this.settings,t=this.getContainer(),a=e.encrypt,i=e.encryptParam,s=t.find("input.password-hidden"),t=t.find("input.password-visible"),t=(e.passwordVisible?t:s).val(),n=(this.removeFocus(),!0),l=[],o=0,d=i.length;o<d;o++){var r=i[o];if(null==e[r]||null==e[r]){n=!1;break}l[o]=e[r]}"function"==$.type(a)&&n&&a(t,l)},disable:function(){var e=this.getContainer(),t=e.find("input.password-text");e.addClass("disabled"),t.prop("disabled",!0),e.triggerHandler("ev_view_disable")},enable:function(){var e=this.getContainer(),t=e.find("input.password-text");e.removeClass("disabled"),t.prop("disabled",!1),e.triggerHandler("ev_view_enable")},setCorrect:function(){this.setNormal(),this.getContainer().addClass("correct")},setPsdShownStatus:function(e){e=e||"hide";var t=this.dom(),a=this.settings,i=t.find("input.password-visible"),t=t.find("input.password-hidden"),s=$("span.allow-visible-btn");"hide"===e?(i.css("display","none"),t.css("display","block"),s.removeClass("visible"),a.passwordVisible=!1,viewObj.dom().triggerHandler("ev_password_hide")):(t.css("display","none"),i.css("display","block"),s.addClass("visible"),a.passwordVisible=!0,viewObj.dom().triggerHandler("ev_password_show"))}}),$.su.Widget.register("slider",{settings:{showPercentage:{attribute:"show-percentage",defaultValue:!0},_width:{attribute:"width",defaultValue:255},inputBox:{attribute:"input-box",defaultValue:!0},increment:{attribute:"increment",defaultValue:1},minValue:{attribute:"min-value",defaultValue:0},maxValue:{attribute:"max-value",defaultValue:100},minSlideValue:{attribute:"min-slide-value"},maxSlideValue:{attribute:"max-slide-value"},range:{attribute:"range",defaultValue:null},unit:{attribute:"unit",defaultValue:""},value:{attribute:"value",defaultValue:0},tipText:{attribute:"tip-text",defaultValue:""},rangeSlider:{attribute:"range-slider",defaultValue:!1},poleValue:{attribute:"pole-value",defaultValue:!1},displayValue:{attribute:"display-value",defaultValue:!1},valueTip:{attribute:"value-tip",defaultValue:!0},ruler:{attribute:"ruler",defaultValue:!1},rulerType:{attribute:"ruler-type",defaultValue:"position"}},listeners:[{selector:"div.left-box input[type=text]",event:"keyup",callback:function(e,t){var a=$.su.clone(t.settings.value),i=$(this).val(),i=t.formatType(i);i&&($(this).val(i),i<=(a[0]>a[1]?a[0]:a[1]))&&(a[0]<a[1]?a[0]=i:a[1]=i,t.setValue(a))}},{selector:"div.right-box input[type=text]",event:"keyup",callback:function(e,t){var a=$.su.clone(t.settings.value),i=$(this).val(),i=t.formatType(i);i&&($(this).val(i),t.settings.rangeSlider?(a[0]<a[1]?a[0]:a[1])<=i&&(a[0]>a[1]?a[0]=i:a[1]=i,t.setValue(a)):t.setValue(i))}},{selector:"div.widget-wrap.slider-wrap",event:"click",callback:function(e,t){t.dom().hasClass("disabled")||(t.dragingHandler(e),t.triggerSliderDone())}}],init:function(){var e=this.settings;e.value=e.rangeSlider?[0,0]:0,this.leftBox=void 0,this.rightBox=void 0,e.configs&&"function"===$.type(e.configs.convertValue)&&(this.convertValue=e.configs.convertValue)},render:function(){var p,e=this.dom(),t=this.settings,a=(e.addClass(t.cls+"slider-container"+(t.rangeSlider?" range":"")),""),i=(null!==t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel slider-fieldlabel">'+t.labelField+"</label>",""!==t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>"),a+='<div class="widget-wrap-outer slider-wrap-outer">',t.inputBox&&t.rangeSlider&&(a+='<div widget="textbox" id="'+this.domId+'_left_textbox" class="left-box"></div>'),!t.inputBox&&t.rangeSlider&&t.displayValue&&(a+='<div class="display-value-container left-value"><span class="content"></span></div>'),a=(a=(a+='<div class="widget-wrap slider-wrap">')+'<div class="widget-wrap slider-content-left">'+'<div class="widget-wrap slider-content-right">')+'<div class="widget-wrap slider-content">'+'<div class="widget-value slider-value"></div>',this.convertValue?this.convertValue(t.value[0]):t.value[0]);a+="<div"+(t.valueTip?' data-tip="'+i+'"':"")+' data-pointer="top" class="widget-value-outer slider-value-outer left"></div>',t.rangeSlider&&(i=t.rangeSlider?t.value[1]:t.value,i=this.convertValue?this.convertValue(i):i,a+="<div"+(t.valueTip?' data-tip="'+i+'"':"")+' data-pointer="top" class="widget-value-outer slider-value-outer right"></div>'),a+="</div></div></div>",t.ruler&&("position"===t.rulerType?a+='<div class="ruler-container"><span>'+$.su.CHAR.PORTAL.UPPER+"</span><span>"+$.su.CHAR.PORTAL.MIDDLE+"</span><span>"+$.su.CHAR.PORTAL.LOWER+"</span></div>":"size"===t.rulerType&&(a+='<div class="ruler-container"><span>'+$.su.CHAR.PORTAL.SMALL+"</span><span>"+$.su.CHAR.PORTAL.MEDIUM+"</span><span>"+$.su.CHAR.PORTAL.LARGE+"</span></div>")),t.poleValue&&(a=(a=(a+='<div class="pole-tips-container">')+'<span class="pole-tips left-tip">'+(this.convertValue?this.convertValue(t.minValue):t.minValue)+"</span>")+'<span class="pole-tips right-tip">'+(this.convertValue?this.convertValue(t.maxValue):t.maxValue)+"</span></div>"),a+="</div>",t.inputBox&&(a+='<div widget="textbox" id="'+this.domId+'_right_textbox" class="right-box"></div>'),!t.inputBox&&t.displayValue&&(a+='<div class="display-value-container right-value"><span class="content"></span></div>'),a=a+('<div widget="errortip" error-cls="'+t.errorTipsCls)+'"></div></div>',t.tipText&&(a+='<div widget="toolTip"></div>'),e.append($(a)),t.inputBox&&t.rangeSlider&&(this.leftBox=new $.su.widgets.textbox({id:this.domId+"_left_textbox"}),this.rightBox=new $.su.widgets.textbox({id:this.domId+"_right_textbox"}),this.leftBox.render(),this.rightBox.render()),t.width&&(t._width=t.width,delete t.width),t.maxValue<=t.minValue||(t.range||(t.range=[t.minValue,t.maxValue]),e.find("div.slider-content").css({"width":t._width}),e.find("span.slider-percentage").text(t.value+t.unit),p=this,e.find("div.slider-value-outer").on("mousedown",function(e){var h,t,a;p.dom().hasClass("disabled")||($(this).parent().find("div.slider-mask").remove(),$(this).before('<div class="slider-mask"></div>'),h=$(this).hasClass("left"),t=function(e){var t,a=p.dom(),i=p.settings,s=(e.preventDefault(),p.dom().find("div.slider-wrap")),n=$("#global-tip").data("viewObj"),l=parseInt(i.maxValue,10),o=parseInt(i.minValue,10),d=parseInt(i._width,10),r=void 0!==i.minSlideValue?parseInt(i.minSlideValue,10):o,c=void 0!==i.maxSlideValue?parseInt(i.maxSlideValue,10):l,i=parseInt(i.increment,10),e=e.pageX||e.screenX,u=$.su.language.isRtl()?d-e+s.offset().left:e-s.offset().left,u=Math.round(u/d*(l-o))+o,o=Math.round(u/i)*i;c<o?o=c:o<r&&(o=r),h||(e=e-s.offset().left,u=Math.round(e/d*l),c<(t=Math.round(u/i)*i)?t=c:t<r&&(t=r)),a.triggerHandler("ev_view_change",[{"type":"value","value":p.settings.rangeSlider?[h?o:p.settings.value[0],h?p.settings.value[1]:t]:o}]),n.removeTip(),p.dom().find("div.slider-value-outer"+(h?".left":".right")).trigger("mouseenter")},a=function(){p.triggerSliderDone(),$("#global-tip").data("viewObj").removeTip(),$("html").off("mousemove",t).off("mouseup",a)},$("html").on("mousemove",t),$("html").on("mouseup",a))}))},dragingHandler:function(e){var t=this.dom(),a=this.settings,i=(e.preventDefault(),t.find("div.slider-wrap")),s=parseInt(a.maxValue,10),n=parseInt(a.minValue,10),l=parseInt(a._width,10),o=void 0!==a.minSlideValue?parseInt(a.minSlideValue,10):n,d=void 0!==a.maxSlideValue?parseInt(a.maxSlideValue,10):s,r=parseInt(a.increment,10),e=e.pageX||e.screenX,e=$.su.language.isRtl()?l-e+i.offset().left:e-i.offset().left,i=Math.round(e/l*(s-n))+n,e=Math.round(i/r)*r,c=(d<e?e=d:e<o&&(e=o),$.isArray(this.settings.value)?$.su.clone(this.settings.value):this.settings.value),u=($.isArray(c)&&(Math.abs(e-c[0])<Math.abs(e-c[1])?c[0]=e:c[1]=e),a.configs&&a.configs.values||[]);if(0<u.length&&!this.settings.rangeSlider){for(var c=a.value,h=0,p=u.length-1;h<p;h++)if(u[h]<c&&c<u[h+1]){t.triggerHandler("ev_view_change",[{"type":"value","value":c-u[h]<=u[h+1]-c?u[h]:u[h+1]}]);break}}else this.setDisplay(this.settings.rangeSlider?c:e),t.triggerHandler("ev_view_change",[{"type":"value","value":this.settings.rangeSlider?c:e}])},triggerSliderDone:function(){this.dom().triggerHandler("ev_slide_done",[{"type":"value","value":this.getValue()}])},getValue:function(){return this.settings.value},setRangeSytle:function(e,t){var a=this.dom(),i=this.settings,s=a.find("div.slider-value"),n=a.find("div.slider-value-outer.left"),l=a.find("div.slider-value-outer.right"),o=parseInt(i.maxValue,10),d=parseInt(i.minValue,10),r=parseInt(i.range[1],10),c=parseInt(i.range[0],10),u=parseInt(i._width,10),r=(r<e?e=r:e<c&&(e=c),r<t?t=r:t<c&&(t=c),u/(o-d)*(e-d)),c=u/(o-d)*(t-d),u=u/(o-d)*Math.abs(t-e);$.su.language.isRtl()?(s.css({"right":r<c?r:c,"width":u}),n.css({"right":r}),l.css({"right":c})):(s.css({"left":r<c?r:c,"width":u}),n.css({"left":r}),l.css({"left":c})),e=this.convertValue?this.convertValue(e):e,t=this.convertValue?this.convertValue(t):t,i.valueTip&&(a.find(".slider-value-outer.left").attr("data-tip",e),a.find(".slider-value-outer.right").attr("data-tip",t))},setStyle:function(e){var t=this.dom(),a=this.settings,i=t.find("div.slider-value"),s=t.find("div.slider-value-outer.left"),n=parseInt(a.maxValue,10),l=parseInt(a.minValue,10),o=parseInt(a.range[1],10),d=parseInt(a.range[0],10),o=(o<e?e=o:e<d&&(e=d),parseInt(a._width,10)),d=Math.round(o/(n-l)*(e-l));i.css({"width":d}),$.su.language.isRtl()?s.css({"right":d}):s.css({"left":d}),t.find("span.slider-percentage").html(e+a.unit),e=this.convertValue?this.convertValue(e):e,a.valueTip&&t.find(".slider-value-outer.left").attr("data-tip",e)},setValue:function(e){var t=this.settings;if(e=e||(t.rangeSlider?[0,0]:0),t.value=e,$.isArray(e))this.leftBox&&this.leftBox.setValue(e[0]<e[1]?e[0]:e[1]),this.rightBox&&this.rightBox.setValue(e[0]<e[1]?e[1]:e[0]),this.setRangeSytle(e[0],e[1]);else{if(t.disablePoints&&0<t.disablePoints.length&&-1!==t.disablePoints.indexOf(e))for(var a=t.enableValue,i=0,s=a.length;i<s;i++)if(a[i]>e){e=0!==i&&e-a[i-1]<=a[i]-e?a[i-1]:a[i],t.value=e;break}this.rightBox&&this.rightBox.setValue(e),this.setStyle(e)}this.setDisplay(e)},setDisplay:function(e){var t,a,i,s=this.settings;!s.inputBox&&s.displayValue&&(t=(s=this.dom().find(".display-value-container")).filter(".left-value").find(".content"),s=s.filter(".right-value").find(".content"),$.isArray(e)?(a=e[0]<e[1]?e[0]:e[1],i=e[0]<e[1]?e[1]:e[0],this.convertValue&&(a=this.convertValue(a),i=this.convertValue(i)),0<t.length&&t.text(a),0<s.length&&s.text(i)):(e=this.convertValue?this.convertValue(e):e,s.text(e)))},setRange:function(e){var t=this.settings;e[0]<t.minValue&&(e[0]=t.minValue),t.maxValue<e[1]&&(e[1]=t.maxValue),e[1]<e[0]&&(e[1]=e[0]-e[1],e[0]=e[0]-e[1],e[1]=e[0]+e[1]),t.range=e},setMaxValue:function(e){e=parseInt(e),"number"!==$.type(e)||(this.settings.maxValue=e,this.settings.range[1]=e,this.settings.rangeSlider)||this.setStyle(this.getValue())},setMinValue:function(e){e=parseInt(e),"number"!==$.type(e)||(this.settings.minValue=e,this.settings.range[0]=e,this.settings.rangeSlider)||this.setStyle(this.getValue())},formatType:function(e){var t=parseFloat(e,10);return/^\d+$/.test(e)&&$.isNumeric(t)?t:!(!isNaN(t)&&(t+"").length===(e+"").length)&&e},disable:function(){this.dom().addClass("disabled"),this.leftBox&&this.leftBox.disable(),this.rightBox&&this.rightBox.disable()},enable:function(){this.dom().removeClass("disabled"),this.leftBox&&this.leftBox.enable(),this.rightBox&&this.rightBox.enable()},setDisablePoints:function(e){var t=this.settings;if(t.configs&&t.configs.values){var a=t.configs.values.slice(),i=(e="array"===$.type(e)?e:[e],this.getValue()),s=e.indexOf(i);t.disablePoints=e.slice();for(var n=0,l=e.length;n<l;n++){var o=a.indexOf(e[n]);-1!==o&&a.splice(o,1)}a.sort(function(e,t){return e-t}),t.enableValue=a,-1!==s&&this.setValue(i)}},setConvertValue:function(e){this.convertValue=e,this.setValue(this.getValue())}}),(()=>{function r(e){if($.isArray(e)){for(var t,a,i=0,s=e.length;i<s;i++){if(t=e[i],isNaN(t.min)||isNaN(t.max)||isNaN(t.step)||isNaN(t.width)||t.min>=t.max||(t.max-t.min)%t.step!=0||a&&t.min!=a)return;a=t.max}return 1}}function c(e){for(var t=0,a=e.length,i=0;t<a;t++)i+=e[t].width;return{width:i,min:e[0].min,max:e[a-1].max}}function u(e,t,a){if(!$.isEmptyObject(e)){for(var i in e)if(i<t||a<i)return;return 1}}function m(e,t){for(var a,i=0,s=t.length,n=0,l=0;i<s;i++){if(e>=(a=t[i]).min&&e<=a.max){var o=a.width/(a.max-a.min),d=Math.round((e-a.min)/a.step)*a.step;n+=Math.round((e-a.min)*o),l+=Math.round(d*o);break}e>a.max&&(n+=a.width,l+=a.width)}return{offset:n,stepOffset:l}}function n(e,t){for(var a,i=0,s=t.length,n=0,l=0;i<s;i++){if(!(e>(a=t[i]).width)){var o=Math.max(e/a.width*(a.max-a.min),0),n=a.min+Math.round(o),l=a.min+Math.round(o/a.step)*a.step;break}e-=a.width,i===s-1&&(n=a.max,l=a.max)}return{value:n,stepValue:l}}$.su.Widget.register("divideSlider",{settings:{dividers:{attribute:"dividers",defaultValue:[{min:0,max:100,step:1,width:200}]},value:{attribute:"value",defaultValue:0},autoAdapt:{attribute:"auto-adapt",defaultValue:!1},tipText:{attribute:"tip-text",defaultValue:""},topAnchors:{attribute:"top-anchors",defaultValue:null},bottomAnchors:{attribute:"bottom-anchors",defaultValue:null},valueMarker:{attribute:"value-marker",defaultValue:!1},valueMarkerPos:{attribute:"value-marker-position",defaultValue:"top"},markerFormatter:{attribute:"marker-formatter",defaultValue:null},toolTipFormatter:{attribute:"tooltip-formatter",defaultValue:null},noTooltip:{attribute:"no-tooltip",defaultValue:!1},startEndAnchors:{attribute:"start-end-anchors",defaultValue:null}},listeners:[{selector:"div.widget-wrap.slider-wrap",event:"click",callback:function(e,t){t.dom().hasClass("disabled")||t.dragingHandler(e)}},{selector:"div.slider-value-outer",event:"mousedown",callback:function(e,s){var t,a;s.dom().hasClass("disabled")||($(this).parent().find("div.slider-mask").remove(),$(this).before('<div class="slider-mask"></div>'),t=function(e){e.preventDefault();var t=s.dom(),a=s.settings,i=t.find("div.slider-wrap");$("#global-tip").data("viewObj").removeTip(),t.find("div.slider-value-outer").trigger("mouseenter");e=n((e.pageX||e.screenX)-i.offset().left,a.dividers).stepValue;e>a._total.max?e=a._total.max:e<a._total.min&&(e=a._total.min),t.triggerHandler("ev_view_change",[{"type":"value","value":e}])},a=function(){$("html").off("mousemove",t).off("mouseup",a)},$("html").on("mousemove",t),$("html").on("mouseup",a))}}],init:function(){var e,t,a=this.settings;a.configs?((e=a.configs).dividers&&(r(e.dividers)?a.dividers=e.dividers:console.error("dividers configuration is not legal")),t=c(a.dividers),a._total=t,e.bottomAnchors&&(u(e.bottomAnchors),t.min,t.max?a.bottomAnchors=e.bottomAnchors:console.error("bottomAnchors configuration is not legal")),a.noTooltip||"function"!==$.type(e.toolTipFormatter)||(this.toolTipFormatter=e.toolTipFormatter),a.valueMarker&&"function"===$.type(e.markerFormatter)&&(this.markerFormatter=e.markerFormatter),e.startEndAnchors&&(a.startEndAnchors=e.startEndAnchors)):(t=c(a.dividers),a._total=t)},render:function(){var e=this.dom(),t=this.settings,a=(e.addClass(t.cls+"slider-container uneven"),""),i=(t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel slider-fieldlabel">'+t.labelField+"</label>",""!==t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>"),a=(a=a+'<div class="widget-wrap-outer slider-wrap-outer">'+'<div class="widget-wrap slider-wrap">')+'<div class="widget-wrap slider-content">'+'<div class="widget-value slider-value"></div>',$("<div><div class='widget-value-outer slider-value-outer'></div></div>")),s=i.children(),n=(t.noTooltip||(n=this.toolTipFormatter?this.toolTipFormatter(t.value):t.value,s.attr("data-tip",n).attr("data-pointer","top")),t.valueMarker&&s.append("<span class='slider-value-marker %pos'>%value</span>".replace("%pos","top"===t.valueMarkerPos?"top":"bottom").replace("%value",this.markerFormatter?this.markerFormatter(t.value):t.value)),a+=i.html(),$("<div><div class='slider-anchors top'></div></div>")),s=$("<div><div class='slider-anchors bottom'></div></div>");if(t.topAnchors){var l=n.children(),o=0,d=t.topAnchors;for(r in d)o=m(r,t.dividers).offset,l.append($("<div class='slider-anchor'></div>").css({"left":o}).html("<span class='slider-anchor-content visible'>"+$.su.escapeHtml(d[r])+"</span>"))}if(a+=n.html(),t.bottomAnchors){var r,l=s.children(),o=0,c=t.bottomAnchors;for(r in c)o=m(r,t.dividers).offset,l.append($("<div class='slider-anchor'></span>").css({"left":o}).html("<span class='slider-anchor-content visible'>"+$.su.escapeHtml(c[r])+"</span>"))}a+=s.html();i="",n="";if(t.startEndAnchors&&(i=t.startEndAnchors.start||"",n=t.startEndAnchors.end||""),a=(a+="<div class='slider-start'>%start%</div>".replace("%start%",$.su.escapeHtml(i)))+"<div class='slider-end'>%end%</div>".replace("%end%",$.su.escapeHtml(n))+"</div></div>",t.tipText&&(a+='<div widget="toolTip"></div>'),e.append(a+="</div>"),!(t._total.max<=t._total.min)){if(t.autoAdapt){s=e.innerWidth();if(s<t._total.width){for(var u,h=t.dividers,p=void 0/void 0,g=h.length;g--;)(u=h[g]).width=Math.round(p*u.width);t._total.width=s}}e.find("div.slider-content").css({"width":t._total.width})}},dragingHandler:function(e){e.preventDefault();var t=this.dom(),a=this.settings,i=t.find("div.slider-wrap"),e=n((e.pageX||e.screenX)-i.offset().left,a.dividers).stepValue;e>a._total.max?e=a._total.max:e<a._total.min&&(e=a._total.min),t.triggerHandler("ev_view_change",[{"type":"value","value":e}])},getValue:function(){return this.settings.value},setStyle:function(e){var t=this.dom(),a=this.settings,i=t.find("div.slider-value"),s=t.find("div.slider-value-outer"),n=m(e,a.dividers).offset;i.css({width:n}),s.css({"left":n}),a.noTooltip||(i=this.toolTipFormatter?this.toolTipFormatter(e):e,t.find(".slider-value-outer").attr("data-tip",i)),a.valueMarker&&(s=this.markerFormatter?this.markerFormatter(e):e,t.find(".slider-value-marker").text(s))},setValue:function(e){var t=this.settings;e=e||0,isNaN(e)||(t.value=e,this.setStyle(e),this.setDisplay(e))},setDisplay:function(e){this.settings.valueMarker&&(e=this.markerFormatter?this.markerFormatter(e):e,this.dom().find(".slider-value-marker").html(e))},disable:function(){this.dom().addClass("disabled")},enable:function(){this.dom().removeClass("disabled")},visibleAnchor:function(e,t,a){t=t?"top":"bottom",t=this.dom().find(".slider-anchors."+t+" .slider-anchor-content").eq(e);a?t.addClass("visible"):t.removeClass("visible")},setConfigs:function(e){var t,a,i=this.settings,s=this.dom();if(e.dividers){if(!r(dividers))return void console.error("dividers configuration is not legal");i.dividers=dividers,i._total=c(dividers),s.find("div.slider-content").css({"width":i._total.width})}if(e.topAnchors){if(!u(e.topAnchors,i._total.min,i._total.max))return void console.error("topAnchors configuration is not legal");i.topAnchors=e.topAnchors;var n=0,l=i.topAnchors,o=s.find(".slider-anchors.top").empty();for(d in l)n=m(d,i.dividers).offset,o.append($("<div class='slider-anchor'></span>").css({"left":n}).html("<span class='slider-anchor-content visible'>"+$.su.escapeHtml(l[d])+"</span>"))}if(e.bottomAnchors){if(!u(e.bottomAnchors,i._total.min,i._total.max))return void console.error("bottomAnchors configuration is not legal");i.bottomAnchors=e.bottomAnchors;var d,n=0,l=i.bottomAnchors,o=s.find(".slider-anchors.bottom").empty();for(d in l)n=m(d,i.dividers).offset,o.append($("<div class='slider-anchor'></span>").css({"left":n}).html("<span class=' visible'>"+$.su.escapeHtml(l[d])+"</span>"))}e.startEndAnchors&&(i.startEndAnchors=e.startEndAnchors,t=$.su.escapeHtml(e.startEndAnchors.start||""),a=$.su.escapeHtml(e.startEndAnchors.end||""),s.find(".slider-start").html(t),s.find(".slider-end").html(a)),"function"===$.type(e.markerFormatter)&&(i.markerFormatter=e.markerFormatter,this.markerFormatter=e.markerFormatter,s.find(".slider-value-marker").text(this.markerFormatter(i.value)))}})})(),$.su.Widget.register("switch",{settings:{name:{attribute:"name",defaultValue:""},trueValue:{attribute:"true-value",defaultValue:1},falseValue:{attribute:"false-value",defaultValue:0},columns:{attribute:"columns",defaultValue:1},tipText:{attribute:"tip-text",defaultValue:""},boxLabel:{attribute:"box-label",defaultValue:""},animateTime:{attribute:"animate-time",defaultValue:300},disable:{attribute:"disable",default:!1}},listeners:[{selector:".switch-label",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation();var e=$(this),a=t.settings,i=t.getValue();e.hasClass("disabled")||(i=i===a.trueValue?a.falseValue:a.trueValue,e=$.su.getDefaultEvent(t,function(){t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}])}),t.dom().triggerHandler("ev_switch_change",[e.ev,i]),e.exe())}}],init:function(){},init:function(){},render:function(){var e=this.dom(),t=this.settings,a=(this.value=null,e.addClass(t.cls+"switch-container"),"");null!==t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel switch-fieldlabel">'+t.labelField+"</label>",""!==t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>"),a=(a+='<div class="widget-wrap-outer switch-wrap-outer"><div class="switch-wrap"><div class="widget-wrap"><label class="switch-label"><span class="icon-bg"></span><span class="icon-ball"></span>')+'</label><span class="text">'+t.boxLabel+"</span></div></div>",null!=t.tips&&null!=t.tips&&(a=(a+='<div class="widget-tips textbox-tips '+t.tipsCls+'">')+'<div class="widget-tips-wrap"><div class="content tips-content">'+t.tips+"</div></div></div>"),a=a+('<div widget="errortip" error-cls="'+t.errorTipsCls)+'"></div></div>',t.tipText&&(a+='<div widget="toolTip"></div>'),e.empty().append(a),t.disable?this.disable():this.enable()},setValue:function(e){var t=this.dom(),a=this.settings,t=t.find("label.switch-label"),i=this;t=t.eq(0),(e=e)===a.trueValue?(t.addClass("checked"),i.value=e):e===a.falseValue&&(t.removeClass("checked"),i.value=e)},getValue:function(){var e=this.settings;return this.value===e.trueValue?e.trueValue:e.falseValue},disable:function(){var e=this.dom();this.getContainer()&&this.getContainer().addClass("disabled"),this.dom().find("label.switch-label").addClass("disabled"),this.setStatus("disabled",!0),e.triggerHandler("ev_view_disable")},enable:function(){var e=this.dom();this.getContainer()&&this.getContainer().removeClass("disabled"),this.dom().find("label.switch-label").removeClass("disabled"),this.setStatus("disabled",!1),e.triggerHandler("ev_view_enable")},setLoadingStatus:function(){this.dom().removeClass("loading").addClass("loading"),this.disable()},cancelLoadingStatus:function(){this.dom().removeClass("loading"),this.enable()}}),$.su.Widget.register("time",{settings:{format:{attribute:"format",defaultValue:"h:m:s"},hourSystem:{attribute:"hour-system",defaultValue:"24"},allowClear:{attribute:"allow-clear",defaultValue:!0}},listeners:[{selector:".time-display-container",event:"click",callback:function(e,t){e.stopPropagation(),t.settings.shownStatus?t.hidePicker():t.dom().hasClass("disabled")||(t.showPicker(),t.setTime(t._selected))}},{selector:".time-list-item",event:"click",callback:function(e,t){e.stopPropagation();var a,i,e=t.dom();$(this);e.hasClass("disabled")||(e=$(this).closest(".time-list-wrap").attr("data-type"),a=t._dataMap[e][$(this).attr("data-index")],(i={})[e]=a,t.setTime(i))}},{selector:".time-input",event:"keydown",callback:function(e,t){t="12"!==t.settings.hourSystem||65!=e.keyCode&&80!==e.keyCode&&77!==e.keyCode;48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105||8==e.keyCode||13==e.keyCode||39===e.keyCode||37===e.keyCode||46===e.keyCode||e.shiftKey&&186==e.keyCode||32==e.keyCode||!t||e.preventDefault()}},{selector:".time-input",event:"keyup",callback:function(e,t){13===e.keyCode&&(e=t.checkInputValid($(this).val()))&&t.setTime(e)}},{selector:".time-display-container .time",event:"mouseenter",callback:function(e,t){t.dom().hasClass("disabled")||null!==t._selected&&t.settings.allowClear&&$(this).addClass("clear")}},{selector:".time-display-container .clear",event:"mouseleave",callback:function(e,t){$(this).removeClass("clear")}},{selector:".time-display-container .clear",event:"click",callback:function(e,t){t.settings.allowClear&&(e.stopPropagation(),t.setTime(null))}},{selector:function(){return{parent:"body",target:""}},event:"click",callback:function(e,t){e.stopPropagation();var a=t.settings,e=e.target||e.srcElement,e=$(e).closest(".time-wrap-outer");a.shownStatus&&0===e.length&&t.hidePicker()}}],init:function(){this.settings.sepMark=":",this._selected=null,this._default={hour:null,minute:null,second:null,ampm:null},this.settings.shownStatus=!1,this._dataMap={hour:[],minute:[],second:[],ampm:[]},this._displayMap={hour:{},minute:{},second:{},ampm:{}}},destroy:function(){var e=this.dom();e.removeClass(),e.empty()},render:function(){var e=this.dom(),t=this.settings,a=(e.addClass(t.cls+" time-container"),""),i=(t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel time-fieldlabel">'+t.labelField+"</label>",""!==t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>"),t.format),s=i.charAt(1),n=i.split(s);t.sepMark=s;for(var a=(a=(a=(a=(a=(a=a+'<div class="widget-wrap-outer time-wrap-outer">'+'<div class="time-display-container u-d-inline-block">')+('<input type="text" class="time-display" readonly placeholder="'+$.su.CHAR.DATEPICKER.PLEASE_SELECT+'">'))+'<span class="icon time"></span>'+"</div>")+'<div class="widget-wrap time-wrap hidden u-d-inline-block">'+'<div class="time-input-container">')+('<input type="text" class="time-input" placeholder="'+$.su.CHAR.DATEPICKER.PLEASE_SELECT+'">')+'<span class="icon time"></span>')+"</div>"+'<div class="time-lists-container">',l=0,o=n.length;l<o;l++)switch(n[l]){case"H":case"h":a=(a+='<div id="'+this.domId+'_hour" class="hour-list-container  time-list-wrap-outer">')+this.initItemsHtml(this.getOptions("hour"),"hour")+"</div>";break;case"M":case"m":a=(a+='<div id="'+this.domId+'_minute" class="minute-list-container  time-list-wrap-outer">')+this.initItemsHtml(this.getOptions("minute"),"minute")+"</div>";break;case"S":case"s":a=(a+='<div id="'+this.domId+'_second" class="second-list-container  time-list-wrap-outer">')+this.initItemsHtml(this.getOptions("second"),"second")+"</div>"}"12"===t.hourSystem&&(a=(a+='<div id="'+this.domId+'_ampm" class="apmp-list-container time-list-wrap-outer">')+this.initItemsHtml(this.getOptions("ampm"),"ampm")+"</div>",this.dom().addClass("hour-12")),a=(a+="</div></div>")+'<div widget="errortip" error-cls="'+t.errorTipsCls+'"></div>',null!=t.tips&&null!=t.tips&&(a=a+('<div class="widget-tips textbox-tips '+t.tipsCls)+'"><div class="content tips-content"></div></div>'),a+="</div>",t.tipText&&(a+='<div widget="toolTip"></div>'),e.append($(a))},setValue:function(e){e&&(this.dom(),this.settings.format,"string"===$.type(e)&&(e=this.checkInputValid(e)),"object"===$.type(e))&&this.setTime(e)},getValue:function(){return this.getFormatTime(this._selected)},viewChange:function(e){this.dom().triggerHandler("ev_view_change",[{type:"value",value:e}])},getOptions:function(e){var t=0,a=0,i=[],s=this.settings;if("ampm"===e)return[{name:this._default[e]="AM",value:"AM",boxlabel:"AM",selected:!0},{name:"PM",value:"PM",boxlabel:"PM"}];switch(e){case"hour":t="12"===s.hourSystem?1:0,a="12"===s.hourSystem?12:23;break;case"minute":case"second":a=59}for(var n=this._default[e]=t;n<=a;n++){var l=n<10?"0"+n:""+n;i.push({name:l,value:n,boxlabel:l,selected:n===t})}return i},initItemsHtml:function(e,t){for(var a='<ul class="'+t+'-list time-list-wrap su-scroll" data-type="'+t+'">',i=0;i<e.length;i++){var s=e[i],n=s.name,l=s.value;this._dataMap[t][i]=l,this._displayMap[t][l]=n,a=(a+='<li class="time-list-item '+(!!s.selected?"selected":"")+" "+t+'-item" data-index="'+i+'">')+('<span class="text">'+$.su.escapeHtml(n)+"</span>")+"</li>"}return a+="</ul>"},showPicker:function(){var e=this.dom();this.settings.shownStatus=!this.settings.shownStatus,e.find(".time-wrap").removeClass("hidden"),e.find(".time-input").focus()},hidePicker:function(){var e=this.dom();this.settings.shownStatus=!this.settings.shownStatus,e.find(".time-wrap").addClass("hidden")},checkInputValid:function(e){if(e=e.trim(),"12"!==this.settings.hourSystem)return this.checkTimeFormat(e);var t=(e=e.toUpperCase()).slice(-2);if("AM"!==t&&"PM"!==t)return!1;e=e.slice(0,-2).trim();e=this.checkTimeFormat(e);return!!e&&(e.ampm=t,e)},checkTimeFormat:function(e){var t=this.settings,a=t.format.split(":"),i=e.split(":");if(i.length!==a.length)return!1;for(var s={},n=0,l=i.length;n<l;n++){var o=+i[n];switch(a[n]){case"h":case"H":var d="12"===t.hourSystem?12:23,r="12"===t.hourSystem?1:0;if(d<o||o<r)return!1;s.hour=o;break;case"m":case"M":if(59<o||o<0)return!1;s.minute=o;break;case"s":case"S":if(59<o||o<0)return!1;s.second=o}}return s},setTime:function(e){this._selected;var t,a,i,s={};for(t in null===e?($.extend(s,this._default),this._selected=null):(null===this._selected&&(this._selected=$.su.clone(this._default)),$.extend(this._selected,this.formatTimeObj(e)),$.extend(s,this._selected)),s)s.hasOwnProperty(t)&&(a=this._dataMap[t].indexOf(s[t]),(i=this.dom().find(".time-list-wrap."+t+"-list")).find(".time-list-item.selected").removeClass("selected"),i.find("."+t+"-item[data-index="+a+"]").addClass("selected"),this.updatePosition(t,a));this.updateText();e=this.getValue();this.dom().triggerHandler("ev_view_change",[{"type":"value","value":e}]),this.dom().triggerHandler("ev_view_change",[{"type":"valid","value":e}])},formatTimeObj:function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]="12"===this.settings.hourSystem&&"ampm"===t?e[t].toUpperCase():+e[t]);return e},updatePosition:function(e,t){this.dom().find("."+e+"-list").scrollTop(36*+t)},getFormatTime:function(e){var t,a,i,s="";return null!==e&&(a=(t=this.settings).format.toLowerCase(),i=this._displayMap,s=a.replace(/h+/,i.hour[e.hour]).replace(/m+/,i.minute[e.minute]).replace(/s+/,i.second[e.second]),"12"===t.hourSystem)&&(s+=" "+i.ampm[e.ampm]),s},updateText:function(){var e=this.dom(),t=this._selected,t=this.getFormatTime(t);e.find(".time-input").val(t),e.find(".time-display").val(t)},setHourSystem:function(e){if("12"!==e&&"24"!==e)return!1;var t=this.settings,a=this.getValue();e!==t.hourSystem&&(t.hourSystem=e,this.destroy(),this.init(),this.render(),this.setValue(a))}}),$.su.Widget.register("datepicker",{settings:{format:{attribute:"format",defaultValue:"yyyy-MM-dd"},transferMonth:{attribute:"transfer-month",defaultValue:!0},labelField:{attribute:"label-field",defaultValue:""},timeZone:{attribute:"time-zone",defaultValue:!1},timeZoneType:{attribute:"time-zone-type",defaultValue:"site"},noneSelectedText:{attribute:"none-selected-text",defaultValue:$.su.CHAR.COMMON.PLEASE_SELECT}},listeners:[{selector:".datepicker-display-container",event:"click",callback:function(e,t){e.stopPropagation(),t.settings.shownStatus?t.hideDatepicker():t.dom().hasClass("disabled")||(e=t.dateInfo,t.calendar.resetStack(),t.setSelected(e.selected),t.showDatepicker(),t.dom().triggerHandler("ev_datepicker_open",[{"type":"value","value":null}]))}},{selector:".datepicker-display-container .date",event:"mouseenter",callback:function(e,t){t.dom().hasClass("disabled")||null!==t.dateInfo.selected&&$(this).addClass("clear")}},{selector:".datepicker-display-container .clear",event:"mouseleave",callback:function(e,t){$(this).removeClass("clear")}},{selector:".datepicker-display-container .clear",event:"click",callback:function(e,t){e.stopPropagation(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":null}])}},{selector:".date-calendar-container .calendar-cell a",event:"click",callback:function(e,t){e.stopPropagation();e=$(this).closest(".calendar-cell");e.hasClass("disabled")||(e.hasClass("selected")||t.dom().triggerHandler("ev_view_change",[{"type":"value","value":$.su.serviceManager.get("time").getEndUTCTimeInDay(t.getDateText(e.attr("data-date")),t.settings.timeZoneType)}]),t.hideDatepicker())}},{selector:".datepicker-input",event:"keyup",callback:function(e,t){var a,i=$(this).val(),s=+$(this).attr("maxlength");"MMMM dd,yyyy"!==t.settings.format&&(a=t.checkFormatValidate(i),8===e.keyCode&&0===i.length?t.dom().triggerHandler("ev_view_change",[{"type":"value","value":null}]):i.length<s||!a||t.dom().triggerHandler("ev_view_change",[{"type":"value","value":moment(a.year,a.month,a.date)}]))}},{selector:".datepicker-input",event:"blur",callback:function(e,t){t.updateText()}},{selector:"a.today-btn",event:"click",callback:function(e,t){t.dom().triggerHandler("ev_view_change",[{"type":"value","value":t.dateInfo.today.valueOf()}]),t.hideDatepicker()}},{selector:function(){return{parent:"body",target:""}},event:"click",callback:function(e,t){e.stopPropagation();var a=t.settings,e=e.target||e.srcElement,e=$(e).closest(".datepicker-wrap-outer");a.shownStatus&&0===e.length&&t.hideDatepicker()}}],init:function(e){this.settings.shownStatus=!1,this.minDate={},this.monthList={1:$.su.CHAR.DATEPICKER.JANUARY,2:$.su.CHAR.DATEPICKER.FEBRUARY,3:$.su.CHAR.DATEPICKER.MARCH,4:$.su.CHAR.DATEPICKER.APRIL,5:$.su.CHAR.DATEPICKER.MAY,6:$.su.CHAR.DATEPICKER.JUNE,7:$.su.CHAR.DATEPICKER.JULY,8:$.su.CHAR.DATEPICKER.AUGUST,9:$.su.CHAR.DATEPICKER.SEPTEMBER,10:$.su.CHAR.DATEPICKER.OCTOBER,11:$.su.CHAR.DATEPICKER.NOVEMBER,12:$.su.CHAR.DATEPICKER.DECEMBER},this._selectedDateStr=""},render:function(){var e=this.dom(),t=this.settings,a=(e.addClass(t.cls+"datepicker-container"),""),a=(null!==t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<div class="widget-fieldlabel-inner"><label class="widget-fieldlabel datepicker-fieldlabel">'+("false"===t.labelField?"":t.labelField)+"</label>",t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div></div>"),a=(a=(a=(a=(a=(a+='<div class="widget-wrap-outer datepicker-wrap-outer">')+('<div id="'+this.domId+'_picker" class="datepicker">')+'<div class="datepicker-display-container">')+('<input type="text" class="datepicker-display" readonly placeholder="'+this.settings.noneSelectedText+'" maxlength="10">')+'<span class="icon date"></span>')+"</div>"+'<div class="datepicker-calendar-container hidden">')+'<div class="datepicker-input-container">'+('<input type="text" class="datepicker-input" placeholder="'+this.settings.noneSelectedText+'" maxlength=" 10">'))+"</div>"+('<div widget="calendar" id="'+this.domId+'_calendar">'),e.append(a=(a=a+"</div>"+"</div>")+"</div>"+"</div>"),{id:this.domId+"_calendar"}),i=(t.timeZone&&(a.settings={"time-zone":!0,"time-zone-type":t.timeZoneType}),this.calendar=new $.su.widgets.calendar(a),this.calendar.render(),this),t=(this.calendar.dom().on("ev_calendar_view_update",function(e){i.setSelectedStatus(),i.setPreselectStatus()}),this.dateInfo=this.calendar.dateInfo,'<div class="today-btn-container"><a class="today-btn">'+$.su.CHAR.DATEPICKER.TODAY+"</a></div>");e.find(".date-calendar-container").append(t),this.updateText()},setSelected:function(e){var t=this.dateInfo;t.selected=e&&moment(e),t.date=moment(e||t.today),t.date.date(1),t.preSelected=null,this.calendar.showCalendar(),this.setSelectedStatus(),this.setPreselectStatus(),this.updateText()},setSelectedStatus:function(){var e=this.dom(),t=this.dateInfo.selected,a=this.getDateObj(this.dateInfo.date),i=e.find(".date-calendar-container"),s=e.find(".month-calendar-container"),e=e.find(".year-calendar-container"),n=(i.find(".selected").removeClass("selected"),s.find(".selected").removeClass("selected"),e.find(".selected").removeClass("selected"),a.month),a=a.month;e.find('.current-slot-year[data-value="'+n+'"]').addClass("selected"),s.find('.calendar-cell[data-value="'+a+'"]').addClass("selected"),t&&(n=(e=this.getDateObj(t)).year,this._selectedDateStr=n+"-"+((s=e.month)+1)+"-"+(a=e.date),i.find('.current-month-date[data-date="'+n+"-"+s+"-"+a+'"]').addClass("selected"))},getSelectedDateStr:function(){return this._selectedDateStr},updateText:function(){var e=this.dateInfo.selected,e=e?$.su.serviceManager.get("time").getTextFromUTC(e,this.settings.timeZoneType,{pattern:this.settings.format,transferMonth:this.settings.transferMonth}):this.settings.noneSelectedText;this.dom().find(".datepicker-input").val(e),this.dom().find(".datepicker-display").val(e)},getDateFromFormat:function(e){var t;return"number"===$.type(e)?moment(e):"string"===$.type(e)?(t=-4==0-(e.lastIndexOf("M")-e.indexOf("M")+1)?this.checkFormatMapValidate(e):this.checkFormatValidate(e))?moment(t.year,t.month,t.date):null:e},checkFormatValidate:function(e,t){var a,i,s,n,l,o,d,r,t=t||this.settings.format;return!(e.length<t.length||(o=t.indexOf("y"),d=t.lastIndexOf("y")+1,r=t.indexOf("M"),a=t.lastIndexOf("M")+1,i=t.indexOf("d"),t=t.lastIndexOf("d")+1,s=+e.slice(o,d),n=e.slice(r,a)-1,e=+e.slice(i,t),isNaN(s))||isNaN(n)||isNaN(e)||(o=+((l=moment(s,n,e)).year()+"").slice(o-d),d=+("0"+l.month()).slice(r-a),r=+("0"+l.date()).slice(i-t),s!=o)||n!=d||e!=r)&&{year:s,month:n,date:e}},checkFormatMapValidate:function(e){var t,a=e.split(" ")[0],i=!1;for(key in this.monthList)if(this.monthList.hasOwnProperty(key)&&this.monthList[key]==a){i=!0,t=key;break}return!!i&&(e=e.replace(a,("0"+t).slice(-2)),this.checkFormatValidate(e,"MM dd,yyyy"))},setPreselectStatus:function(){var e=this.dom(),t=e.find(".date-calendar-container"),a=this.dateInfo.selected||this.dateInfo.today,i=a.year(),s=a.month(),a=(this.dateInfo.preSelected=this.dateInfo.preSelected||moment(a),this.dateInfo.preSelected.date()),e=(e.find(".pre-selected").removeClass("pre-selected"),t.find(".current-month-date")),t=e.eq(0).attr("data-date").split("-");i===+t[0]&&s===+t[1]||(i=a>e.length?e.length:a,e.eq(i-1).addClass("pre-selected"),this.dateInfo.preSelected.date(i))},showDatepicker:function(){var e=this.dom();this.dateInfo;this.settings.shownStatus=!0,e.find(".datepicker-calendar-container").removeClass("hidden"),e.find(".datepicker-input").focus()},hideDatepicker:function(){var e=this.dom();this.settings.shownStatus=!1,e.find(".datepicker-calendar-container").addClass("hidden")},setValue:function(e){void 0!==e&&this.setSelected(this.getDateFromFormat(e))},getValue:function(){return this.dateInfo.selected},setMinDate:function(e){e=this.getDateObj(e);this.minDate={year:e.year,month:e.month,day:e.date},this.calendar.setMinDate(this.minDate)},getDateText:function(e){return(e=e.split("-"))[1]=this.padStart(+e[1]+1),e[2]=this.padStart(e[2]),e.join("-")},padStart:function(e){return("0"+e).slice(-2)},getDateObj:function(e){return e instanceof moment&&(e=e.valueOf()),"date"===$.type(e)?null:(e=$.su.serviceManager.get("time").getTextFromUTC(e,this.settings.timeZoneType,{pattern:"yyyy-MM-dd",transferMonth:!1}).split("-"),{year:parseInt(e[0]),month:parseInt(e[1])-1,date:parseInt(e[2]),day:parseInt(e[2])})}}),$.su.Widget.register("fieldset",{settings:{legend:{attribute:"legend",defaultValue:""},disableOnHide:{attribute:"disable-on-hide",defaultValue:!0},enableOnShow:{attribute:"enable-on-show",defaultValue:!0},showValue:{attribute:"show-value",defaultValue:null},enableValue:{attribute:"enable-value",defaultValue:null},parentEnabled:{defaultValue:!0},selfEnabled:{defaultValue:!0},autoExpand:{attribute:"auto-expand",defaultValue:!0}},listeners:[{selector:"div.legend",event:"click",callback:function(e,t){e.preventDefault(),e.stopPropagation();e=t.getContainer();e.hasClass("expand")?e.removeClass("expand").addClass("collapse"):e.hasClass("collapse")?e.removeClass("collapse").addClass("expand"):e.addClass("collapse")}}],init:function(){},render:function(){var e=this.dom(),t=this.settings,a=(e.addClass(t.cls+"fieldset-container"),t.autoExpand?e.addClass("expand"):e.addClass("collapse"),""),t=(a=(a=(a+='<div class="legend">')+'<div class="fieldset-img"></div>'+('<div class="fieldset-text">'+t.legend+"</div>"))+"</div>"+'<div class="fieldset-content"></div>',e.children("div")),l=(e.append(a),e.find("div.fieldset-content").eq(0).append(t),[]);!function e(t){for(var a,i=$(t).children("div"),s=0,n=i.length;s<n;s++)$(i[s]).attr("widget")?(a={id:$(i[s]).attr("id"),type:$(i[s]).attr("widget")},l.push(a)):e(i[s])}(e.find("div.fieldset-content").get(0)),this.fields=l},hide:function(e){var t=this.dom(),a=this.settings;"true"!==a.disableOnHide&&!0!==a.disableOnHide||this.disable(),t.stop(!0).hide(),this.setStatus("shown",!1),e&&e.call(t)},show:function(e){var t=this.dom(),a=this.settings,i=$.isFunction(e)?void 0:e;this.setStatus("shown",!0),$.su.isIe?(t.show(),"true"!==a.enableOnShow&&!0!==a.enableOnShow||!1===i||this.enable(),e&&e()):(t.fadeIn(200,e),"true"!==a.enableOnShow&&!0!==a.enableOnShow||!1===i||this.enable())},setValue:function(e){var t=this.settings;t.data=e,null!==t.showValue&&(e==t.showValue?this.show():this.hide()),null!==t.enableValue&&(e==t.enableValue?this.enable():this.disable())},getValue:function(){return this.settings.data},disable:function(e,t){var a=this.getContainer(),i=this.fields;!0===e||void 0===e?this.settings.selfEnabled=!1:this.settings.parentEnabled=!1,a.addClass("disabled");for(var s=0,n=i.length;s<n;s++){var l=i[s];if(l){var o=$("#"+l.id);l.type;if(0<o.length)try{o.data("viewObj").disable(!1)}catch(e){}}}t&&t.call(this)},enable:function(e,t){var a=this.getContainer(),i=this.fields;if(!1===e?this.settings.parentEnabled=!0:this.settings.selfEnabled=!0,!1!==this.settings.parentEnabled&&(!1!==this.settings.selfEnabled||!1!==e)){a.removeClass("disabled");for(var s=0,n=i.length;s<n;s++){var l=i[s];if(l){var o=$("#"+l.id);l.type;if(0<o.length)try{o.data("viewObj").enable(!1)}catch(e){}}}this.setStatus("disabled",!1),t&&t.call(this)}},expand:function(e){var t=this.getContainer();e?t.removeClass("collapse").addClass("expand"):t.removeClass("expand").addClass("collapse")},toggleFields:function(a){var e=this.fields;$.each(e,function(e,t){$("#"+t.id).toggle(a)})}}),$.su.Widget.register("tab",{settings:{freeSelect:{attribute:"free-select",defaultValue:!1},allowEdit:{attribute:"allow-edit",defaultValue:!1},maxTab:{attribute:"max-tab",defaultValue:!1},sortable:{attribute:"sortable",defaultValue:!1},activeDelay:{attribute:"active-delay",defaultValue:!1},sortableContainment:{attribute:"sortable-containment",defaultValue:"parent"}},listeners:[{selector:".tab-btn",event:"click",callback:function(e,t){var a,i;e.stopPropagation(),$(this).closest(".tab-container").hasClass("disabled")||$(this).hasClass("disabled")||(a=$(this).attr("data-name"),i=t.getActiveTabName(),t.settings.freeSelect?($(this).toggleClass("selected"),$(this).hasClass("selected")?(t.setActive(a),t.dom().triggerHandler("ev_tab_select",[a])):(t.setInactive(a),t.dom().triggerHandler("ev_tab_unselect",[a]))):$(this).hasClass("selected")||(t.settings.activeDelay?(e=$.su.getDefaultEvent(t,function(){t.setActive(a),t.dom().triggerHandler("ev_tab_select",[a,i])}),t.dom().triggerHandler("ev_before_tab_select",[a,e.ev]),e.exe()):(t.setActive(a),t.dom().triggerHandler("ev_tab_select",[a,i]))))}},{selector:".tab-editor a",event:"click",callback:function(e,t){e.stopPropagation();var e=$(this).hasClass("tab-edit")?"edit":"add",a="edit"==e?t.getActiveTabName():null;t.dom().triggerHandler("ev_tab_edit",[e,a])}}],init:function(){this.tabMap={},this.currentTab=""},render:function(){var e,t=this.dom(),a=this.settings;t.addClass(a.cls+"tab-container"),(0<t.children(".tab-btn").length?(e=t).children(".tab-btn"):e=t.find(".tab-btn").eq(0).parent()).wrapAll('<div class="tab-btns"></div>'),e.html(e.html().replace(/([\s]+)<div/g,function(e,t){return e.replace(t,"")})),this.updateTabStatus()},updateTabStatus:function(){var i=this,s=this.settings;i.tabMap={},this.getTabs().each(function(e){var t=$(this).attr("data-name"),a=$(this).attr("data-target");i.tabMap[t]=a,(!1===s.freeSelect&&0===e||$(this).hasClass("selected"))&&(i.currentTab=t),e+1!==i.getTabs().length&&$(this).after('<div class="tab-spliter u-d-inline-block"></div>'),0===e&&$(this).addClass("first"),e===i.getTabs().length-1&&($(this).addClass("last"),s.allowEdit||s.configs&&s.configs.allowEdit)&&$(this).after('<div class="tab-editor u-d-inline-block"><a class="tab-edit m-l-20"><span class="icon"></span></a><a class="tab-add m-l-20"><span class="icon"></span></a></div>').after('<div class="tab-spliter u-d-inline-block"></div>')}),this.dom().children(".tab-content").addClass("u-d-none"),this.setActive(this.currentTab),s.sortable&&(this.sortSettings=this.dom().find(".tab-btns").sortable({helper:"clone",forceHelperSize:!0,cursor:"move",scroll:!0,scrollSensitivity:10,tolerance:"pointer",items:"div.tab-btn",containment:i.settings.sortableContainment,update:function(e,t){var a=i.dom().find(".tab-btns").find("div.tab-btn").map(function(e,t){return t.getAttribute("data-name")}).toArray();i.dom().triggerHandler("ev_tab_sort_end",[a])}}))},setActive:function(e){var t=this.dom(),a=this.getTabs().filter('[data-name="'+e+'"]'),i=a.attr("data-target");this.currentTab=e,this.settings.freeSelect||(this.getTabs().removeClass("selected"),t.children(".tab-content").addClass("u-d-none")),a.addClass("selected"),t.hasClass("tab__panel")||t.children(".tab-content[data-name="+i+"]").removeClass("u-d-none")},setInactive:function(e){var t=this.dom(),a=this.getTabs().filter("[data-name="+e+"]"),i=a.attr("data-target");a.removeClass("selected"),this.currentTab=e,t.hasClass("tab__panel")||t.children(".tab-content[data-name="+i+"]").addClass("u-d-none")},getActiveTabName:function(){var e;return this.settings.freeSelect?(e=[],this.getTabs().filter(".selected").each(function(){e.push($(this).attr("data-name"))}),e):(0===this.getTabs().length&&(this.currentTab=""),this.currentTab)},getTabs:function(){return this.dom().find(".tab-btns").eq(0).find(".tab-btn")},setTabs:function(e){var s,t,n;!1!==this.settings.maxTab&&e.length>this.settings.maxTab||(t=(s=this).dom().find(".tab-btns").eq(0),e="array"===$.type(e)?e:[e],n="",$.each(e,function(e,t){var a=t.cls||"",i=s.currentTab==t.name?" selected":"";n+='<div class="tab-btn '+a+i+'" data-name="'+t.name+'"><span class="icon"></span><span class="text">'+$.su.escapeHtml(t.text)+"</span>",t.innerHtml&&(n+=t.innerHtml),n+="</div>"}),t.empty().append(n),this.updateTabStatus(),!1!==this.settings.maxTab&&e.length===Number(this.settings.maxTab)?this.dom().find(".tab-add").hide():this.dom().find(".tab-add").show())},getAllTabsName:function(){var e=[];return this.getTabs().each(function(){e.push($(this).attr("data-name"))}),e},hideBtn:function(e){this.dom();var t=this.getTabs();(t=void 0!==e?t.filter('[data-name="'+e+'"]'):t).addClass("hidden"),t.prev(".tab-spliter").addClass("hidden"),this.updatePosCls()},showBtn:function(e){this.dom();var t=this.getTabs();(t=void 0!==e?t.filter('[data-name="'+e+'"]'):t).removeClass("hidden"),t.prev(".tab-spliter").removeClass("hidden"),this.updatePosCls()},updatePosCls:function(){var t=this.getTabs().removeClass("first last").not(".hidden");t.each(function(e){0===e&&$(this).addClass("first"),e===t.length-1&&$(this).addClass("last")})},getShowTabsName:function(){var e=[];return this.getTabs().not(".hidden").each(function(){e.push($(this).attr("data-name"))}),e},setNotice:function(e,t){e=this.getTabs().filter("[data-name="+e+"]");t?e.addClass("notice"):e.removeClass("notice")},setTabText:function(e){var a=this.getTabs();$.each(e,function(e,t){a.filter("[data-name="+t.name+"]").text(t.text)})},enableSort:function(){this.settings.sortable&&this.sortSettings.sortable("enable")},disableSort:function(){this.settings.sortable&&this.sortSettings.sortable("disable")},disableTabBtn:function(e){this.dom().find(".tab-btn[data-name="+e+"]").addClass("disabled")},enableTabBtn:function(e){this.dom().find(".tab-btn[data-name="+e+"]").removeClass("disabled")}}),$.su.Widget.register("toolTip",{settings:{tipText:{attribute:"tip-text",defaultValue:""},iconCls:{attribute:"icon-cls",defaultValue:""},maxWidth:{attribute:"max-width",defaultValue:""},widgetSize:{attribute:"widget-size"}},listeners:[{selector:"span.tooltip-icon, div.tip-text-container",event:$.su.isMobile()?"click":"click mouseenter",callback:function(e,t){e.stopPropagation(),$("#global-tips-text").hasClass("show")&&t.hideTips(),t.showHelp=setTimeout(function(){t.showTips()},0)}},{selector:"span.tooltip-icon, div.tip-text-container",event:"mouseleave",callback:function(e,t){clearTimeout(t.showHelp),t.hideTips()}}],init:function(e){$.extend(this.settings,e)},render:function(){var e=this.dom(),t=this.settings,a=(e.addClass(t.cls+"tooltip-container"),""),a=(a=(a=(a+='<div class="widget-wrap-outer tooltip-wrap-outer">')+'<div class="widget-wrap tooltip-wrap">'+'<div class="tooltip-icon-container">')+'<span class="tooltip-icon-mask"></span>'+('<span class="tooltip-icon '+t.iconCls+'"></span>'),e.append(a=(a=(a=(a=(a=(a+="</div>")+'<div class="tip-text-container">'+'<div class="tip-text-delta-container">')+'<span class="icon-delta"></span>'+"</div>")+'<div class="tip-text-box">'+'<p class="tip-text"></p>')+"</div>"+"</div>")+"</div>"+"</div>"),e.find("div.tip-text-container"));a.find("p.tip-text").html(t.tipText),t.maxWidth&&Number(t.maxWidth)&&a.find("div.tip-text-box").css("max-width",t.maxWidth+"px")},showTips:function(){var t=this,e=$("#global-tips-text");e.attr("data-shown",this.domId),$("div.ps--active-y").one("click.toolTip scroll.toolTip",function(e){t.hideTips()}),e.empty().append(this.dom().find("div.tip-text-container").clone()),e.show().addClass("show"),this.adjustLayout()},hideTips:function(){$("#global-tips-text").hide().removeClass("show").attr("data-shown","_hidden_")},getWidgetSize:function(){var e=document.body.clientWidth,e=e<=768?"s":e<1024?"m":e<1280?"l":"xl";return e},adjustLayout:function(){var e,t,a,i,s,n,l,o,d,r,c,u,h,p,g,m=$("#global-tips-text");m.hasClass("show")&&(m.css({width:"auto",left:-9999,top:-9999}),e=m.height(),t=m.width(),a=this.settings.widgetSize||this.getWidgetSize(),m.removeClass("s m l xl").addClass(a),p=this.dom(),s=(i=m.find("div.tip-text-container")).height(),n=i.width(),l=(d=p.find(".tooltip-icon-container")).offset(),o=d.height(),d=d.width(),c=(r=m.find(".tip-text-delta-container")).height(),u=r.width(),h=document.body.clientWidth,$("body").offset(),"s"==a?(g=(p=$(p).closest(".panel-container")).offset(),m.css({width:p.outerWidth()||$("body").width()-50,top:l.top+o,left:g.left}),r.css({left:l.left-g.left+(d-u)/2,top:1-c})):"m"==a?(m.css({top:l.top-e,left:l.left-(t-d)/2}),r.css({left:(n-u)/2,top:s}),m.width()<t&&(m.css({top:l.top-m.height()}),r.css({top:i.height()}))):($.su.language.isRtl()?l.left-t<0:l.left+t>h)?(m.css({left:l.left+($.su.language.isRtl()?u+d+5:-t-u-5),top:l.top-(e-o)/2}),r.removeClass("left").addClass("right"),r.css({top:(s-c)/2,left:"unset",right:$.su.language.isRtl()?n:-u})):(m.css({left:l.left+($.su.language.isRtl()?-d-n:d),top:l.top-(e-o)/2}),r.removeClass("right").addClass("left"),r.css({top:(s-c)/2,left:$.su.language.isRtl()?n:-u,right:"unset"})))},setHtml:function(e){var t=this.dom(),a=this.settings,t=t.find("div.tip-text-container");t.find("p.tip-text").html(e),a.maxWidth&&Number(a.maxWidth)&&t.find("div.tip-text-box").css("max-width",a.maxWidth+"px")}}),$.su.Widget.register("tip",{settings:{},listeners:[{selector:function(){return{parent:"body",target:"[data-tip]"}},event:"mouseenter",callback:function(e,r){null!==r.timer&&(clearTimeout(r.timer),r.timer=null);var c=this;function t(){var e=$.su.transferedStr($(c).attr("data-tip"))||$(c).attr("data-tip")||$(c).data("tip"),t=$(c).data("tleft"),a=$(c).data("ttop"),i=$(c).data("pointer"),s=$(c).attr("tip-width"),n=$(c).attr("tip-max-width"),l=$(c).attr("tip-wrap"),o="html"===$(c).attr("tip-html"),d="";$(c).attr("tip-class")&&(d=$(c).attr("tip-class").split(" ")),e&&r.setTip($(c),e,{left:t,top:a,pointer:i,width:s,wrap:l,tipClass:d,maxWidth:n,html:o})}var a=$(this).attr("time-delay");void 0===a?t():r.timer=setTimeout(t,parseInt(a)),$(this).one("mouseleave",function(){r.removeTip(),clearTimeout(r.timer),r.timer=null}),"close"===$(this).attr("click-operation")&&$(this).off("click").on("click",function(e){r.removeTip(),clearTimeout(r.timer),r.timer=null})}}],init:function(){this.timer=null},render:function(){this.dom().addClass("title-tip"),this.dom().append('<span class="title-tip-text"></span><span class="tip-pointer"></span>')},setTip:function(e,t,a){var i=this.dom(),s=e.offset(),n=e.width(),l=e.height(),o="bottom",d=0;if(a.html?i.find(".title-tip-text").html(t):i.find(".title-tip-text").text(t),i.css({"display":"inline-block","visibility":"hidden","width":a.width||"","white-space":a.wrap||"normal","max-width":a.maxWidth||"400px"}),i.removeClass().addClass("title-tip"),"array"===$.type(a.tipClass))for(var r=0;r<a.tipClass.length;r++)i.addClass(a.tipClass[r]);else"string"===$.type(a.tipClass)&&i.addClass(a.tipClass);a&&a.pointer&&(o=a.pointer);var t=i.outerWidth(),c=i.outerHeight(),u=t/2,h=$.su.language.isRtl()?s.left+n/2:$("body").width()-s.left-n/2,p=s.left+n/2-t/2,u=("nowrap"===a.wrap?d=Math.min(h-u,0):h<u?a.width?(i.outerWidth(a.width),d=h-u):i.outerWidth(t=2*h-2):p<=0&&"right"!==o?d=-p:a.width||i.css("width",""),(t-n)/2),h=(c-l)/2;"bottom"===o&&(void 0===a.top?s.top+e.height():a.top)+6+8+c>$(window).height()&&(o="top"),i.addClass(o),"bottom"===o?i.css({"visibility":"visible","left":(void 0===a.left?s.left-u:a.left-t/2)+($.su.language.isRtl()?-d:d)+"px","top":(void 0===a.top?s.top+e.height():a.top)+6+8+"px"}):"top"===o?i.css({"visibility":"visible","left":(void 0===a.left?s.left-u:a.left-t/2)+($.su.language.isRtl()?-d:d)+"px","top":(void 0===a.top?s:a).top-c-14+"px"}):"left"===o?i.css({"visibility":"visible","left":(void 0===a.left?s:a).left-t-14+"px","top":(void 0===a.top?s.top-h:a.top-c/2)+"px"}):"right"===o&&i.css({"visibility":"visible","left":(void 0===a.left?s.left+n+6+8:a.left)+"px","top":(void 0===a.top?s.top-h:a.top-c/2)+"px"}),"nowrap"===a.wrap||d?(p=i.offset(),l=s.left-p.left+n/2,i.find(".tip-pointer").css("left",l)):"bottom"===o||"top"===o?i.find(".tip-pointer").css({left:"50%",right:""}):"left"===o?i.find(".tip-pointer").css({right:"-5px",left:""}):"right"===o&&i.find(".tip-pointer").css({right:"",left:"-5px"})},setText:function(e,t){e="string"===$.type(e)?$("#"+e):$(e);e.attr("data-tip",t)},removeTip:function(){this.dom().css({"display":"none","left":""})}}),$.su.Widget.register("paragraph",{settings:{text:{attribute:"text",defaultValue:""}},init:function(){},render:function(){var e=this.dom(),t=this.settings,a=t.labelField?"":"label-empty",a=(e.addClass(t.cls+" "+a+" paragraph-container"),"");t.labelField&&(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+'<label class="widget-fieldlabel text-fieldlabel">'+t.labelField+"</label>",t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a+="</div>"),a=a+'<div class="widget-wrap-outer paragraph-wrap-outer">'+t.text,e.html(a+="</div>")},setText:function(e){var t=this.settings,a=this.getContainer().find("div.paragraph-wrap-outer");t.text=e||"",a.text(e||"")},getText:function(e){this.settings;return this.getContainer().find("div.paragraph-wrap-outer").text()},setHtml:function(e){this.dom().find("div.paragraph-wrap-outer").html(e)}}),$.su.Widget.register("errortip",{settings:{errorCls:{attribute:"error-cls",defaultValue:""}},listeners:[{selector:"span.widget-error-tips-delta",event:"mouseenter",callback:function(e,t){t.dom().find("div.widget-error-tips-wrap").addClass("hover"),t.animate()}},{selector:"span.widget-error-tips-delta",event:"mouseleave",callback:function(e,t){t.dom().find("div.widget-error-tips-wrap").removeClass("hover")}}],init:function(e){var t=this.dom();switch(e.type){case"errortip":case"fieldset":case"form":case"msg":return!1;case"textbox":case"password":t.addClass("textbox-error-tips");break;case"button":case"checkbox":case"combobox":case"displaylabel":case"radio":t.addClass(e.type+"-error-tips")}},render:function(){var e=this.dom(),t=this.settings;e.append('<span class="widget-error-tips-delta"></span><div class="widget-error-tips-wrap"><span class="widget-error-tips-delta"></span><div class="content error-tips-content"></div></div>'),e.addClass(t.errorCls+" widget-error-tips")},show:function(e,t){var a=this.dom();a.find("div.widget-error-tips-wrap"),a.find("div.error-tips-content");""!=e&&this.animate(e,t)},animate:function(e,t){var a=this.dom(),i=(a.find("div.widget-error-tips-wrap"),a.find("div.error-tips-content"));"string"===$.type(e)&&(t?i.html(e):i.text(e)),a.addClass("show"),$.su.isIe?a.show():a.fadeIn(150)},hide:function(){var e=this.dom();e.find("div.widget-error-tips-wrap"),e.find("div.error-tips-content");e.removeClass("show").stop(!0).hide()}}),!function(){var Time=$.su.Widget.register("combination",{settings:{widgetSeparator:{attribute:"widget-separator",defaultValue:""},subLabelField:{attribute:"sub-label-field",defaultValue:""},total:{attribute:"total",defaultValue:""},autoCompose:{attribute:"auto-compose",defaultValue:!0}},listeners:[],init:function(){},render:function(){var _this=this.dom(),settings=this.settings,hour=" hour-"+settings.hourSystem,inHTML=(_this.addClass(settings.cls+"combination-container"),""),widgets=(!1===settings.labelField&&!settings.subLabelField||(inHTML+='<div class="widget-fieldlabel-wrap '+settings.labelCls+(settings.labelField?" has-main-label":"")+'">',inHTML+='<div class="widget-fieldlabel-inner">',inHTML+='<label class="widget-fieldlabel combination-fieldlabel">'+settings.labelField+"</label>",""!==settings.labelField&&(inHTML+='<span class="widget-separator">'+settings.separator+"</span>"),""!==settings.subLabelField&&(inHTML+='<span class="widget-sub-fieldlabel combination-sub-fieldlabel">'+settings.subLabelField+"</span>"),inHTML+="</div>",inHTML+="</div>"),inHTML+='<div class="widget-wrap-outer combination-wrap-outer">',inHTML+='<div widget="errortip"></div>',inHTML+="</div>",settings.tipText&&(inHTML+='<div widget="toolTip"></div>'),_this.children("div[widget]")),len=widgets.length,separatorIsArray;_this.append(inHTML),_this.children("div.combination-wrap-outer").eq(0).prepend(widgets),settings.autoCompose&&(/^\[.*\]$/.test(settings.widgetSeparator)&&(settings.widgetSeparator=eval(settings.widgetSeparator)),separatorIsArray=$.isArray(settings.widgetSeparator),widgets.each(function(e,t){var a=$(this).attr("widget");$(this).addClass("combination-item widget-"+e+" "+a+"-"+e),!1!==settings.widgetSeparator&&e<len-1&&$(this).after('<span class="separator separator-'+e+'">'+(separatorIsArray&&settings.widgetSeparator[e]||settings.widgetSeparator)+"</span>")}),_this.addClass("total-"+(""===settings.total?len:settings.total)))},disable:function(){var e=this.dom();e.addClass("disabled").find(".combination-wrap-outer>div[widget]").each(function(e,t){$(t).data("viewObj").disable()}),e.triggerHandler("ev_view_disable")},enable:function(){var e=this.dom();e.removeClass("disabled").find(".combination-wrap-outer>div[widget]").each(function(e,t){$(t).data("viewObj").enable()}),e.triggerHandler("ev_view_enable")}})}(),(s=>{s.su.Widget.register("colorpicker",{settings:{},listeners:[{selector:"input.hex-input",event:"keydown",callback:function(e,t){48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105||65<=e.keyCode&&e.keyCode<=70||8===e.keyCode||190===e.keyCode||110===e.keyCode||e.ctrlKey||e.metaKey||39===e.keyCode||37===e.keyCode||e.preventDefault()}},{selector:"input.hex-input",event:"keyup change",callback:s.su.debounce(function(e,t){var a=s(this).val()||"#ffffff",i=s.su.clone(t.value),a=s.su.hexToRgb(a);a&&(i.r=a.r,i.g=a.g,i.b=a.b,t.dom().triggerHandler("ev_view_change",[{"type":"value","value":i}]))},500)},{selector:"input.opacity-input",event:"keyup change",callback:s.su.debounce(function(e,t){var a,i=s(this).val()||100;100<Number(i)||Number(i)<0||isNaN(Number(i))||((a=s.su.clone(t.value)).a=Number(i)/100,t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}]))},500)},{selector:"input.opacity-input",event:"keydown",callback:function(e,t){(!(48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105||8===e.keyCode||190===e.keyCode||110===e.keyCode||e.ctrlKey||e.metaKey||39===e.keyCode||37===e.keyCode)||!0===e.shiftKey)&&e.preventDefault()}},{selector:"span.color-display, input.hex-input, input.opacity-input",event:"click",callback:function(e,t){t.showPicker()}},{selector:"span.opacity-button.up",event:"click",callback:function(e,t){t.showPicker();var a,i=t.dom().find("input.opacity-input").val();100!==Number(i)&&(""!==i&&"number"==typeof Number(i)&&0<=i&&i<=99?t.dom().find("input.opacity-input").val(++i):(t.dom().find("input.opacity-input").val(0),i=0),(a=s.su.clone(t.value)).a=Number(i)/100,t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}]))}},{selector:"span.opacity-button.down",event:"click",callback:function(e,t){t.showPicker();var a,i=t.dom().find("input.opacity-input").val();0!==Number(i)&&(""!==i&&"number"==typeof Number(i)&&1<=i&&i<=100?t.dom().find("input.opacity-input").val(--i):(t.dom().find("input.opacity-input").val(100),i=100),(a=s.su.clone(t.value)).a=Number(i)/100,t.dom().triggerHandler("ev_view_change",[{"type":"value","value":a}]))}}],init:function(){this._showPicker=!1,this.value=null,this.hexString="",this.opacity=""},render:function(){var t=this,a=this.dom(),e=this.settings,i=(e.readOnly,"");a.addClass("colorpicker-container widget-container"),null!==e.labelField&&(i=(i+='<div class="widget-fieldlabel-wrap '+e.labelCls+'">')+'<label class="widget-fieldlabel keywords-fieldlabel">'+e.labelField+"</label>",e.labelField&&(i+='<span class="widget-separator">'+e.separator+"</span>"),i+="</div>"),a.append(i=(i=(i=i+'<span class="color-display"></span>'+'<div class="colorpicker-hex-container"><input type="text" class="hex-input"></div>')+'<div class="colorpicker-opacity-container"><input type="text" class="opacity-input"></div>'+'<div class="widget-colorpicker-wrap u-d-none">')+'<label class="colorpicker-fieldlabel"></label>'+"</div>"),a.find(".colorpicker-opacity-container").append("<div class='text-wrap-after'><span class='opacity-button up'></span><span class='opacity-button down'></span></div>"),a.find(".colorpicker-fieldlabel").spectrum({preferredFormat:"hex",color:"#ffffff",flat:!0,appendTo:a,move:function(e){t.dom().triggerHandler("ev_view_change",[{"type":"value","value":e.toRgb()}]),a.find("span.color-display").css("background-color",e.toRgbString()),a.find("input.opacity-input").val((100*e.toRgb().a).toFixed(0))}}),a.find(".sp-button-container").hide()},setValue:function(e){var t;this.value!==e&&e&&(this.value=e,(t=this.dom()).find("input.hex-input").val(s.su.rgbToHexString(e)),this.hexString=s.su.rgbToHexString(e),null!=e.a&&""!==e.a?(t.find("input.opacity-input").val((100*e.a).toFixed(0)),this.opacity=(100*e.a).toFixed(0)):t.find("input.opacity-input").val(this.opacity),t.find(".colorpicker-fieldlabel").spectrum("set",e),t.find("span.color-display").css("background-color",this.toRgbString(e)))},getValue:function(){return this.value},reflow:function(){this.dom().find(".colorpicker-fieldlabel").spectrum("reflow")},showPicker:function(){var e=this.dom(),t=this;e.find(".widget-colorpicker-wrap").show(),e.find(".widget-colorpicker-wrap").css("margin-top",4),e.find(".widget-colorpicker-wrap").css("left",210),e.find(".colorpicker-fieldlabel").spectrum("reflow"),setTimeout(function(){s("body").on("click",function(e){e=e.target||e.srcElement;t._showPicker&&0===s(e).closest("#"+t.domId).length&&(t.hidePicker(),s("body").off("click"))})},0),this._showPicker=!0},hidePicker:function(){this.dom().find(".widget-colorpicker-wrap").hide(),this._showPicker=!1},toRgbString:function(e){return 1===e.a?"rgb("+Math.round(e.r)+", "+Math.round(e.g)+", "+Math.round(e.b)+")":"rgba("+Math.round(e.r)+", "+Math.round(e.g)+", "+Math.round(e.b)+", "+e.a+")"}})})(jQuery),(()=>{var t=$.su.CHAR.GRANULARITY_PICKER,a=0,i=1,s=2,n={},l=(n[a]="5min",n[i]="hourly",n[s]="daily",0),o=1,d=2,r=3;$.su.Widget.register("granularityPicker",{settings:{defaultSelected:{attribute:"default-selected",defaultValue:"hours24"},type:{attribute:"type",defaultValue:"tab"},showTimeRangeText:{attribute:"show-time-range-text",defaultValue:!0}},listeners:[],init:function(e){this.rangeList={hour1:{text:t.HOUR1,interval:36e5,granularity:a,wanGranularity:l},hours24:{text:t.HOURS24,interval:864e5,granularity:i,wanGranularity:o},days7:{text:t.DAYS7,interval:6048e5,granularity:i,wanGranularity:d},days30:{text:t.DAYS30,interval:2592e6,granularity:s,wanGranularity:r}}},render:function(){var e=this.dom(),a=this,t=this.settings,i="tab"===t.type,s="combobox"===t.type,n=this.settings.showTimeRangeText;e.addClass(t.cls+"granularity-picker-container");t=(t="")+'<div class="widget-wrap-outer granularity-picker-wrap-outer"><div id="'+this.domId+'_granularity_picker" class="granularity-picker">';n&&(t+='<div class="time-range-display-container u-d-inline-block"><span class="time-range-text"></span></div>'),i&&(t=(t=t+('<div widget="tab" id="'+this.domId)+'_tab" class="range-tab tab_menu_top u-d-inline-block m-b-0"><div widget="transition">')+this.getTabsHtml()+"</div></div>"),s&&(t+='<div widget="combobox" id="'+this.domId+'_combobox" class="range-combobox u-d-inline-block m-b-0"></div>'),e.append(t=t+"</div>"+"</div>"),i&&(n={id:this.domId+"_tab"},this.tab=new $.su.widgets.tab(n),this.tab.render(),this.tab.dom().on("ev_tab_select",function(e,t){a.updateRange(),a.dom().triggerHandler("ev_granularity_change",[a.granularityValue])})),s&&(this.combobox=new $.su.widgets.combobox({id:this.domId+"_combobox"}),this.combobox.render(),this.combobox.loadItems(this.getComboboxItems()),this.combobox.dom().on("ev_view_change",function(e,t){a.combobox.setValue(t.value),a.updateRange(),a.dom().triggerHandler("ev_granularity_change",[a.granularityValue])})),a.updateRange()},getTabsHtml:function(){var i="",s=this;return $.each(this.rangeList,function(e,t){var a=s.settings.defaultSelected===e?"selected":"";i+='<div class="tab-btn '+a+'" data-name="'+e+'">'+t.text+"</div>"}),i},getComboboxItems:function(){var a=[],i=this;return $.each(this.rangeList,function(e,t){a.push({name:t.text,value:e,selected:i.settings.defaultSelected===e})}),a},getSelectedRange:function(){var e=this.settings,t="tab"===e.type,e="combobox"===e.type;return t?this.tab.getActiveTabName():e?this.combobox.getValue():this.settings.defaultSelected},setSelectedRange:function(e){var t=this.settings,a="tab"===t.type,t="combobox"===t.type;a&&this.tab.setActive(e),t&&this.combobox.setValue(e),this.updateRange(),this.dom().triggerHandler("ev_granularity_change",[this.granularityValue])},updateRange:function(){var e=this.getSelectedRange(),t=this,a=$.su.serviceManager.get("time").getNowTimeStamp(),i=a-this.getInterval(e);t.settings.showTimeRangeText&&this.updateRangeText(i,a),this.granularityValue={start:t.transTime(i),end:t.transTime(a),granularity:t.getGranularity(e),wanGranularity:t.getWanGranularity(e),granularityUrl:t.getGranularityUrl(e)}},getInterval:function(e){return this.rangeList[e].interval},getGranularity:function(e){return this.rangeList[e].granularity},getWanGranularity:function(e){return this.rangeList[e].wanGranularity},getGranularityUrl:function(e){return n[this.getGranularity(e)]},updateRangeText:function(e,t){var a=$.su.serviceManager.get("user").isSiteView()?"site":"controller",e=$.su.serviceManager.get("time").getTextFromUTC(e,a,{pattern:"MM dd, hh:mm hc"}),t=$.su.serviceManager.get("time").getTextFromUTC(t,a,{pattern:"MM dd, hh:mm hc"});this.dom().find(".time-range-text").text(e+" - "+t)},transTime:function(e){return Math.round(e/1e3)},getGranularityValue:function(){return this.updateRange(),this.granularityValue}})})(),(()=>{var i=$.su.Widget.register("imageEditor",{extend:"file",settings:{ratio:{attribute:"ratio",defaultValue:!1},maxSize:{attribute:"max-size",defaultValue:""},btnCtrl:{attribute:"btn-ctrl",defaultValue:!0},realSize:{attribute:"real-size",defaultValue:!0}},listeners:[{selector:"input.file-input",event:"click",callback:function(e,t){t.resetFile()}},{selector:function(){return{parent:this.dom().find("input.file-input")}},event:"change",callback:function(e,t){var a=t.getContainer(),i=$(this),s=i.val();if(s){if(i[0].files){var n=i[0].files[0].size;if(t.settings.maxSize&&n>Number(t.settings.maxSize))return t.resetPreview(),void t.dom().triggerHandler("ev_img_size_error",[n])}-1<".jpg,.bmp,.gif,.png,.jpeg".indexOf(l(s).toLowerCase())?((i=document.getElementById(t.domId+"-canvas"))&&i.getContext&&(t.previewImage($("#"+t.domId+" input")[0],t.domId+"_jcrop_img",t.domId+"_jcrop_wrap",t.ratio),a.find("div.jcrop-wrap").show().css("display","inline-block")),a.find("div.img-editor-button-wrap").show(),a.find("div.file-wrap-outer").hide(),a.find("div[widget=toolTip]").hide(),t.dom().triggerHandler("ev_img_change",[t.getLoadFileName(),n])):(t.dom().triggerHandler("ev_img_type_error",[l(s).toLowerCase()]),t.resetPreview())}function l(e){var t=e.lastIndexOf(".");return e.substr(t)}}},{selector:"div.img-editor-confirm-btn",event:"click",callback:function(e,t){var a,i=t.getContainer(),s=i.find("input.file-input"),n=i.find("div.img-editor-confirm-btn").data("viewObj"),l=s.val().toLowerCase(),i=document.getElementById(t.domId+"-canvas");i&&i.getContext?(s=t.drawSltImg(),a=s.toDataURL("image/png"),s.toBlob(function(e){t.dom().triggerHandler("ev_img_edit",[l,e,n,a,t.getLoadFileName()])},"image/png")):t.dom().triggerHandler("ev_img_edit",[l])}},{selector:"div.img-editor-change-btn",event:"click",callback:function(e,t){t=t.getContainer();e.preventDefault(),e.stopPropagation(),t.find("input.file-input").click()}}],init:function(){var e;!1===this.settings.ratio||this.settings.ratio.match(/^[0-9]+:[0-9]+$/)?(!1!==this.settings.ratio&&(e=this.settings.ratio.split(":"),this.ratio=+e[0]/e[1],this.imgRatio=1),this.imgObj=new Image,this.imageSrc="",this.jcrop_api,this.jcrop_x=0,this.jcrop_y=0,this.jcrop_w=30,this.jcrop_h=this.ratio?30/this.ratio:30):console.error("ratio must be 'width:height',like '1:2'")},render:function(){i.superclass.render.call(this);var e=this.dom(),t=(e.addClass("imageEditor-container"),'<div id="'+this.domId+'_jcrop_wrap" class="jcrop-wrap">');t+='<img id="'+this.domId+'_jcrop_img" class="jcrop-img"/>',t=(t=this.settings.btnCtrl?(t=(t+='<div class="img-editor-button-wrap" >')+'<div widget="button" id="'+this.domId+'-confirm-btn" class="img-editor-confirm-btn m-t-12" label-field="test" type="button" text="'+$.su.CHAR.OPERATION.CONFIRM+'"></div>')+'<div widget="button" id="'+this.domId+'-change-btn"  class="img-editor-change-btn" label-field="test" type="button" text="'+$.su.CHAR.OPERATION.CHANGE+'"></div></div>':t)+'</div><canvas class="canvas-bgd" id="'+this.domId+'-canvas"></canvas>',e.append(t);for(var a=1;a<=3;a++)new $.su.widgets.button({id:e.find("div[widget=button]").eq(a)}).render()},previewImage:function(e,a,t,i){var s,n=this,l=(void 0!==n.jcrop_api&&n.jcrop_api.destroy(),e.value.substring(e.value.lastIndexOf(".")+1).toLowerCase()),o=window.navigator.userAgent.toUpperCase();0!=l.length&&-1<".jpg,.bmp,.gif,.png,.jpeg".indexOf(l)?e.files?window.FileReader?(s=new FileReader,null!=e.files[0]&&s.readAsDataURL(e.files[0]),s.onload=function(e){imageSrc=e.target.result,n.imgObj.src=e.target.result,$(a).css("display","inline-block");setTimeout(function(){n.imgObj.width<266&&n.imgObj.height<266?(document.getElementById(a).style.width=n.imgObj.width+"px",document.getElementById(a).style.height=n.imgObj.height+"px",n.imgRatio=1):n.imgObj.width>=n.imgObj.height?(document.getElementById(a).style.width="266px",document.getElementById(a).style.height="auto",n.imgRatio=266/n.imgObj.width):n.imgObj.width<n.imgObj.height&&(document.getElementById(a).style.height="266px",document.getElementById(a).style.width="auto",n.imgRatio=266/n.imgObj.height);var e=getComputedStyle(document.getElementById(a)).width.replace("px",""),t=getComputedStyle(document.getElementById(a)).height.replace("px","");n.jcrop_x=.1*e,n.jcrop_y=.1*t,n.jcrop_w=.8*e,n.jcrop_h=.8*t,$("#"+a).Jcrop({aspectRatio:i,onSelect:function(e){n.jcrop_x=e.x,n.jcrop_y=e.y,n.jcrop_w=e.w,n.jcrop_h=e.h,n.dom().triggerHandler("ev_img_resize")},allowSelect:!1,allowResize:!0,allowMove:!0,boundary:0,bgColor:"transparent"},function(){n.jcrop_api=this,n.jcrop_api.setSelect([.1*e,.1*t,.9*e,.9*t]),n.dom().triggerHandler("ev_img_resize")})},100);document.getElementById(a).style.display="inline-block",document.getElementById(a).setAttribute("src",e.target.result)}):o.indexOf("SAFARI"):-1<o.indexOf("MSIE")?-1<o.indexOf("MSIE 6")?document.getElementById(a).setAttribute("src",e.value):(e.select(),-1<o.indexOf("MSIE 9")&&e.blur(),null==(s=document.getElementById(t+"New"))&&((s=document.createElement("div")).setAttribute("id",t+"New"),s.style.width=document.getElementById(a).width+"px",s.style.height=document.getElementById(a).height+"px",s.style.border="solid 1px #d2e2e2"),s.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='scale',src='"+document.selection.createRange().text+"')",(t=document.getElementById(t)).parentNode.insertBefore(s,t),t.style.display="none"):-1<o.indexOf("FIREFOX")?parseFloat(o.toLowerCase().match(/firefox\/([\d.]+)/)[1])<7?document.getElementById(a).setAttribute("src",e.files[0].getAsDataURL()):document.getElementById(a).setAttribute("src",window.URL.createObjectURL(e.files[0])):document.getElementById(a).setAttribute("src",e.value):0!=l.length&&(e.value="",-1<o.indexOf("MSIE")&&(e.select(),document.selection.clear()),document.getElementById(a).setAttribute("src",""),document.getElementById(a).style.display="none")},drawSltImg:function(){var e=document.getElementById(this.domId+"-canvas"),t=this.settings.realSize?this.imgRatio:1,a=this.jcrop_x/t,i=this.jcrop_y/t,s=this.jcrop_w/t,t=this.jcrop_h/t,n=(e.width=s,e.height=t,e.getContext("2d")),s=s>this.imgObj.width?this.imgObj.width:s,t=t>this.imgObj.height?this.imgObj.height:t;return n.drawImage(this.imgObj,a/(this.settings.realSize?1:this.imgRatio),i/(this.settings.realSize?1:this.imgRatio),s/(this.settings.realSize?1:this.imgRatio),t/(this.settings.realSize?1:this.imgRatio),0,0,s,t),e},getImageData:function(){var t,e,a=$.Deferred();return this.imgObj.src?(t={},e=this.drawSltImg(),t.base64=e.toDataURL("image/png"),this.fileName.match(/(\.png)$/i)?e.toBlob(function(e){t.blob=e,a.resolve(t)},"image/png"):e.toBlob(function(e){t.blob=e,a.resolve(t)},"image/jpeg")):a.resolve(null),a.promise()},resetPreview:function(){var e=this.getContainer();this.imgObj=new Image,e.find("div.jcrop-wrap").hide(),e.find("div.img-editor-button-wrap").hide(),e.find("div.file-wrap-outer").show(),e.find("div[widget=toolTip]").show()}})})(),$.su.Widget.register("releaseLog",{settings:{maxLines:{attribute:"max-lines",defaultValue:10}},listeners:[{selector:".release-log-wrap-after span",event:"click",callback:function(e,t){t.moreMsg.setContentByHtml(t.getValue()),t.moreMsg.show()}}],init:function(){},render:function(){var e=this.dom(),t=this.settings,a=!1===t.labelField?"label-empty":"",a=(e.addClass(t.cls+"displaylabel-container "+a),""),a=(a=(a+='<div class="widget-fieldlabel-wrap '+t.labelCls+'">')+('<label class="widget-fieldlabel text-fieldlabel">'+t.labelField+"</label>"),t.labelField&&(a+='<span class="widget-separator">'+t.separator+"</span>"),a=(a=(a=a+"</div>"+'<div class="widget-wrap-outer release-log-wrap-outer">')+'<div class="widget-wrap release-log-wrap">'+"</div>")+('<div class="release-log-wrap-after"><span>'+$.su.CHAR.COMMON.MORE+"</span></div>"),e.append(a+="</div>"),t.maxLines&&e.find("div.release-log-wrap").css("max-height",25*t.maxLines+8+"px"),'<div widget="msg" class="msg-in-release-log" type="window" id="'+this.domId+'_more-msg" msg-title="'+$.su.CHAR.COMMON.RELEASE_NOTE+'"></div>');e.append(a),this.moreMsg=new $.su.widgets.msg({id:e.find("#"+this.domId+"_more-msg")}),this.moreMsg.render()},setValue:function(e){var t,a=this.dom(),i=this,s="";if(e){for(a.show(),t=e.split("\n")||[],l=0;l<t.length;l++)s+='<div class="release-log-item"></div>';a.find("div.release-log-wrap").html(s);for(var n=a.find("div.release-log-wrap .release-log-item"),l=0;l<t.length;l++)n[l].innerText=t[l]}else a.hide();setTimeout(function(){i.isOverflow()?a.find("div.release-log-wrap-after").removeClass("u-d-none"):a.find("div.release-log-wrap-after").addClass("u-d-none")},0)},getValue:function(){return this.dom().find("div.release-log-wrap").html()},isOverflow:function(){for(var e=0,t=this.dom().find("div.release-log-item"),a=0;a<t.length;a++)e+=Number($(t[a]).height());return e>25*this.settings.maxLines+8}}),$.su.Widget.register("treeSelect",{settings:{selectType:{attribute:"select-type",defaultValue:"single"},placeholder:{attribute:"select-placeholder",defaultValue:$.su.CHAR.COMMON.PLEASE_SELECT},isDisabled:{attribute:"is-disabled",defaultValue:"false"},customWidth:{attribute:"custom-width",defaultValue:""},allowSelectAll:{attribute:"allow-select-all",defaultValue:!0},selectAllPos:{attribute:"select-all-pos",defaultValue:"top"},independent:{attribute:"independent",defaultValue:!1},noneItemTipText:{attribute:"none-item-tip-text",defaultValue:$.su.CHAR.COMMON.NO_ITEMS},tipText:{attribute:"tip-text",defaultValue:""},showPath:{attribute:"show-path",defaultValue:!1},onlySelectLeafnode:{attribute:"only-select-leafnode",defaultValue:!0},searchBox:{attribute:"search-box",defaultValue:!1},maxTagCount:{attribute:"max-tag-count",defaultValue:20}},listeners:function(){return[{seletor:".tree-select-selector-wrap",event:"click",callback:function(e,t){e=$(e.target);0===e.parents(".tree-select-selector-wrap").length&&!e.hasClass("tree-select-selector-wrap")||e.parents(".tree-select-container").hasClass("disabled")||e.hasClass("close")||(t.settings.searchBox&&t._resetSearchedData(),t._expanded?t._collapseDropdown(200):t._expandDropdown(200))}},{selector:".tree-select-selector-wrap",event:"mouseenter",callback:function(e,t){t.toggleClear(!0)}},{selector:".tree-select-selector-wrap",event:"mouseleave",callback:function(e,t){t.toggleClear()}},{selector:".tree-select-selector-switch.clear .icon",event:"click",callback:function(e,t){e.stopPropagation(),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":[]}]),t.dom().find(".tree-select-selector-switch").removeClass("clear"),t._collapseDropdown()}},{seletor:".tree-select-selector-wrap .selector-text .close",event:"click",callback:function(e,t){var a=$(e.target);if(a.hasClass("close")&&!a.parents(".tree-select-container").hasClass("disabled")){e.stopPropagation(),e.preventDefault();for(var i=a.siblings(".text").attr("node-path"),s=t._selectedData.map(t._formatPath),n=[],l=0;l<s.length;l++)0===s[l].indexOf(i)||n.push(t._selectedData[l]);t.dom().triggerHandler("ev_view_change",[{type:"value",value:n}]),setTimeout(function(){t.dom().triggerHandler("ev_view_change",[{type:"valid",value:t.getValue()}])},0)}}},{selector:".tree-select-dropdown-children-ul",event:"ev_click_item",callback:function(e,t,a,i){var s=[];if("single"===i.settings.selectType)s.push(i._formatSingleObj(t)),i.settings.independent||i.dom().find(".tree-select-dropdown-children-ul").trigger("ev_click_single_item_collapse",[t]);else if("multiple"===i.settings.selectType)for(var s=$.su.clone(i._selectedData),n=i._selectedData.map(i._formatPath),l=i._formatPath(t),o=i._flattenData,d=0;d<o.length;d++){var r,c=i._formatPath(o[d]);(0===c.indexOf(l)&&-1!==c.indexOf("|")||c===l)&&(-1===(r=n.indexOf(c))?o[d].disabled||(s.push(i._formatSingleObj(o[d])),n.push(c)):"full"!==a&&(s.splice(r,1),n.splice(r,1)))}i.dom().triggerHandler("ev_view_change",[{type:"value",value:s}]),i.toggleClear(!0)}},{selector:".tree-select-dropdown-children-ul",event:"ev_click_single_item_collapse",callback:function(e,i,t){"single"===t.settings.selectType&&(t.dom().find(".tree-select-node-text").each(function(e,t){var a=$(t);$(t).attr("node-value")!==i.value&&a.trigger("ev_remove_selected_class")}),t._collapseDropdown())}},{selector:function(){return{parent:"body",target:""}},event:"click",callback:function(e,t){e.stopPropagation();e=e.target||e.srcElement,e=$(e).closest(".tree-select-wrap-outer");t._expanded&&0===e.length&&t._collapseDropdown()}},{selector:".tree-select-dropdown",event:"mouseleave",callback:function(e,t){var a=t.getValue();t.dom().triggerHandler("ev_view_change",[{"type":"valid","value":a}]),t.toggleClear()}},{selector:".tree-select-dropdown",event:"mouseenter",callback:function(e,t){t.toggleClear(!0)}},{selector:".tree-select-all-row a",event:"click",callback:function(e,t){t._empty?$(this).closest(".tree-select-all-row").removeClass("selected").addClass("selected"):$(this).closest(".tree-select-all-row").removeClass("selected"),t._empty?t.selectAll():t.unSelectAll(),t.toggleClear(!0)}},{selector:".tree-select-search-box",event:"ev_textbox_search",callback:function(e,t,a){a._filterOptions(t)}}]},init:function(){this._originData=[],this._flattenData=[],this._selectedData=[],this._hashMap={},this._rootMap={},this._empty=!0,this.onlySelectLeafnode=this.settings.onlySelectLeafnode},render:function(){var e=this.settings,t=!1===e.labelField?" label-empty":"",a=this.dom(),i="multiple"===e.selectType,s=e.allowSelectAll,n=e.searchBox,l=""===e.tips?"":" tips",t=(a.addClass("widget-container tree-select-container"+t+l+(e.independent?" independent":"")),i&&a.addClass("multiple"),"true"===this.settings.isDisabled&&this.setDisabled(),"");null!==e.labelField&&(t=(t+='<div class="widget-fieldlabel-wrap '+e.labelCls+'">')+'<div class="widget-fieldlabel-inner"><label class="widget-fieldlabel text-fieldlabel">'+e.labelField+"</label>",e.labelField&&(t+='<span class="widget-separator">'+e.separator+"</span>"),t+="</div></div>"),t+='<div class="widget-wrap-outer tree-select-wrap-outer u-d-inline-block">',e.independent||(t=(t=(t+='<div class="widget-wrap tree-select-selector-wrap hover-errortip"><span class="text-wrap-before"></span>')+'<div class="selector-wrap-text"><span class="selector-text'+(i?" multiple-items-container":"")+'">')+'<span class="placeholder">'+e.placeholder+'</span></span></div><a class="tree-select-selector-switch"><span class="icon"></span></a><span class="text-wrap-after"></span></div>'),t+='<div class="tree-select-dropdown'+(e.independent?"":" u-d-none")+'">',n&&(t+="<div widget='textbox' class='tree-select-search-box search-box' ></div>"),t=(i&&s&&"top"===e.selectAllPos?(t=(t+='<ul class="tree-select-dropdown-all-ul">')+'<div id="'+this.domId+'_selectAll" class="tree-select-node-container tree-select-all"><div class="tree-select-all-row multiple"><a class="checkbox"><span class="tree-select-all-select-icon"></span></a><a class="text-node">')+'<span class="tree-select-all-text" title="Select All">'+$.su.CHAR.COMMON.ALL+"</span></a></div></div></ul>":t)+'<ul class="tree-select-dropdown-children-ul"></ul>',t=(t=i&&s&&"bottom"===e.selectAllPos?(t=(t+='<ul class="tree-select-dropdown-all-ul">')+'<div id="'+this.domId+'_selectAll" class="tree-select-node-container tree-select-all"><div class="tree-select-all-row multiple"><a class="checkbox"><span class="tree-select-all-select-icon"></span></a><a class="text-node">')+'<span class="tree-select-all-text" title="Select All">'+$.su.CHAR.COMMON.ALL+"</span></a></div></div></ul>":t)+'</div><div widget="errortip" error-cls="'+e.errorTipsCls+'"></div></div>',null!=e.tips&&null!=e.tips&&(t=(t+='<div class="widget-tips textbox-tips '+e.tipsCls+'">')+'<div class="content tips-content">'+e.tips+"</div></div>"),e.tipText&&(t+='<div widget="toolTip"></div>'),a.append(t),e.independent||a.find(".tree-select-dropdown").hide(),n&&(this._searchBox=new $.su.widgets.textbox({id:a.find(".tree-select-search-box"),customSettings:{instantSearch:!0}}),this._searchBox.render()),$.su.scrollbar({ele:a.find(".tree-select-dropdown-children-ul")[0],opts:{wheelPropagation:!1}})},_createRootNode:function(e,t,a){return"single"!==t&&"multiple"!==t&&(t="single"),new $.su.widgets["treeSelectNode"]({id:e,selectType:t,onlySelectLeafnode:a})},loadItems:function(e){$.isArray(e)||(e=[e]),this._addParentStackToData(e);var t,a=0,i=e.length,s=this.dom().find(".tree-select-dropdown-children-ul"),n=this.dom().find(".tree-select-dropdown");for(this._children=[],this._rootMap={},n.removeClass("empty-items"),s.empty();a<i;a++){t=$('<div node-value="'+e[a].value+'"></div>'),s.append(t);var l=this._createRootNode(t,this.settings.selectType,this.onlySelectLeafnode);this._children.push(l),this._rootMap[e[a].value]=e[a].name,l.render(),l.loadData(e[a])}0===i&&n.addClass("empty-items"),t=$("<div class='tree-select-node-text-empty'>"+this.settings.noneItemTipText+"</div>"),s.append(t);l=this._createRootNode(t,this.settings.selectType,this.onlySelectLeafnode);for(this._children.push(l),l.render(),this._originData=e,this._flattenData=this._flattenOriginData(e),this._hashMap={},a=0;a<this._flattenData.length;a++)this._hashMap[this._flattenData[a].value]={name:this._flattenData[a].name,parentStack:this._flattenData[a].parentStack};this._selectedData=this._initSelectedData(this._flattenData),this._updateSelectorText(this._selectedData),this._expandSelectedTree(this._selectedData)},clearTree:function(e){this.dom().find(".tree-select-dropdown-children-ul").empty()},_expandDropdown:function(e){e=e||0===e?e:200,this._expanded=!0;var t=this.dom();t.addClass("opened"),t.find(".tree-select-selector-switch").addClass("arrow-up"),t.find(".tree-select-dropdown").eq(0).slideDown(e)},_collapseDropdown:function(e){e=e||0===e?e:200,this._expanded=!1;var t=this.dom();t.removeClass("opened"),t.find(".tree-select-selector-switch").removeClass("arrow-up"),t.find(".tree-select-dropdown").eq(0).slideUp(e)},_resetSearchedData:function(){this._searchBox.setValue(null),this._filterOptions(null)},setValue:function(e){if(null===e)this.dom().triggerHandler("ev_view_change",{type:"value",value:[]});else{if(("string"==typeof e[0]||"number"==typeof e[0])&&"{}"!==JSON.stringify(this._hashMap))for(var t=0;t<e.length;t++)e[t]={name:this._hashMap[e[t]].name,parentStack:this._hashMap[e[t]].parentStack,value:e[t]};0<e.filter(function(e){return!(e.name+""&&e.parentStack&&e.value+"")}).length?this.dom().triggerHandler("ev_view_change",{type:"value",value:[]}):(this._selectedData=e,this._updateTreeSelect(this._selectedData))}},getValue:function(){return this.getSelectedData()},getSelectedData:function(){return this._selectedData.map(function(e){return{name:e.name,value:e.value,parentStack:e.parentStack}})},_addParentStackToData:function(e,t){t=$.isArray(t)?$.su.clone(t):[];for(var a=0;a<e.length;a++)e[a].parentStack=t,e[a].children&&this._addParentStackToData(e[a].children,e[a].parentStack.concat([e[a].value]))},_flattenOriginData:function(e,t){var a=[];for(var i=0;i<e.length;i++)e[i].children&&0<e[i].children.length?a=a.concat(this._flattenOriginData(e[i].children,e[i].value)):a.push(e[i]);return a},_initSelectedData:function(e){return e.filter(function(e){return!!e.selected&&$.su.clone(e)})},_formatSingleObj:function(e){return{name:e.name,value:e.value,parentStack:e.parentStack||[],type:e.type||void 0}},_updateTreeSelect:function(e){this._updateSelectorText(e),this._updateTreeNode(e);var t="multiple"===this.settings.selectType,a=this.settings.allowSelectAll;t&&a&&(t=this.dom().find(".tree-select-all-row"),0===e.length?(t.removeClass("selected partial-selected"),this._empty=!0):e.length===this._flattenData.length?(t.removeClass("selected partial-selected").addClass("selected"),this._empty=!1):(t.removeClass("selected partial-selected").addClass("partial-selected"),this._empty=!0))},_updateSelectorText:function(e){if(!this.settings.independent){var t=this.dom().find(".selector-text"),a='<span class="placeholder">'+this.settings.placeholder+"</span>";if(0===e.length)t.html(a);else{var i=t.width()||300;if("multiple"===this.settings.selectType){var a=this.settings.maxTagCount,s=e.length>a?a:e.length;t.html("");for(var n,l=0;l<s;l++){var o,d=this._formatPath(e[l]),r=$('<span class="multiple-item"></span>'),c="",u=(c+='<span class="text" node-value="'+e[l].value+'" node-path="'+d+'">',"");if(this.settings.showPath)for(u+=this._rootMap[e[l].parentStack[0]]+"-",o=e[l].parentStack.length-1;0<o;o--)u+=this._hashMap[e[l].parentStack[o]]+"-";u+=e[l].name,c=(c+=$.su.ellipsisGridStr(u,i-26))+"</span>"+'<span class="close icon"></span>',r.append(c),t.append(r),r.data("dataObj",e[l])}e.length>a&&(n="",n+='<span class="multiple-item over-item">',a="+ "+(e.length-a)+" ...",a=$.su.ellipsisGridStr(a,i-26),t.append(n=n+a+"</span>"))}else{a=e[0].name;t.html(a)}}}},_updateTreeNode:function(e){var s=e.map(this._formatPath),e=this.dom().find(".tree-select-node-text"),n=this;"multiple"===this.settings.selectType?e.each(function(e,t){var t=$(t),a=t.parents(".tree-select-node").data("viewObj"),a=n._formatPath(a._data);n._needRemoveSelectedClass(a,s)?t.trigger("ev_remove_selected_class"):t.trigger("ev_add_selected_class")}):e.each(function(e,t){var t=$(t),a=t.parents(".tree-select-node").data("viewObj"),i=n._formatPath(a._data);s.some(function(e){return e===i})?t.trigger("ev_add_selected_class"):t.trigger("ev_remove_selected_class")})},_needRemoveSelectedClass:function(t,e){return 0===e.filter(function(e){return e===t||0===e.indexOf(t)}).length},_expandSelectedTree:function(e){var s,n,t=this.dom().find(".tree-select-node-open-icon");0===this._selectedData.length?t.each(function(e,t){var t=$(t),a=t.parents(".tree-select-node").data("viewObj");if($.isArray(a._data.children))return t.trigger("ev_expand_parent_node"),!1}):(s=e.map(function(e){return e.parentStack.join("|")}),n=this._formatPath,t.each(function(e,t){var t=$(t),a=t.parents(".tree-select-node").data("viewObj"),i=n(a._data);s.some(function(e){return 0===e.indexOf(i)})&&t.trigger("ev_expand_parent_node")}))},showLoading:function(){this.dom().addClass("loading")},hideLoading:function(){this.dom().removeClass("loading")},setDisabled:function(){this.dom().addClass("disabled")},setEnabled:function(){this.dom().removeClass("disabled")},_formatPath:function(e){var t=e.parentStack.join("|");return t+=(0===t.length?"":"|")+e.value},selectData:function(t){var e=this._flattenData.filter(function(e){return!e.disabled&&0<=t.indexOf(e.value)});e.length?this.dom().triggerHandler("ev_view_change",[{type:"value",value:e}]):this._updateTreeSelect([])},selectAll:function(){var e=this._flattenData.filter(function(e){return!e.disabled});e.length?(this.dom().triggerHandler("ev_view_change",[{type:"value",value:e}]),this._updateTreeSelect(e)):this._updateTreeSelect([])},unSelectAll:function(){this._updateTreeSelect([]),this.dom().triggerHandler("ev_view_change",[{type:"value",value:[]}])},getFlattenData:function(){return this._flattenData},getHashMap:function(){return this._hashMap},setOnlySelectLeafnode:function(e){this.onlySelectLeafnode=e},_filterOptions:$.su.debounce(function(e){var i,t=this.dom(),s=!1,n=!1;null==e||""===e?s=!0:i=$.su.createRegFromText(e,"i"),t.find(".tree-select-dropdown-children-ul")[0].scrollTop=0,this.dom().find(".tree-select-node-text").each(function(e,t){var t=$(t),a=t.parents(".tree-select-node").data("viewObj");s||i&&i.test(a._data.name)?(t.trigger("ev_tree_node_show"),n=!0):t.trigger("ev_tree_node_hide")}),this.dom().find(".tree-select-dropdown")[n?"removeClass":"addClass"]("empty-search")},200),toggleClear:function(e){var t,a;this.dom().hasClass("disabled")||(t=this.getValue(),a=this.dom().find(".tree-select-selector-switch"),e&&"multiple"===this.settings.selectType&&("array"===$.type(t)?0<t.length:t)?a.addClass("clear"):a.removeClass("clear"))}}),(()=>{var l=[{name:$.su.CHAR.ACCESS_POINTS.BAND1,value:"band1",rangeMin:36,rangeMax:48,children:[]},{name:$.su.CHAR.ACCESS_POINTS.BAND2,value:"band2",rangeMin:52,rangeMax:64,children:[]},{name:$.su.CHAR.ACCESS_POINTS.BAND3,value:"band3",rangeMin:100,rangeMax:144,children:[]},{name:$.su.CHAR.ACCESS_POINTS.BAND4,value:"band4",rangeMin:149,rangeMax:165,children:[]}];$.su.Widget.register("channelRangeSelect",{settings:{subLabel:{attribute:"sub-label",defaultValue:""}},listeners:function(){return[{seletor:".channel-item",event:"click",callback:function(e,t){$(e.target).parents(".channel-range-select-container").hasClass("disabled")||((e=$(e.target).parent(".channel-item")).hasClass("unchecked")?e.removeClass("unchecked").addClass("checked"):e.removeClass("checked").addClass("unchecked"),t.dom().triggerHandler("ev_view_change",[{"type":"value","value":t.getSelectedData()}]))}}]},init:function(){this._originData=[],this._selectedData=[]},render:function(){var e=this.settings,t=!1===e.labelField?" label-empty":"",a=this.dom(),t=(a.addClass("widget-container channel-range-select-container"+t),"");a.empty(),null!==e.labelField&&(t=(t+='<div class="widget-fieldlabel-wrap '+e.labelCls+'">')+'<label class="widget-fieldlabel combobox-fieldlabel">'+e.labelField+"</label>",e.labelField&&(t+='<span class="widget-separator">'+e.separator+"</span>"),e.subLabel&&(t+='<p class="sub-label">'+e.subLabel+"</p>"),t+="</div>"),a.append(t=(t=t+'<div class="widget-wrap-outer channel-range-wrap-outer">'+'<div class="widget-wrap channel-range-wrap">')+"</div>"+"</div>"),e.items&&0<e.items.length&&this.loadItems(e.items)},generateChannelsDom:function(e){if(!e||!e.length)return"";var t='<div class="channel-container">';l[0].rangeMin;if(this.needConvertChannelsToBands(e))for(var a=this.convert5gChannelsToBands(e),i=0;i<a.length;i++){var s=a[i].children;t=t+('<div class="band-outer '+a[i].value+'"</div>')+'<div class="channel-outer">';for(var n=0;n<s.length;n++)t+='<div class="channel-item unchecked" item-value="'+s[n].value+'"><span class="item-name">'+$.su.escapeHtml(s[n].name)+"</span></div>";t=(t+="</div>")+('<p class="band-text"> '+a[i].name+"</p>")+"</div>"}else{for(var t=t+'<div class="band-outer"</div>'+'<div class="channel-outer single-band">',i=0;i<e.length;i++)t+='<div class="channel-item unchecked" item-value="'+e[i].value+'"><span class="item-name">'+$.su.escapeHtml(e[i].name)+"</span></div>";t=t+"</div>"+"</div>"}return t+="</div>"},convert5gChannelsToBands:function(e){for(var t=$.su.clone(l),a=0;a<e.length;a++)for(var i=0;i<t.length;i++)if(Number(e[a].channelValue)>=t[i].rangeMin&&Number(e[a].channelValue)<=t[i].rangeMax){t[i].children.push({name:e[a].name,value:e[a].value});break}for(a=t.length-1;0<=a;a--)0===t[a].children.length&&t.splice(a,1);return t},loadItems:function(e){var t=this.dom();this._originData=$.su.clone(e),t.find("div.channel-range-wrap").eq(0).empty().append(this.generateChannelsDom(e)),t.triggerHandler("ev_view_update")},setValue:function(i){var e=this.dom().find("div.channel-range-wrap .channel-container").eq(0).find(".channel-item")||[];(null==i||""===i||$.isArray(i)&&0===i.length)&&(i=[]),$.each(e,function(e,t){var a=parseInt($(t).attr("item-value"));-1===i.indexOf(a)?$(t).removeClass("checked").addClass("unchecked"):$(t).removeClass("unchecked").addClass("checked")}),this.dom().triggerHandler("ev_view_change",{type:"value",value:i})},getValue:function(){return this.getSelectedData()},selectAll:function(){var e;this._originData&&(e=this._originData.map(function(e){return e.value}),this.setValue(e))},getSelectedData:function(){var e=this.dom(),a=[],e=e.find("div.channel-range-wrap .channel-container").eq(0).find(".channel-item")||[];return $.each(e,function(e,t){$(t).hasClass("checked")&&a.push(parseInt($(t).attr("item-value")))}),a},needConvertChannelsToBands:function(e){var t=l[0].rangeMin,t=e[0].channelValue<t,a=!1;return!t&&($.each(e,function(e,t){t.channelValue%2==0&&(a=!0)}),a)}})})(),$.su.Widget.register("customerCombobox",{settings:{name:{attribute:"name",defaultValue:""},labelField:{attribute:"label-field",defaultValue:""},noneSelectedText:{attribute:"none-selected-text",defaultValue:$.su.CHAR.COMMON.PLEASE_SELECT},noneItemTipText:{attribute:"none-item-tip-text",defaultValue:$.su.CHAR.COMMON.NO_ITEMS},itemWidth:{attribute:"item-width",defaultValue:240},virtualLazyLoad:{attribute:"virtual-lazy-load",defaultValue:!1},variableHeight:{attribute:"variable-height",defaultValue:!1}},listeners:[{selector:".combobox-switch.arrow-up .icon",event:"click",callback:function(e,t){e.stopPropagation(),t.hideGlobalOptions()}},{selector:"div.combobox-wrap",event:"click",callback:function(e,t){e.stopPropagation(),t._handleToggle(),t.dom().triggerHandler("ev_combobox_wrap_click")}},{selector:"div.combobox-wrap",event:"mouseenter",callback:function(e,t){t.dom().addClass("hover")}},{selector:"div.combobox-wrap",event:"mouseleave",callback:function(e,t){t.dom().removeClass("hover")}},{selector:".combobox-text",event:"click",callback:function(e){e.preventDefault()}},{selector:".combobox-text",event:"focus",callback:function(e,t){var a=t.getContainer();a.hasClass("disabled")||a.hasClass("none-items")||(t.setFocus(),a.addClass("focus"))}},{selector:".combobox-text",event:"keyup",callback:function(e,t){var a,i=$("#customer-combobox-options");i.attr("data-shown")===t.domId&&(a=i.find(".combobox-text").val(),t=i.find("input.combobox-checkbox"),i.find("li").removeClass("selected"),t.prop("checked",!1),t.each(function(e,t){if($(t).val()==a)return $(t).prop("checked",!0),$(t).closest("li.combobox-list").addClass("selected"),!1}))}}],init:function(){this._defaultValue=null,this._dataMap={},this._displayMap={},this._value=[],this._addonEnable=!0,this._addonTopEnable=!0,this._addonBottomEnable=!0,this._cascaderMap=[],this._cascaderValue=[],this._siteList=[],this._defaultPagingData={currentPage:1,currentPageSize:100},this.totalRows=0,this.expandKey="",this.searchKey=void 0,this.OPTION_NUM_IN_ONE_VIEW=8,this.optionHeight=36,this.dynamicOffset=0,this.dynamicHeight=0,this.EMPTY_SITE_HEIGHT=30.95,this.isIntegrated=window.top!==window,this.EXCLUDE_COMBOBOX_LIST_HEIGHT=this.isIntegrated?421:477,this.MIN_OPTION_NUM=4,this.COMBOBOX_CONTAINER_PADDING=16,this.COMBOBOX_DISTANCE_BOTTOM=24,this.COMBOX_LIST_CONTENT_WRAP_MIN_HEIGHT=298},render:function(){for(var e,t=this.dom(),a=this.settings,i=(t.addClass(a.cls).addClass("widget-container").addClass("combobox-container single cascader"),""),s=(this.addonTop=$.su.transferedStr(t.find("[slot=top]").html()||""),this.addonBottom=$.su.transferedStr(t.find("[slot=bottom]").html()||""),this.addonTop||this.addonBottom||(this.addonBottom=$.su.transferedStr(t.html())),t.empty(),null!==a.labelField&&(i=(i+='<div class="widget-fieldlabel-wrap '+a.labelCls+'">')+'<label class="widget-fieldlabel combobox-fieldlabel">'+("false"===a.labelField?"":$.su.escapeHtml(a.labelField))+"</label>",a.labelField&&(i+='<span class="widget-separator">'+a.separator+"</span>"),i+="</div>"),i=(i=(i=(i=(i+='<div class="widget-wrap-outer combobox-wrap-outer">')+'<div class="widget-wrap combobox-wrap">'+'<span class="text-wrap-before"></span>')+'<span class="combobox-wrap-inner">'+('<span class="combobox-text '+a.inputCls+'"readOnly></span>'))+"</span>"+('<a class="combobox-switch" tabindex="'+a.tabindex+'">'))+'<span class="icon"></span>'+"</a>",0===$("#customer-combobox-options").children().length&&(e='<div class="combobox-list-wrap">',e=(e+='<div class="position-top-left"></div><div class="position-top-center"></div><div class="position-center-left"><div class="position-center-right"><div class="combobox-list-content-wrap-outer"><div class="combobox-list-content-wrap"><div class="combobox-empty-tip"></div><div class="list-wrapper"><div class="customer-wrap">')+'<div class="combobox-no-search-result-tip">'+$.su.CHAR.COMMON.NO_SEARCH_RESULT_FOUND+'</div><ul class="combobox-list"></ul></div><div class="site-wrap"><div class="combobox-list-2-wrapper"><ul class="combobox-list-2 u-d-none">',this.isVirtualLazyLoad()&&(e+='<div class="combobox-list-2-container"></div><div class="combobox-list-2-phantom"></div>'),e+='</ul></div></div></div></div></div></div></div><div class="position-bottom-left"></div><div class="position-bottom-center"></div></div>',$("#customer-combobox-options").append(e)),i=i+'<div class="hidden combobox-lists"></div>'+'<div class="hidden combobox-lists">',this.isVirtualLazyLoad()&&(i+='<div class="combobox-list-2-container"></div><div class="combobox-list-2-phantom"></div>'),i=(i=(i=(i+="</div>")+'<div class="hidden combobox-lists"></div>'+'<div class="hidden top-slots"></div>')+'<div class="hidden bottom-slots"></div>'+'<span class="text-wrap-after"></span>')+"</div>"+('<div widget="errortip" error-cls="'+a.errorTipsCls+'">'),t.append(i=i+"</div>"+"</div>"),a.items&&0<a.items.length&&this.loadItems(a.items),$("#customer-combobox-options .combobox-list-content-wrap ul")),n=0;n<s.length;n++)0===$(s[n]).find(".ps__rail-y").length&&$.su.scrollbar({ele:s[n],opts:{minScrollbarLength:25}})},loadItems:function(e){for(var t,a=this.dom(),i=this.settings,s=this.getContainer(),n=a.find("div.combobox-lists").eq(0),l=(this.hideGlobalOptions(),$.isArray(e)||(e=[]),i.items=e,this._displayMap={},this._dataMap={},this._cascaderMap=this.getLevelOrder(e),""),o=0,d=e.length;o<d;o++)e[o]&&e[o].name&&(l+=this.initItemHtml(o,e[o]),e[o].selected)&&(t=e[o].value,t=this.convertValue(t),this._defaultValue=t);this._addonEnable&&(a.find("div.top-slots").html(this.addonTop),a.find("div.bottom-slots").html(this.addonBottom)),n.html(l),this.setValue(t),0==e.length?s.addClass("none-items"):s.removeClass("none-items"),a.triggerHandler("ev_view_update")},createSubItem:function(e,t){for(var a="",i=0,s=(e=$.isArray(e)?e:[]).length;i<s;i++)e[i]&&(a+=this.initItemHtml(i,e[i],t));return a},initItemHtml:function(e,t,a){var i,s=this.settings,n=this.dom()[0].id+"-"+$.su.randomId("option"),l=t.name,o=t.value,d=!!t.selected,r=t.cls||"",c=(tipText="",l=$.isArray(l)?l.map(function(e){return null==e?e:e.toString()}):l.toString(),this._dataMap[e]=o,this._displayMap[o]=l,s.itemWidth&&(i=$.su.abbreviateStr(l,s.itemWidth-120,40).text),this._displayMap[o]!==i&&(tipText=$.su.escapeHtml(this._displayMap[o])),"");return c=(c=(c=(c=(c+='<li class="combobox-list '+r+" "+(d?"selected":"")+'">')+('<label for="'+n+'" cascader-index="'+((e,t,a)=>{a=a||0;for(var i=0;i<t.length;i++)if(t[i].value===e&&t[i].level===a)return i;return-1})(o,this._cascaderMap,a)+'" type="single" class="combobox-label single has-sub'+(t.cls?" "+t.cls:"")+'">'))+('<input id="'+n+'" name="'+s.name+'" display="'+$.su.escapeHtml(l)+'" class="combobox-checkbox" type="checkbox" data-index="'+e+'" data-id="'+t.value+'"'+(d?' checked="checked"':"")+" />"))+('<span class="icon"'+(t.tipText?'data-tip="'+t.tipText+'"':"")+"></span>"))+('<span class="text u-d-inline-block" data-tip="'+tipText+'">'+$.su.escapeHtml(i)+"</span>"),t.labelDom&&(c+=t.labelDom),t.children&&(c+='<span class="has-sub-icon"></span>'),c=c+"</label>"+"</li>"},setValue:function(e){var t=$("#customer-combobox-options"),a=this.dom(),i=this.settings;if(null==e||""===e||$.isArray(e)&&0===e.length){if(null!=this._defaultValue)return void this.dom().triggerHandler("ev_view_change",[{"type":"record","value":this._defaultValue},"set-value"]);e=this._defaultValue}e=this.convertValue(e),this._value=$.su.clone(e),this._cascaderValue=$.su.clone(e)||[];i=i.noneSelectedText;if(e&&e.length&&0!==e.length){for(var s=[],n=0;n<e.length;n++)this.getNode(e[n],n+1)&&s.push(this.getNode(e[n],n+1).name);i=s.join(" / "),a.find(".combobox-text").removeClass("no-selected")}else a.find(".combobox-text").removeClass("no-selected").addClass("no-selected"),t.find("ul.combobox-list-2 .combobox-list-2-container").empty();this.settings.configs&&this.settings.configs.setCurrentText?this.settings.configs.setCurrentText():this.setText(i),t.attr("data-shown")===this.domId&&this.setOptionsSelected(),this.adaptWidth()},setOptionsSelected:function(){this.dom();for(var s=this,e=$("#customer-combobox-options"),n=$.isArray(this._value)?$.su.clone(this._value):[this._value],t=n.length-1;0<=t;t--)void 0===s._displayMap[n[t]]&&n.splice(t,1);e.find("label.combobox-label").each(function(e,t){var t=$(t),a=!!s._cascaderMap[t.attr("cascader-index")]&&s._cascaderMap[t.attr("cascader-index")].value,i=!!s._cascaderMap[t.attr("cascader-index")]&&s._cascaderMap[t.attr("cascader-index")].level;n[i]===a?(t.closest("li.combobox-list").removeClass("selected").addClass("selected"),s.expandKey=a,s.initSiteList()):t.closest("li.combobox-list").removeClass("selected")})},convertValue:function(e){return e="array"!==$.type(e)?null==e?[]:[e]:e},setText:function(e,t){e===this.settings.noneSelectedText?this.dom().removeClass("none-selected").addClass("none-selected"):this.dom().removeClass("none-selected");var a=$.su.escapeHtml(e),i=this.getContainer().find(".combobox-text");this._text=e,i.is("input")?i.val(a):i.html(a),this._text=a},refreshText:function(){this.setValue(this.getValue())},toggleAddon:function(e,t){t?"top"===t&&(this._addonTopEnable=e):this._addonEnable=e,this.loadItems(this.settings.items)},showHotspotManage:function(){var e='<li class="hotspot-management"><label><span class="icon"></span>'+`<div class="u-d-inline-block transition-container u-cursor-pointer">${$.su.CHAR.MAIN.HOTSPOT_ENTRY}</div>`+"</label></li>";this.addonBottom=e,this.toggleAddon(this._addonEnable)},setAddonTop:function(e){this.addonTop=e,this.toggleAddon(this._addonEnable)},getValue:function(){return $.isArray(this._value)?$.su.clone(this._value):[this._value]},_handleToggle:function(){var s=this,e=s.dom(),t=s.getContainer(),n=$("#customer-combobox-options"),a=n.attr("data-shown")===s.domId?"shown":"hidden";t.hasClass("none-items")?n.removeClass("none-items").addClass("none-items"):n.removeClass("none-items"),s.setFocus(),t.addClass("focus"),t.removeClass("error"),"hidden"==a?(n.css({width:""}),n.addClass("single"),n.removeClass("dimension"),n.removeClass("cascader").addClass("cascader"),e.off("focusout","div.combobox-wrap-outer").on("focusout","div.combobox-wrap-outer",function(e){var t=n.offset(),a=n.find(".combobox-list-wrap").width(),i=n.find(".combobox-list-wrap").height();(s._xx<t.left||s._xx>t.left+a||s._yy<t.top||s._yy>t.top+i)&&s.hideGlobalOptions()}),s._bindGlobalEvent(),s.showGlobalOptions()):s.hideGlobalOptions()},_bindGlobalEvent:function(){var t=this,e=$("#customer-combobox-options");e.off("click",".global-switch").on("click",".global-switch",function(e){e.stopPropagation(),e.preventDefault(),t.dom().triggerHandler("ev_customer_change",[{"type":"value","value":t.expandKey}]),t.hideGlobalOptions()}),e.off("click",".customer-wrap label.combobox-label").on("click",".customer-wrap label.combobox-label",function(e){e.stopPropagation(),e.preventDefault();e=$(this).find(".combobox-checkbox").attr("data-index");$(this).closest("ul").find("li.combobox-list").removeClass("selected"),$(this).closest("li.combobox-list").addClass("selected"),t.expandKey=t.settings.items[e].value,t.initSiteList()}),e.off("click",".customer-wrap .unstar span.icon").on("click",".customer-wrap .unstar span.icon",function(e){e.stopPropagation(),e.preventDefault();e=$(this).prev(".combobox-checkbox").attr("data-index");t.dom().triggerHandler("ev_customer_favorite",[{"type":"value","value":t.settings.items[e].value}])}),e.off("click",".customer-wrap .star span.icon").on("click",".customer-wrap .star span.icon",function(e){e.stopPropagation(),e.preventDefault();e=$(this).prev(".combobox-checkbox").attr("data-index");t.dom().triggerHandler("ev_customer_unfavorite",[{"type":"value","value":t.settings.items[e].value}])}),e.off("click",".site-wrap .all-site label.combobox-label").on("click",".site-wrap .all-site label.combobox-label",function(e){e.stopPropagation(),e.preventDefault();e=$(this).find(".combobox-checkbox").attr("data-id");t.dom().triggerHandler("ev_site_change",[{"type":"value","customer":t.expandKey,value:e}]),t.hideGlobalOptions()}),e.off("click",".site-wrap .all-site .star span.icon").on("click",".site-wrap .all-site .star span.icon",function(e){e.stopPropagation(),e.preventDefault();e=$(this).prev(".combobox-checkbox").attr("data-id");t.dom().triggerHandler("ev_site_unfavorite",[{"type":"value","customer":t.expandKey,value:e}])}),e.off("click",".site-wrap .all-site .unstar span.icon").on("click",".site-wrap .all-site .unstar span.icon",function(e){e.stopPropagation(),e.preventDefault();e=$(this).prev(".combobox-checkbox").attr("data-id");t.dom().triggerHandler("ev_site_favorite",[{"type":"value","customer":t.expandKey,value:e}])})},initSiteList:function(){this.resetPagingData();var e=this;this.lazyLoadData(function(){e.updateDynamicHeight(),e.loadVirtualList()},!0)},updateComboboxListPosition:function(){this.dynamicOffset=0,$("#customer-combobox-options").find("div.combobox-list-content-wrap ul.combobox-list-2").scrollTop(0)},lazyLoadData:function(a,i){var s,e;this.pagingData.currentPage*this.pagingData.currentPageSize>=this.totalRows&&!i||this.getSiteLoadingDataStatus()&&!i||(i||this.pagingData.currentPage++,s=this,e=$.extend(s.pagingData,{searchKey:s.searchKey,customerId:s.expandKey,"filters.needFavorite":!0}),this.setSiteLoadingDataStatus(!0),$.when(this.settings.configs.lazyLoadData(e)).done(function(e){var t;t=1===s.pagingData.currentPage?e.result||[]:(s.getSiteList()||[]).concat(e.result||[]),s.updateOptionNum(t),s.setSiteList(t),i&&(s.updateComboboxListPosition(),s.updateOptionHeight(),s.updateComboboxListVariableHeight()),s.totalRows=e.totalRows||0,a&&a()}).fail(function(){i||s.pagingData.currentPage--}).always(function(){s.setSiteLoadingDataStatus(!1)}))},showSites:function(e){var t="";e&&0<e.length?(e=this.createSubItem(e,1),t=(t=t+('<div class="combobox-no-search-result-tip">'+$.su.CHAR.COMMON.NO_SEARCH_RESULT_FOUND)+'</div><div class="all-site">')+e+"</div>"):t+=`<div class="site-empty-tip">${$.su.CHAR.MAIN.NO_SITES}</div>`,$("#customer-combobox-options ul.combobox-list-2 .combobox-list-2-container").empty().html(t),this.dom().find("div.combobox-lists .combobox-list-2-container").eq(0).html(t),this.setSiteSelected(),this.adaptWidth()},setSiteSelected:function(){var a=this.settings.configs&&this.settings.configs.getSelectedSite&&this.settings.configs.getSelectedSite();a&&this.expandKey===this._value[0]&&$("#customer-combobox-options").find(".all-site label.combobox-label").each(function(e,t){t=$(t);t.find(".combobox-checkbox").attr("data-id")==a?t.closest("li.combobox-list").removeClass("selected").addClass("selected"):t.closest("li.combobox-list").removeClass("selected")})},showGlobalOptions:function(){var n=this,l=this.settings,e=n.dom(),t=e.find(".widget-wrap.combobox-wrap"),a=$("#customer-combobox-options"),i=t.offset(),s=$("body").offset(),o=t.outerHeight()-t.height(),d=e.find("div.combobox-lists").eq(0).html(),r=a.find("div.combobox-list-wrap"),c=a.find("div.combobox-list-content-wrap"),u=(parseInt(e.attr("option-offset"),10),l.noneItemTipText),h=a.find("ul.combobox-list"),p=e.find(".widget-wrap-outer").width();c.find(".combobox-empty-tip").html(u);e.find("a.combobox-switch").addClass("arrow-up"),h.html(d),c.find("div.combobox-list-editor-wrap").remove(),c.find(".combobox-empty-tip").before('<div class="combobox-list-editor-wrap top u-d-none"><ul class="top-slot"></ul></div>'),c.find(".site-wrap").append('<div class="combobox-list-editor-wrap bottom u-d-none"><ul class="bottom-slot"></ul></div>'),this._addonEnable&&(this.addonTop&&this._addonTopEnable&&a.find(".combobox-list-editor-wrap.top").removeClass("u-d-none"),this.addonBottom&&this._addonBottomEnable&&(a.find(".combobox-list-editor-wrap.bottom").removeClass("u-d-none"),a.find("ul.combobox-list")),a.find("ul.top-slot").html(this.addonTop),a.find("ul.bottom-slot").html(this.addonBottom));for(var g,m,u=n.getValue(),v=(a.find("ul.combobox-list-2 .combobox-list-2-container").empty(),u&&0!==u.length&&null!=u[1]&&a.find("ul.combobox-list-2 .combobox-list-2-container").html(e.find("div.combobox-lists .combobox-list-2-container").eq(0).html()),r.removeClass().addClass("combobox-list-wrap "+this.settings.cls),this.adaptWidth(),r.show(),a.attr("data-shown",n.domId),e.triggerHandler("ev_combobox_show"),i.top+t.outerHeight(!0)+r.height()<=$(window).height()||i.top-r.height()<=0?a.css({"position":"absolute","left":$.su.language.isRtl()?i.left-r.width()+p-o+"px":i.left-s.left+"px","top":i.top+t.outerHeight(!0)+2+"px","z-index":1e3}):a.css({"position":"absolute","left":$.su.language.isRtl()?i.left-r.width()+p-o+"px":i.left-s.left+"px","top":i.top-r.height()-2+"px","z-index":1e3}),n._globalOffset=a.offset(),$("body").off("mousedown").on("mousedown",function(e){!n.dom().hasClass("hover")&&"hidden"!==n.toggleFlag&&(n.getComboboxXy(e),n._xx<n._globalOffset.left-1||n._xx>n._globalOffset.left+r.width()+1||n._yy<n._globalOffset.top-1||n._yy>n._globalOffset.top+r.height()+1)&&n.hideGlobalOptions()}),a.removeClass("none-customer-search-result"),a.removeClass("none-site-search-result"),$(a).find("div.customer-wrap div[widget=textbox].combobox-search-box").length?((g=$(a).find("div.customer-wrap div[widget=textbox].combobox-search-box").data("viewObj")).setValue(""),g.setHint($.su.CHAR.MAIN.SEARCH_CUSTOMER),n.filterCustomers(null)):($(a).find("div.customer-wrap").prepend('<div class="text-box-wrapper"><div widget="textbox" class="combobox-search-box" ></div><div class="combobox-search-box-icon"></div></div>'),new $.su.widgets.textbox({id:$(a).find("div.customer-wrap div[widget=textbox].combobox-search-box")}).render(),$(a).find("div.customer-wrap div.combobox-search-box-icon").off("click").on("click",function(){n.searchCustomer()}),$(a).find("div.customer-wrap div[widget=textbox].combobox-search-box .widget-wrap-outer").off("keyup").on("keyup",function(e){108!==e.keyCode&&13!==e.keyCode||(e.stopPropagation(),n.searchCustomer())})),$(a).find("div.site-wrap div[widget=textbox].combobox-search-box").length?((g=$(a).find("div.site-wrap div[widget=textbox].combobox-search-box").data("viewObj")).setValue(""),g.setHint($.su.CHAR.MAIN.SEARCH_SITE),n.filterSites(null),this.searchKey=void 0):($(a).find("div.site-wrap").prepend('<div class="text-box-wrapper"><div widget="textbox" class="combobox-search-box" ></div><div class="combobox-search-box-icon"></div></div>'),new $.su.widgets.textbox({id:$(a).find("div.site-wrap div[widget=textbox].combobox-search-box")}).render(),$(a).find("div.site-wrap div.combobox-search-box-icon").off("click").on("click",function(){n.searchSite()}),$(a).find("div.site-wrap div[widget=textbox].combobox-search-box .widget-wrap-outer").off("keyup").on("keyup",function(e){108!==e.keyCode&&13!==e.keyCode||(e.stopPropagation(),n.searchSite())})),$(a).find("div.site-wrap div.global-switch").length||(h=`<div class="global-title global-switch">
        <div class="global-switch-icon"></div>
        <div class="global-switch-text">${$.su.CHAR.MAIN.GLOBAL}</div>
        </div>`,$(a).find("div.site-wrap").prepend(h)),this.settings.configs.hideMspBtn||$(a).find("div.customer-wrap div.msp-switch").length||(d=`<div class="global-title msp-switch">
        <div class="global-switch-icon"></div>
        <div class="global-switch-text">${$.su.CHAR.MAIN.MSP}</div>
        </div>`,$(a).find("div.customer-wrap").prepend(d)),$(a).find("div.customer-wrap div.title").length||(m=`<div class="title">${$.su.CHAR.MAIN.CUSTOMER}</div>`,$(a).find("div.customer-wrap").prepend(m)),$(a).find("div.site-wrap div.global-select-title").length||(m=`<div class="global-select-title">
        <div class="title-text">${$.su.CHAR.MAIN.SITE}</div>
      </div>`,$(a).find("div.site-wrap").prepend(m)),$(a).find("ul.combobox-list-2").off("scroll").on("scroll",function(e){var t,a,i,s;l.virtualLazyLoad&&l.configs&&l.configs.lazyLoadData&&(e.stopPropagation(),e.preventDefault(),t=e.target,(a=$(t).data("ps")).update(),e=5*n.optionHeight,i=a.containerHeight,s=t.scrollTop,a.contentHeight<=i+s+e&&n.lazyLoadData(function(){n.updateDynamicHeight(),n.loadVirtualList(),a.update(),s=t.scrollTop}),n.getSiteList().length>2*n.OPTION_NUM_IN_ONE_VIEW&&(n.dynamicOffset=s),n.updateDynamicOffset(),n.updateDynamicHeight(),n.loadVirtualList())}),n.isVariableHeight()&&(n.updatePersistentHeight(),$(window).off("resize.combobox").on("resize.combobox",$.su.debounce(function(e){var t=n.getSiteList()||[];n.updateOptionNum(t),n.updateComboboxListVariableHeight(),n.updateDynamicOffset(),n.updateDynamicHeight(),n.loadVirtualList()},200))),n.toggleFlag="shown",n.setOptionsSelected(),a.find("div.combobox-list-content-wrap ul")),b=0;b<v.length;b++){var f=$(v[b]).find("li.selected"),x=$($(v[b]).find("li").get(0));0<f.length?(f=f.offset().top-x.offset().top,a.find("div.combobox-list-content-wrap ul").scrollTop(f)):a.find("div.combobox-list-content-wrap ul").scrollTop(0)}$("div.ps--active-y").not(function(){return $(a).find(this).length||$(a).is(this)||$(this).closest(".combobox-wrap-outer",e).length}).off(".combobox").one("scroll.combobox",function(e){0===$(e.target).closest(".combobox-container").length&&n.hideGlobalOptions()}),this.settings.configs.hideMspBtn?$(a).addClass("hide-mspbtn"):$(a).removeClass("hide-mspbtn")},searchCustomer:function(){var e=$("#customer-combobox-options").find("div.customer-wrap div[widget=textbox].combobox-search-box").data("viewObj").getValue();this.filterCustomers(e)},searchSite:function(){var e=$("#customer-combobox-options").find("div.site-wrap div[widget=textbox].combobox-search-box").data("viewObj").getValue(),t=(this.searchKey=e,this.resetPagingData(),this);this.lazyLoadData(function(){t.updateDynamicHeight(),t.loadVirtualList()},!0)},hideGlobalOptions:function(){var e=$("#customer-combobox-options");this.dom().find("a.combobox-switch").removeClass("arrow-up"),e.find("div.combobox-list-wrap").removeClass().addClass("combobox-list-wrap"),this.toggleFlag="hidden",this.dom().removeClass("focus"),e.attr("data-shown")===this.domId&&(e.find("div.combobox-list-wrap").hide(),e.attr("data-shown","_hidden_"),e.off("click","label.combobox-label"),$("body").off("mousemove",this.getComboboxXy)),this.dom().triggerHandler("ev_combobox_hide")},adaptWidth:function(){$("#customer-combobox-options").find("ul.combobox-list-2").removeClass("u-d-none")},getComboboxXy:function(e){e=e||window.event;this._xx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this._yy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop},getNode:function(i,s){var n,e=this.settings.items,l=[];try{for(var t=0;t<e.length;t++)!function e(t){if(l.push(t),(n=t).value===i&&(!s||l.length===s))throw"GOT IT!";if(t.children&&0<t.children.length)for(var a=0;a<t.children.length;a++)e(t.children[a]);l.pop()}(e[t])}catch(e){return n}},getLevelOrder:function(e){var t=[],a=[],i={children:e};i&&a.push(i);for(var s,n=i,l=-1;0!==a.length;){if(t.push({name:a[0].name,value:a[0].value,level:l}),(i=a.shift()).children&&0<i.children.length)for(var o=0;o<i.children.length;o++)a.push(i.children[o]),s=i.children[o];n===i&&(n=s,l++)}return t.shift(),t},filterCustomers:$.su.debounce(function(e){var a,i,t=$("#customer-combobox-options .customer-wrap"),s=$("#customer-combobox-options"),n=t.find("input.combobox-checkbox");null==e||""===e?n.each(function(){s.removeClass("none-customer-search-result"),$(this).closest("li.combobox-list").removeClass("u-d-none")}):(t.find("ul.combobox-list")[0]&&(t.find("ul.combobox-list")[0].scrollTop=0),a=this._createReg(e),i=0,n.each(function(){var e=$(this).attr("display"),t=!0;e.replace(a,function(e){t=!1}),t&&i++,t?$(this).closest("li.combobox-list").removeClass("u-d-none").addClass("u-d-none"):$(this).closest("li.combobox-list").removeClass("u-d-none")}),i===n.length?s.removeClass("none-customer-search-result").addClass("none-customer-search-result"):s.removeClass("none-customer-search-result"))},200),filterSites:$.su.debounce(function(e){var a,i,t=$("#customer-combobox-options .all-site"),s=$("#customer-combobox-options"),n=t.find("input.combobox-checkbox");null==e||""===e?n.each(function(){s.removeClass("none-site-search-result"),$(this).closest("li.combobox-list").removeClass("u-d-none")}):(t.find("ul.combobox-list-2")[0]&&(t.find("ul.combobox-list-2")[0].scrollTop=0),a=this._createReg(e),i=0,n.each(function(){var e=$(this).attr("display"),t=!0;e.replace(a,function(e){t=!1}),t&&i++,t?$(this).closest("li.combobox-list").removeClass("u-d-none").addClass("u-d-none"):$(this).closest("li.combobox-list").removeClass("u-d-none")}),i===n.length?s.removeClass("none-site-search-result").addClass("none-site-search-result"):s.removeClass("none-site-search-result"))},200),_createReg:function(e){return e=(e=e.replace(/[\*\.\?\+\$\^\[\]\(\)\{\}\|\\\/]/g,function(e){return"\\"+e})).replace(/\s/g,function(e){return"\\s"}),new RegExp(e,"gi")},setSiteLoadingDataStatus:function(e){var t=this.getContainer(),a=$("#customer-combobox-options").find(".combobox-list-2-wrapper");e&&!a.find(".loading-container").length?(t.addClass("loading"),a.prepend('<div class="loading-container"><span class="icon loading-btn"></span></div>')):e||(t.removeClass("loading"),a.find(".loading-container").length&&a.find(".loading-container").remove()),this.updateDynamicHeight()},getSiteLoadingDataStatus:function(){return this.getContainer().hasClass("loading")},resetPagingData:function(){this.settings.configs&&this.settings.configs.pagingData?this.pagingData=$.su.clone(this.settings.configs.pagingData):this.pagingData=$.su.clone(this._defaultPagingData)},getText:function(){return this._text},setTextWithSubtitle:function(e,t){var i=!1,a=(a=t?[e,t]:[e]).map(e=>{var t=$.su.measureText(e),a=t?Math.floor(144*$.su.len(e)/t):15;return i=144<=t||i,$.su.sub(e,a)}),s=this.getContainer(),n="",a=(n=t?(s.addClass("has-subtitle"),`<div class="title">${a[0]}</div><div class="subtitle">${a[1]}</div>`):a[0],s.find(".combobox-text"));a.html(n),i&&(s=t?`<div>${$.su.CHAR.MAIN.SITE}: ${$.su.escapeHtml(e)}</div><div>${$.su.CHAR.MAIN.CUSTOMER}: ${$.su.escapeHtml(t)}</div>`:$.su.CHAR.MAIN.CUSTOMER+": "+$.su.escapeHtml(e),a.attr("data-tip",s),a.attr("data-pointer","top"),a.attr("tip-html","html"))},isVirtualLazyLoad:function(){return this.settings.virtualLazyLoad},updateDynamicOffset:function(){$("#customer-combobox-options").find(".combobox-list-2-container").css("top",this.dynamicOffset+"px")},updateDynamicHeight:function(){var e,t=$("#customer-combobox-options");this.getSiteList().length?this.dynamicHeight=this.getSiteList().length*this.optionHeight:(e=t.find(".site-empty-tip"),this.dynamicHeight=e.length&&e[0].getBoundingClientRect().height||this.EMPTY_SITE_HEIGHT),t.find(".combobox-list-2-phantom").css("height",this.dynamicHeight+"px")},getSiteList:function(){return $.su.clone(this._siteList)},setSiteList:function(e){this._siteList=e},isLoadingInView:function(){var e;return!!this.getSiteLoadingDataStatus()&&(!(this.getSiteList().length>2*this.OPTION_NUM_IN_ONE_VIEW)||(e=$("#customer-combobox-options"),e=$(e).find("ul.combobox-list-2").data("ps").containerHeight,parseInt(this.dynamicHeight)-parseInt(this.dynamicOffset)-e<=this.optionHeight/2))},getVirtualList:function(){var e,t,a=this.getSiteList()||[];return a.length>2*this.OPTION_NUM_IN_ONE_VIEW&&(e=Math.floor(Math.max(parseInt(this.dynamicOffset)+this.optionHeight/2,0)/this.optionHeight),a=(e=a.slice(e,e+this.OPTION_NUM_IN_ONE_VIEW-(this.isLoadingInView()?1:0))).length<this.OPTION_NUM_IN_ONE_VIEW-(this.isLoadingInView()?1:0)?(t=a.length,a.slice(t-this.OPTION_NUM_IN_ONE_VIEW,t)):e),a},loadVirtualList:function(){var e=$("#customer-combobox-options ul.combobox-list-2"),e=(e[0]&&this.getSiteList().length>2*this.OPTION_NUM_IN_ONE_VIEW?this.dynamicOffset=e[0].scrollTop:this.dynamicOffset=0,this.updateDynamicOffset(),this.getVirtualList());this.showSites(e),this.getSiteLoadingDataStatus()?this.setSiteLoadingDataStatus(!0):this.setSiteLoadingDataStatus(!1)},updateOptionHeight:function(){var e=$("#customer-combobox-options").find("ul.combobox-list-2 li.combobox-list"),e=e.length&&e[0].getBoundingClientRect().height||this.optionHeight;this.optionHeight=e},updateComboboxListVariableHeight:function(){var e=$("#customer-combobox-options"),t=e.find("ul.combobox-list-2"),e=e.find(".combobox-list-content-wrap"),a=this.optionHeight*this.OPTION_NUM_IN_ONE_VIEW+"px";this.isVariableHeight()?(t.css("height",a),e.css("min-height",this.COMBOX_LIST_CONTENT_WRAP_MIN_HEIGHT+"px")):(t.css("height",""),e.css("min-height","")),t.css("max-height",a)},isVariableHeight:function(){return this.isVirtualLazyLoad()&&this.settings.variableHeight},updateOptionNum:function(e){var t;e.length>this.MIN_OPTION_NUM&&this.isVariableHeight()?(e=(t=Math.floor((window.innerHeight-this.EXCLUDE_COMBOBOX_LIST_HEIGHT)/this.optionHeight))<=this.MIN_OPTION_NUM?this.MIN_OPTION_NUM:e.length<=t?e.length:t,this.OPTION_NUM_IN_ONE_VIEW=e):this.OPTION_NUM_IN_ONE_VIEW=this.MIN_OPTION_NUM},updatePersistentHeight:function(){var e=this.isIntegrated?0:$(".header__central").height(),t=$("#customer-combobox-options"),a=t.find(".global-select-title").outerHeight(!0),i=t.find(".global-switch").outerHeight(!0),t=t.find(".text-box-wrapper").outerHeight(!0),s=$(".header__label").outerHeight(!0),n=$("#userCustomersSites").height();(this.isIntegrated||e)&&a&&i&&t&&s&&n&&(this.EXCLUDE_COMBOBOX_LIST_HEIGHT=e+this.COMBOBOX_CONTAINER_PADDING+a+i+t+this.COMBOBOX_DISTANCE_BOTTOM+s+n,this.COMBOX_LIST_CONTENT_WRAP_MIN_HEIGHT=this.optionHeight*this.MIN_OPTION_NUM+a+i+t)}}),(()=>{var n={"FULL":"full","PARTIAL":"partial","UNSELECTED":"unSelected"},e={"FULL":"selected","PARTIAL":"partial-selected"},o=$.su.Widget.register("treeSelectNode",{settings:{childrenProp:{attribute:"children-prop",defaultValue:"children"}},listeners:function(){return[{selector:".tree-select-node-select-icon",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.dom().find(".tree-select-node-row").eq(0).hasClass("disabled")||(e=t.dom().closest(".tree-select-dropdown-children-ul"),"multiple"===t._selectType?(t._selectStatus===n.FULL?t._unselectNode():t._selectNode(),t.syncSelectedStatusToChildren(),t.syncSelectedStatusToParent(),e.trigger("ev_click_item",[t._data,t._selectStatus])):t.onlySelectLeafnode&&$.isArray(t._children)&&0<t._children.length?t.toggle():(t._selectStatus!==n.FULL&&t._selectNode(),e.trigger("ev_click_item",[t._data,void 0])))}},{selector:".tree-select-node-text",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.dom().find(".tree-select-node-row").eq(0).hasClass("disabled")||(e=t.dom().closest(".tree-select-dropdown-children-ul"),"multiple"===t._selectType?(t._selectStatus===n.FULL?t._unselectNode():t._selectNode(),t.syncSelectedStatusToChildren(),t.syncSelectedStatusToParent(),e.trigger("ev_click_item",[t._data,t._selectStatus])):t.onlySelectLeafnode&&$.isArray(t._children)&&0<t._children.length?t.toggle():(t._selectStatus!==n.FULL&&t._selectNode(),e.trigger("ev_click_item",[t._data,void 0])))}},{selector:".tree-select-node-text",event:"ev_remove_selected_class",callback:function(e,t){e.stopPropagation(),e.preventDefault(),"single"===t._selectType?t._unselectNode():(t._unselectNode(),t.syncSelectedStatusToChildren(),t.syncSelectedStatusToParent())}},{selector:".tree-select-node-text",event:"ev_add_selected_class",callback:function(e,t){e.stopPropagation(),e.preventDefault(),"single"===t._selectType?t._selectNode():(t._selectNode(),t.syncSelectedStatusToChildren(),t.syncSelectedStatusToParent())}},{selector:".tree-select-node-text",event:"ev_tree_node_show",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t.show(),t._showStatus=!0,t.syncShowStatusToChildren(),t.syncShowStatusToParent()}},{selector:".tree-select-node-text",event:"ev_tree_node_hide",callback:function(e,t){e.stopPropagation(),e.preventDefault(),t._showByParent||(t.hide(),t._showStatus=!1,t.syncShowStatusToChildren(),t.syncShowStatusToParent())}},{selector:".tree-select-node-open-icon",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),$(this).closest(".tree-select-node").hasClass("empty")||t.toggle(200)}},{selector:".tree-select-node-open-icon",event:"ev_expand_parent_node",callback:function(e,t){e.stopPropagation(),e.preventDefault(),$(this).closest(".tree-select-node").hasClass("empty")||t.open()}}]},init:function(e){"single"!==e.selectType&&"multiple"!==e.selectType?this._selectType="single":this._selectType=e.selectType,this.onlySelectLeafnode=e.onlySelectLeafnode,this._data={},this._showStatus=!0,this._showByParent=!1},render:function(){this.dom().addClass("tree-select-node-container")},_nodeIsBranch:function(e){return $.isArray(e.children)},_nodeIsLeaf:function(e){return!$.isArray(e.children)},loadData:function(e){this.dom(),this.settings.childrenProp;this._data=$.su.clone(e),this._renderNode(e),this._data.selected&&(this._selectNode(),"multiple"===this._selectType)&&(this.syncSelectedStatusToChildren(),this.syncSelectedStatusToParent())},_selectNode:function(){this.dom().find(".tree-select-node-row").eq(0).hasClass("disabled")||this._selectStatus!=n.FULL&&(this._selectStatus=n.FULL,("multiple"===this._selectType?this.dom().find(".tree-select-node-row").eq(0).removeClass(e.PARTIAL):this.dom().find(".tree-select-node-row").eq(0)).addClass(e.FULL))},_unselectNode:function(){this.dom().find(".tree-select-node-row").eq(0).hasClass("disabled")||this._selectStatus!=n.UNSELECTED&&(this._selectStatus=n.UNSELECTED,"multiple"===this._selectType?this.dom().find(".tree-select-node-row").eq(0).removeClass(e.PARTIAL+" "+e.FULL):this.dom().find(".tree-select-node-row").eq(0).removeClass(e.FULL))},_partialSelectNode:function(){this.dom().find(".tree-select-node-row").eq(0).hasClass("disabled")||this._selectStatus!=n.PARTIAL&&(this._selectStatus=n.PARTIAL,this.dom().find(".tree-select-node-row").eq(0).removeClass(e.FULL).addClass(e.PARTIAL))},_renderNodeAsChild:function(e){var t=e[this.settings.childrenProp],a=this.dom(),i=a.find(".tree-select-node-children-ul"),s=t&&t.length,n=0;if(!(0<s))return a.addClass("empty"),!1;for(a.removeClass("empty"),a.find(".tree-select-node-text").attr("node-value",e.value);n<s;n++){var l=$("<div></div>"),l=(i.append(l),new o({id:l,selectType:this._selectType,onlySelectLeafnode:this.onlySelectLeafnode}));this._children.push(l),l.parentNode=this,l.render(),l.loadData(t[n])}return!0},_renderNode:function(e){this._children=[],this._path=e.path;var t=this.dom(),a="multiple"===this._selectType,i=(t.addClass("tree-select-node empty"),""),a=(i=(i+="<div>")+('<div class="tree-select-node-row'+(a?" multiple":"")+(e.disabled?" disabled":"")+'">')+'<a class="open-icon">',this._nodeIsBranch(e)?i+='<span class="tree-select-node-open-icon"></span>':i+='<span class="tree-select-node-indent"></span>',i+="</a>",a&&(i+='<a class="checkbox"><span class="tree-select-node-select-icon"></span></a>'),i=(i+='<a class="text-node">')+('<span node-value="'+e.value+'" class="tree-select-node-text" title="'+$.su.escapeHtml(e.name)+'">'+$.su.escapeHtml(e.name)+"</span>"),t.append(i=(i=(i+="</a>")+"</div>"+'<ul class="tree-select-node-children-ul">')+"</ul>"+"</div>"),t.find(".tree-select-node-children-ul")),i=e[this.settings.childrenProp];a.hide(),this._nodeIsBranch(e)&&t.removeClass("empty"),i&&this._renderNodeAsChild(e)},open:function(e){e=e||0===e?e:200,this._open=!0;var t=this.dom();t.find(".tree-select-node-children-ul").eq(0).slideDown(e),t.find(".tree-select-node-open-icon").eq(0).addClass("opened")},close:function(e){e=e||0===e?e:200,this._open=!1;var t=this.dom();t.find(".tree-select-node-children-ul").eq(0).slideUp(e),t.find(".tree-select-node-open-icon").eq(0).removeClass("opened")},toggle:function(e){var t=this,a=$.su.getDefaultEvent(this,function(){t._open?t.close(e):t.open(e)});this.dom().closest(".tree-select-dropdown-children-ul").trigger("ev_before_toggle",[a.ev,this._open,this]),a.exe()},renderNodeWithEmpty:function(e){this.dom().empty(),this.loadData(e)},syncSelectedStatusToChildren:function(){var e,a;this.dom().find(".tree-select-node-row").eq(0).hasClass("disabled")||((e=this._selectStatus)==n.FULL?a="_selectNode":e==n.UNSELECTED&&(a="_unselectNode"),this._children&&$.each(this._children,function(e,t){a&&t[a](),t.syncSelectedStatusToChildren()}))},syncSelectedStatusToParent:function(){if(!this.dom().find(".tree-select-node-row").eq(0).hasClass("disabled")&&this.parentNode){for(var e=!0,t=!0,a=this.parentNode._children.length,i=0;i<a;i++){var s=this.parentNode._children[i];if(!s._data.disabled){switch(s._selectStatus){case n.FULL:t=!1;break;case n.PARTIAL:e=t=!1;break;default:n.UNSELECTED;e=!1}if(!e&&!t)break}}e?this.parentNode._selectNode():t?this.parentNode._unselectNode():this.parentNode._partialSelectNode(),this.parentNode.syncSelectedStatusToParent()}},syncShowStatusToChildren:function(){var a;this._children&&(a=this._showStatus,$.each(this._children,function(e,t){a?(t.show(),t._showByParent=!0):t._showByParent=!1,t.syncShowStatusToChildren()}))},syncShowStatusToParent:function(){var a;this.parentNode&&(a=!1,$.each(this.parentNode._children,function(e,t){if(t._showStatus)return!(a=!0)}),this.parentNode[a?"show":"hide"](),this.parentNode.syncShowStatusToParent())}})})(),(()=>{var i={SWITCH:0,EAP:1,GATEWAY:2},n=[0,0,0,0],l=[0,0,0,0],o=[0,0,0,0];$.su.Widget.register("healthOverviewCard",{settings:{},listeners:[{selector:".device-health-card [data-info-panel]",event:"ev_info_panel_show",callback:function(e,t){var a,i,s=$.su.CHAR.COMMON;switch(t){case"gateway":a=s.GATEWAY_HEALTH,i=n;break;case"switch":a=s.SWITCH_HEALTH,i=l;break;case"eap":a=s.EAP_HEALTH,i=o}t=[{name:a,html:"<span></span>",cls:"health-panel-title"},{name:s.HEALTH_GOOD+" "+s.HEALTH_GOOD_SCORE,value:i[0],cls:"panel-name level-"+$.appUtils.HEALTH_LEVEL.GOOD},{name:s.HEALTH_FAIR+" "+s.HEALTH_FAIR_SCORE,value:i[1],cls:"panel-name level-"+$.appUtils.HEALTH_LEVEL.FAIR},{name:s.HEALTH_POOR+" "+s.HEALTH_POOR_SCORE,value:i[2],cls:"panel-name level-"+$.appUtils.HEALTH_LEVEL.POOR},{name:s.HEALTH_NO_DATA,value:i[3],cls:"panel-name level-"+$.appUtils.HEALTH_LEVEL.NO_DATA}],$.appUtils.globalInfoPanel.setInfo({cls:"health-overview-info-panel",rows:t})}}],init:function(e){},render:function(){var e=this.dom(),t=this,a="",a=(a=(a+='<div class="health-overview-card">')+this.getDeviceCardHtml("gateway")+'<div class="split-line"></div>')+this.getDeviceCardHtml("switch");!$.su.serviceManager.get("capability").support("switch")&&$.su.serviceManager.get("user").isSiteView()||(a+='<div class="split-line"></div>'),a+=this.getDeviceCardHtml("eap"),e.append(a+="</div>"),e.find("div[widget=progressbar]").each(function(e){t["progressbar_"+e]=new $.su.widgets.progressbar({id:t.domId+"-"+e}),t["progressbar_"+e].settings.configs={subsection:[{name:"level-"+$.appUtils.HEALTH_LEVEL.GOOD},{name:"level-"+$.appUtils.HEALTH_LEVEL.FAIR},{name:"level-"+$.appUtils.HEALTH_LEVEL.POOR},{name:"level-"+$.appUtils.HEALTH_LEVEL.NO_DATA}]},t["progressbar_"+e].render()})},getDeviceCardHtml:function(e){var t="";return"switch"===e&&!$.su.serviceManager.get("capability").support("switch")&&$.su.serviceManager.get("user").isSiteView()?t+='<div class="device-health-card hidden">':t+='<div class="device-health-card">',t=(t=t+'<div class="device-icon-wrapper">'+('<div class="'+e+'-icon device-icon"></div>'))+('<div class="device-none-name '+e+' none">'+$.su.CHAR.HEALTH["NO_"+e.toUpperCase()]+"</div>")+"</div>","gateway"===e&&(t+='<div class="gateway-health-score none"></div>'),t=(t=(t=(t+='<div class="device-health-num-wrapper '+e+'" data-info-panel data-key="'+e+'">')+('<div class="device-name '+e+'">'+$.su.CHAR.DASHBOARD[e.toUpperCase()]+"</div>")+('<div class="device-num '+e+'"></div>'))+('<div widget="progressbar" id="'+this.domId+"-"+i[e.toUpperCase()]+'" show-percentage="{false}" class="health-progressbar m-b-0 u-label-none" multi-section="{true}" animate="{false}"></div>'))+"</div>"+"</div>"},setDeviceHealthCard:function(e){var t=e.gateway;l=e.switch,o=e.ap,$.isArray(t)?(n=t,this.setDeviceNum(t,"gateway"),this.dom().find(".gateway-health-score").addClass("none"),this.dom().find(".device-health-num-wrapper.gateway").removeClass("none")):(this.setGatewayStatus(t),this.dom().find(".gateway-health-score").removeClass("none"),this.dom().find(".device-health-num-wrapper.gateway").addClass("none")),this.setDeviceNum(l,"switch"),this.setDeviceNum(o,"eap")},setGatewayStatus:function(e){null==e||e===$.appUtils.HEALTH_NO_MANAGEMENT?(this.dom().find(".gateway-health-score").addClass("none"),this.dom().find(".device-none-name.gateway").removeClass("none")):(this.dom().find(".gateway-health-score").removeClass("none"),this.dom().find(".device-none-name.gateway").addClass("none"),e='<div class="device-name gateway">'+$.su.CHAR.DASHBOARD.GATEWAY+'</div><span class="gateway-status level-'+$.appUtils.getHealthLevel(e)+'">'+$.appUtils.getHealthScoreText(e)+"</span>",this.dom().find(".gateway-health-score").html(e),this.dom().find(".device-name.gateway").html($.su.CHAR.DEVICES.GATEWAY))},setDeviceNum:function(e,t){var a=this.dom(),e=this.formatterDeviceNumArr(e);this.getDeviceSum(e)?(this.setNum(e,t),this.setProgress(e,t),a.find(".device-health-num-wrapper."+t).show(),a.find(".device-none-name."+t).addClass("none"),a.find(".device-name."+t).html($.su.CHAR.DASHBOARD[t.toUpperCase()])):(a.find(".device-health-num-wrapper."+t).hide(),a.find(".device-none-name."+t).removeClass("none"))},formatterDeviceNumArr:function(e){for(var t=0;t<e.length;t++)null===e[t]&&(e[t]=0);return e},getDeviceSum:function(e){var a=0;return $.each(e,function(e,t){a+=t}),a},setNum:function(a,e){var i="",t=this.dom();i+='<ul class="device-num-list">',$.each(a,function(e,t){i+='<li class="health-level level-'+e+'">'+t+"</li>",e!==a.length-1&&(i+='<li class="health-level">&nbsp;/&nbsp;</li>')}),i+="</ul>",t.find(".device-num."+e).html(i)},setProgress:function(e,t){var a={};$.each(e,function(e,t){a["level-"+e]=t}),this["progressbar_"+i[t.toUpperCase()]].setValue(a)}})})(),(u=>{u.su.Widget.register("incidentList",{settings:{timeZoneType:{attribute:"time-zone-type",defaultValue:"site"},multiple:{attribute:"multiple",defaultValue:!1}},listeners:[{selector:"a.paging-btn-num",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();e=u(this);e.hasClass("disabled")||t.goTo(parseInt(e.attr("data-index"),10))}},{selector:"a.pageing-btn-prev",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),u(this).hasClass("disabled")||t.goTo(--t.pagingPrams.currentPage)}},{selector:"a.pageing-btn-next",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),u(this).hasClass("disabled")||t.goTo(++t.pagingPrams.currentPage)}},{selector:"span.dots",event:"mouseenter",callback:function(e,t){e.stopPropagation(),e.preventDefault();e=u(this);e.hasClass("disabled")||(e.addClass("hidden"),e.parent().find(".btn-more.current").removeClass("hidden"))}},{selector:"span.btn-more",event:"mouseleave",callback:function(e,t){e.stopPropagation(),e.preventDefault();e=u(this);e.hasClass("disabled")||(e.addClass("hidden"),e.parent().find(".dots").removeClass("hidden"))}},{selector:"span.btn-more-left",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),u(this).hasClass("disabled")||(t.pagingPrams.currentPage=t.pagingPrams.currentPage-4<=0?0:t.pagingPrams.currentPage-4,t.goTo(t.pagingPrams.currentPage))}},{selector:"span.btn-more-right",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),u(this).hasClass("disabled")||(t.pagingPrams.currentPage=t.pagingPrams.currentPage+4>=t.pagingPrams.totalPage-1?t.pagingPrams.totalPage-1:t.pagingPrams.currentPage+4,t.goTo(t.pagingPrams.currentPage))}},{selector:".paging-go .text-wrap-inner input",event:"keyup",callback:function(e,t){13===e.keyCode&&t.go()}}],render:function(){this.dom().addClass(this.settings.cls+"incident-list-container"),this.dom().append('<div class="incident-content-wrapper su-scroll"></div>'),this.settings.multiple&&(this.dom().append(this.getPagingHtml()),this.renderPaging())},loadItems:function(e,t){var a=this,i=this.dom().find(".incident-content-wrapper"),s=(e=u.isArray(e)?e:[e],"");u.each(e,function(e,t){s=(s=(s=(s+='<div class="list-item-container level-'+t.level+'" data-key="'+t.key+'">')+a.getTitleHtml(t))+a.getContentHtml(t))+a.getTimeHtml(t.time,t.startTime,t.endTime)+"</div>"}),i.html(s),this.settings.multiple?(a.updatePagingPrams(t),this.numSelectObj.setValue(this.pagingPrams.currentSize),this.goToPage(this.pagingPrams.currentPage)):e[0].contentHtml&&u.each(e[0].contentHtml,function(e,t){var a,i;t.html&&(a=t.callback,i=t.callbackData,u(t=t.html).attr("widget")?(t=new u.su.widgets[u(t).attr("widget")]({id:u(t).attr("id")}),a&&a(t,i)):a&&a(i))})},getTitleHtml:function(e){var t=e.category,a=e.title,i=e.status,e=e.frequency;return u.isNumeric(t)&&a?'<div class="item-header-container"><div class="item-title-container">'+'<span class="title-text">['+u.appUtils.getIncidentCategoryText(t)+"] "+a+"</span></div>"+this.getCornerHtml(i,e)+"</div>":""},getContentHtml:function(e){var a,t=e.contentHtml,e=e.content;return t||e?(a="",a+='<div class="item-content-container">',e&&u.each(e.split("\n"),function(e,t){a+='<div class="item-content-text">'+t.trim()+"</div>"}),t&&u.each(t,function(e,t){a+=t.html||'<div class="item-content-text">'+t.text+"</div>"||""}),a+='</div><div class="item-extend-content-container"></div>'):""},getTimeHtml:function(e,t,a){var i=(i="")+'<div class="item-time-container">'+'<div class="time-icon"></div>';if(u.isNumeric(t)&&u.isNumeric(a)&&0!==t)i+='<div class="time-text">'+this.getFormatTime(t)+" ~ "+this.getFormatTime(a)+"</div>";else{if(!u.isNumeric(e))return"";i+='<div class="time-text">'+this.getFormatTime(e)+"</div>"}return i+="</div>"},getFormatTime:function(e){return this.settings.timeZoneType=u.su.serviceManager.get("user").isSiteView()?"site":"controller",u.su.serviceManager.get("time").getTextFromUTC(e,this.settings.timeZoneType,{pattern:"MM dd, yyyy hh:mm hc"})},getCornerHtml:function(e,t){return u.isNumeric(e)?'<div class="status-'+e+' top-right-corner"> '+u.appUtils.getIncidentStatusText(e)+"</div>":u.isNumeric(t)?'<div class="frequency top-right-corner">'+t+"</div>":""},getPagingHtml:function(){var e="";return(e+='<div id="'+this.domId+'-paging-container">')+'<div class="container widget-container paging-container disabled">'+'<div class="paging-wrap u-d-none">'+'<div class="paging-wrap-inner u-d-inline-block">'+'<div class="paging-info-container u-d-inline-block">'+'<div class="paging-info u-d-inline-block">'+"<span></span>"+"</div>"+"</div>"+'<div class="paging-items hidden">'+'<span class="content u-d-inline-block"></span>'+"</div>"+'<div class="paging-btns u-d-inline-block">'+'<a href="javascript:void(0);" class="paging-btn hidden pageing-btn-first" data-index="first">'+'<span class="icon"></span>'+'<span class="text"><<</span>'+"</a>"+'<a href="javascript:void(0);" class="paging-btn pageing-btn-prev" data-index="prev">'+'<span class="icon"></span>'+'<span class="text"></span>'+"</a>"+'<div class="num-buttons-container">'+"</div>"+'<a href="javascript:void(0);" class="paging-btn pageing-btn-next" data-index="next">'+'<span class="icon"></span>'+'<span class="text"></span>'+"</a>"+'<a href="javascript:void(0);" class="paging-btn hidden pageing-btn-last" data-index="last">'+'<span class="icon"></span>'+'<span class="text">>></span>'+"</a>"+"</div>"+'<div class="paging-options u-d-inline-block">'+'<div class="paging-select inline-block">'+('<div id="'+this.domId+'_select"  widget="combobox" class="u-label-none"></div>')+"</div>"+"</div>"+'<div class="paging-go u-d-inline-block">'+('<div widget="textbox" id="'+this.domId+'_textbox" label-field="{GRID.PAGE_TO}" class="u-label-auto"></div>')+('<div widget="button" id="'+this.domId+'_button" text="'+u.su.CHAR.COMMON.GO+'"></div>')+"</div>"+'<div class="paging-separator hidden">'+'<span class="icon"></span>'+"</div>"+'<div class="paging-total hidden">'+'<span class="content u-d-inline-block"></span>'+"</div>"+"</div>"+"</div>"+"</div>"+'<input type="hidden" class="hidden paging-input">'+"</div>"},renderPaging:function(){this.renderPageNumSelect(),this.renderPageGo()},renderPageNumSelect:function(){var a=this,e=this.settings.configs.paging.items||[];a.numSelectObj=new u.su.widgets.combobox({id:a.domId+"_select"}),a.numSelectObj.render(),e.forEach(function(e,t){e.name+=" "+u.su.CHAR.GRID.OPTIONS_UNIT}),a.numSelectObj.loadItems(e),a.numSelectObj.dom().on("ev_view_change",function(e,t){a.pagingPrams.currentSize=t.value,a.numSelectObj.setValue(t.value),a.pagingPrams.currentPage>a.pagingPrams.totalPage&&(a.pagingPrams.currentPage=0),a.goTo(a.pagingPrams.currentPage)})},renderPageGo:function(){var t=this;t.textbox=new u.su.widgets.textbox({id:this.domId+"_textbox"}),t.pageButton=new u.su.widgets.button({id:this.domId+"_button"}),t.textbox.render(),t.pageButton.render(),t.pageButton.dom().addClass("disabled"),t.textbox.dom().on("ev_view_change",function(){var e=t.textbox.getValue(),e=parseInt(e,10)-1;u.isNumeric(e)?t.pageButton.dom().removeClass("disabled"):t.pageButton.dom().addClass("disabled")}),t.pageButton.dom().on("ev_button_click",function(){t.go()})},go:function(){var e=this.textbox.getValue(),e=parseInt(e,10)-1;u.isNumeric(e)&&e!==this.pagingPrams.currentPage&&this.goTo(e),this.textbox.setValue(""),this.pageButton.dom().addClass("disabled")},updatePagingPrams:function(e){e&&(this.pagingPrams={currentPage:e.currentPage-1,currentSize:e.currentSize,totalRows:e.totalRows,totalPage:Math.ceil(e.totalRows/e.currentSize)})},goToPage:function(e){var t=this,a=this.dom(),i=a.find("div.paging-container"),s=t.pagingPrams.totalRows,e=(t.pagingPrams.currentPage=isNaN(e)?0:e,t.pagingPrams.totalPage=Math.ceil(t.pagingPrams.totalRows/t.pagingPrams.currentSize),t.pagingPrams.currentPage>=t.pagingPrams.totalPage&&0<t.pagingPrams.totalPage?t.pagingPrams.currentPage=t.pagingPrams.totalPage-1:t.pagingPrams.currentPage<0&&(t.pagingPrams.currentPage=0),this.updateNumBtns(),0===s?0:t.pagingPrams.currentPage*t.pagingPrams.currentSize+1),n=s<(n=0===s?0:e+t.pagingPrams.currentSize-1)?s:n,l=u.su.CHAR.COMMON.GRID_PAGING_SHOW,o=(l=(l=(l=l.replace("%start",e)).replace("%end",n)).replace("%total",s),a.find(".paging-info span").text(l),i.find("a.paging-btn.pageing-btn-prev")),d=i.find("a.paging-btn.pageing-btn-next"),r=i.find("a.paging-btn.pageing-btn-first"),c=i.find("a.paging-btn.pageing-btn-last"),e=i.find("a.paging-btn-num"),n=i.find("span.dots"),s=i.find("span.btn-more");e.removeClass("current"),s.removeClass("current").addClass("hidden"),n.addClass("hidden"),e.filter("[data-index="+t.pagingPrams.currentPage+"]").addClass("current"),7<=t.pagingPrams.totalPage&&(a=t.pagingPrams.totalPage-1,l=t.pagingPrams.currentPage-1,s=t.pagingPrams.currentPage+1,t.pagingPrams.currentPage<=3?(l=0,s=4):t.pagingPrams.currentPage>=t.pagingPrams.totalPage-4&&(l=t.pagingPrams.totalPage-5,s=t.pagingPrams.totalPage),0!==l&&((n=i.find(".pageing-btn-0").next(".dots-container")).find(".dots").removeClass("hidden"),n.find(".btn-more-left").addClass("current")),s!==a)&&((e=i.find(".pageing-btn-"+s).next(".dots-container")).find(".dots").removeClass("hidden"),e.find(".btn-more-right").addClass("current")),setTimeout(function(){o.removeClass("disabled"),d.removeClass("disabled"),r.removeClass("disabled"),c.removeClass("disabled"),0===t.pagingPrams.currentPage&&(r.addClass("disabled"),o.addClass("disabled")),t.pagingPrams.currentPage>=t.pagingPrams.totalPage-1&&(d.addClass("disabled"),c.addClass("disabled"))},180)},goTo:function(e){this.goToPage(e),this.dom().triggerHandler("ev_paging_change",[this.pagingPrams.currentPage+1,this.pagingPrams.currentSize])},updateNumBtns:function(){var e=this.pagingPrams.currentPage,t=this.pagingPrams.totalPage,a=this.dom().find("div.paging-wrap"),i=a.find("div.num-buttons-container");if(0===t)a.addClass("disabled").hide();else{a.removeClass("disabled").show();var s="",n=0;if(5<t){var a=t-1,l=e-1,o=e+1;for(e<=3?(l=0,o=4):t-4<=e&&(l=t-5,o=t-1),0!==l&&(s+=this.getPageNum(0)),n=l;n<=o;n++)s+=this.getPageNum(n);o!==a&&(s+=this.getPageNum(a))}else for(n=0;n<t;n++)s+=this.getPageNum(n);i.empty().append(u(s))}},getPageNum:function(e){var t="";return(t+='<a href="javascript:void(0);" class="paging-btn paging-btn-num pageing-btn-'+e+'" data-index="'+e+'">')+'<span class="icon"></span>'+('<span class="text">'+(e+1)+"</span>")+"</a>"+'<div class="dots-container u-d-inline-block">'+'<span class="btn-more-left btn-more hidden"></span>'+'<span class="dots"></span>'+'<span class="btn-more-right btn-more hidden"></span>'+"</div>"},addExtendHtml:function(e){this.dom().find(".item-extend-content-container").html(e)}})})(jQuery),(u=>{var s=!1,n=!0;u.su.Widget.register("incidentTimeline",{settings:{timeZoneType:{attribute:"time-zone-type",defaultValue:"site"}},listeners:[{selector:"div.detail",event:"click",callback:function(e,t){var a=u(this).parents(".item-container").attr("data-key");t.dom().triggerHandler("ev_detail_click",[a])}},{selector:".action-btns .action-btn",event:"click",callback:function(e,t){var a,i;u(this).hasClass("disabled")||(a=u(this).parents(".item-container").attr("data-key"),i=u(this).attr("class").split(" ")[0].replace("-btn",""),t.dom().triggerHandler("ev_action_click",[i,a]))}},{selector:"a.paging-btn-num",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault();e=u(this);e.hasClass("disabled")||t.goTo(parseInt(e.attr("data-index"),10))}},{selector:"a.pageing-btn-prev",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),u(this).hasClass("disabled")||t.goPrev()}},{selector:"a.pageing-btn-next",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),u(this).hasClass("disabled")||t.goNext()}},{selector:"span.dots",event:"mouseenter",callback:function(e,t){e.stopPropagation(),e.preventDefault();e=u(this);e.hasClass("disabled")||(e.addClass("hidden"),e.parent().find(".btn-more.current").removeClass("hidden"))}},{selector:"span.btn-more",event:"mouseleave",callback:function(e,t){e.stopPropagation(),e.preventDefault();e=u(this);e.hasClass("disabled")||(e.addClass("hidden"),e.parent().find(".dots").removeClass("hidden"))}},{selector:"span.btn-more-left",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),u(this).hasClass("disabled")||(t.pagingPrams.currentPage=t.pagingPrams.currentPage-4<=0?0:t.pagingPrams.currentPage-4,t.goTo(t.pagingPrams.currentPage))}},{selector:"span.btn-more-right",event:"click",callback:function(e,t){e.stopPropagation(),e.preventDefault(),u(this).hasClass("disabled")||(t.pagingPrams.currentPage=t.pagingPrams.currentPage+4>=t.pagingPrams.totalPage-1?t.pagingPrams.totalPage-1:t.pagingPrams.currentPage+4,t.goTo(t.pagingPrams.currentPage))}},{selector:"#incident-timeline-checkbox-all .checkbox-label",event:"click",callback:function(e,t){var a=t.dom().find(".item-container"),i=[];a.each(function(e,t){i.push(u(t).attr("data-key"))}),u(this).hasClass("checked")?t.updateSelectStatus(i,s):t.updateSelectStatus(i,n)}},{selector:".item-container .checkbox-label",event:"click",callback:function(e,t){var a=u(this).parents(".item-container").attr("data-key");u(this).hasClass("checked")?t.updateSelectStatus([a],s):t.updateSelectStatus([a],n)}},{selector:".selected-all-page",event:"click",callback:function(e,t){t.isSelectAll&&0===t.selectedList.length?t.updateSelectStatus(void 0,s):t.updateSelectStatus(void 0,n)}},{selector:".incident-timeline-title .action-btn-container",event:"click",callback:function(e,t){var a=u(this).find(".action-btn");a.hasClass("disabled")||t.dom().find(".btns-info").hasClass("disabled")||(a=a.attr("action-key"),t.dom().triggerHandler("ev_batch_action_click",[a,{isSelectAll:t.isSelectAll,selectedList:t.selectedList}]))}},{selector:".paging-go .text-wrap-inner input",event:"keyup",callback:function(e,t){13===e.keyCode&&t.go()}}],render:function(){this.initSelectedStatus(),this.dom().addClass(this.settings.cls+"incident-timeline-container"),this.dom().append(this.getPagingHtml()),this.renderPaging()},loadItems:function(e,t){var a=this,i=this.dom(),s="",n=u.appUtils.INCIDENT_STATUS;switch(a.updatePagingPrams(t),u(".incident-timeline-content-container").remove(),s=(s=(s=(s=(s+='<div class="incident-timeline-content-container">')+'<div class="incident-timeline-title">'+'<div class="title-container">')+('<div widget="checkbox" id="'+a.domId+'-checkbox-all" class="u-label-none u-d-inline-block" box-label="{ABNORMAL.TIMELINE_TITLE}"></div>'))+('<div class="incident-num">'+this.pagingPrams.totalRows+"</div>"))+"</div>"+'<div class="btns-info none">',e[0].status){case n.UNRESOLVED:case n.ONGOING:s=(s=(s=(s=s+'<div class="action-btn-container">'+'<div class="resolve-btn action-btn u-d-inline-block" action-key="resolve"></div>')+('<div class="u-d-inline-block icon-text">'+u.su.CHAR.INCIDENT_INFOS.RESOLVE+"</div>")+"</div>")+'<div class="action-btn-container">'+'<div class="ignore-btn action-btn u-d-inline-block" action-key="ignore"></div>')+('<div class="u-d-inline-block icon-text">'+u.su.CHAR.INCIDENT_INFOS.IGNORE+"</div>")+"</div>";break;case n.RESOLVED:case n.IGNORED:s=(s=s+'<div class="action-btn-container">'+'<div class="open-btn action-btn u-d-inline-block" action-key="open"></div>')+('<div class="u-d-inline-block icon-text">'+u.su.CHAR.INCIDENT_INFOS.OPEN+"</div>")+"</div>"}s=(s+='<div class="action-btn-container"><div class="delete-btn action-btn u-d-inline-block" action-key="delete"></div>')+'<div class="u-d-inline-block icon-delete-text">'+u.su.CHAR.OPERATION.DELETE+"</div></div></div></div>",u.each(e,function(e,t){switch(s=(s=(s=(s=(s+='<div class="item-container" data-key="'+t.key+'">')+('<div class="item-time">'+u.su.serviceManager.get("time").getTextFromUTC(t.time,a.settings.timeZoneType,{pattern:"MM dd, yyyy hh:mm hc"})+"</div>")+'<div class="item-content">')+('<div widget="checkbox" id="'+a.domId+"-checkbox-"+e+'" class="u-label-none" box-label="{ABNORMAL.REASON}"></div>'))+('<div class="content-text">'+t.text+"</div>"))+('<div class="detail">'+u.su.CHAR.ABNORMAL.DETAIL+"</div>")+'<div class="action-btns none">',t.status){case n.UNRESOLVED:case n.ONGOING:s=s+'<div class="resolve-btn action-btn" data-tip="{INCIDENT_INFOS.RESOLVE}"></div>'+'<div class="ignore-btn action-btn" data-tip="{INCIDENT_INFOS.IGNORE}"></div>';break;case n.RESOLVED:case n.IGNORED:s+='<div class="open-btn action-btn" data-tip="{INCIDENT_INFOS.OPEN}"></div>'}s+='<div class="delete-btn action-btn" data-tip="{OPERATION.DELETE}"></div></div></div></div>'}),s+="</div>",i.prepend(s),new u.su.widgets.checkbox({id:a.domId+"-checkbox-all"}).render(),i.find(".item-container").find("div[widget=checkbox]").each(function(e,t){new u.su.widgets.checkbox({id:u(this).attr("id")}).render()}),this.numSelectObj.setValue(this.pagingPrams.currentSize),this.goToPage(this.pagingPrams.currentPage),this.setSelectedStatus()},updatePagingPrams:function(e){this.pagingPrams={currentPage:e.currentPage-1,currentSize:e.currentSize,totalRows:e.totalRows,totalPage:Math.ceil(e.totalRows/e.currentSize)}},getPagingHtml:function(){var e="";return(e+='<div id="'+this.domId+'-paging-container">')+'<div class="container widget-container paging-container disabled">'+'<div class="paging-wrap u-d-none">'+'<div class="paging-wrap-inner u-d-inline-block">'+'<div class="selected-info-wrapper u-d-inline-block">'+'<span class="selected-info"></span>'+('<span class="selected-all-page">'+u.su.CHAR.OPERATION.SELECT_ALL+"</span>")+"</div>"+'<div class="paging-info-container u-d-inline-block">'+'<div class="paging-info u-d-inline-block">'+"<span></span>"+"</div>"+"</div>"+'<div class="paging-items hidden">'+'<span class="content u-d-inline-block"></span>'+"</div>"+'<div class="paging-btns u-d-inline-block">'+'<a href="javascript:void(0);" class="paging-btn hidden pageing-btn-first" data-index="first">'+'<span class="icon"></span>'+'<span class="text"><<</span>'+"</a>"+'<a href="javascript:void(0);" class="paging-btn pageing-btn-prev" data-index="prev">'+'<span class="icon"></span>'+'<span class="text"></span>'+"</a>"+'<div class="num-buttons-container">'+"</div>"+'<a href="javascript:void(0);" class="paging-btn pageing-btn-next" data-index="next">'+'<span class="icon"></span>'+'<span class="text"></span>'+"</a>"+'<a href="javascript:void(0);" class="paging-btn hidden pageing-btn-last" data-index="last">'+'<span class="icon"></span>'+'<span class="text">>></span>'+"</a>"+"</div>"+'<div class="paging-options u-d-inline-block">'+'<div class="paging-select inline-block">'+('<div id="'+this.domId+'_select"  widget="combobox" class="u-label-none"></div>')+"</div>"+"</div>"+'<div class="paging-go u-d-inline-block">'+('<div widget="textbox" id="'+this.domId+'_textbox" label-field="{GRID.PAGE_TO}" class="u-label-auto"></div>')+('<div widget="button" id="'+this.domId+'_button" text="'+u.su.CHAR.COMMON.GO+'"></div>')+"</div>"+'<div class="paging-separator hidden">'+'<span class="icon"></span>'+"</div>"+'<div class="paging-total hidden">'+'<span class="content u-d-inline-block"></span>'+"</div>"+"</div>"+"</div>"+"</div>"+'<input type="hidden" class="hidden paging-input">'+"</div>"},renderPaging:function(){this.renderPageNumSelect(),this.renderPageGo()},renderPageNumSelect:function(){var a=this,e=this.settings.configs.paging.items||[];a.numSelectObj=new u.su.widgets.combobox({id:a.domId+"_select"}),a.numSelectObj.render(),e.forEach(function(e,t){e.name+=" "+u.su.CHAR.GRID.OPTIONS_UNIT}),a.numSelectObj.loadItems(e),a.numSelectObj.dom().on("ev_view_change",function(e,t){a.pagingPrams.currentSize=t.value,a.numSelectObj.setValue(t.value),a.pagingPrams.currentPage>a.pagingPrams.totalPage&&(a.pagingPrams.currentPage=0),a.goTo(a.pagingPrams.currentPage)})},renderPageGo:function(){var t=this;t.textbox=new u.su.widgets.textbox({id:this.domId+"_textbox"}),t.pageButton=new u.su.widgets.button({id:this.domId+"_button"}),t.textbox.render(),t.pageButton.render(),t.pageButton.dom().addClass("disabled"),t.textbox.dom().on("ev_view_change",function(){var e=t.textbox.getValue(),e=parseInt(e,10)-1;u.isNumeric(e)?t.pageButton.dom().removeClass("disabled"):t.pageButton.dom().addClass("disabled")}),t.pageButton.dom().on("ev_button_click",function(){t.go()})},go:function(){var e=this.textbox.getValue(),e=parseInt(e,10)-1;u.isNumeric(e)&&e!==this.pagingPrams.currentPage&&this.goTo(e),this.textbox.setValue(""),this.pageButton.dom().addClass("disabled")},goToPage:function(e){var t=this,a=this.dom(),i=a.find("div.paging-container"),s=t.pagingPrams.totalRows,e=(t.pagingPrams.currentPage=isNaN(e)?0:e,t.pagingPrams.totalPage=Math.ceil(t.pagingPrams.totalRows/t.pagingPrams.currentSize),t.pagingPrams.currentPage>=t.pagingPrams.totalPage&&0<t.pagingPrams.totalPage?t.pagingPrams.currentPage=t.pagingPrams.totalPage-1:t.pagingPrams.currentPage<0&&(t.pagingPrams.currentPage=0),this.updateNumBtns(),0===s?0:t.pagingPrams.currentPage*t.pagingPrams.currentSize+1),n=s<(n=0===s?0:e+t.pagingPrams.currentSize-1)?s:n,l=u.su.CHAR.COMMON.GRID_PAGING_SHOW,o=(l=(l=(l=l.replace("%start",e)).replace("%end",n)).replace("%total",s),a.find(".paging-info span").text(l),i.find("a.paging-btn.pageing-btn-prev")),d=i.find("a.paging-btn.pageing-btn-next"),r=i.find("a.paging-btn.pageing-btn-first"),c=i.find("a.paging-btn.pageing-btn-last"),e=i.find("a.paging-btn-num"),n=i.find("span.dots"),s=i.find("span.btn-more");e.removeClass("current"),s.removeClass("current").addClass("hidden"),n.addClass("hidden"),e.filter("[data-index="+t.pagingPrams.currentPage+"]").addClass("current"),7<=t.pagingPrams.totalPage&&(a=t.pagingPrams.totalPage-1,l=t.pagingPrams.currentPage-1,s=t.pagingPrams.currentPage+1,t.pagingPrams.currentPage<=3?(l=0,s=4):t.pagingPrams.currentPage>=t.pagingPrams.totalPage-4&&(l=t.pagingPrams.totalPage-5,s=t.pagingPrams.totalPage),0!==l&&((n=i.find(".pageing-btn-0").next(".dots-container")).find(".dots").removeClass("hidden"),n.find(".btn-more-left").addClass("current")),s!==a)&&((e=i.find(".pageing-btn-"+s).next(".dots-container")).find(".dots").removeClass("hidden"),e.find(".btn-more-right").addClass("current")),setTimeout(function(){o.removeClass("disabled"),d.removeClass("disabled"),r.removeClass("disabled"),c.removeClass("disabled"),0===t.pagingPrams.currentPage&&(r.addClass("disabled"),o.addClass("disabled")),t.pagingPrams.currentPage>=t.pagingPrams.totalPage-1&&(d.addClass("disabled"),c.addClass("disabled"))},180)},goTo:function(e){this.goToPage(e),this.dom().triggerHandler("ev_paging_change",[this.pagingPrams.currentPage+1,this.pagingPrams.currentSize])},updateNumBtns:function(){var e=this.pagingPrams.currentPage,t=this.pagingPrams.totalPage,a=this.dom().find("div.paging-wrap"),i=a.find("div.num-buttons-container");if(0===t)a.addClass("disabled").hide();else{a.removeClass("disabled").show();var s="",n=0;if(5<t){var a=t-1,l=e-1,o=e+1;for(e<=3?(l=0,o=4):t-4<=e&&(l=t-5,o=t-1),0!==l&&(s+=this.getPageNum(0)),n=l;n<=o;n++)s+=this.getPageNum(n);o!==a&&(s+=this.getPageNum(a))}else for(n=0;n<t;n++)s+=this.getPageNum(n);i.empty().append(u(s))}},getPageNum:function(e){var t="";return(t+='<a href="javascript:void(0);" class="paging-btn paging-btn-num pageing-btn-'+e+'" data-index="'+e+'">')+'<span class="icon"></span>'+('<span class="text">'+(e+1)+"</span>")+"</a>"+'<div class="dots-container u-d-inline-block">'+'<span class="btn-more-left btn-more hidden"></span>'+'<span class="dots"></span>'+'<span class="btn-more-right btn-more hidden"></span>'+"</div>"},goPrev:function(){this.goTo(--this.pagingPrams.currentPage)},goNext:function(){this.goTo(++this.pagingPrams.currentPage)},updateAllPageCheckboxStatus:function(){var e="",t=this.dom().find(".item-container").find(".checkbox-label").length,a=this.dom().find(".item-container").find(".checkbox-label.checked").length,i=this.dom().find("#incident-timeline-checkbox-all").find(".checkbox-label");0!==a&&(t===a?e="checked":a<t&&(e="imperfect")),i.removeClass("imperfect checked"),i.addClass(e)},disableActionBtns:function(){this.dom().find(".action-btn").addClass("disabled")},enableActionBtns:function(){this.dom().find(".action-btn").removeClass("disabled")},initSelectedStatus:function(){this.isSelectAll=!1,this.selectedList=[]},updateSelectStatus:function(e,t){this.updateSelectedList(e,t),this.setSelectedStatus()},updateSelectedList:function(e,t){var a=this,i=t?!this.isSelectAll:this.isSelectAll;e?u.each(e,function(e,t){i?-1===a.selectedList.indexOf(t)&&a.selectedList.push(t):-1!==(t=a.selectedList.indexOf(t))&&a.selectedList.splice(t,1)}):(this.isSelectAll=t,this.selectedList=[]),this.updateSelectAllStatus()},updateSelectAllStatus:function(){this.selectedList.length===this.pagingPrams.totalRows&&(this.isSelectAll=!this.isSelectAll,this.selectedList=[])},updateCheckboxStatus:function(){var a=this,e=a.dom().find(".item-container .checkbox-label");this.isSelectAll?e.addClass("checked"):e.removeClass("checked"),u.each(a.selectedList,function(e,t){t=a.dom().find('.item-container[data-key="'+t+'"]').find(".checkbox-label");a.isSelectAll?t.removeClass("checked"):t.addClass("checked")}),this.updateAllPageCheckboxStatus()},updateSelectedInfo:function(){var e=this.dom().find(".selected-info"),t=this.isSelectAll?this.pagingPrams.totalRows-this.selectedList.length:this.selectedList.length,t=u.su.CHAR.GRID.SELECTED_INFO.replace("%selected",t).replace("%total",this.pagingPrams.totalRows);e.text(t)},setSelectedStatus:function(){this.updateCheckboxStatus(),this.updateSelectedInfo(),this.updateBatchActionStatus()},updateBatchActionStatus:function(){this.isSelectAll&&this.pagingPrams.totalRows||!this.isSelectAll&&0<this.selectedList.length?this.dom().find(".btns-info").removeClass("disabled"):this.dom().find(".btns-info").addClass("disabled")},toggleAllActionBtn:function(e){e?(this.dom().find(".btns-info").removeClass("none"),this.dom().find(".action-btns").removeClass("none")):(this.dom().find(".btns-info").addClass("none"),this.dom().find(".action-btns").addClass("none"))}})})(jQuery),(s=>{s.su.Widget.register("repeatList",{settings:{multiSelect:{attribute:"multi-select",defaultValue:!1},textWidth:{attribute:"text-width",defaultValue:130},maxSelectedNum:{attribute:"max-selected-num",defaultValue:!1}},listeners:[{selector:".repeat-list-item",event:"click",callback:function(e,a){if(!s(this).hasClass("disabled")){if(a.settings.multiSelect){if(s.isNumeric(a.settings.maxSelectedNum)&&a.getSelectedItems().length>=a.settings.maxSelectedNum&&!s(this).hasClass("active"))return;s(this).siblings().removeClass("max-disabled"),s(this).toggleClass("active"),a.getSelectedItems().length===a.settings.maxSelectedNum&&s(this).siblings().each(function(e,t){a.disableExceptActive(t)})}else s(this).siblings().removeClass("active"),s(this).addClass("active");a.dom().triggerHandler("ev_item_click")}}}],render:function(){var e=this.dom();e.addClass(this.settings.cls+"repeat-list-container");e.append('<div class="repeat-list-wrap su-scroll"></div>')},loadItems:function(e){var a="",i=this.settings;s.each(e,function(e,t){a=(a=a+('<div class="repeat-list-item" data-key="'+t.key)+'"><div class="repeat-list-item-text u-d-inline-block">')+s.su.ellipsisGridStr(t.text,i.textWidth)+"</div>",t.extendHtml&&(a+=t.extendHtml),a+="</div>"}),this.dom().find(".repeat-list-wrap").html(a)},getSelectedItems:function(){var e=this.dom().find(".repeat-list-item.active"),a=[];return e.each(function(e,t){a.push(s(t).attr("data-key"))}),a},setSelectedItem:function(e){var a=this,i=this.dom().find(".repeat-list-item");i.removeClass("active"),e=s.isArray(e)?e:[e],this.settings.multiSelect?((!s.isNumeric(this.settings.maxSelectedNum)||e.length<=this.settings.maxSelectedNum)&&s.each(e,function(e,t){i.filter('[data-key="'+t+'"]').addClass("active")}),s.isNumeric(this.settings.maxSelectedNum)&&e.length===this.settings.maxSelectedNum&&i.each(function(e,t){a.disableExceptActive(t)})):1<e.length||i.filter('[data-key="'+e[0]+'"]').addClass("active")},disableExceptActive:function(e){s(e).hasClass("active")||s(e).addClass("max-disabled")},disableItem:function(e){var a=this.dom().find(".repeat-list-item");e=s.isArray(e)?e:[e],s.each(e,function(e,t){a.filter('[data-key="'+t+'"]').addClass("disabled")})},toggleMultiSelect:function(e){this.settings.multiSelect=e},setMaxSelectedNum:function(e){this.settings.maxSelectedNum=e}})})(jQuery),$.su.Widget.register("icon",{settings:{svgName:{attribute:"svg-name",defaultValue:""},height:{attribute:"height",defaultValue:20},width:{attribute:"width",defaultValue:20},svgClass:{attribute:"svg-class",defaultValue:""},sharedIcon:{attribute:"shared-icon",defaultValue:!1}},init:function(){},render:function(){var e=this.dom(),t=this.settings,a='<div class="svg-icon-container-wrap">';a=(a+=`<svg class="svg-icon ${t.svgClass}" height="${t.height}" width="${t.width}">`)+`<use xlink:href="${t.sharedIcon?t.svgName:"#svg-icon-"+t.svgName.toLowerCase()}"/>`+"</svg></div>",e.addClass("svg-icon-container").append(a)}});