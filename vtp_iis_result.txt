=== IIS 8.5 + ASP.NET 漏洞利用 [171.244.51.188:8080] ===

[1] IIS短文件名泄露
HTTP/1.1 400 Bad Request
Cache-Control: private
Content-Length: 3297
Content-Type: text/html; charset=utf-8
Server: Microsoft-IIS/8.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Tue, 11 Nov 2025 13:41:17 GMT


[2] ASP.NET页面分析

[3] 常见.NET路径
/elmah.axd -> 404
/trace.axd -> 403
<!DOCTYPE html>
<html>
    <head>
        <title>跟踪错误</title>
        <meta name="viewport" content="width=device-width" />
        <style>
         body {font-family:"Verdana";font-weight:normal;font-size: .7em;color:black;} 
         p {font-family:"Verdana";font-weight:normal;color:black;margin-top: -5px}
         b {font-family:"Verdana";font-weight:bold;color:black;margin-top: -5px}
         H1 { font-family:"Verdana";font-weight:normal;font-size:18pt;color:red }
         H2 { font-family:"Verdana";font-weight:normal;font-size:14pt;color:maroon }
         pre {font-family:"Consolas","Lucida Console",Monospace;font-size:11pt;margin:0;padding:0.5em;line-height:14pt}
         .marker {font-weight: bold; color: black;text-decoration: none;}
         .version {color: gray;}
         .error {margin-bottom: 10px;}
         .expandable { text-decoration:underline; font-weight:bold; color:navy; cursor:hand; }
         @media screen and (max-width: 639px) {
          pre { width: 440px; overflow: auto; white-space: pre-wrap; word-wrap: break-word; }
         }
         @media screen and (max-width: 479px) {
          pre { width: 280px; }
         }
        </style>
    </head>

    <body bgcolor="white">

            <span><H1>“/”应用程序中的服务器错误。<hr width=100% size=1 color=silver></H1>

            <h2> <i>跟踪错误</i> </h2></span>

            <font face="Arial, Helvetica, Geneva, SunSans-Regular, sans-serif ">

            <b> 说明: </b>当前跟踪设置禁止远程查看 trace.axd (出于安全原因)。然而可以通过在本地服务器计算机上运行的浏览器进行查看。
            <br><br>

            <b>详细信息:</b> 若要可以在远程计算机上查看 trace.axd，请在当前 web 应用程序根目录下的配置文件中创建 &lt;trace&gt; 标记。然后应该将此 &lt;trace&gt; 标记的“localOnly”特性设置为“false”。<br><br>

            <table width=100% bgcolor="#ffffcc">
               <tr>
                  <td>
                      <code><pre>

&lt;configuration&gt;
    &lt;system.web&gt;
        &lt;trace localOnly=&quot;false&quot;/&gt;
    &lt;/system.web&gt;
&lt;/configuration&gt;</pre></code>

                  </td>
/WebResource.axd -> 404
/ScriptResource.axd -> 404
/.well-known -> 404
/api -> 404
/swagger -> 404
