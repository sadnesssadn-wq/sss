# ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—

## ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
pip3 install -r requirements.txt
```

æˆ–ç›´æ¥å®‰è£…ï¼š
```bash
pip3 install requests
```

---

## ç¬¬äºŒæ­¥ï¼šæµ‹è¯•è¿è¡Œï¼ˆæ¨èï¼ï¼‰

**å…ˆè¿è¡Œæµ‹è¯•ç‰ˆï¼ŒéªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸**ï¼š

```bash
python3 test_scan_full_api.py
```

### æµ‹è¯•ç‰ˆç‰¹ç‚¹
- âœ… åªæ‰«æ 100 ä¸ªå·æ®µ
- âœ… åªæ‰¾ 10 ä¸ªè®¢å•
- âœ… 1-2åˆ†é’Ÿå®Œæˆ
- âœ… è¯¦ç»†æ˜¾ç¤ºæ¯ä¸ªAPIè°ƒç”¨è¿‡ç¨‹

### é¢„æœŸè¾“å‡º
```
ğŸ§ª æµ‹è¯•ç‰ˆ - 3ä¸ªAPIå®Œæ•´è°ƒç”¨æµ‹è¯•

âœ… åŠ è½½ 5 ä¸ªä»£ç†

ğŸš€ å¼€å§‹æµ‹è¯•...

ğŸ” [EF043571075VN] è°ƒç”¨API 1/3: Inquiry...
   âœ… API1 Code: 00
   ğŸ“¦ è°ƒç”¨API 2/3: DeliveryLadingJourney...
   âœ… API2 Code: 01
   âš ï¸  æ— é…é€è®°å½•ï¼ˆæœªç­¾æ”¶ï¼‰
   ğŸ è°ƒç”¨API 3/3: Gateway/Bussiness...
   âœ… API3 Code: 01

======================================================================
âœ… æ‰¾åˆ°ä»Šå¤©æœªé…é€è®¢å• [1/10]
======================================================================
è¿å•å·: EF043571075VN
å‘ä»¶äºº: ViÃªn TÄƒng CÃ¢n Hoa Báº£o
æ”¶ä»¶äºº: HoÃ ng thá»‹ Thá»§y | ğŸ“ 834358808
åœ°å€: ThÃ´n 6, XÃ£ Tháº¡ch HoÃ , Huyá»‡n Tháº¡ch Tháº¥t, HÃ  Ná»™i.1
é‡‘é¢: 1,500,000 VND
é‡é‡: 250 g
çŠ¶æ€: C10
å‘ä»¶æ—¥æœŸ: 15/10/2025
å•†å“: ***
å·²é…é€: å¦
é…é€è®°å½•: 0 æ¡
======================================================================
```

### æµ‹è¯•æˆåŠŸæ ‡å¿—
- âœ… 3ä¸ªAPIéƒ½è¿”å› Codeï¼ˆ00 æˆ– 01 éƒ½æ­£å¸¸ï¼‰
- âœ… èƒ½æ‰¾åˆ°ä»Šå¤©çš„è®¢å•
- âœ… ç”Ÿæˆ `test_result_*.csv` å’Œ `test_result_*.json`

---

## ç¬¬ä¸‰æ­¥ï¼šæ­£å¼æ‰«æ

**æµ‹è¯•æˆåŠŸåï¼Œè¿è¡Œæ­£å¼ç‰ˆ**ï¼š

```bash
python3 scan_today_full_api.py
```

### æ­£å¼ç‰ˆç‰¹ç‚¹
- ğŸ¯ ç›®æ ‡ï¼š10,000 ä¸ªè®¢å•
- ğŸ”„ 30 çº¿ç¨‹é«˜é€Ÿå¹¶å‘
- ğŸŒ 100 ä¸ªä»£ç†æ± 
- âš¡ æ‰«æ 4 ä¸ªç³»åˆ—çš„å¯†é›†åŒºé—´

### é¢„æœŸè¾“å‡º
```
ğŸš€ æ‰«æä»Šå¤©æœªç­¾æ”¶è®¢å•ï¼ˆå®Œæ•´ç‰ˆ-3ä¸ªAPIå…¨å­—æ®µï¼‰

âœ… åŠ è½½ 100 ä¸ªä»£ç†

ğŸš€ å¼€å§‹é«˜é€Ÿæ‰«æï¼ˆå®Œæ•´ç‰ˆï¼‰...

âœ… [1/10000] EF043571075VN | ğŸ‘¤HoÃ ng thá»‹ Thá»§y | ğŸ“834358808 | ğŸ’°1,500,000â‚« | ğŸ“¦*** | âš¡52/s
âœ… [2/10000] EB102885483VN | ğŸ‘¤Nguyá»…n Thá»‹ NÃ¹i | ğŸ“0979738052 | ğŸ’°1,500,000â‚« | ğŸ“¦*** | âš¡56/s
...

ğŸ“Š å·²æ‰«1000 | æ‰¾åˆ°23 | 58/s | 2.30%

ğŸ’¾ å·²ä¿å­˜ 100 ä¸ªè®¢å•:
   ğŸ“„ CSV: today_undelivered_full_20251015_143022.csv
   ğŸ“„ JSON: today_undelivered_full_20251015_143022.json
```

---

## ç¬¬å››æ­¥ï¼šæŸ¥çœ‹ç»“æœ

### æ‰“å¼€CSVæ–‡ä»¶ï¼ˆExcelï¼‰
```
åŒå‡» today_undelivered_full_*.csv
```

**CSVåŒ…å«æ‰€æœ‰å­—æ®µ**ï¼š
- å‘ä»¶äºº/æ”¶ä»¶äººå®Œæ•´ä¿¡æ¯
- æ‰€æœ‰é‡‘é¢æ˜ç»†
- é…é€çŠ¶æ€
- å•†å“ä¿¡æ¯
- é…é€ç…§ç‰‡URL

### æŸ¥çœ‹JSONæ–‡ä»¶
```bash
cat today_undelivered_full_*.json | jq .
```

æˆ–ç”¨ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ã€‚

**JSONåŒ…å«åµŒå¥—æ•°æ®**ï¼š
- é…é€è½¨è¿¹åˆ—è¡¨ï¼ˆå¤šæ¡è®°å½•ï¼‰
- å•†å“åˆ—è¡¨ï¼ˆå¤šä¸ªå•†å“ï¼‰
- å®Œæ•´çš„ç»Ÿè®¡ä¿¡æ¯

---

## ğŸ¯ è·å–çš„å®Œæ•´ä¿¡æ¯ç¤ºä¾‹

### æ¯ä¸ªè®¢å•åŒ…å« 42+ ä¸ªå­—æ®µï¼š

```json
{
  "tracking": "EF043571075VN",
  
  // åŸºæœ¬ä¿¡æ¯
  "ParcelCode": "EF043571075VN",
  "Weigh": "250",
  "Status": "C10",
  
  // å‘ä»¶äºº
  "SenderName": "ViÃªn TÄƒng CÃ¢n Hoa Báº£o",
  "SenderPhone": "0919386150",
  "SenderAddress": "ViÃªn tÄƒng cÃ¢n hoa báº£o. Phan ÄÃ¬nh PhÃ¹ng, ThÃ¡i NguyÃªn",
  
  // æ”¶ä»¶äºº
  "ReceiverName": "HoÃ ng thá»‹ Thá»§y-834358808",
  "ReceiverPhone": "834358808",
  "ReceiverAddress": "ThÃ´n 6, XÃ£ Tháº¡ch HoÃ , Huyá»‡n Tháº¡ch Tháº¥t, HÃ  Ná»™i.1",
  "ReceiverIDNumber": "",
  
  // é‡‘é¢ï¼ˆ7ä¸ªå­—æ®µï¼‰
  "CollectAmount": 1500000,
  "AmountCOD": 0,
  "FeeShip": 0,
  "FeePPA": 0,
  "FeeC": 0,
  "FeeCancelOrder": 0,
  "FeeCollectLater": 0,
  
  // æ—¥æœŸ
  "IssueDate": "15/10/2025",
  "LoadDate": null,
  "DeliveryDate": null,
  
  // é…é€ä¿¡æ¯
  "IssuePOCode": "",
  "DeliveryPOCode": "100000",
  "RouteCode": "",
  "DeliverySignature": "",    // ç­¾åç…§ç‰‡URL
  "DeliveryImage": "",         // é…é€ç…§ç‰‡URL
  "DeliveryImageAuthen": "",   // è®¤è¯ç…§ç‰‡URL
  
  // å…¶ä»–ä¿¡æ¯
  "Note": "",
  "Instruction": "",
  "VATCode": "",
  "ReasonName": "",
  "SolutionName": "",
  
  // API 2 æ•°æ®ï¼ˆé…é€è½¨è¿¹ï¼‰
  "is_delivered": false,
  "journey_count": 0,
  "journey_records": [],
  
  // API 3 æ•°æ®ï¼ˆå•†å“ï¼‰
  "product_count": 1,
  "product_name": "***",
  "products": [
    {
      "ProductName": "***",
      "Quantity": 0,
      "Weight": 0,
      "Price": 0
    }
  ]
}
```

---

## ğŸ“Š æ•°æ®åº”ç”¨ç¤ºä¾‹

### 1. Excel åˆ†æ

æ‰“å¼€ CSV æ–‡ä»¶åï¼Œå¯ä»¥ï¼š

- âœ… æŒ‰é‡‘é¢æ’åºï¼ˆæ‰¾å‡ºå¤§é¢è®¢å•ï¼‰
- âœ… æŒ‰åŒºåŸŸç­›é€‰ï¼ˆç»Ÿè®¡å„åœ°è®¢å•ï¼‰
- âœ… æŒ‰çŠ¶æ€åˆ†ç»„ï¼ˆåˆ†æé…é€çŠ¶æ€ï¼‰
- âœ… é€è§†è¡¨åˆ†æï¼ˆå¤šç»´åº¦ç»Ÿè®¡ï¼‰

### 2. ç¼–ç¨‹å¤„ç†

```python
import json

# è¯»å–JSONæ•°æ®
with open('today_undelivered_full_20251015_143022.json', 'r') as f:
    data = json.load(f)

# ç»Ÿè®¡æ€»é‡‘é¢
total_amount = sum(order['CollectAmount'] for order in data['orders'])
print(f"ä»Šæ—¥æœªç­¾æ”¶è®¢å•æ€»é‡‘é¢: {total_amount:,} VND")

# ç»Ÿè®¡åŒºåŸŸåˆ†å¸ƒ
from collections import Counter
addresses = [order['ReceiverAddress'] for order in data['orders']]
# æå–åŸå¸‚
cities = [addr.split(',')[-1].strip() for addr in addresses]
city_count = Counter(cities)
print(f"è®¢å•æœ€å¤šçš„åŸå¸‚: {city_count.most_common(5)}")

# ç»Ÿè®¡é…é€çŠ¶æ€
delivered = sum(1 for order in data['orders'] if order['is_delivered'])
print(f"å·²é…é€: {delivered}, æœªé…é€: {len(data['orders']) - delivered}")
```

---

## âš™ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹æ‰«æåŒºé—´

ç¼–è¾‘ `scan_today_full_api.py`ï¼š

```python
SCAN_RANGES = [
    # åªæ‰«æ EF ç³»åˆ—
    ('EF', 48000000, 49000000, 10),
]
```

### ä¿®æ”¹ç›®æ ‡æ•°é‡

```python
TARGET = 1000  # æ”¹ä¸ºåªæ‰¾1000ä¸ª
```

### ä¿®æ”¹å¹¶å‘æ•°

```python
max_workers=10  # é™ä½å¹¶å‘ï¼ˆå¦‚æœç½‘ç»œä¸ç¨³å®šï¼‰
```

### ä¿å­˜æ‰€æœ‰è®¢å•ï¼ˆåŒ…æ‹¬å·²ç­¾æ”¶ï¼‰

æ‰¾åˆ°è¿™è¡Œå¹¶æ³¨é‡Šæ‰ï¼š
```python
# if not order['is_delivered']:
#     with state['lock']:
#         ...

# æ”¹ä¸ºç›´æ¥ä¿å­˜
with state['lock']:
    state['found'] += 1
    state['orders'].append(order)
```

---

## â“ å¸¸è§é—®é¢˜

### Q: è¿è¡Œåæ²¡æœ‰æ‰¾åˆ°è®¢å•ï¼Ÿ
A: å¯èƒ½åŸå› ï¼š
- ä»Šå¤©ç¡®å®æ²¡æœ‰æ–°è®¢å•ï¼ˆè¯•è¯•æ”¹ä¸ºæ˜¨å¤©çš„æ—¥æœŸï¼‰
- æ‰«æåŒºé—´ä¸å¯¹ï¼ˆæ¢å…¶ä»–ç³»åˆ—è¯•è¯•ï¼‰
- ç½‘ç»œé—®é¢˜ï¼ˆæ£€æŸ¥ä»£ç†æ˜¯å¦æ­£å¸¸ï¼‰

### Q: é€Ÿåº¦å¾ˆæ…¢æ€ä¹ˆåŠï¼Ÿ
A: 
1. æ£€æŸ¥ä»£ç†æ˜¯å¦å¯ç”¨
2. å‡å°‘å¹¶å‘æ•°ï¼ˆmax_workersï¼‰
3. å¢å¤§æ­¥é•¿ï¼ˆstepï¼‰

### Q: CSV ä¹±ç æ€ä¹ˆåŠï¼Ÿ
A: 
- æ–‡ä»¶å·²ä½¿ç”¨ UTF-8 BOM ç¼–ç 
- ç”¨ Excel æ‰“å¼€åº”è¯¥ä¸ä¹±ç 
- å¦‚æœè¿˜æ˜¯ä¹±ç ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€å¦å­˜ä¸º UTF-8

### Q: æƒ³ä¸‹è½½é…é€ç…§ç‰‡æ€ä¹ˆåŠï¼Ÿ
A: 
```python
# ä»CSVä¸­æå–ç…§ç‰‡URL
import pandas as pd
df = pd.read_csv('today_undelivered_full_*.csv')

# ä¸‹è½½ç­¾åç…§ç‰‡
import requests
for idx, row in df.iterrows():
    if row['é…é€ç­¾åURL']:
        url = row['é…é€ç­¾åURL']
        r = requests.get(url)
        with open(f"signature_{idx}.jpg", 'wb') as f:
            f.write(r.content)
```

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ å¯ä»¥ï¼š
- âœ… è·å–ä»Šå¤©æ‰€æœ‰æœªç­¾æ”¶è®¢å•çš„**å®Œæ•´ä¿¡æ¯**
- âœ… å¯¼å‡º Excel è¿›è¡Œ**æ•°æ®åˆ†æ**
- âœ… ç”¨ JSON è¿›è¡Œ**ç¨‹åºåŒ–å¤„ç†**
- âœ… ä¸‹è½½**é…é€è¯æ®ç…§ç‰‡**

æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ [è¯¦ç»†æ–‡æ¡£](README_SCAN.md)ã€‚

**Happy Scanning! ğŸš€**
