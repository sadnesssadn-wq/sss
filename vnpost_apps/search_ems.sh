#!/bin/bash
# ???? Vnpost EMS ????

cd /workspace/vnpost_apps
mkdir -p ems_search

echo "[+] Vnpost EMS ??????"
echo "========================================"

# 1. ????????? EMS ??
echo -e "\n[1] ????? com.vnpost"
echo "????: VNPost SSM (Self-Service Mobile)"
echo "??: com.vnpost"
echo "??: ????? EMS ????"

# 2. ??????? EMS ????
echo -e "\n[2] ??? EMS ????:"
possible_packages=(
    "com.vnpost.ems"
    "vn.vnpost.ems"
    "com.ems.vnpost"
    "vn.ems.vnpost"
    "com.vnpost.tracking"
    "vn.vnpost.tracking"
    "com.vnpost.express"
    "vn.vnpost.express"
)

for pkg in "${possible_packages[@]}"; do
    echo "  - $pkg"
    
    # ??? APKPure ??
    wget -q -O "ems_search/${pkg}.apk" \
         "https://d.apkpure.net/b/APK/${pkg}?version=latest" \
         --timeout=30 \
         --user-agent="Mozilla/5.0" 2>/dev/null
    
    if [ -f "ems_search/${pkg}.apk" ]; then
        size=$(stat -c%s "ems_search/${pkg}.apk" 2>/dev/null)
        if [ $size -gt 100000 ]; then
            echo "    [?] ??! ??: $(($size/1024/1024)) MB"
        else
            rm "ems_search/${pkg}.apk"
        fi
    fi
done

# 3. ?? Play Store
echo -e "\n[3] Play Store ????:"
echo "???????:"
echo "  - vnpost ems"
echo "  - vietnam post express"
echo "  - buu dien vietnam"

# 4. ??????????
echo -e "\n[4] ???????:"
echo ""
echo "com.vnpost (35.85 MB) - VNPost SSM"
echo "  ??: ?????????"
echo "  ????:"
echo "    ? EMS ????"
echo "    ? ????"
echo "    ? ????"
echo "    ? ????"
echo ""
echo "vn.vnpost.myvnp (50.45 MB) - MyVNP"
echo "  ??: ??????"
echo "  ????:"
echo "    ? ??????"
echo "    ? ????"
echo "    ? EMS ??"
echo ""
echo "vn.vnpost.collectaddress (2.01 MB)"
echo "  ??: ?????????"
echo "  ???????????"

# 5. ????? EMS ????
echo -e "\n[5] ??? EMS ??????:"
third_party=(
    "com.packagetracker"
    "com.logistics.tracker"
)

echo -e "\n========================================"
echo "[??]"
echo "========================================"
echo ""
echo "Vnpost ??????:"
echo "  1. com.vnpost - ?????? EMS ??"
echo "  2. vn.vnpost.myvnp - ????"
echo "  3. vn.vnpost.collectaddress - ????"
echo "  4. com.datapost.posteyehrm - ????"
echo ""
echo "??:"
echo "  Vietnam Post ????? EMS ????"
echo "  EMS ???????? com.vnpost ?"
echo ""
echo "????:"
echo "  ? ??? com.vnpost (? EMS ??)"
echo "  ? ??? vn.vnpost.myvnp (?????)"
echo ""

# 6. ???????
echo -e "\n[6] ??????????:"
ls -lh ems_search/*.apk 2>/dev/null | awk '{print "  " $9 " - " $5}' || echo "  ?????? EMS ????"

echo -e "\n========================================"
echo "????"
echo "========================================"
