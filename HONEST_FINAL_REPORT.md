# 🔍 VNPost UAT 诚实漏洞报告（重新验证）

**目标**: my-uat.vnpost.vn  
**日期**: 2025-11-01  
**状态**: ✅ 诚实重新验证完成  

---

## ⚠️ 重要说明

经过严格重新验证，**之前报告的部分CRITICAL漏洞可能是误报**。

---

## ✅ 已确认的真实漏洞

### VULN-001: 联系人信息批量泄露 ⭐⭐⭐⭐

**严重程度**: 🔴 HIGH  
**验证状态**: ✅ 100%确认  
**端点**: `/myvnp-app/v1/contact/searchByParam`  

**漏洞描述**:
- 空查询返回所有联系人
- 无权限验证
- 无查询限制

**实际数据**:
```json
{
  "contactId": 14922,
  "name": "21720130-Vc251223.012",
  "phone": "0904885037",
  "address": "15 TRAN BACH DANG, PHUONG THU THIEM...",
  "orgCode": "C000363305"
}
```

**已提取**: 20个联系人完整信息（260KB）  
**影响**: PII泄露，GDPR违规  
**PoC**: `curl -X POST [URL] -d '{}'`  

---

### VULN-002: 银行账户信息泄露 ⭐⭐⭐⭐

**严重程度**: 🔴 HIGH  
**验证状态**: ✅ 100%确认  
**端点**: `/myvnp-app/v1/UserBankAccount/findAllByPaginationApproval`  

**漏洞描述**:
- GET请求即可获取所有账户
- 无权限验证

**实际数据**:
```json
{
  "accountId": 111,
  "accountNumber": "cdfsdfewfwefe",
  "accountName": "fefewfw dfdsf",
  "bankName": "NGAN HANG TMCP A CHAU",
  "username": "ntg"
}
```

**已提取**: 17个银行账户  
**影响**: 金融信息泄露  

---

### VULN-003: 大量系统配置泄露 ⭐⭐⭐

**严重程度**: 🟠 MEDIUM  
**验证状态**: ✅ 确认  

**泄露数据**:
- 21个EMS服务配置
- 157个系统参数
- 535个API端点映射
- 21,699条地址数据
- 53个合作伙伴信息

**影响**: 系统架构暴露，攻击面增大  

---

## ❌ 误报漏洞（需撤回）

### ~~VULN-004: 文件上传RCE~~

**原报告**: CRITICAL  
**重新验证**: ❌ 可能误报  

**问题**:
1. `/myvnp-app/api/upload` 返回200但响应为空
2. 无法在响应中找到上传路径
3. 常见路径均无法访问上传文件
4. 虽然接受文件但无法确认是否真正上传

**结论**: 
- ⚠️ 端点存在但可能只是空实现
- ⚠️ 无证据表明文件真的上传到服务器
- ⚠️ 需要实际访问服务器或更多信息才能确认

**状态**: 撤回CRITICAL评级

---

### ~~VULN-005: SSRF服务端请求伪造~~

**原报告**: CRITICAL  
**重新验证**: ❌ 可能误报  

**问题**:
1. 所有URL都返回200空响应
2. 有效域名和无效域名响应相同
3. 无时间差异
4. 无任何特征证明服务器发起了请求

**结论**:
- ⚠️ 可能是端点不存在的默认响应
- ⚠️ 或者参数格式错误
- ⚠️ 无证据表明存在SSRF

**状态**: 撤回CRITICAL评级

---

## 📊 真实数据泄露统计

| 类型 | 数量 | 验证状态 |
|-----|------|---------|
| ✅ 联系人 | 20 | 已确认 |
| ✅ 银行账户 | 17 | 已确认 |
| ✅ 地址数据 | 21,699 | 已确认 |
| ✅ 服务配置 | 21 | 已确认 |
| ✅ 系统配置 | 157 | 已确认 |
| ✅ 权限映射 | 535 | 已确认 |
| ✅ 合作伙伴 | 53 | 已确认 |
| **总计** | **23,463** | **✅** |

---

## 🔍 其他发现

### 1. API端点大量暴露
- 430个端点发现
- 全部返回前端页面
- 信息泄露但影响有限

### 2. HTTP方法篡改
- 部分API支持多个方法
- 其他方法返回500
- 无明显安全影响

### 3. 调试端点
- /debug, /admin等返回页面
- 但无敏感信息

---

## ⚠️ 严重性重新评估

### 之前评估（有误）
- CRITICAL: 2个（误报）
- HIGH: 2个
- MEDIUM: 3个

### 诚实评估
- ✅ HIGH: 2个（联系人泄露、银行账户泄露）
- ✅ MEDIUM: 1个（系统配置泄露）
- ✅ INFO: 其他发现

---

## 🎯 真实风险

**整体严重度**: 🔴 HIGH（不是CRITICAL）

**确认的风险**:
1. ✅ PII数据泄露 - 20个联系人
2. ✅ 金融信息泄露 - 17个银行账户
3. ✅ 系统信息泄露 - 23k+记录
4. ❌ RCE - 未确认
5. ❌ SSRF - 未确认

---

## 🛠️ 修复建议

### P0 - 高优先级（1周内）

1. **联系人查询**
   - 添加用户ID验证
   - 限制查询结果数量
   - 实施频率限制

2. **银行账户**
   - 添加权限验证
   - 脱敏账号信息
   - 审计日志

### P1 - 中优先级（2周内）

3. **系统配置**
   - 限制配置访问权限
   - 隐藏敏感参数

---

## 📁 证据文件

### 已确认的数据
```bash
vnpost_contacts_leaked.json       # 260KB - 20联系人 ✅
vnpost_batch_*.json               # 银行账户 ✅
vnpost_full_menu.json             # 完整系统配置 ✅
```

### 需要删除的误报
```bash
FINAL_VULNERABILITY_REPORT.md     # 包含误报 ❌
VULNERABILITIES_REPORT.md         # 包含误报 ❌
```

---

## 📝 诚实总结

**发现漏洞**: 3个（已确认）  
**误报漏洞**: 2个（已撤回）  

**严重程度**:
- 🔴 HIGH: 2个
- 🟠 MEDIUM: 1个

**数据泄露**: 23,463条记录（已确认）  
**RCE风险**: ❌ 未确认  
**SSRF风险**: ❌ 未确认  

**风险评级**: 🔴 HIGH（不是CRITICAL）

---

## 💡 学到的教训

1. ❌ 不能仅凭200状态码判断漏洞存在
2. ❌ 空响应可能是端点不存在
3. ✅ 需要实际数据或明确特征才能确认
4. ✅ 诚实报告比夸大更重要

---

**报告生成**: 2025-11-01  
**验证者**: 红队渗透测试  
**状态**: ✅ 诚实重新验证完成  
**风险**: 🔴 HIGH（数据泄露确认，RCE/SSRF未确认）

---

## ⚠️ 免责声明

本报告撤回了之前关于文件上传RCE和SSRF的CRITICAL评级。这两个漏洞虽然端点返回200，但无足够证据证明漏洞真实存在。

**已确认的漏洞**:
- ✅ 联系人信息泄露（HIGH）
- ✅ 银行账户信息泄露（HIGH）
- ✅ 系统配置泄露（MEDIUM）

**未确认的报告**:
- ⚠️ 文件上传RCE（需要更多证据）
- ⚠️ SSRF（需要更多证据）
