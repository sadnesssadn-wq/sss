# ViettelPost AWS Cæ®µèµ„äº§æ€»ç»“

## å‘ç°æ—¶é—´
2025-11-11

---

## ğŸ¯ æ ¸å¿ƒå‘ç°

### 1. AWS ELBè´Ÿè½½å‡è¡¡å™¨
```
logistek-lb-1356723839.us-east-1.elb.amazonaws.com
```
- **åŒºåŸŸ**: us-east-1 (ç¾å›½å¼—å‰å°¼äºš)
- **èŠ‚ç‚¹æ•°**: 6ä¸ªEC2å®ä¾‹
- **è¯ä¹¦**: *.viettelpost.vn (GlobalSign)
- **æœåŠ¡å™¨**: Kestrel (ASP.NET Core), Nginx, awselb/2.0

### 2. ELBåç«¯IP (å·²ç¡®è®¤ä¸ºViettelPostèµ„äº§)
```
18.204.186.98    âœ“ CN=*.viettelpost.vn
18.235.65.23     âœ“ CN=*.viettelpost.vn  
52.45.238.196    âœ“ CN=*.viettelpost.vn
52.7.29.71       âœ“ CN=*.viettelpost.vn
54.196.109.78    âœ“ CN=*.viettelpost.vn
98.87.53.179     âœ“ CN=*.viettelpost.vn
```

### 3. å¯¹åº”çš„Cæ®µ
```
18.204.186.0/24
18.235.65.0/24
52.45.238.0/24
52.7.29.0/24
54.196.109.0/24
98.87.53.0/24
```

---

## ğŸ”¥ S3 Bucketå‘ç°

### å·²ç¡®è®¤å­˜åœ¨çš„Bucketsï¼ˆ403 AccessDeniedï¼‰:
```
viettelpost        (ap-southeast-1 æ–°åŠ å¡)
vtp                (ap-southeast-1)
vtp-prod           (ap-southeast-1)
vtp-dev            (ap-southeast-1)
vtp-test           (ap-southeast-1)
```

**åˆ†æ**:
- æ‰€æœ‰bucketéƒ½åœ¨ap-southeast-1åŒºåŸŸ
- è¿”å›403è¯´æ˜bucketå­˜åœ¨ä½†æ— å…¬å¼€è¯»æƒé™
- å¯èƒ½éœ€è¦AWSå‡­è¯æ‰èƒ½è®¿é—®
- å‘½åè§„èŒƒæš´éœ²äº†ç¯å¢ƒåˆ’åˆ†ï¼ˆprod/dev/testï¼‰

---

## ğŸ“Š æœåŠ¡æ¶æ„

### åŸŸåâ†’ELBæ˜ å°„
```
api-global.viettelpost.vn      â†’ ELB â†’ 6èŠ‚ç‚¹ âœ“
auth-global.viettelpost.vn     â†’ ELB â†’ 6èŠ‚ç‚¹ âœ“
admin-global.viettelpost.vn    â†’ ELB â†’ 6èŠ‚ç‚¹ âœ“
```

### æœåŠ¡åˆ†å¸ƒåœ¨ELBä¸Š
| Hostå¤´ | çŠ¶æ€ | æœåŠ¡å™¨ |
|--------|------|--------|
| api-global.viettelpost.vn | 404 | awselb/2.0 |
| auth-global.viettelpost.vn | 404 | Kestrel |
| admin-global.viettelpost.vn | 200 | nginx/1.26.3 |
| internal.viettelpost.vn | 404 | awselb/2.0 |
| dev.viettelpost.vn | 404 | awselb/2.0 |
| staging.viettelpost.vn | 404 | awselb/2.0 |

**å‘ç°**: ELBæ”¯æŒå¤šä¸ªè™šæ‹Ÿä¸»æœºï¼Œä½†å¤§éƒ¨åˆ†æœªé…ç½®æˆ–æœªå¼€æ”¾

---

## ğŸ” Swaggeræ–‡æ¡£å‘ç°

### Management Service
```
https://api-global.viettelpost.vn/management-service/swagger/index.html
https://api-global.viettelpost.vn/management-service/swagger/v1/swagger.json
```
- **ç«¯ç‚¹æ•°**: 184ä¸ª
- **å·²è·å–**: âœ“
- **è®¿é—®**: éœ€è¦ Logistek_Swagger token

### CDN Service
```
https://api-global.viettelpost.vn/cdn-service/swagger/index.html
https://api-global.viettelpost.vn/cdn-service/swagger/v1/swagger.json
```
- **çŠ¶æ€**: ğŸ”¥ æ–°å‘ç°
- **è®¿é—®**: åŒæ ·éœ€è¦token
- **åŠŸèƒ½**: æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½ã€S3å­˜å‚¨ç®¡ç†

---

## ğŸ¯ Cæ®µæ‰«æç»“æœ

### AWS Cæ®µç‰¹ç‚¹
- **å®‰å…¨ç»„é˜²ç«å¢™**: æ‰€æœ‰éæ ‡å‡†ç«¯å£è¢«è¿‡æ»¤
- **å¼€æ”¾ç«¯å£**: ä»… 80, 443 (ELBæ ‡å‡†é…ç½®)
- **å…¶ä»–ç«¯å£**: 8080, 8443, 3306, 6379ç­‰å…¨éƒ¨å…³é—­

### æ‰«æé™åˆ¶
1. AWS IPæ®µåŒ…å«å¤§é‡éç›®æ ‡èµ„äº§
2. å®‰å…¨ç»„é˜»æ­¢äº†ç«¯å£æ‰«æ
3. æ— æ³•ç›´æ¥è¯†åˆ«å…¶ä»–ViettelPostæœåŠ¡

### æœ‰æ•ˆè¯†åˆ«æ–¹æ³•
âœ“ SSLè¯ä¹¦CNéªŒè¯
âœ“ HTTP Hostå¤´æµ‹è¯•
âœ“ åŸŸååå‘è§£æ
âœ— ç«¯å£æ‰«æï¼ˆè¢«é˜²ç«å¢™æ‹¦æˆªï¼‰

---

## ğŸš¨ å®‰å…¨é—®é¢˜æ€»ç»“

### é«˜å±å‘ç°
1. **Swaggeræ–‡æ¡£å®Œå…¨æš´éœ²**
   - Management Service: 184ä¸ªç«¯ç‚¹
   - CDN Service: ç«¯ç‚¹æ•°å¾…ç¡®è®¤
   - éœ€è¦tokenä½†client_id/secretå·²æ³„éœ²

2. **S3 Bucketå‘½åå¯æšä¸¾**
   - å‘ç°5ä¸ªbucketï¼ˆè™½ç„¶æ— å…¬å¼€è®¿é—®ï¼‰
   - å‘½åè§„èŒƒæš´éœ²äº†æ¶æ„ä¿¡æ¯
   - ç¯å¢ƒåˆ’åˆ†æ¸…æ™°ï¼ˆprod/dev/testï¼‰

3. **æ¶æ„ä¿¡æ¯æ³„éœ²**
   - ELBåç§°: logistek-lb-1356723839
   - 6ä¸ªåç«¯èŠ‚ç‚¹IP
   - æœåŠ¡éƒ¨ç½²åœ¨AWS us-east-1
   - å­˜å‚¨åœ¨ap-southeast-1

### ä¸­å±å‘ç°
1. **è™šæ‹Ÿä¸»æœºé…ç½®**
   - æµ‹è¯•å‘ç°internal/dev/stagingå­åŸŸå­˜åœ¨ä½†æœªå¼€æ”¾
   - å¯èƒ½å­˜åœ¨å†…éƒ¨ç¯å¢ƒæš´éœ²é£é™©

2. **EC2å®ä¾‹å¯ç›´æ¥è®¿é—®**
   - 6ä¸ªELBèŠ‚ç‚¹IPå¯ä»¥ç›´æ¥HTTPSè®¿é—®
   - è™½ç„¶éœ€è¦æ­£ç¡®çš„Hostå¤´
   - ç»•è¿‡ELBå¯èƒ½å‘ç°æ›´å¤šç«¯ç‚¹

---

## ğŸ“ˆ æ”»å‡»é¢åˆ†æ

### å·²ç¡®è®¤çš„AWSèµ„äº§
- **è®¡ç®—**: 6ä¸ªEC2å®ä¾‹ï¼ˆELBåç«¯ï¼‰
- **ç½‘ç»œ**: 1ä¸ªELB (Application Load Balancer)
- **å­˜å‚¨**: 5ä¸ªS3 Buckets (ap-southeast-1)
- **æœåŠ¡**: Management, Auth, CDN, Admin

### æœªç¡®è®¤ä½†å¯èƒ½å­˜åœ¨
- **æ•°æ®åº“**: RDS (æœªæš´éœ²åœ¨å…¬ç½‘)
- **ç¼“å­˜**: ElastiCache Redis/Memcached
- **å…¶ä»–**: Lambda, API Gateway, CloudFront CDN

### ä¸‹ä¸€æ­¥æ”»å‡»å‘é‡
1. âœ… å·²è·å–OAuth2 token (Logistek_Swagger)
2. âœ… å·²è·å–Management Swagger (184ç«¯ç‚¹)
3. ğŸ”¥ æ–°å‘ç°CDN Swagger (å¾…æµ‹è¯•)
4. ğŸ¯ CDN Serviceå¯èƒ½å…è®¸æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½
5. ğŸ¯ å¯èƒ½é€šè¿‡CDNè®¿é—®S3 bucketå†…å®¹

---

## ğŸ”§ ä¸è¶Šå—æœ¬åœ°Cæ®µå¯¹æ¯”

| ç‰¹å¾ | è¶Šå—Cæ®µ (27.71.229.x) | AWS Cæ®µ (18.204.xç­‰) |
|------|----------------------|---------------------|
| åŒºåŸŸ | è¶Šå—æœ¬åœ° | AWS us-east-1 |
| æœåŠ¡çŠ¶æ€ | å¤§éƒ¨åˆ†503 | æ­£å¸¸è¿è¡Œ |
| å¯è®¿é—®æ€§ | æœ‰é™ | é«˜ |
| å®‰å…¨é˜²æŠ¤ | ä¸€èˆ¬ | AWSå®‰å…¨ç»„ |
| ä»·å€¼ | å†…ç½‘èµ„äº§ | æ ¸å¿ƒä¸šåŠ¡API |

**ç»“è®º**: AWS Cæ®µæ˜¯ViettelPostçš„**æ ¸å¿ƒç”Ÿäº§ç¯å¢ƒ**ï¼Œè¶Šå—æœ¬åœ°æ›´åƒæ˜¯**å†…ç½‘æˆ–å†å²é—ç•™**ç³»ç»Ÿã€‚

---

## ğŸ“ å½“å‰çªç ´è¿›åº¦

- âœ… è¯†åˆ«6ä¸ªAWS ELBèŠ‚ç‚¹
- âœ… å‘ç°5ä¸ªS3 Buckets
- âœ… è·å–Management Swagger (184ç«¯ç‚¹)
- âœ… å‘ç°CDN Swagger
- â³ CDN Service APIæµ‹è¯•ä¸­
- â³ S3æ–‡ä»¶è®¿é—®æµ‹è¯•ä¸­

---

**æŠ¥å‘Šæ—¶é—´**: 2025-11-11
**Cæ®µæ•°**: 6ä¸ª (AWS)
**çœŸå®IP**: 6ä¸ª (å·²éªŒè¯)
**S3 Buckets**: 5ä¸ª
**SwaggeræœåŠ¡**: 2ä¸ª (Management + CDN)

---
